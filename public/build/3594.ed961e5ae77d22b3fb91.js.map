{"version":3,"file":"3594.ed961e5ae77d22b3fb91.js","mappings":"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CACE,KAAM,eACN,KAAM,WACN,MAAO,gEACT,EACA,CACE,KAAM,oBACN,KAAM,WACN,MAAO,qEACT,EACA,CACE,KAAM,cACN,KAAM,SACN,MAAO,sDACT,CACF,EAEaC,GAA+C,CAC1D,CACE,KAAM,SACN,KAAM,WACN,MAAO,sCACT,EACA,CACE,KAAM,cACN,KAAM,WACN,MAAO,2CACT,EACA,CACE,KAAM,WACN,KAAM,mBACN,MAAO,gCACT,EACA,CACE,KAAM,SACN,KAAM,mBACN,MAAO,6BACT,CACF,EAEaC,GAAwC,CACnD,CACE,KAAM,SACN,KAAM,SACN,MAAO,qBACT,EACA,CACE,KAAM,SACN,KAAM,WACN,MAAO,sCACT,EACA,CACE,KAAM,cACN,KAAM,WACN,MAAO,2CACT,EACA,CACE,KAAM,SACN,KAAM,WACN,MACE,6IACJ,EACA,CACE,KAAM,WACN,KAAM,YACN,MAAO,gCACT,EACA,CACE,KAAM,SACN,KAAM,YACN,MACE,gJACJ,EACA,CACE,KAAM,eACN,KAAM,SACN,MAAO,kDACT,EACA,CACE,KAAM,aACN,KAAM,SACN,MAAO,qGACT,EACA,CACE,KAAM,eACN,KAAM,SACN,MAAO,2FACT,EACA,CACE,KAAM,WACN,KAAM,SACN,MAAO,iGACT,EACA,CACE,KAAM,cACN,KAAM,SACN,MAAO,qDACT,EACA,CACE,KAAM,cACN,KAAM,SACN,MAAO,oFACT,CACF,EAEaC,GAAoD,CAC/D,CACE,KAAM,cACN,QAAS,WACT,MAAO,iDACT,EACA,CACE,KAAM,SACN,KAAM,WACN,QAAS,WACT,MAAO,6DACT,EACA,CACE,KAAM,QACN,QAAS,WACT,MAAO,qBACT,EACA,CACE,KAAM,SACN,QAAS,WACT,MAAO,sBACT,CACF,EAEaC,GAAsB;AAAA;AAAA;AAAA;AAAA,E,gBC7J5B,SAASC,IAAmB,CACjC,MAAMzE,KAAS,MAAW0E,EAAyB,EAE7CC,EACJ,gBAACC,GAAA,CACC,QACE,gBAAC,MAAG,UAAW5E,EAAO,QAAQ,uBACR,gBAAC,YAAK,2EAAyE,CACrG,EAEF,UAAWsE,E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","sources":["webpack://grafana/./public/app/features/alerting/unified/utils/template-constants.ts","webpack://grafana/./public/app/features/alerting/unified/api/templateApi.ts","webpack://grafana/./public/app/features/alerting/unified/components/contact-points/templates/EditorColumnHeader.tsx","webpack://grafana/./node_modules/date-fns/subDays.mjs","webpack://grafana/./node_modules/date-fns/addMinutes.mjs","webpack://grafana/./node_modules/date-fns/addHours.mjs","webpack://grafana/./node_modules/date-fns/subHours.mjs","webpack://grafana/./public/app/features/alerting/unified/components/receivers/AlertInstanceModalSelector.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/TemplateData.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/TemplateDataDocs.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/GenerateAlertDataModal.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/PayloadEditor.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/TemplateForm.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/TemplatePreview.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/utils.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/usePreviewTemplate.ts","webpack://grafana/./public/app/features/alerting/unified/components/rules/state-history/common.ts","webpack://grafana/./public/app/features/alerting/unified/utils/templates.ts"],"sourcesContent":["// We need to use this constat until we have an API to get the default templates\nexport const DEFAULT_TEMPLATES = `{{ define \"__subject\" }}[{{ .Status | toUpper }}{{ if eq .Status \"firing\" }}:{{ .Alerts.Firing | len }}{{ if gt (.Alerts.Resolved | len) 0 }}, RESOLVED:{{ .Alerts.Resolved | len }}{{ end }}{{ end }}] {{ .GroupLabels.SortedPairs.Values | join \" \" }} {{ if gt (len .CommonLabels) (len .GroupLabels) }}({{ with .CommonLabels.Remove .GroupLabels.Names }}{{ .Values | join \" \" }}{{ end }}){{ end }}{{ end }}\n\n{{ define \"__text_values_list\" }}{{ if len .Values }}{{ $first := true }}{{ range $refID, $value := .Values -}}\n{{ if $first }}{{ $first = false }}{{ else }}, {{ end }}{{ $refID }}={{ $value }}{{ end -}}\n{{ else }}[no value]{{ end }}{{ end }}\n\n{{ define \"__text_alert_list\" }}{{ range . }}\nValue: {{ template \"__text_values_list\" . }}\nLabels:\n{{ range .Labels.SortedPairs }} - {{ .Name }} = {{ .Value }}\n{{ end }}Annotations:\n{{ range .Annotations.SortedPairs }} - {{ .Name }} = {{ .Value }}\n{{ end }}{{ if gt (len .GeneratorURL) 0 }}Source: {{ .GeneratorURL }}\n{{ end }}{{ if gt (len .SilenceURL) 0 }}Silence: {{ .SilenceURL }}\n{{ end }}{{ if gt (len .DashboardURL) 0 }}Dashboard: {{ .DashboardURL }}\n{{ end }}{{ if gt (len .PanelURL) 0 }}Panel: {{ .PanelURL }}\n{{ end }}{{ end }}{{ end }}\n\n{{ define \"default.title\" }}{{ template \"__subject\" . }}{{ end }}\n\n{{ define \"default.message\" }}{{ if gt (len .Alerts.Firing) 0 }}**Firing**\n{{ template \"__text_alert_list\" .Alerts.Firing }}{{ if gt (len .Alerts.Resolved) 0 }}\n\n{{ end }}{{ end }}{{ if gt (len .Alerts.Resolved) 0 }}**Resolved**\n{{ template \"__text_alert_list\" .Alerts.Resolved }}{{ end }}{{ end }}\n\n{{ define \"__teams_text_alert_list\" }}{{ range . }}\nValue: {{ template \"__text_values_list\" . }}\nLabels:\n{{ range .Labels.SortedPairs }} - {{ .Name }} = {{ .Value }}\n{{ end }}\nAnnotations:\n{{ range .Annotations.SortedPairs }} - {{ .Name }} = {{ .Value }}\n{{ end }}\n{{ if gt (len .GeneratorURL) 0 }}Source: [{{ .GeneratorURL }}]({{ .GeneratorURL }})\n\n{{ end }}{{ if gt (len .SilenceURL) 0 }}Silence: [{{ .SilenceURL }}]({{ .SilenceURL }})\n\n{{ end }}{{ if gt (len .DashboardURL) 0 }}Dashboard: [{{ .DashboardURL }}]({{ .DashboardURL }})\n\n{{ end }}{{ if gt (len .PanelURL) 0 }}Panel: [{{ .PanelURL }}]({{ .PanelURL }})\n\n{{ end }}\n{{ end }}{{ end }}\n\n{{ define \"teams.default.message\" }}{{ if gt (len .Alerts.Firing) 0 }}**Firing**\n{{ template \"__teams_text_alert_list\" .Alerts.Firing }}{{ if gt (len .Alerts.Resolved) 0 }}\n\n{{ end }}{{ end }}{{ if gt (len .Alerts.Resolved) 0 }}**Resolved**\n{{ template \"__teams_text_alert_list\" .Alerts.Resolved }}{{ end }}{{ end }}`;\n","import { Template } from 'app/features/alerting/unified/components/receivers/form/fields/TemplateSelector';\nimport { DEFAULT_TEMPLATES } from 'app/features/alerting/unified/utils/template-constants';\n\nimport { parseTemplates } from '../components/receivers/form/fields/utils';\n\nimport { alertingApi } from './alertingApi';\n\nexport const previewTemplateUrl = `/api/alertmanager/grafana/config/api/v1/templates/test`;\n\nexport interface TemplatePreviewResult {\n  name: string;\n  text: string;\n}\nexport interface TemplatePreviewErrors {\n  name?: string;\n  message: string;\n  kind: string;\n}\nexport interface TemplatePreviewResponse {\n  results?: TemplatePreviewResult[];\n  errors?: TemplatePreviewErrors[];\n}\n\nexport interface KeyValueField {\n  key: string;\n  value: string;\n}\nexport interface AlertField {\n  annotations: KeyValueField[];\n  labels: KeyValueField[];\n}\n\nexport const templatesApi = alertingApi.injectEndpoints({\n  endpoints: (build) => ({\n    previewTemplate: build.mutation<TemplatePreviewResponse, { template: string; alerts: AlertField[]; name: string }>({\n      query: ({ template, alerts, name }) => ({\n        url: previewTemplateUrl,\n        data: { template: template, alerts: alerts, name: name },\n        method: 'POST',\n      }),\n    }),\n    getDefaultTemplates: build.query<Template[], void>({\n      queryFn: async () => {\n        const data = parseTemplates(DEFAULT_TEMPLATES);\n        return { data };\n      },\n    }),\n  }),\n});\n\nexport const { usePreviewTemplateMutation } = templatesApi;\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Label, Stack, useStyles2 } from '@grafana/ui';\n\nexport function EditorColumnHeader({ label, actions }: { label: string; actions?: React.ReactNode }) {\n  const styles = useStyles2(editorColumnStyles);\n\n  return (\n    <div className={styles.container}>\n      <Label className={styles.label}>{label}</Label>\n      <Stack direction=\"row\" gap={1}>\n        {actions}\n      </Stack>\n    </div>\n  );\n}\n\nexport const editorColumnStyles = (theme: GrafanaTheme2) => ({\n  container: css({\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    padding: theme.spacing(1, 2),\n    backgroundColor: theme.colors.background.secondary,\n    borderBottom: `1px solid ${theme.colors.border.medium}`,\n  }),\n  label: css({\n    margin: 0,\n  }),\n});\n","import { addDays } from \"./addDays.mjs\";\n\n/**\n * @name subDays\n * @category Day Helpers\n * @summary Subtract the specified number of days from the given date.\n *\n * @description\n * Subtract the specified number of days from the given date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param date - The date to be changed\n * @param amount - The amount of days to be subtracted.\n *\n * @returns The new date with the days subtracted\n *\n * @example\n * // Subtract 10 days from 1 September 2014:\n * const result = subDays(new Date(2014, 8, 1), 10)\n * //=> Fri Aug 22 2014 00:00:00\n */\nexport function subDays(date, amount) {\n  return addDays(date, -amount);\n}\n\n// Fallback for modularized imports:\nexport default subDays;\n","import { addMilliseconds } from \"./addMilliseconds.mjs\";\nimport { millisecondsInMinute } from \"./constants.mjs\";\n\n/**\n * @name addMinutes\n * @category Minute Helpers\n * @summary Add the specified number of minutes to the given date.\n *\n * @description\n * Add the specified number of minutes to the given date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param date - The date to be changed\n * @param amount - The amount of minutes to be added.\n *\n * @returns The new date with the minutes added\n *\n * @example\n * // Add 30 minutes to 10 July 2014 12:00:00:\n * const result = addMinutes(new Date(2014, 6, 10, 12, 0), 30)\n * //=> Thu Jul 10 2014 12:30:00\n */\nexport function addMinutes(date, amount) {\n  return addMilliseconds(date, amount * millisecondsInMinute);\n}\n\n// Fallback for modularized imports:\nexport default addMinutes;\n","import { addMilliseconds } from \"./addMilliseconds.mjs\";\nimport { millisecondsInHour } from \"./constants.mjs\";\n\n/**\n * @name addHours\n * @category Hour Helpers\n * @summary Add the specified number of hours to the given date.\n *\n * @description\n * Add the specified number of hours to the given date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param date - The date to be changed\n * @param amount - The amount of hours to be added.\n *\n * @returns The new date with the hours added\n *\n * @example\n * // Add 2 hours to 10 July 2014 23:00:00:\n * const result = addHours(new Date(2014, 6, 10, 23, 0), 2)\n * //=> Fri Jul 11 2014 01:00:00\n */\nexport function addHours(date, amount) {\n  return addMilliseconds(date, amount * millisecondsInHour);\n}\n\n// Fallback for modularized imports:\nexport default addHours;\n","import { addHours } from \"./addHours.mjs\";\n\n/**\n * @name subHours\n * @category Hour Helpers\n * @summary Subtract the specified number of hours from the given date.\n *\n * @description\n * Subtract the specified number of hours from the given date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param date - The date to be changed\n * @param amount - The amount of hours to be subtracted.\n *\n * @returns The new date with the hours subtracted\n *\n * @example\n * // Subtract 2 hours from 11 July 2014 01:00:00:\n * const result = subHours(new Date(2014, 6, 11, 1, 0), 2)\n * //=> Thu Jul 10 2014 23:00:00\n */\nexport function subHours(date, amount) {\n  return addHours(date, -amount);\n}\n\n// Fallback for modularized imports:\nexport default subHours;\n","import { css, cx } from '@emotion/css';\nimport React, { CSSProperties, useCallback, useMemo, useState } from 'react';\nimport AutoSizer from 'react-virtualized-auto-sizer';\nimport { FixedSizeList } from 'react-window';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport {\n  Button,\n  clearButtonStyles,\n  FilterInput,\n  LoadingPlaceholder,\n  Modal,\n  Tooltip,\n  useStyles2,\n  Icon,\n  Tag,\n} from '@grafana/ui';\nimport { AlertmanagerAlert, TestTemplateAlert } from 'app/plugins/datasource/alertmanager/types';\n\nimport { alertmanagerApi } from '../../api/alertmanagerApi';\nimport { GRAFANA_RULES_SOURCE_NAME } from '../../utils/datasource';\nimport { arrayLabelsToObject, labelsToTags, objectLabelsToArray } from '../../utils/labels';\nimport { extractCommonLabels, omitLabels } from '../rules/state-history/common';\n\nexport function AlertInstanceModalSelector({\n  onSelect,\n  isOpen,\n  onClose,\n}: {\n  onSelect: (alerts: TestTemplateAlert[]) => void;\n  isOpen: boolean;\n  onClose: () => void;\n}) {\n  const styles = useStyles2(getStyles);\n\n  const [selectedRule, setSelectedRule] = useState<string>();\n  const [selectedInstances, setSelectedInstances] = useState<AlertmanagerAlert[] | null>(null);\n  const { useGetAlertmanagerAlertsQuery } = alertmanagerApi;\n\n  const {\n    currentData: result = [],\n    isFetching: loading,\n    isError: error,\n  } = useGetAlertmanagerAlertsQuery({\n    amSourceName: GRAFANA_RULES_SOURCE_NAME,\n    filter: {\n      inhibited: true,\n      silenced: true,\n      active: true,\n    },\n  });\n\n  const [ruleFilter, setRuleFilter] = useState('');\n\n  const rulesWithInstances: Record<string, AlertmanagerAlert[]> = useMemo(() => {\n    const rules: Record<string, AlertmanagerAlert[]> = {};\n    if (!loading && result) {\n      result.forEach((instance) => {\n        if (!rules[instance.labels['alertname']]) {\n          rules[instance.labels['alertname']] = [];\n        }\n        rules[instance.labels['alertname']].push(instance);\n      });\n    }\n    return rules;\n  }, [loading, result]);\n\n  const handleRuleChange = useCallback((rule: string) => {\n    setSelectedRule(rule);\n    setSelectedInstances(null);\n  }, []);\n\n  const filteredRules: Record<string, AlertmanagerAlert[]> = useMemo(() => {\n    const filteredRules = Object.keys(rulesWithInstances).filter((rule) =>\n      rule.toLowerCase().includes(ruleFilter.toLowerCase())\n    );\n    const filteredRulesObject: Record<string, AlertmanagerAlert[]> = {};\n    filteredRules.forEach((rule) => {\n      filteredRulesObject[rule] = rulesWithInstances[rule];\n    });\n    return filteredRulesObject;\n  }, [rulesWithInstances, ruleFilter]);\n\n  if (error) {\n    return null;\n  }\n\n  const filteredRulesKeys = Object.keys(filteredRules || []);\n\n  const RuleRow = ({ index, style }: { index: number; style?: CSSProperties }) => {\n    if (!filteredRules) {\n      return null;\n    }\n    const ruleName = filteredRulesKeys[index];\n\n    const isSelected = ruleName === selectedRule;\n\n    return (\n      <button\n        type=\"button\"\n        title={ruleName}\n        style={style}\n        className={cx(styles.rowButton, { [styles.rowOdd]: index % 2 === 1, [styles.rowSelected]: isSelected })}\n        onClick={() => handleRuleChange(ruleName)}\n      >\n        <div className={cx(styles.ruleTitle, styles.rowButtonTitle)}>{ruleName}</div>\n        <div className={styles.alertFolder}>\n          <>\n            <Icon name=\"folder\" /> {filteredRules[ruleName][0].labels['grafana_folder'] ?? ''}\n          </>\n        </div>\n      </button>\n    );\n  };\n\n  const getAlertUniqueLabels = (allAlerts: AlertmanagerAlert[], currentAlert: AlertmanagerAlert) => {\n    const allLabels = allAlerts.map((alert) => alert.labels);\n    const labelsAsArray = allLabels.map(objectLabelsToArray);\n\n    const ruleCommonLabels = extractCommonLabels(labelsAsArray);\n    const alertUniqueLabels = omitLabels(objectLabelsToArray(currentAlert.labels), ruleCommonLabels);\n\n    const tags = alertUniqueLabels.length\n      ? labelsToTags(arrayLabelsToObject(alertUniqueLabels))\n      : labelsToTags(currentAlert.labels);\n\n    return tags;\n  };\n\n  const InstanceRow = ({ index, style }: { index: number; style: CSSProperties }) => {\n    const alerts = useMemo(() => (selectedRule ? rulesWithInstances[selectedRule] : []), []);\n    const alert = alerts[index];\n    const isSelected = selectedInstances?.includes(alert);\n    const tags = useMemo(() => getAlertUniqueLabels(alerts, alert), [alerts, alert]);\n\n    const handleSelectInstances = () => {\n      if (isSelected && selectedInstances) {\n        setSelectedInstances(selectedInstances.filter((instance) => instance !== alert));\n        return;\n      }\n      setSelectedInstances([...(selectedInstances || []), alert]);\n    };\n\n    return (\n      <button\n        type=\"button\"\n        style={style}\n        className={cx(styles.rowButton, styles.instanceButton, {\n          [styles.rowOdd]: index % 2 === 1,\n          [styles.rowSelected]: isSelected,\n        })}\n        onClick={handleSelectInstances}\n      >\n        <div className={styles.rowButtonTitle} title={alert.labels['alertname']}>\n          <Tooltip placement=\"bottom\" content={<pre>{JSON.stringify(alert, null, 2)}</pre>} theme={'info'}>\n            <div>\n              {tags.map((tag, index) => (\n                <Tag key={index} name={tag} className={styles.tag} />\n              ))}\n            </div>\n          </Tooltip>\n        </div>\n      </button>\n    );\n  };\n\n  const handleConfirm = () => {\n    const instances: TestTemplateAlert[] =\n      selectedInstances?.map((instance: AlertmanagerAlert) => {\n        const alert: TestTemplateAlert = {\n          status: 'firing',\n          annotations: instance.annotations,\n          labels: instance.labels,\n          startsAt: instance.startsAt,\n          endsAt: instance.endsAt,\n          generatorURL: instance.generatorURL,\n          fingerprint: instance.fingerprint,\n        };\n        return alert;\n      }) || [];\n\n    onSelect(instances);\n    resetState();\n  };\n\n  const resetState = () => {\n    setSelectedRule(undefined);\n    setSelectedInstances(null);\n    setRuleFilter('');\n    handleSearchRules('');\n  };\n\n  const onDismiss = () => {\n    resetState();\n    onClose();\n  };\n\n  const handleSearchRules = (filter: string) => {\n    setRuleFilter(filter);\n  };\n\n  return (\n    <div>\n      <Modal\n        title=\"Select alert instances\"\n        className={styles.modal}\n        closeOnEscape\n        isOpen={isOpen}\n        onDismiss={onDismiss}\n        contentClassName={styles.modalContent}\n      >\n        <div className={styles.container}>\n          <FilterInput\n            value={ruleFilter}\n            onChange={handleSearchRules}\n            title=\"Search alert rule\"\n            placeholder=\"Search alert rule\"\n            autoFocus\n          />\n          <div>{(selectedRule && 'Select one or more instances from the list below') || ''}</div>\n\n          <div className={styles.column}>\n            {loading && <LoadingPlaceholder text=\"Loading rules...\" className={styles.loadingPlaceholder} />}\n\n            {!loading && (\n              <AutoSizer>\n                {({ height, width }) => (\n                  <FixedSizeList itemSize={50} height={height} width={width} itemCount={filteredRulesKeys.length}>\n                    {RuleRow}\n                  </FixedSizeList>\n                )}\n              </AutoSizer>\n            )}\n          </div>\n\n          <div className={styles.column}>\n            {!selectedRule && !loading && (\n              <div className={styles.selectedRulePlaceholder}>\n                <div>Select an alert rule to get a list of available firing instances</div>\n              </div>\n            )}\n            {loading && <LoadingPlaceholder text=\"Loading rule...\" className={styles.loadingPlaceholder} />}\n\n            {selectedRule && rulesWithInstances[selectedRule].length && !loading && (\n              <AutoSizer>\n                {({ width, height }) => (\n                  <FixedSizeList\n                    itemSize={32}\n                    height={height}\n                    width={width}\n                    itemCount={rulesWithInstances[selectedRule].length || 0}\n                  >\n                    {InstanceRow}\n                  </FixedSizeList>\n                )}\n              </AutoSizer>\n            )}\n          </div>\n        </div>\n        <Modal.ButtonRow>\n          <Button type=\"button\" variant=\"secondary\" onClick={onDismiss}>\n            Cancel\n          </Button>\n          <Button\n            type=\"button\"\n            variant=\"primary\"\n            disabled={!(selectedRule && selectedInstances)}\n            onClick={() => {\n              if (selectedRule && selectedInstances) {\n                handleConfirm();\n              }\n            }}\n          >\n            Add alert data to payload\n          </Button>\n        </Modal.ButtonRow>\n      </Modal>\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  const clearButton = clearButtonStyles(theme);\n\n  return {\n    container: css({\n      display: 'grid',\n      gridTemplateColumns: '1fr 1.5fr',\n      gridTemplateRows: 'min-content auto',\n      gap: theme.spacing(2),\n      flex: 1,\n    }),\n\n    tag: css({\n      margin: '5px',\n    }),\n\n    column: css({\n      flex: '1 1 auto',\n    }),\n\n    alertLabels: css({\n      overflowX: 'auto',\n      height: '32px',\n    }),\n    ruleTitle: css({\n      height: '22px',\n      fontWeight: theme.typography.fontWeightBold,\n    }),\n    rowButton: css(clearButton, {\n      padding: theme.spacing(0.5),\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      textAlign: 'left',\n      whiteSpace: 'nowrap',\n      cursor: 'pointer',\n      border: '2px solid transparent',\n\n      '&:disabled': {\n        cursor: 'not-allowed',\n        color: theme.colors.text.disabled,\n      },\n    }),\n    rowButtonTitle: css({\n      overflowX: 'auto',\n    }),\n    rowSelected: css({\n      borderColor: theme.colors.primary.border,\n    }),\n    rowOdd: css({\n      backgroundColor: theme.colors.background.secondary,\n    }),\n    instanceButton: css({\n      display: 'flex',\n      gap: theme.spacing(1),\n      justifyContent: 'space-between',\n      alignItems: 'center',\n    }),\n    loadingPlaceholder: css({\n      height: '100%',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n    }),\n    selectedRulePlaceholder: css({\n      width: '100%',\n      height: '100%',\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n      textAlign: 'center',\n      fontWeight: theme.typography.fontWeightBold,\n    }),\n    modal: css({\n      height: '100%',\n    }),\n    modalContent: css({\n      flex: 1,\n      display: 'flex',\n      flexDirection: 'column',\n    }),\n    modalAlert: css({\n      flexGrow: 0,\n    }),\n    warnIcon: css({\n      fill: theme.colors.warning.main,\n    }),\n    labels: css({\n      justifyContent: 'flex-start',\n    }),\n    alertFolder: css({\n      height: '20px',\n      fontSize: theme.typography.bodySmall.fontSize,\n      color: theme.colors.text.secondary,\n      display: 'flex',\n      flexDirection: 'row',\n      justifyContent: 'flex-start',\n      columnGap: theme.spacing(1),\n      alignItems: 'center',\n    }),\n  };\n};\n","export interface TemplateDataItem {\n  name: string;\n  type: string;\n  notes: string;\n}\n\ninterface TemplateFunctionItem {\n  name: string;\n  args?: '[]string';\n  returns: 'KeyValue' | '[]string';\n  notes?: string;\n}\n\nexport const GlobalTemplateData: TemplateDataItem[] = [\n  {\n    name: 'Receiver',\n    type: 'string',\n    notes: 'Name of the contact point that the notification is being sent to.',\n  },\n  {\n    name: 'Status',\n    type: 'string',\n    notes: 'firing if at least one alert is firing, otherwise resolved',\n  },\n  {\n    name: 'Alerts',\n    type: '[]Alert',\n    notes: 'List of alert objects that are included in this notification.',\n  },\n  {\n    name: 'Alerts.Firing',\n    type: '[]Alert',\n    notes: 'List of firing alerts',\n  },\n  {\n    name: 'Alerts.Resolved',\n    type: '[]Alert',\n    notes: 'List of resolved alerts',\n  },\n  {\n    name: 'GroupLabels',\n    type: 'KeyValue',\n    notes: 'Labels these alerts were grouped by.',\n  },\n  {\n    name: 'CommonLabels',\n    type: 'KeyValue',\n    notes: 'Labels common to all the alerts included in this notification.',\n  },\n  {\n    name: 'CommonAnnotations',\n    type: 'KeyValue',\n    notes: 'Annotations common to all the alerts included in this notification.',\n  },\n  {\n    name: 'ExternalURL',\n    type: 'string',\n    notes: 'Back link to the Grafana that sent the notification.',\n  },\n];\n\nexport const AlertTemplatePreviewData: TemplateDataItem[] = [\n  {\n    name: 'labels',\n    type: 'Object{}',\n    notes: 'Set of labels attached to the alert.',\n  },\n  {\n    name: 'annotations',\n    type: 'Object{}',\n    notes: 'Set of annotations attached to the alert.',\n  },\n  {\n    name: 'startsAt',\n    type: 'string (ISO8601)',\n    notes: 'Time the alert started firing.',\n  },\n  {\n    name: 'endsAt',\n    type: 'string (ISO8601)',\n    notes: 'Time the alert ends firing.',\n  },\n];\n\nexport const AlertTemplateData: TemplateDataItem[] = [\n  {\n    name: 'Status',\n    type: 'string',\n    notes: 'firing or resolved.',\n  },\n  {\n    name: 'Labels',\n    type: 'KeyValue',\n    notes: 'Set of labels attached to the alert.',\n  },\n  {\n    name: 'Annotations',\n    type: 'KeyValue',\n    notes: 'Set of annotations attached to the alert.',\n  },\n  {\n    name: 'Values',\n    type: 'KeyValue',\n    notes:\n      'The values of all instant queries, reduce and math expressions, and classic conditions for the alert. It does not contain time series data.',\n  },\n  {\n    name: 'StartsAt',\n    type: 'time.Time',\n    notes: 'Time the alert started firing.',\n  },\n  {\n    name: 'EndsAt',\n    type: 'time.Time',\n    notes:\n      'Only set if the end time of an alert is known. Otherwise set to a configurable timeout period from the time since the last alert was received.',\n  },\n  {\n    name: 'GeneratorURL',\n    type: 'string',\n    notes: 'A back link to Grafana or external Alertmanager.',\n  },\n  {\n    name: 'SilenceURL',\n    type: 'string',\n    notes: 'Link to Grafana silence for with labels for this alert pre-filled. Only for Grafana managed alerts.',\n  },\n  {\n    name: 'DashboardURL',\n    type: 'string',\n    notes: 'Link to Grafana dashboard, if alert rule belongs to one. Only for Grafana managed alerts.',\n  },\n  {\n    name: 'PanelURL',\n    type: 'string',\n    notes: 'Link to Grafana dashboard panel, if alert rule belongs to one. Only for Grafana managed alerts.',\n  },\n  {\n    name: 'Fingerprint',\n    type: 'string',\n    notes: 'Fingerprint that can be used to identify the alert.',\n  },\n  {\n    name: 'ValueString',\n    type: 'string',\n    notes: 'String that contains the labels and value of each reduced expression in the alert.',\n  },\n];\n\nexport const KeyValueTemplateFunctions: TemplateFunctionItem[] = [\n  {\n    name: 'SortedPairs',\n    returns: 'KeyValue',\n    notes: 'Returns sorted list of key & value string pairs',\n  },\n  {\n    name: 'Remove',\n    args: '[]string',\n    returns: 'KeyValue',\n    notes: 'Returns a copy of the Key/Value map without the given keys.',\n  },\n  {\n    name: 'Names',\n    returns: '[]string',\n    notes: 'List of label names',\n  },\n  {\n    name: 'Values',\n    returns: '[]string',\n    notes: 'List of label values',\n  },\n];\n\nexport const KeyValueCodeSnippet = `{\n  \"summary\": \"alert summary\",\n  \"description\": \"alert description\"\n}\n`;\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2, Stack } from '@grafana/ui';\n\nimport { HoverCard } from '../HoverCard';\n\nimport {\n  AlertTemplateData,\n  GlobalTemplateData,\n  KeyValueCodeSnippet,\n  KeyValueTemplateFunctions,\n  TemplateDataItem,\n} from './TemplateData';\n\nexport function TemplateDataDocs() {\n  const styles = useStyles2(getTemplateDataDocsStyles);\n\n  const AlertTemplateDataTable = (\n    <TemplateDataTable\n      caption={\n        <h4 className={styles.header}>\n          Alert template data <span>Available only when in the context of an Alert (e.g. inside .Alerts loop)</span>\n        </h4>\n      }\n      dataItems={AlertTemplateData}\n    />\n  );\n\n  return (\n    <Stack gap={2}>\n      <TemplateDataTable\n        caption={<h4 className={styles.header}>Template Data</h4>}\n        dataItems={GlobalTemplateData}\n        typeRenderer={(type) =>\n          type === '[]Alert' ? (\n            <HoverCard content={AlertTemplateDataTable}>\n              <div className={styles.interactiveType}>{type}</div>\n            </HoverCard>\n          ) : type === 'KeyValue' ? (\n            <HoverCard content={<KeyValueTemplateDataTable />}>\n              <div className={styles.interactiveType}>{type}</div>\n            </HoverCard>\n          ) : (\n            type\n          )\n        }\n      />\n    </Stack>\n  );\n}\n\nconst getTemplateDataDocsStyles = (theme: GrafanaTheme2) => ({\n  header: css({\n    color: theme.colors.text.primary,\n\n    span: {\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize,\n    },\n  }),\n  interactiveType: css({\n    color: theme.colors.text.link,\n  }),\n});\n\ninterface TemplateDataTableProps {\n  dataItems: TemplateDataItem[];\n  caption?: JSX.Element | string;\n  typeRenderer?: (type: TemplateDataItem['type']) => React.ReactNode;\n}\n\nexport function TemplateDataTable({ dataItems, caption, typeRenderer }: TemplateDataTableProps) {\n  const styles = useStyles2(getTemplateDataTableStyles);\n\n  return (\n    <table className={styles.table}>\n      {caption && <caption>{caption}</caption>}\n      <thead>\n        <tr>\n          <th>Name</th>\n          <th>Type</th>\n          <th>Notes</th>\n        </tr>\n      </thead>\n      <tbody>\n        {dataItems.map(({ name, type, notes }, index) => (\n          <tr key={index}>\n            <td>{name}</td>\n            <td>{typeRenderer ? typeRenderer(type) : type}</td>\n            <td>{notes}</td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  );\n}\n\nfunction KeyValueTemplateDataTable() {\n  const tableStyles = useStyles2(getTemplateDataTableStyles);\n\n  return (\n    <div>\n      KeyValue is a set of key/value string pairs that represent labels and annotations.\n      <pre>\n        <code>{KeyValueCodeSnippet}</code>\n      </pre>\n      <table className={tableStyles.table}>\n        <caption>Key-value methods</caption>\n        <thead>\n          <tr>\n            <th>Name</th>\n            <th>Arguments</th>\n            <th>Returns</th>\n            <th>Notes</th>\n          </tr>\n        </thead>\n        <tbody>\n          {KeyValueTemplateFunctions.map(({ name, args, returns, notes }) => (\n            <tr key={name}>\n              <td>{name}</td>\n              <td>{args}</td>\n              <td>{returns}</td>\n              <td>{notes}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n\nconst getTemplateDataTableStyles = (theme: GrafanaTheme2) => ({\n  table: css({\n    borderCollapse: 'collapse',\n    width: '100%',\n\n    caption: {\n      captionSide: 'top',\n    },\n\n    'td, th': {\n      padding: theme.spacing(1, 1),\n    },\n\n    thead: {\n      fontWeight: theme.typography.fontWeightBold,\n    },\n\n    'tbody tr:nth-child(2n + 1)': {\n      backgroundColor: theme.colors.background.secondary,\n    },\n\n    'tbody td:nth-child(1)': {\n      fontWeight: theme.typography.fontWeightBold,\n    },\n\n    'tbody td:nth-child(2)': {\n      fontStyle: 'italic',\n    },\n  }),\n});\n","import { css } from '@emotion/css';\nimport { addDays, subDays } from 'date-fns';\nimport { uniqueId } from 'lodash';\nimport React, { useState } from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Button, Card, Modal, RadioButtonGroup, Stack, useStyles2 } from '@grafana/ui';\nimport { TestTemplateAlert } from 'app/plugins/datasource/alertmanager/types';\n\nimport { KeyValueField } from '../../../api/templateApi';\nimport AnnotationsStep from '../../rule-editor/AnnotationsStep';\nimport LabelsField from '../../rule-editor/labels/LabelsField';\n\ninterface Props {\n  isOpen: boolean;\n  onDismiss: () => void;\n  onAccept: (alerts: TestTemplateAlert[]) => void;\n}\n\ninterface FormFields {\n  annotations: KeyValueField[];\n  labels: KeyValueField[];\n  status: 'firing' | 'resolved';\n}\n\nconst defaultValues: FormFields = {\n  annotations: [{ key: '', value: '' }],\n  labels: [{ key: '', value: '' }],\n  status: 'firing',\n};\n\nexport const GenerateAlertDataModal = ({ isOpen, onDismiss, onAccept }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const [alerts, setAlerts] = useState<TestTemplateAlert[]>([]);\n\n  const formMethods = useForm<FormFields>({ defaultValues, mode: 'onBlur' });\n  const annotations = formMethods.watch('annotations');\n  const labels = formMethods.watch('labels');\n  const [status, setStatus] = useState<'firing' | 'resolved'>('firing');\n\n  const onAdd = () => {\n    const alert: TestTemplateAlert = {\n      annotations: annotations\n        .filter(({ key, value }) => !!key && !!value)\n        .reduce((acc, { key, value }) => {\n          return { ...acc, [key]: value };\n        }, {}),\n      labels: labels\n        .filter(({ key, value }) => !!key && !!value)\n        .reduce((acc, { key, value }) => {\n          return { ...acc, [key]: value };\n        }, {}),\n      startsAt: '2023-04-01T00:00:00Z',\n      endsAt: status === 'firing' ? addDays(new Date(), 1).toISOString() : subDays(new Date(), 1).toISOString(),\n      status,\n      fingerprint: uniqueId('fingerprint_'),\n    };\n    setAlerts((alerts) => [...alerts, alert]);\n    formMethods.reset();\n  };\n\n  const onSubmit = () => {\n    onAccept(alerts);\n    setAlerts([]);\n    formMethods.reset();\n    setStatus('firing');\n  };\n\n  const labelsOrAnnotationsAdded = () => {\n    const someLabels = labels.some((lb) => lb.key !== '' && lb.value !== '');\n    const someAnnotations = annotations.some((ann) => ann.key !== '' && ann.value !== '');\n    return someLabels || someAnnotations;\n  };\n\n  type AlertOption = {\n    label: string;\n    value: 'firing' | 'resolved';\n  };\n  const alertOptions: AlertOption[] = [\n    {\n      label: 'Firing',\n      value: 'firing',\n    },\n    { label: 'Resolved', value: 'resolved' },\n  ];\n\n  return (\n    <Modal onDismiss={onDismiss} isOpen={isOpen} title={'Add custom alerts'}>\n      <FormProvider {...formMethods}>\n        <form\n          onSubmit={(e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            formMethods.reset();\n            setStatus('firing');\n          }}\n        >\n          <>\n            <Card>\n              <Stack direction=\"column\" gap={1}>\n                <div className={styles.section}>\n                  <AnnotationsStep />\n                </div>\n                <div className={styles.section}>\n                  <LabelsField />\n                </div>\n                <div className={styles.flexWrapper}>\n                  <RadioButtonGroup value={status} options={alertOptions} onChange={(value) => setStatus(value)} />\n                  <Button\n                    onClick={onAdd}\n                    className={styles.onAddButton}\n                    icon=\"plus-circle\"\n                    type=\"button\"\n                    variant=\"secondary\"\n                    disabled={!labelsOrAnnotationsAdded()}\n                  >\n                    Add alert data\n                  </Button>\n                </div>\n              </Stack>\n            </Card>\n          </>\n          <div className={styles.onSubmitWrapper}></div>\n          {alerts.length > 0 && (\n            <Stack direction=\"column\" gap={1}>\n              <h5> Review alert data to add to the payload:</h5>\n              <pre className={styles.result} data-testid=\"payloadJSON\">\n                {JSON.stringify(alerts, null, 2)}\n              </pre>\n            </Stack>\n          )}\n          <div className={styles.onSubmitWrapper}>\n            <Modal.ButtonRow>\n              <Button onClick={onSubmit} disabled={alerts.length === 0} className={styles.onSubmitButton}>\n                Add alert data to payload\n              </Button>\n            </Modal.ButtonRow>\n          </div>\n        </form>\n      </FormProvider>\n    </Modal>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  section: css({\n    marginBottom: theme.spacing(2),\n  }),\n  onAddButton: css({\n    flex: 'none',\n    width: 'fit-content',\n    paddingRight: theme.spacing(1),\n    marginLeft: 'auto',\n  }),\n  flexWrapper: css({\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n  }),\n  onSubmitWrapper: css({\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'baseline',\n    justifyContent: 'flex-end',\n  }),\n  onSubmitButton: css({\n    marginLeft: theme.spacing(2),\n  }),\n  result: css({\n    width: '570px',\n    height: '363px',\n  }),\n});\n","import { css, cx } from '@emotion/css';\nimport React, { useState } from 'react';\nimport AutoSizer from 'react-virtualized-auto-sizer';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Button, CodeEditor, Dropdown, Menu, Stack, Toggletip, useStyles2 } from '@grafana/ui';\nimport { TestTemplateAlert } from 'app/plugins/datasource/alertmanager/types';\n\nimport { EditorColumnHeader } from '../contact-points/templates/EditorColumnHeader';\n\nimport { AlertInstanceModalSelector } from './AlertInstanceModalSelector';\nimport { AlertTemplatePreviewData } from './TemplateData';\nimport { TemplateDataTable } from './TemplateDataDocs';\nimport { GenerateAlertDataModal } from './form/GenerateAlertDataModal';\n\nexport const RESET_TO_DEFAULT = 'Reset to defaults';\n\nexport function PayloadEditor({\n  payload,\n  setPayload,\n  defaultPayload,\n  setPayloadFormatError,\n  payloadFormatError,\n  className,\n}: {\n  payload: string;\n  defaultPayload: string;\n  setPayload: React.Dispatch<React.SetStateAction<string>>;\n  setPayloadFormatError: (value: React.SetStateAction<string | null>) => void;\n  payloadFormatError: string | null;\n  className?: string;\n}) {\n  const styles = useStyles2(getStyles);\n  const onReset = () => {\n    setPayload(defaultPayload);\n  };\n\n  const [isEditingAlertData, setIsEditingAlertData] = useState(false);\n\n  const onCloseEditAlertModal = () => {\n    setIsEditingAlertData(false);\n  };\n\n  const errorInPayloadJson = payloadFormatError !== null;\n\n  const validatePayload = () => {\n    try {\n      const payloadObj = JSON.parse(payload);\n      JSON.stringify([...payloadObj]); // check if it's iterable, in order to be able to add more data\n      setPayloadFormatError(null);\n    } catch (e) {\n      setPayloadFormatError(e instanceof Error ? e.message : 'Invalid JSON.');\n      throw e;\n    }\n  };\n\n  const onOpenEditAlertModal = () => {\n    try {\n      validatePayload();\n      setIsEditingAlertData(true);\n    } catch (e) {}\n  };\n\n  const onOpenAlertSelectorModal = () => {\n    try {\n      validatePayload();\n      setIsAlertSelectorOpen(true);\n    } catch (e) {}\n  };\n\n  const onAddAlertList = (alerts: TestTemplateAlert[]) => {\n    onCloseEditAlertModal();\n    setIsAlertSelectorOpen(false);\n    setPayload((payload) => {\n      const payloadObj = JSON.parse(payload);\n      return JSON.stringify([...payloadObj, ...alerts], undefined, 2);\n    });\n  };\n\n  const [isAlertSelectorOpen, setIsAlertSelectorOpen] = useState(false);\n\n  return (\n    <>\n      <div className={cx(styles.wrapper, className)}>\n        <EditorColumnHeader\n          label=\"Payload\"\n          actions={\n            <Stack direction=\"row\" alignItems=\"center\" gap={0.5}>\n              <Dropdown\n                overlay={\n                  <Menu>\n                    <Menu.Item\n                      label=\"Use existing alert instances\"\n                      disabled={errorInPayloadJson}\n                      onClick={onOpenAlertSelectorModal}\n                    />\n                    <Menu.Item\n                      label=\"Add custom alert instance\"\n                      disabled={errorInPayloadJson}\n                      onClick={onOpenEditAlertModal}\n                    />\n                    <Menu.Divider />\n                    <Menu.Item label={RESET_TO_DEFAULT} onClick={onReset} destructive />\n                  </Menu>\n                }\n              >\n                <Button variant=\"secondary\" size=\"sm\" icon=\"angle-down\">\n                  Edit payload\n                </Button>\n              </Dropdown>\n              <Toggletip content={<AlertTemplateDataTable />} placement=\"top\" fitContent>\n                <Button variant=\"secondary\" fill=\"outline\" size=\"sm\" icon=\"question-circle\">\n                  Help\n                </Button>\n              </Toggletip>\n            </Stack>\n          }\n        />\n\n        <div className={styles.editorWrapper}>\n          <AutoSizer>\n            {({ width, height }) => (\n              <CodeEditor\n                containerStyles={styles.editorContainer}\n                width={width}\n                height={height}\n                language={'json'}\n                showLineNumbers={true}\n                showMiniMap={false}\n                value={payload}\n                readOnly={false}\n                onBlur={setPayload}\n                monacoOptions={{\n                  scrollBeyondLastLine: false,\n                }}\n              />\n            )}\n          </AutoSizer>\n        </div>\n      </div>\n\n      <GenerateAlertDataModal isOpen={isEditingAlertData} onDismiss={onCloseEditAlertModal} onAccept={onAddAlertList} />\n\n      <AlertInstanceModalSelector\n        onSelect={onAddAlertList}\n        isOpen={isAlertSelectorOpen}\n        onClose={() => setIsAlertSelectorOpen(false)}\n      />\n    </>\n  );\n}\nconst AlertTemplateDataTable = () => {\n  return <TemplateDataTable dataItems={AlertTemplatePreviewData} />;\n};\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n  }),\n  tooltip: css({\n    paddingLeft: theme.spacing(1),\n  }),\n  label: css({\n    margin: 0,\n  }),\n  editorWrapper: css({\n    flex: 1,\n  }),\n  editorContainer: css({\n    width: 'fit-content',\n    border: 'none',\n  }),\n  templateDataDocsHeader: css({\n    color: theme.colors.text.primary,\n\n    span: {\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize,\n    },\n  }),\n});\n","import { css, cx } from '@emotion/css';\nimport { addMinutes, subDays, subHours } from 'date-fns';\nimport { Location } from 'history';\nimport React, { useRef, useState } from 'react';\nimport { FormProvider, useForm, Validate } from 'react-hook-form';\nimport { useToggle } from 'react-use';\nimport AutoSizer from 'react-virtualized-auto-sizer';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { isFetchError } from '@grafana/runtime';\nimport {\n  Alert,\n  Button,\n  FieldSet,\n  Input,\n  LinkButton,\n  useStyles2,\n  Stack,\n  useSplitter,\n  Drawer,\n  InlineField,\n  Box,\n} from '@grafana/ui';\nimport { useCleanup } from 'app/core/hooks/useCleanup';\nimport { ActiveTab as ContactPointsActiveTabs } from 'app/features/alerting/unified/components/contact-points/ContactPoints';\nimport { AlertManagerCortexConfig, TestTemplateAlert } from 'app/plugins/datasource/alertmanager/types';\nimport { useDispatch } from 'app/types';\n\nimport { AppChromeUpdate } from '../../../../../core/components/AppChrome/AppChromeUpdate';\nimport { useUnifiedAlertingSelector } from '../../hooks/useUnifiedAlertingSelector';\nimport { updateAlertManagerConfigAction } from '../../state/actions';\nimport { GRAFANA_RULES_SOURCE_NAME } from '../../utils/datasource';\nimport { makeAMLink } from '../../utils/misc';\nimport { initialAsyncRequestState } from '../../utils/redux';\nimport { ensureDefine } from '../../utils/templates';\nimport { ProvisionedResource, ProvisioningAlert } from '../Provisioning';\nimport { EditorColumnHeader } from '../contact-points/templates/EditorColumnHeader';\n\nimport { PayloadEditor } from './PayloadEditor';\nimport { TemplateDataDocs } from './TemplateDataDocs';\nimport { TemplateEditor } from './TemplateEditor';\nimport { TemplatePreview } from './TemplatePreview';\nimport { snippets } from './editor/templateDataSuggestions';\n\nexport interface TemplateFormValues {\n  name: string;\n  content: string;\n}\n\nexport const defaults: TemplateFormValues = Object.freeze({\n  name: '',\n  content: '',\n});\n\ninterface Props {\n  existing?: TemplateFormValues;\n  config: AlertManagerCortexConfig;\n  alertManagerSourceName: string;\n  provenance?: string;\n}\nexport const isDuplicating = (location: Location) => location.pathname.endsWith('/duplicate');\n\n/**\n * We're going for this type of layout, but with the ability to resize the columns.\n * To achieve this, we're using the useSplitter hook from Grafana UI twice.\n * The first hook is for the vertical splitter between the template editor and the payload editor.\n * The second hook is for the horizontal splitter between the template editor and the preview.\n * If we're using a vanilla Alertmanager source, we don't show the payload editor nor the preview but we still use the splitter at 100/0.\n *\n * \n *  Template           Preview   \n *                               \n *                               \n *                               \n *            \n *            \n *  Payload                      \n *                               \n *                               \n *                               \n * \n */\nexport const TemplateForm = ({ existing, alertManagerSourceName, config, provenance }: Props) => {\n  const styles = useStyles2(getStyles);\n  const dispatch = useDispatch();\n\n  useCleanup((state) => (state.unifiedAlerting.saveAMConfig = initialAsyncRequestState));\n  const formRef = useRef<HTMLFormElement>(null);\n  const isGrafanaAlertManager = alertManagerSourceName === GRAFANA_RULES_SOURCE_NAME;\n\n  const { loading, error } = useUnifiedAlertingSelector((state) => state.saveAMConfig);\n\n  const [cheatsheetOpened, toggleCheatsheetOpened] = useToggle(false);\n\n  const [payload, setPayload] = useState(defaultPayloadString);\n  const [payloadFormatError, setPayloadFormatError] = useState<string | null>(null);\n\n  // splitter for template and payload editor\n  const columnSplitter = useSplitter({\n    direction: 'column',\n    // if Grafana Alertmanager, split 50/50, otherwise 100/0 because there is no payload editor\n    initialSize: isGrafanaAlertManager ? 0.5 : 1,\n    dragPosition: 'middle',\n  });\n\n  // splitter for template editor and preview\n  const rowSplitter = useSplitter({\n    direction: 'row',\n    // if Grafana Alertmanager, split 60/40, otherwise 100/0 because there is no preview\n    initialSize: isGrafanaAlertManager ? 0.6 : 1,\n    dragPosition: 'middle',\n  });\n\n  const submit = (values: TemplateFormValues) => {\n    // wrap content in \"define\" if it's not already wrapped, in case user did not do it/\n    // it's not obvious that this is needed for template to work\n    const content = ensureDefine(values.name, values.content);\n\n    // add new template to template map\n    const template_files = {\n      ...config.template_files,\n      [values.name]: content,\n    };\n\n    // delete existing one (if name changed, otherwise it was overwritten in previous step)\n    if (existing && existing.name !== values.name) {\n      delete template_files[existing.name];\n    }\n\n    // make sure name for the template is configured on the alertmanager config object\n    const templates = [\n      ...(config.alertmanager_config.templates ?? []).filter((name) => name !== existing?.name),\n      values.name,\n    ];\n\n    const newConfig: AlertManagerCortexConfig = {\n      template_files,\n      alertmanager_config: {\n        ...config.alertmanager_config,\n        templates,\n      },\n    };\n    dispatch(\n      updateAlertManagerConfigAction({\n        alertManagerSourceName,\n        newConfig,\n        oldConfig: config,\n        successMessage: 'Template saved.',\n        redirectPath: '/alerting/notifications',\n        redirectSearch: `tab=${ContactPointsActiveTabs.NotificationTemplates}`,\n      })\n    );\n  };\n\n  const formApi = useForm<TemplateFormValues>({\n    mode: 'onSubmit',\n    defaultValues: existing ?? defaults,\n  });\n  const {\n    handleSubmit,\n    register,\n    formState: { errors },\n    getValues,\n    setValue,\n    watch,\n  } = formApi;\n\n  const validateNameIsUnique: Validate<string, TemplateFormValues> = (name: string) => {\n    return !config.template_files[name] || existing?.name === name\n      ? true\n      : 'Another template with this name already exists.';\n  };\n\n  const actionButtons = (\n    <Stack>\n      <Button onClick={() => formRef.current?.requestSubmit()} variant=\"primary\" size=\"sm\" disabled={loading}>\n        Save\n      </Button>\n      <LinkButton\n        disabled={loading}\n        href={makeAMLink('alerting/notifications', alertManagerSourceName, {\n          tab: ContactPointsActiveTabs.NotificationTemplates,\n        })}\n        variant=\"secondary\"\n        size=\"sm\"\n      >\n        Cancel\n      </LinkButton>\n    </Stack>\n  );\n\n  return (\n    <>\n      <FormProvider {...formApi}>\n        <AppChromeUpdate actions={actionButtons} />\n        <form onSubmit={handleSubmit(submit)} ref={formRef} className={styles.form}>\n          {/* error message */}\n          {error && (\n            <Alert severity=\"error\" title=\"Error saving template\">\n              {error.message || (isFetchError(error) && error.data?.message) || String(error)}\n            </Alert>\n          )}\n          {/* warning about provisioned template */}\n          {provenance && <ProvisioningAlert resource={ProvisionedResource.Template} />}\n\n          {/* name field for the template */}\n          <FieldSet disabled={Boolean(provenance)} className={styles.fieldset}>\n            <InlineField\n              label=\"Template name\"\n              error={errors?.name?.message}\n              invalid={!!errors.name?.message}\n              required\n              className={styles.nameField}\n            >\n              <Input\n                {...register('name', {\n                  required: { value: true, message: 'Required.' },\n                  validate: { nameIsUnique: validateNameIsUnique },\n                })}\n                placeholder=\"Give your template a name\"\n                width={42}\n                autoFocus={true}\n                id=\"new-template-name\"\n              />\n            </InlineField>\n\n            {/* editor layout */}\n            <div {...rowSplitter.containerProps} className={styles.contentContainer}>\n              <div {...rowSplitter.primaryProps}>\n                {/* template content and payload editor column  full height and half-width */}\n                <div {...columnSplitter.containerProps} className={styles.contentField}>\n                  {/* template editor */}\n                  <div {...columnSplitter.primaryProps}>\n                    {/* primaryProps will set \"minHeight: min-content;\" so we have to make sure to apply minHeight to the child */}\n                    <div className={cx(styles.flexColumn, styles.containerWithBorderAndRadius, styles.minEditorSize)}>\n                      <EditorColumnHeader\n                        label=\"Template\"\n                        actions={\n                          <Button\n                            icon=\"question-circle\"\n                            size=\"sm\"\n                            fill=\"outline\"\n                            variant=\"secondary\"\n                            onClick={toggleCheatsheetOpened}\n                          >\n                            Help\n                          </Button>\n                        }\n                      />\n                      <Box flex={1}>\n                        <AutoSizer>\n                          {({ width, height }) => (\n                            <TemplateEditor\n                              value={getValues('content')}\n                              onBlur={(value) => setValue('content', value)}\n                              containerStyles={styles.editorContainer}\n                              width={width}\n                              height={height}\n                            />\n                          )}\n                        </AutoSizer>\n                      </Box>\n                    </div>\n                  </div>\n                  {/* payload editor  only available for Grafana Alertmanager */}\n                  {isGrafanaAlertManager && (\n                    <>\n                      <div {...columnSplitter.splitterProps} />\n                      <div {...columnSplitter.secondaryProps}>\n                        <div\n                          className={cx(\n                            styles.containerWithBorderAndRadius,\n                            styles.minEditorSize,\n                            styles.payloadEditor,\n                            styles.flexFull\n                          )}\n                        >\n                          <PayloadEditor\n                            payload={payload}\n                            defaultPayload={defaultPayloadString}\n                            setPayload={setPayload}\n                            setPayloadFormatError={setPayloadFormatError}\n                            payloadFormatError={payloadFormatError}\n                          />\n                        </div>\n                      </div>\n                    </>\n                  )}\n                </div>\n              </div>\n              {/* preview column  full height and half-width */}\n              {isGrafanaAlertManager && (\n                <>\n                  <div {...rowSplitter.secondaryProps}>\n                    <div {...rowSplitter.splitterProps}></div>\n                    <TemplatePreview\n                      payload={payload}\n                      templateName={watch('name')}\n                      setPayloadFormatError={setPayloadFormatError}\n                      payloadFormatError={payloadFormatError}\n                      className={cx(styles.templatePreview, styles.minEditorSize)}\n                    />\n                  </div>\n                </>\n              )}\n            </div>\n          </FieldSet>\n        </form>\n      </FormProvider>\n      {cheatsheetOpened && (\n        <Drawer title=\"Templating cheat sheet\" onClose={toggleCheatsheetOpened} size=\"lg\">\n          <TemplatingCheatSheet />\n        </Drawer>\n      )}\n    </>\n  );\n};\n\nfunction TemplatingBasics() {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <Alert title=\"How to\" severity=\"info\">\n      <Stack direction=\"row\">\n        <div>\n          Grafana uses Go templating language to create notification messages.\n          <br />\n          To find out more about templating please visit our documentation.\n        </div>\n        <div>\n          <LinkButton\n            href=\"https://grafana.com/docs/grafana/latest/alerting/manage-notifications/template-notifications/\"\n            target=\"_blank\"\n            icon=\"external-link-alt\"\n            variant=\"secondary\"\n          >\n            Templating documentation\n          </LinkButton>\n        </div>\n      </Stack>\n\n      <div className={styles.snippets}>\n        For auto-completion of common templating code, type the following keywords in the content editor:\n        <div className={styles.code}>\n          {Object.values(snippets)\n            .map((s) => s.label)\n            .join(', ')}\n        </div>\n      </div>\n    </Alert>\n  );\n}\n\nfunction TemplatingCheatSheet() {\n  return (\n    <Stack direction=\"column\" gap={1}>\n      <TemplatingBasics />\n      <TemplateDataDocs />\n    </Stack>\n  );\n}\n\nexport const getStyles = (theme: GrafanaTheme2) => {\n  const narrowScreenQuery = theme.breakpoints.down('md');\n\n  return {\n    flexFull: css({\n      flex: 1,\n    }),\n    minEditorSize: css({\n      minHeight: 300,\n      minWidth: 300,\n    }),\n    payloadEditor: css({\n      minHeight: 0,\n    }),\n    containerWithBorderAndRadius: css({\n      borderRadius: theme.shape.radius.default,\n      border: `1px solid ${theme.colors.border.medium}`,\n    }),\n    flexColumn: css({\n      display: 'flex',\n      flex: 1,\n      flexDirection: 'column',\n    }),\n    form: css({\n      label: 'template-form',\n      height: '100%',\n      display: 'flex',\n      flexDirection: 'column',\n    }),\n    fieldset: css({\n      label: 'template-fieldset',\n      flex: 1,\n      display: 'flex',\n      flexDirection: 'column',\n    }),\n    label: css({\n      margin: 0,\n    }),\n    nameField: css({\n      marginBottom: theme.spacing(1),\n    }),\n    contentContainer: css({\n      flex: 1,\n      display: 'flex',\n      flexDirection: 'row',\n    }),\n    contentField: css({\n      display: 'flex',\n      flexDirection: 'column',\n      flex: 1,\n      marginBottom: 0,\n    }),\n    templatePreview: css({\n      flex: 1,\n      display: 'flex',\n    }),\n    templatePayload: css({\n      flex: 1,\n    }),\n    editorContainer: css({\n      width: 'fit-content',\n      border: 'none',\n    }),\n    payloadCollapseButton: css({\n      backgroundColor: theme.colors.info.transparent,\n      margin: 0,\n      [narrowScreenQuery]: {\n        display: 'none',\n      },\n    }),\n    snippets: css({\n      marginTop: theme.spacing(2),\n      fontSize: theme.typography.bodySmall.fontSize,\n    }),\n    code: css({\n      color: theme.colors.text.secondary,\n      fontWeight: theme.typography.fontWeightBold,\n    }),\n  };\n};\n\nconst defaultPayload: TestTemplateAlert[] = [\n  {\n    status: 'firing',\n    annotations: {\n      summary: 'Instance instance1 has been down for more than 5 minutes',\n    },\n    labels: {\n      alertname: 'InstanceDown',\n      instance: 'instance1',\n    },\n    startsAt: subDays(new Date(), 1).toISOString(),\n    endsAt: addMinutes(new Date(), 5).toISOString(),\n    fingerprint: 'a5331f0d5a9d81d4',\n    generatorURL: 'http://grafana.com/alerting/grafana/cdeqmlhvflz40f/view',\n  },\n  {\n    status: 'resolved',\n    annotations: {\n      summary: 'CPU usage above 90%',\n    },\n    labels: {\n      alertname: 'CpuUsage',\n      instance: 'instance1',\n    },\n    startsAt: subHours(new Date(), 4).toISOString(),\n    endsAt: new Date().toISOString(),\n    fingerprint: 'b77d941310f9d381',\n    generatorURL: 'http://grafana.com/alerting/grafana/oZSMdGj7z/view',\n  },\n];\n\nexport const defaultPayloadString = JSON.stringify(defaultPayload, null, 2);\n","import { css, cx } from '@emotion/css';\nimport { compact, uniqueId } from 'lodash';\nimport React from 'react';\nimport { useFormContext } from 'react-hook-form';\nimport AutoSizer from 'react-virtualized-auto-sizer';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Alert, Box, Button, useStyles2 } from '@grafana/ui';\n\nimport { TemplatePreviewErrors, TemplatePreviewResponse, TemplatePreviewResult } from '../../api/templateApi';\nimport { stringifyErrorLike } from '../../utils/misc';\nimport { EditorColumnHeader } from '../contact-points/templates/EditorColumnHeader';\n\nimport type { TemplateFormValues } from './TemplateForm';\nimport { usePreviewTemplate } from './usePreviewTemplate';\n\nexport function TemplatePreview({\n  payload,\n  templateName,\n  payloadFormatError,\n  setPayloadFormatError,\n  className,\n}: {\n  payload: string;\n  templateName: string;\n  payloadFormatError: string | null;\n  setPayloadFormatError: (value: React.SetStateAction<string | null>) => void;\n  className?: string;\n}) {\n  const styles = useStyles2(getStyles);\n\n  const { watch } = useFormContext<TemplateFormValues>();\n\n  const templateContent = watch('content');\n\n  const {\n    data,\n    isLoading,\n    onPreview,\n    error: previewError,\n  } = usePreviewTemplate(templateContent, templateName, payload, setPayloadFormatError);\n  const previewToRender = getPreviewResults(previewError, payloadFormatError, data);\n\n  return (\n    <div className={cx(styles.container, className)}>\n      <EditorColumnHeader\n        label=\"Preview\"\n        actions={\n          <Button\n            disabled={isLoading}\n            icon=\"sync\"\n            aria-label=\"Refresh preview\"\n            onClick={onPreview}\n            size=\"sm\"\n            variant=\"secondary\"\n          >\n            Refresh\n          </Button>\n        }\n      />\n      <Box flex={1}>\n        <AutoSizer disableWidth>\n          {({ height }) => <div className={styles.viewerContainer({ height })}>{previewToRender}</div>}\n        </AutoSizer>\n      </Box>\n    </div>\n  );\n}\n\nfunction PreviewResultViewer({ previews }: { previews: TemplatePreviewResult[] }) {\n  const styles = useStyles2(getStyles);\n  // If there is only one template, we don't need to show the name\n  const singleTemplate = previews.length === 1;\n\n  return (\n    <ul className={styles.viewer.container}>\n      {previews.map((preview) => (\n        <li className={styles.viewer.box} key={preview.name}>\n          {singleTemplate ? null : <header className={styles.viewer.header}>{preview.name}</header>}\n          <pre className={styles.viewer.pre}>{preview.text ?? '<Empty>'}</pre>\n        </li>\n      ))}\n    </ul>\n  );\n}\n\nfunction PreviewErrorViewer({ errors }: { errors: TemplatePreviewErrors[] }) {\n  return errors.map((error) => (\n    <Alert key={uniqueId('errors-list')} title={compact([error.name, error.kind]).join('  ')}>\n      {error.message}\n    </Alert>\n  ));\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  container: css({\n    label: 'template-preview-container',\n    display: 'flex',\n    flexDirection: 'column',\n    borderRadius: theme.shape.radius.default,\n    border: `1px solid ${theme.colors.border.medium}`,\n  }),\n  viewerContainer: ({ height }: { height: number }) =>\n    css({\n      height,\n      overflow: 'auto',\n      backgroundColor: theme.colors.background.primary,\n    }),\n  viewer: {\n    container: css({\n      display: 'flex',\n      flexDirection: 'column',\n      height: 'inherit',\n    }),\n    box: css({\n      display: 'flex',\n      flexDirection: 'column',\n      borderBottom: `1px solid ${theme.colors.border.medium}`,\n      height: 'inherit',\n    }),\n    header: css({\n      fontSize: theme.typography.bodySmall.fontSize,\n      padding: theme.spacing(1, 2),\n      borderBottom: `1px solid ${theme.colors.border.medium}`,\n      backgroundColor: theme.colors.background.secondary,\n    }),\n    errorText: css({\n      color: theme.colors.error.text,\n    }),\n    pre: css({\n      backgroundColor: 'transparent',\n      margin: 0,\n      border: 'none',\n      padding: theme.spacing(2),\n    }),\n  },\n});\n\nexport function getPreviewResults(\n  previewError: unknown | undefined,\n  payloadFormatError: string | null,\n  data: TemplatePreviewResponse | undefined\n): JSX.Element {\n  // ERRORS IN JSON OR IN REQUEST (endpoint not available, for example)\n  const previewErrorRequest = previewError ? stringifyErrorLike(previewError) : undefined;\n  const errorToRender = payloadFormatError || previewErrorRequest;\n\n  //PREVIEW : RESULTS AND ERRORS\n  const previewResponseResults = data?.results ?? [];\n  const previewResponseErrors = data?.errors;\n\n  return (\n    <>\n      {errorToRender && (\n        <Alert severity=\"error\" title=\"Error\">\n          {errorToRender}\n        </Alert>\n      )}\n      {previewResponseErrors && <PreviewErrorViewer errors={previewResponseErrors} />}\n      {previewResponseResults && <PreviewResultViewer previews={previewResponseResults} />}\n    </>\n  );\n}\n","/**\n * This function parses the template content and returns an array of Template objects.\n * Each Template object represents a single template definition found in the content.\n *\n * There are several rules for parsing the template content:\n * - The template content may use the \"-\" symbol for whitespace trimming. If a template's left delimiter (\"{{\")\n *   is immediately followed by a \"-\" and whitespace, all trailing whitespace is removed from the preceding text.\n * - Similarly, if the right delimiter (\"}}\") is immediately preceded by whitespace and a \"-\", all leading whitespace\n *  is removed from the following text. In these cases, the whitespace must be present for the trimming to occur.\n * - The template content may contain nested templates. The nested templates are appended to the main template content,\n *  and the nested templates are removed from the list of templates.\n * - We don't return templates with names starting with \"__\" as they are considered internal templates.\n *\n * @param templatesString is a string containing the template content. Each template is defined within\n * \"{{ define \"templateName\" }}\" and \"{{ end }}\" delimiters.But it may also contain nested templates.\n */\n\nimport { Template } from './TemplateSelector';\n\nexport function parseTemplates(templatesString: string): Template[] {\n  const templates: Record<string, Template> = {};\n  const stack: Array<{ type: string; startIndex: number; name?: string }> = [];\n  const regex = /{{(-?\\s*)(define|end|if|range|else|with|template)(\\s*.*?)?(-?\\s*)}}/gs;\n\n  let match;\n  let currentIndex = 0;\n\n  while ((match = regex.exec(templatesString)) !== null) {\n    const [, , keyword, middleContent] = match;\n    currentIndex = match.index;\n\n    if (keyword === 'define') {\n      const nameMatch = middleContent?.match(/\"([^\"]+)\"/);\n      if (nameMatch) {\n        stack.push({ type: 'define', startIndex: currentIndex, name: nameMatch[1] });\n      }\n    } else if (keyword === 'end') {\n      let top = stack.pop();\n      while (top && top.type !== 'define' && top.type !== 'if' && top.type !== 'range' && top.type !== 'with') {\n        top = stack.pop();\n      }\n      if (top) {\n        const endIndex = regex.lastIndex;\n        if (top.type === 'define' && !top.name?.startsWith('__')) {\n          templates[top.name!] = {\n            name: top.name!,\n            content: templatesString.slice(top.startIndex, endIndex),\n          };\n        }\n      }\n    } else if (keyword === 'if' || keyword === 'range' || keyword === 'else' || keyword === 'with') {\n      stack.push({ type: keyword, startIndex: currentIndex });\n    }\n  }\n  // Append sub-template content to the end of the main template and remove sub-templates from the list\n  for (const template of Object.values(templates)) {\n    const regex = /{{ template \"([^\"]+)\" }}/g;\n    let match;\n    while ((match = regex.exec(template.content)) !== null) {\n      const name = match[1];\n      if (templates[name]?.content) {\n        template.content += '\\n' + templates[name]?.content;\n        delete templates[name]; // Remove the sub-template from the list\n      }\n    }\n  }\n\n  return Object.values(templates);\n}\n\nexport function getUseTemplateText(templateName: string) {\n  return `{{ template \"${templateName}\" . }}`;\n}\n\nexport function getTemplateName(useTemplateText: string) {\n  const match = useTemplateText.match(/\\{\\{\\s*template\\s*\"(.*)\"\\s*\\.\\s*\\}\\}/);\n  return match ? match[1] : '';\n}\n\n/* This function checks if the a field value contains only one template usage\n    for example: \n    \"{{ template \"templateName\" . }}\"\" returns true\n    but \"{{ template \"templateName\" . }} some text {{ template \"templateName\" . }}\"\" returns false\n    and \"{{ template \"templateName\" . }} some text\" some text returns false\n**/\n\nexport function matchesOnlyOneTemplate(fieldValue: string) {\n  const pattern = /\\{\\{\\s*template\\s*\".*?\"\\s*\\.\\s*\\}\\}/g;\n  const matches = fieldValue.match(pattern);\n\n  if (matches?.length !== 1) {\n    return false;\n  }\n\n  // Split the content by the template pattern\n  const parts = fieldValue.split(pattern);\n\n  // Check if there is any non-whitespace text outside the template pattern\n  for (const part of parts) {\n    if (part.trim() !== '') {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import { useCallback, useEffect } from 'react';\n\nimport { AlertField, usePreviewTemplateMutation } from '../../api/templateApi';\n\nexport function usePreviewTemplate(\n  templateContent: string,\n  templateName: string,\n  payload: string,\n  setPayloadFormatError: (value: React.SetStateAction<string | null>) => void\n) {\n  const [trigger, { data, error, isLoading }] = usePreviewTemplateMutation();\n\n  const onPreview = useCallback(() => {\n    try {\n      const alertList: AlertField[] = JSON.parse(payload);\n      JSON.stringify([...alertList]); // check if it's iterable, in order to be able to add more data\n      trigger({ template: templateContent, alerts: alertList, name: templateName });\n      setPayloadFormatError(null);\n    } catch (e) {\n      setPayloadFormatError(e instanceof Error ? e.message : 'Invalid JSON.');\n    }\n  }, [templateContent, templateName, payload, setPayloadFormatError, trigger]);\n\n  useEffect(() => onPreview(), [onPreview]);\n\n  return { data, error, isLoading, onPreview };\n}\n","import { isEqual, uniqBy } from 'lodash';\n\nimport { GrafanaAlertStateWithReason } from 'app/types/unified-alerting-dto';\n\nexport interface Line {\n  previous: GrafanaAlertStateWithReason;\n  current: GrafanaAlertStateWithReason;\n  values?: Record<string, number>;\n  labels?: Record<string, string>;\n}\n\nexport interface LogRecord {\n  timestamp: number;\n  line: Line;\n}\n\nexport type Label = [string, string];\n\n// omit \"common\" labels from \"labels\"\nexport function omitLabels(labels: Label[], common: Label[]): Label[] {\n  return labels.filter((label) => {\n    return !common.find((commonLabel) => JSON.stringify(commonLabel) === JSON.stringify(label));\n  });\n}\n\n// find all common labels by looking at which ones occur in every record, then create a unique array of items for those\nexport function extractCommonLabels(labels: Label[][]): Label[] {\n  const flatLabels = labels.flatMap((label) => label);\n\n  const commonLabels = uniqBy(\n    flatLabels.filter((label) => {\n      const count = flatLabels.filter((l) => isEqual(label, l)).length;\n      return count === Object.keys(labels).length;\n    }),\n    (label) => JSON.stringify(label)\n  );\n\n  return commonLabels;\n}\n","import { now } from 'lodash';\n\nexport function ensureDefine(templateName: string, templateContent: string): string {\n  // notification template content must be wrapped in {{ define \"name\" }} tag,\n  // but this is not obvious because user also has to provide name separately in the form.\n  // so if user does not manually add {{ define }} tag, we do it automatically\n  let content = templateContent.trim();\n  if (!content.match(/\\{\\{\\s*define/)) {\n    const indentedContent = content\n      .split('\\n')\n      .map((line) => '  ' + line)\n      .join('\\n');\n    content = `{{ define \"${templateName}\" }}\\n${indentedContent}\\n{{ end }}`;\n  }\n  return content;\n}\nexport function updateDefinesWithUniqueValue(templateContent: string): string {\n  const getNewValue = (match_: string, originalDefineName: string) => {\n    return `{{ define \"${originalDefineName}_NEW_${now()}\" }}`;\n  };\n  return templateContent.replace(/\\{\\{\\s*define\\s*\\\"(?<defineName>.*)\\\"\\s*\\}\\}/g, getNewValue);\n}\n"],"names":["DEFAULT_TEMPLATES","previewTemplateUrl","templatesApi","alertingApi","build","template","alerts","name","usePreviewTemplateMutation","EditorColumnHeader","label","actions","styles","editorColumnStyles","theme","subDays","date","amount","addDays","addMinutes","addMilliseconds","addHours","subHours","AlertInstanceModalSelector","onSelect","isOpen","onClose","getStyles","selectedRule","setSelectedRule","selectedInstances","setSelectedInstances","useGetAlertmanagerAlertsQuery","alertmanagerApi","result","loading","error","ruleFilter","setRuleFilter","rulesWithInstances","rules","instance","handleRuleChange","rule","filteredRules","filteredRulesObject","filteredRulesKeys","RuleRow","index","style","ruleName","isSelected","Icon","getAlertUniqueLabels","allAlerts","currentAlert","labelsAsArray","alert","ruleCommonLabels","alertUniqueLabels","labels","InstanceRow","tags","handleSelectInstances","Tooltip","tag","Tag","handleConfirm","instances","resetState","handleSearchRules","onDismiss","filter","Modal","FilterInput","LoadingPlaceholder","height","width","Button","clearButton","GlobalTemplateData","AlertTemplatePreviewData","AlertTemplateData","KeyValueTemplateFunctions","KeyValueCodeSnippet","TemplateDataDocs","getTemplateDataDocsStyles","AlertTemplateDataTable","TemplateDataTable","Stack","type","HoverCard","KeyValueTemplateDataTable","dataItems","caption","typeRenderer","getTemplateDataTableStyles","notes","tableStyles","args","returns","defaultValues","GenerateAlertDataModal","onAccept","setAlerts","formMethods","annotations","status","setStatus","onAdd","key","value","acc","onSubmit","labelsOrAnnotationsAdded","someLabels","lb","someAnnotations","ann","alertOptions","e","Card","AnnotationsStep","LabelsField","RadioButtonGroup","RESET_TO_DEFAULT","PayloadEditor","payload","setPayload","defaultPayload","setPayloadFormatError","payloadFormatError","className","onReset","isEditingAlertData","setIsEditingAlertData","onCloseEditAlertModal","errorInPayloadJson","validatePayload","payloadObj","onOpenEditAlertModal","onOpenAlertSelectorModal","setIsAlertSelectorOpen","onAddAlertList","isAlertSelectorOpen","Dropdown","Menu","Toggletip","CodeEditor","defaults","isDuplicating","location","TemplateForm","existing","alertManagerSourceName","config","provenance","dispatch","useCleanup","state","formRef","isGrafanaAlertManager","useUnifiedAlertingSelector","cheatsheetOpened","toggleCheatsheetOpened","useToggle","defaultPayloadString","columnSplitter","useSplitter","rowSplitter","submit","values","content","template_files","templates","newConfig","ContactPoints","formApi","handleSubmit","register","errors","getValues","setValue","watch","validateNameIsUnique","actionButtons","AppChromeUpdate","Alert","Provisioning","FieldSet","InlineField","Input","Box","TemplateEditor","TemplatePreview","Drawer","TemplatingCheatSheet","TemplatingBasics","s","narrowScreenQuery","templateName","templateContent","data","isLoading","onPreview","previewError","previewToRender","getPreviewResults","PreviewResultViewer","previews","singleTemplate","preview","PreviewErrorViewer","previewErrorRequest","errorToRender","previewResponseResults","previewResponseErrors","parseTemplates","templatesString","stack","regex","match","currentIndex","keyword","middleContent","nameMatch","top","endIndex","getUseTemplateText","getTemplateName","useTemplateText","matchesOnlyOneTemplate","fieldValue","pattern","parts","part","usePreviewTemplate","trigger","alertList","omitLabels","common","commonLabel","extractCommonLabels","flatLabels","l","ensureDefine","indentedContent","line","updateDefinesWithUniqueValue","getNewValue","match_","originalDefineName"],"sourceRoot":""}