{"version":3,"file":"canvasPanel.62a2d9db78ed36ace636.js","mappings":"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","sources":["webpack://grafana/./public/app/core/components/Layers/AddLayerButton.tsx","webpack://grafana/./public/app/features/canvas/elements/notFound.tsx","webpack://grafana/./public/app/plugins/panel/canvas/panelcfg.gen.ts","webpack://grafana/./public/app/plugins/panel/canvas/types.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/ParamsEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/utils.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/APIEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/ButtonStyleEditor.tsx","webpack://grafana/./public/app/features/canvas/element.ts","webpack://grafana/./public/app/features/canvas/types.ts","webpack://grafana/./public/app/features/canvas/elements/button.tsx","webpack://grafana/./public/app/features/canvas/elements/cloud.tsx","webpack://grafana/./public/app/features/canvas/elements/droneFront.tsx","webpack://grafana/./public/app/features/canvas/elements/droneSide.tsx","webpack://grafana/./public/app/features/canvas/elements/droneTop.tsx","webpack://grafana/./public/app/features/canvas/elements/ellipse.tsx","webpack://grafana/./public/app/features/canvas/elements/icon.tsx","webpack://grafana/./public/app/features/canvas/elements/metricValue.tsx","webpack://grafana/./public/app/features/canvas/elements/parallelogram.tsx","webpack://grafana/./public/app/features/canvas/elements/rectangle.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/database.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/single.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/stack.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/terminal.tsx","webpack://grafana/./public/app/features/canvas/elements/server/server.tsx","webpack://grafana/./public/app/features/canvas/elements/text.tsx","webpack://grafana/./public/app/features/canvas/elements/triangle.tsx","webpack://grafana/./public/app/features/canvas/elements/windTurbine.tsx","webpack://grafana/./public/app/features/canvas/registry.ts","webpack://grafana/./public/app/features/canvas/runtime/element.tsx","webpack://grafana/./public/app/plugins/panel/canvas/utils.ts","webpack://grafana/./node_modules/framework-utils/dist/utils.esm.js","webpack://grafana/./node_modules/@daybrush/utils/dist/utils.esm.js","webpack://grafana/./node_modules/@egjs/list-differ/dist/list-differ.esm.js","webpack://grafana/./node_modules/croact/dist/croact.esm.js","webpack://grafana/./node_modules/@egjs/agent/dist/agent.esm.js","webpack://grafana/./node_modules/@scena/matrix/dist/matrix.esm.js","webpack://grafana/./node_modules/css-to-mat/dist/css-to-mat.esm.js","webpack://grafana/./node_modules/@egjs/children-differ/dist/children-differ.esm.js","webpack://grafana/./node_modules/@scena/event-emitter/dist/event-emitter.esm.js","webpack://grafana/./node_modules/@scena/dragscroll/dist/dragscroll.esm.js","webpack://grafana/./node_modules/overlap-area/dist/overlap-area.esm.js","webpack://grafana/./node_modules/gesto/dist/gesto.esm.js","webpack://grafana/./node_modules/css-styled/dist/styled.esm.js","webpack://grafana/./node_modules/croact-css-styled/dist/styled.esm.js","webpack://grafana/./node_modules/croact-moveable/dist/moveable.esm.js","webpack://grafana/./node_modules/moveable/dist/moveable.esm.js","webpack://grafana/./node_modules/keycon/dist/keycon.esm.js","webpack://grafana/./node_modules/selecto/dist/selecto.esm.js","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/ConnectionAnchors.tsx","webpack://grafana/./public/app/features/canvas/runtime/sceneElementManagement.ts","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/ConnectionSVG.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/Connections.tsx","webpack://grafana/./public/app/features/canvas/runtime/ables.tsx","webpack://grafana/./public/app/features/canvas/runtime/sceneAbleManagement.ts","webpack://grafana/./public/app/features/canvas/runtime/frame.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/CanvasContextMenu.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/CanvasTooltip.tsx","webpack://grafana/./node_modules/react-zoom-pan-pinch/dist/index.esm.js","webpack://grafana/./public/app/features/canvas/runtime/SceneTransformWrapper.tsx","webpack://grafana/./public/app/features/canvas/runtime/root.tsx","webpack://grafana/./public/app/features/canvas/runtime/scene.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/SetBackground.tsx","webpack://grafana/./public/app/features/dimensions/editors/BackgroundSizeEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/LineStyleEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/DataLinksEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/options.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/connectionEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/ConstraintSelectionBox.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/QuickPositioning.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/PlacementEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/elementEditor.tsx","webpack://grafana/./node_modules/rc-tree/es/contextTypes.js","webpack://grafana/./node_modules/rc-tree/es/DropIndicator.js","webpack://grafana/./node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js","webpack://grafana/./node_modules/rc-tree/es/Indent.js","webpack://grafana/./node_modules/rc-tree/es/TreeNode.js","webpack://grafana/./node_modules/rc-tree/es/useUnmount.js","webpack://grafana/./node_modules/rc-tree/es/MotionTreeNode.js","webpack://grafana/./node_modules/rc-tree/es/utils/diffUtil.js","webpack://grafana/./node_modules/rc-tree/es/NodeList.js","webpack://grafana/./node_modules/rc-tree/es/util.js","webpack://grafana/./node_modules/rc-tree/es/Tree.js","webpack://grafana/./node_modules/rc-tree/es/index.js","webpack://grafana/./public/app/plugins/panel/canvas/globalStyles.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/TreeNodeTitle.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/tree.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/TreeNavigationEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/layerEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/inline/TabsEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/inline/InlineEditBody.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/inline/InlineEdit.tsx","webpack://grafana/./public/app/plugins/panel/canvas/CanvasPanel.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/panZoomHelp.tsx","webpack://grafana/./public/app/plugins/panel/canvas/migrations.ts","webpack://grafana/./public/app/plugins/panel/canvas/module.tsx"],"sourcesContent":["import { SelectableValue } from '@grafana/data';\nimport { ValuePicker } from '@grafana/ui';\n\nexport type AddLayerButtonProps = {\n  onChange: (sel: SelectableValue<string>) => void;\n  options: Array<SelectableValue<string>>;\n  label: string;\n};\n\nexport const AddLayerButton = ({ onChange, options, label }: AddLayerButtonProps) => {\n  return (\n    <ValuePicker\n      icon=\"plus\"\n      label={label}\n      variant=\"secondary\"\n      options={options}\n      onChange={onChange}\n      isFullWidth={true}\n    />\n  );\n};\n","import { PureComponent } from 'react';\n\nimport { CanvasElementItem, CanvasElementProps } from '../element';\n\nclass NotFoundDisplay extends PureComponent<CanvasElementProps> {\n  render() {\n    const { config } = this.props;\n    return (\n      <div>\n        <h3>NOT FOUND:</h3>\n        <pre>{JSON.stringify(config, null, 2)}</pre>\n      </div>\n    );\n  }\n}\n\nexport const notFoundItem: CanvasElementItem = {\n  id: 'not-found',\n  name: 'Not found',\n  description: 'Display when element type is not found in the registry',\n\n  display: NotFoundDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 100,\n  },\n\n  getNewOptions: () => ({\n    config: {},\n  }),\n};\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as ui from '@grafana/schema';\n\nexport enum HorizontalConstraint {\n  Center = 'center',\n  Left = 'left',\n  LeftRight = 'leftright',\n  Right = 'right',\n  Scale = 'scale',\n}\n\nexport enum VerticalConstraint {\n  Bottom = 'bottom',\n  Center = 'center',\n  Scale = 'scale',\n  Top = 'top',\n  TopBottom = 'topbottom',\n}\n\nexport interface Constraint {\n  horizontal?: HorizontalConstraint;\n  vertical?: VerticalConstraint;\n}\n\nexport interface Placement {\n  bottom?: number;\n  height?: number;\n  left?: number;\n  right?: number;\n  rotation?: number;\n  top?: number;\n  width?: number;\n}\n\nexport enum BackgroundImageSize {\n  Contain = 'contain',\n  Cover = 'cover',\n  Fill = 'fill',\n  Original = 'original',\n  Tile = 'tile',\n}\n\nexport interface BackgroundConfig {\n  color?: ui.ColorDimensionConfig;\n  image?: ui.ResourceDimensionConfig;\n  size?: BackgroundImageSize;\n}\n\nexport interface LineConfig {\n  color?: ui.ColorDimensionConfig;\n  radius?: number;\n  width?: number;\n}\n\nexport enum HttpRequestMethod {\n  GET = 'GET',\n  POST = 'POST',\n  PUT = 'PUT',\n}\n\nexport interface ConnectionCoordinates {\n  x: number;\n  y: number;\n}\n\nexport enum ConnectionPath {\n  Straight = 'straight',\n}\n\nexport interface CanvasConnection {\n  color?: ui.ColorDimensionConfig;\n  path: ConnectionPath;\n  size?: ui.ScaleDimensionConfig;\n  source: ConnectionCoordinates;\n  sourceOriginal?: ConnectionCoordinates;\n  target: ConnectionCoordinates;\n  targetName?: string;\n  targetOriginal?: ConnectionCoordinates;\n  vertices?: Array<ConnectionCoordinates>;\n}\n\nexport const defaultCanvasConnection: Partial<CanvasConnection> = {\n  vertices: [],\n};\n\nexport interface CanvasElementOptions {\n  background?: BackgroundConfig;\n  border?: LineConfig;\n  /**\n   * TODO: figure out how to define this (element config(s))\n   */\n  config?: unknown;\n  connections?: Array<CanvasConnection>;\n  constraint?: Constraint;\n  name: string;\n  placement?: Placement;\n  type: string;\n}\n\nexport const defaultCanvasElementOptions: Partial<CanvasElementOptions> = {\n  connections: [],\n};\n\nexport interface Options {\n  /**\n   * Enable infinite pan\n   */\n  infinitePan: boolean;\n  /**\n   * Enable inline editing\n   */\n  inlineEditing: boolean;\n  /**\n   * Enable pan and zoom\n   */\n  panZoom: boolean;\n  /**\n   * The root element of canvas (frame), where all canvas elements are nested\n   * TODO: Figure out how to define a default value for this\n   */\n  root: {\n    /**\n     * Name of the root element\n     */\n    name: string;\n    /**\n     * Type of root element (frame)\n     */\n    type: 'frame';\n    /**\n     * The list of canvas elements attached to the root element\n     */\n    elements: Array<CanvasElementOptions>;\n  };\n  /**\n   * Show all available element types\n   */\n  showAdvancedTypes: boolean;\n}\n\nexport const defaultOptions: Partial<Options> = {\n  infinitePan: true,\n  inlineEditing: true,\n  panZoom: true,\n  showAdvancedTypes: true,\n};\n","import { ElementState } from '../../../features/canvas/runtime/element';\n\nimport { CanvasConnection, ConnectionCoordinates } from './panelcfg.gen';\n\nexport enum LayerActionID {\n  Delete = 'delete',\n  Duplicate = 'duplicate',\n  MoveTop = 'move-top',\n  MoveBottom = 'move-bottom',\n}\n\nexport interface DragNode {\n  key: number;\n  dataRef: ElementState;\n}\n\nexport interface DropNode extends DragNode {\n  pos: string;\n}\n\nexport enum InlineEditTabs {\n  ElementManagement = 'element-management',\n  SelectedElement = 'selected-element',\n  SelectedConnection = 'selected-connection',\n}\n\nexport type AnchorPoint = {\n  x: number;\n  y: number;\n};\n\nexport interface CanvasTooltipPayload {\n  anchorPoint: AnchorPoint | undefined;\n  element: ElementState | undefined;\n  isOpen?: boolean;\n}\n\nexport interface ConnectionState {\n  index: number; // array index from the source\n  source: ElementState;\n  target: ElementState;\n  info: CanvasConnection;\n  vertices?: ConnectionCoordinates[];\n  sourceOriginal?: ConnectionCoordinates;\n  targetOriginal?: ConnectionCoordinates;\n}\n\nexport enum LineStyle {\n  Solid = 'solid',\n  Dashed = 'dashed',\n  Dotted = 'dotted',\n}\n\nexport enum StrokeDasharray {\n  Solid = '0',\n  Dashed = '8 8',\n  Dotted = '3',\n}\n","import { useState } from 'react';\nimport * as React from 'react';\n\nimport { IconButton, Input, Stack } from '@grafana/ui';\n\ninterface Props {\n  onChange: (v: Array<[string, string]>) => void;\n  value: Array<[string, string]>;\n}\n\nexport const ParamsEditor = ({ value, onChange }: Props) => {\n  const [paramName, setParamName] = useState('');\n  const [paramValue, setParamValue] = useState('');\n\n  const changeParamValue = ({ currentTarget }: React.ChangeEvent<HTMLInputElement>) => {\n    setParamValue(currentTarget.value);\n  };\n\n  const changeParamName = ({ currentTarget }: React.ChangeEvent<HTMLInputElement>) => {\n    setParamName(currentTarget.value);\n  };\n\n  const removeParam = (key: string) => () => {\n    const updatedParams = value.filter((param) => param[0] !== key);\n    onChange(updatedParams);\n  };\n\n  const addParam = () => {\n    const key = paramName;\n    let newParams: Array<[string, string]>;\n    if (value) {\n      newParams = value.filter((e) => e[0] !== key);\n    } else {\n      newParams = [];\n    }\n    newParams.push([key, paramValue]);\n    newParams.sort((a, b) => a[0].localeCompare(b[0]));\n\n    setParamName('');\n    setParamValue('');\n    onChange(newParams);\n  };\n\n  const isAddParamsDisabled = !paramName && !paramValue;\n\n  return (\n    <div>\n      <Stack direction=\"row\">\n        <Input placeholder=\"Key\" value={paramName} onChange={changeParamName} />\n        <Input placeholder=\"Value\" value={paramValue} onChange={changeParamValue} />\n        <IconButton aria-label=\"add\" name=\"plus-circle\" onClick={addParam} disabled={isAddParamsDisabled} />\n      </Stack>\n      <Stack direction=\"column\">\n        {Array.from(value || []).map((entry) => (\n          <Stack key={entry[0]} direction=\"row\">\n            <Input disabled value={entry[0]} />\n            <Input disabled value={entry[1]} />\n            <IconButton aria-label=\"delete\" onClick={removeParam(entry[0])} name=\"trash-alt\" />\n          </Stack>\n        ))}\n      </Stack>\n    </div>\n  );\n};\n","import { AppEvents } from '@grafana/data';\nimport { BackendSrvRequest, getBackendSrv, getTemplateSrv } from '@grafana/runtime';\nimport { appEvents } from 'app/core/core';\nimport { getDashboardSrv } from 'app/features/dashboard/services/DashboardSrv';\n\nimport { HttpRequestMethod } from '../../panelcfg.gen';\n\nimport { APIEditorConfig } from './APIEditor';\n\ntype IsLoadingCallback = (loading: boolean) => void;\n\nexport const callApi = (api: APIEditorConfig, updateLoadingStateCallback?: IsLoadingCallback) => {\n  if (api && api.endpoint) {\n    // If API endpoint origin matches Grafana origin, don't call it.\n    const interpolatedUrl = interpolateVariables(api.endpoint);\n    if (requestMatchesGrafanaOrigin(interpolatedUrl)) {\n      appEvents.emit(AppEvents.alertError, ['Cannot call API at Grafana origin.']);\n      updateLoadingStateCallback && updateLoadingStateCallback(false);\n      return;\n    }\n    const request = getRequest(api);\n\n    getBackendSrv()\n      .fetch(request)\n      .subscribe({\n        error: (error) => {\n          appEvents.emit(AppEvents.alertError, ['An error has occurred. Check console output for more details.']);\n          console.error('API call error: ', error);\n          updateLoadingStateCallback && updateLoadingStateCallback(false);\n        },\n        complete: () => {\n          appEvents.emit(AppEvents.alertSuccess, ['API call was successful']);\n          updateLoadingStateCallback && updateLoadingStateCallback(false);\n        },\n      });\n  }\n};\n\nexport const interpolateVariables = (text: string) => {\n  const panel = getDashboardSrv().getCurrent()?.panelInEdit;\n  return getTemplateSrv().replace(text, panel?.scopedVars);\n};\n\nexport const getRequest = (api: APIEditorConfig) => {\n  const requestHeaders: HeadersInit = [];\n\n  const url = new URL(interpolateVariables(api.endpoint!));\n\n  let request: BackendSrvRequest = {\n    url: url.toString(),\n    method: api.method,\n    data: getData(api),\n    headers: requestHeaders,\n  };\n\n  if (api.headerParams) {\n    api.headerParams.forEach((param) => {\n      requestHeaders.push([interpolateVariables(param[0]), interpolateVariables(param[1])]);\n    });\n  }\n\n  if (api.queryParams) {\n    api.queryParams?.forEach((param) => {\n      url.searchParams.append(interpolateVariables(param[0]), interpolateVariables(param[1]));\n    });\n\n    request.url = url.toString();\n  }\n\n  if (api.method === HttpRequestMethod.POST) {\n    requestHeaders.push(['Content-Type', api.contentType!]);\n  }\n\n  request.headers = requestHeaders;\n\n  return request;\n};\n\nconst getData = (api: APIEditorConfig) => {\n  let data: string | undefined = api.data ? interpolateVariables(api.data) : '{}';\n  if (api.method === HttpRequestMethod.GET) {\n    data = undefined;\n  }\n\n  return data;\n};\n\nconst requestMatchesGrafanaOrigin = (requestEndpoint: string) => {\n  const requestURL = new URL(requestEndpoint);\n  const grafanaURL = new URL(window.location.origin);\n  return requestURL.origin === grafanaURL.origin;\n};\n","import { useCallback } from 'react';\n\nimport {\n  StandardEditorProps,\n  StandardEditorsRegistryItem,\n  StringFieldConfigSettings,\n  SelectableValue,\n} from '@grafana/data';\nimport { Button, Field, InlineField, InlineFieldRow, JSONFormatter, RadioButtonGroup, Select } from '@grafana/ui';\nimport { StringValueEditor } from 'app/core/components/OptionsUI/string';\nimport { defaultApiConfig } from 'app/features/canvas/elements/button';\n\nimport { HttpRequestMethod } from '../../panelcfg.gen';\n\nimport { ParamsEditor } from './ParamsEditor';\nimport { callApi, interpolateVariables } from './utils';\n\nexport interface APIEditorConfig {\n  method: string;\n  endpoint: string;\n  data?: string;\n  contentType?: string;\n  queryParams?: Array<[string, string]>;\n  headerParams?: Array<[string, string]>;\n}\n\nconst dummyStringSettings: StandardEditorsRegistryItem<string, StringFieldConfigSettings> = {\n  id: '',\n  name: '',\n  description: '',\n  editor: StringValueEditor,\n  settings: {},\n};\n\ntype Props = StandardEditorProps<APIEditorConfig>;\n\nconst httpMethodOptions = [\n  { label: HttpRequestMethod.GET, value: HttpRequestMethod.GET },\n  { label: HttpRequestMethod.POST, value: HttpRequestMethod.POST },\n  { label: HttpRequestMethod.PUT, value: HttpRequestMethod.PUT },\n];\n\nconst contentTypeOptions: SelectableValue[] = [\n  { label: 'JSON', value: 'application/json' },\n  { label: 'Text', value: 'text/plain' },\n  { label: 'JavaScript', value: 'application/javascript' },\n  { label: 'HTML', value: 'text/html' },\n  { label: 'XML', value: 'application/XML' },\n  { label: 'x-www-form-urlencoded', value: 'application/x-www-form-urlencoded' },\n];\n\nexport function APIEditor({ value, context, onChange }: Props) {\n  const LABEL_WIDTH = 13;\n\n  if (!value) {\n    value = defaultApiConfig;\n  }\n\n  const onEndpointChange = useCallback(\n    (endpoint = '') => {\n      onChange({\n        ...value,\n        endpoint,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onDataChange = useCallback(\n    (data?: string) => {\n      onChange({\n        ...value,\n        data,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onMethodChange = useCallback(\n    (method: string) => {\n      onChange({\n        ...value,\n        method,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onContentTypeChange = useCallback(\n    (contentType: SelectableValue<string>) => {\n      onChange({\n        ...value,\n        contentType: contentType?.value,\n      });\n    },\n    [onChange, value]\n  );\n\n  const formatCreateLabel = (input: string) => {\n    return input;\n  };\n\n  const onQueryParamsChange = useCallback(\n    (queryParams: Array<[string, string]>) => {\n      onChange({\n        ...value,\n        queryParams,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onHeaderParamsChange = useCallback(\n    (headerParams: Array<[string, string]>) => {\n      onChange({\n        ...value,\n        headerParams,\n      });\n    },\n    [onChange, value]\n  );\n\n  const renderJSON = (data: string) => {\n    try {\n      const json = JSON.parse(interpolateVariables(data));\n      return <JSONFormatter json={json} />;\n    } catch (error) {\n      if (error instanceof Error) {\n        return `Invalid JSON provided: ${error.message}`;\n      } else {\n        return 'Invalid JSON provided';\n      }\n    }\n  };\n\n  const renderTestAPIButton = (api: APIEditorConfig) => {\n    if (api && api.endpoint) {\n      return (\n        <Button onClick={() => callApi(api)} title=\"Test API\">\n          Test API\n        </Button>\n      );\n    }\n\n    return;\n  };\n\n  return (\n    <>\n      <InlineFieldRow>\n        <InlineField label=\"Endpoint\" labelWidth={LABEL_WIDTH} grow={true}>\n          <StringValueEditor\n            context={context}\n            value={value?.endpoint}\n            onChange={onEndpointChange}\n            item={dummyStringSettings}\n          />\n        </InlineField>\n      </InlineFieldRow>\n      <InlineFieldRow>\n        <InlineField label=\"Method\" labelWidth={LABEL_WIDTH} grow={true}>\n          <RadioButtonGroup value={value?.method} options={httpMethodOptions} onChange={onMethodChange} fullWidth />\n        </InlineField>\n      </InlineFieldRow>\n      {value?.method !== HttpRequestMethod.GET && (\n        <InlineFieldRow>\n          <InlineField label=\"Content-Type\" labelWidth={LABEL_WIDTH} grow={true}>\n            <Select\n              options={contentTypeOptions}\n              allowCustomValue={true}\n              formatCreateLabel={formatCreateLabel}\n              value={value?.contentType}\n              onChange={onContentTypeChange}\n            />\n          </InlineField>\n        </InlineFieldRow>\n      )}\n\n      <br />\n      <Field label=\"Query parameters\">\n        <ParamsEditor value={value?.queryParams ?? []} onChange={onQueryParamsChange} />\n      </Field>\n      <Field label=\"Header parameters\">\n        <ParamsEditor value={value?.headerParams ?? []} onChange={onHeaderParamsChange} />\n      </Field>\n      {value?.method !== HttpRequestMethod.GET && value?.contentType && (\n        <Field label=\"Payload\">\n          <StringValueEditor\n            context={context}\n            value={value?.data ?? '{}'}\n            onChange={onDataChange}\n            item={{ ...dummyStringSettings, settings: { useTextarea: true } }}\n          />\n        </Field>\n      )}\n      {renderTestAPIButton(value)}\n      <br />\n      {value?.method !== HttpRequestMethod.GET &&\n        value?.contentType === defaultApiConfig.contentType &&\n        renderJSON(value?.data ?? '{}')}\n    </>\n  );\n}\n","import { useCallback } from 'react';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { ButtonVariant, InlineField, InlineFieldRow, Select } from '@grafana/ui';\nimport { defaultStyleConfig } from 'app/features/canvas/elements/button';\n\nexport interface ButtonStyleConfig {\n  variant: ButtonVariant;\n}\n\ntype Props = StandardEditorProps<ButtonStyleConfig>;\n\nconst variantOptions: SelectableValue[] = [\n  { label: 'primary', value: 'primary' },\n  { label: 'secondary', value: 'secondary' },\n  { label: 'success', value: 'success' },\n  { label: 'destructive', value: 'destructive' },\n];\n\nexport const ButtonStyleEditor = ({ value, onChange }: Props) => {\n  if (!value) {\n    value = defaultStyleConfig;\n  }\n\n  const onVariantChange = useCallback(\n    (variant: SelectableValue<ButtonVariant>) => {\n      onChange({\n        ...value,\n        variant: variant?.value ?? defaultStyleConfig.variant,\n      });\n    },\n    [onChange, value]\n  );\n\n  return (\n    <>\n      <InlineFieldRow>\n        <InlineField label=\"Variant\" grow={true}>\n          <Select options={variantOptions} value={value?.variant} onChange={onVariantChange} />\n        </InlineField>\n      </InlineFieldRow>\n    </>\n  );\n};\n","import { ComponentType } from 'react';\n\nimport { DataLink, RegistryItem, OneClickMode } from '@grafana/data';\nimport { PanelOptionsSupplier } from '@grafana/data/src/panel/PanelPlugin';\nimport { ColorDimensionConfig, ScaleDimensionConfig } from '@grafana/schema';\nimport { config } from 'app/core/config';\nimport { BackgroundConfig, Constraint, LineConfig, Placement } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { LineStyleConfig } from '../../plugins/panel/canvas/editor/LineStyleEditor';\nimport { DimensionContext } from '../dimensions';\n\nimport { StandardEditorConfig } from './types';\n\n/**\n * This gets saved in panel json\n *\n * depending on the type, it may have additional config\n *\n * @alpha\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport interface CanvasElementOptions<TConfig = any> {\n  name: string; // configured unique display name\n  type: string;\n\n  // Custom options depending on the type\n  config?: TConfig;\n\n  // Standard options available for all elements\n  constraint?: Constraint; // defaults vertical - top, horizontal - left\n  placement?: Placement;\n  background?: BackgroundConfig;\n  border?: LineConfig;\n  connections?: CanvasConnection[];\n  links?: DataLink[];\n  oneClickMode?: OneClickMode;\n}\n\n// Unit is percentage from the middle of the element\n// 0, 0 middle; -1, -1 bottom left; 1, 1 top right\nexport interface ConnectionCoordinates {\n  x: number;\n  y: number;\n}\n\nexport enum ConnectionPath {\n  Straight = 'straight',\n}\n\nexport enum ConnectionDirection {\n  Forward = 'forward',\n  Reverse = 'reverse',\n  Both = 'both',\n  None = 'none',\n}\n\nexport interface CanvasConnection {\n  source: ConnectionCoordinates;\n  target: ConnectionCoordinates;\n  targetName?: string;\n  path: ConnectionPath;\n  color?: ColorDimensionConfig;\n  size?: ScaleDimensionConfig;\n  lineStyle?: LineStyleConfig;\n  vertices?: ConnectionCoordinates[];\n  radius?: ScaleDimensionConfig;\n  direction?: ConnectionDirection;\n  sourceOriginal?: ConnectionCoordinates;\n  targetOriginal?: ConnectionCoordinates;\n  // See https://github.com/anseki/leader-line#options for more examples of more properties\n}\n\nexport interface CanvasElementProps<TConfig = unknown, TData = unknown> {\n  // Saved config\n  config: TConfig;\n\n  // Raw data\n  data?: TData;\n\n  // If the element is currently selected\n  isSelected?: boolean;\n}\n\n/**\n * Canvas item builder\n *\n * @alpha\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport interface CanvasElementItem<TConfig = any, TData = any> extends RegistryItem {\n  /** The default width/height to use when adding  */\n  defaultSize?: Placement;\n\n  prepareData?: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TConfig>) => TData;\n\n  /** Component used to draw */\n  display: ComponentType<CanvasElementProps<TConfig, TData>>;\n\n  getNewOptions: (options?: CanvasElementOptions) => Omit<CanvasElementOptions<TConfig>, 'type' | 'name'>;\n\n  /** Build the configuration UI */\n  registerOptionsUI?: PanelOptionsSupplier<CanvasElementOptions<TConfig>>;\n\n  /** If item has an edit mode */\n  hasEditMode?: boolean;\n\n  /** Optional config to customize what standard element editor options are available for the item */\n  standardEditorConfig?: StandardEditorConfig;\n\n  /** Custom connection anchor coordinates, like for svg elements such as triangle, cloud, etc */\n  customConnectionAnchors?: Array<{\n    x: number;\n    y: number;\n  }>;\n}\n\nexport const defaultBgColor = '#D9D9D9';\nexport const defaultTextColor = '#000000';\nexport const defaultLightTextColor = '#F0F4FD';\nexport const defaultThemeTextColor = config.theme2.colors.text.primary;\n","import { LinkModel } from '@grafana/data/src';\nimport { ColorDimensionConfig, ResourceDimensionConfig, TextDimensionConfig } from '@grafana/schema';\nimport { BackgroundImageSize } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nexport enum QuickPlacement {\n  Top = 'top',\n  Bottom = 'bottom',\n  Left = 'left',\n  Right = 'right',\n  HorizontalCenter = 'hcenter',\n  VerticalCenter = 'vcenter',\n}\n\nexport enum Align {\n  Left = 'left',\n  Center = 'center',\n  Right = 'right',\n}\n\nexport enum VAlign {\n  Top = 'top',\n  Middle = 'middle',\n  Bottom = 'bottom',\n}\n\nexport interface TextData {\n  text?: string;\n  color?: string;\n  size?: number; // 0 or missing will \"auto size\"\n  align: Align;\n  valign: VAlign;\n  links?: LinkModel[];\n  field?: string;\n}\n\nexport interface TextConfig {\n  text?: TextDimensionConfig;\n  color?: ColorDimensionConfig;\n  size?: number; // 0 or missing will \"auto size\"\n  align: Align;\n  valign: VAlign;\n}\n\nexport interface CanvasElementConfig extends TextConfig {\n  backgroundColor?: ColorDimensionConfig;\n  backgroundImage?: ResourceDimensionConfig;\n  backgroundSize?: BackgroundImageSize;\n  borderColor?: ColorDimensionConfig;\n  borderWidth?: number;\n}\n\nexport interface CanvasElementData extends TextData {\n  backgroundColor?: string;\n  backgroundImage?: string;\n  backgroundSize?: string;\n  borderColor?: string;\n  borderWidth?: number;\n}\n\nexport interface StandardEditorConfig {\n  layout?: boolean;\n  background?: boolean;\n  border?: boolean;\n}\n","import { css } from '@emotion/css';\nimport { useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { PluginState } from '@grafana/data/src';\nimport { TextDimensionMode } from '@grafana/schema';\nimport { Button, Spinner, useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\nimport { APIEditor, APIEditorConfig } from 'app/plugins/panel/canvas/editor/element/APIEditor';\nimport { ButtonStyleConfig, ButtonStyleEditor } from 'app/plugins/panel/canvas/editor/element/ButtonStyleEditor';\nimport { callApi } from 'app/plugins/panel/canvas/editor/element/utils';\nimport { HttpRequestMethod } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultLightTextColor } from '../element';\nimport { Align, TextConfig, TextData } from '../types';\n\ninterface ButtonData extends Omit<TextData, 'valign'> {\n  api?: APIEditorConfig;\n  style?: ButtonStyleConfig;\n}\n\ninterface ButtonConfig extends Omit<TextConfig, 'valign'> {\n  api?: APIEditorConfig;\n  style?: ButtonStyleConfig;\n}\n\nexport const defaultApiConfig: APIEditorConfig = {\n  endpoint: '',\n  method: HttpRequestMethod.POST,\n  data: '{}',\n  contentType: 'application/json',\n  queryParams: [],\n  headerParams: [],\n};\n\nexport const defaultStyleConfig: ButtonStyleConfig = {\n  variant: 'primary',\n};\n\nconst ButtonDisplay = ({ data }: CanvasElementProps<ButtonConfig, ButtonData>) => {\n  const styles = useStyles2(getStyles, data);\n\n  const [isLoading, setIsLoading] = useState(false);\n\n  const updateLoadingStateCallback = (loading: boolean) => {\n    setIsLoading(loading);\n  };\n\n  const onClick = () => {\n    if (data?.api && data?.api?.endpoint) {\n      setIsLoading(true);\n      callApi(data.api, updateLoadingStateCallback);\n    }\n  };\n\n  return (\n    <Button type=\"submit\" variant={data?.style?.variant} onClick={onClick} className={styles.button}>\n      <span>\n        {isLoading && <Spinner inline={true} className={styles.buttonSpinner} />}\n        {data?.text}\n      </span>\n    </Button>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: ButtonData | undefined) => ({\n  button: css({\n    height: '100%',\n    width: '100%',\n    display: 'grid',\n\n    '> span': {\n      display: 'inline-grid',\n      gridAutoFlow: 'column',\n      textAlign: data?.align,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    },\n  }),\n  buttonSpinner: css({\n    marginRight: theme.spacing(0.5),\n  }),\n});\n\nexport const buttonItem: CanvasElementItem<ButtonConfig, ButtonData> = {\n  id: 'button',\n  name: 'Button',\n  description: 'Button',\n  state: PluginState.beta,\n\n  standardEditorConfig: {\n    background: false,\n  },\n\n  display: ButtonDisplay,\n\n  defaultSize: {\n    width: 150,\n    height: 45,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      text: {\n        mode: TextDimensionMode.Fixed,\n        fixed: 'Button',\n      },\n      align: Align.Center,\n      color: {\n        fixed: defaultLightTextColor,\n      },\n      size: 14,\n      api: defaultApiConfig,\n      style: defaultStyleConfig,\n    },\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 32,\n      height: options?.placement?.height ?? 78,\n      top: options?.placement?.top ?? 100,\n      left: options?.placement?.left ?? 100,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<ButtonConfig>) => {\n    const buttonConfig = elementOptions.config;\n\n    const getAPIConfig = () => {\n      if (buttonConfig?.api) {\n        buttonConfig.api = {\n          ...buttonConfig.api,\n          method: buttonConfig.api.method ?? defaultApiConfig.method,\n          contentType: buttonConfig.api.contentType ?? defaultApiConfig.contentType,\n        };\n        return buttonConfig.api;\n      }\n\n      return undefined;\n    };\n\n    const data: ButtonData = {\n      text: buttonConfig?.text ? dimensionContext.getText(buttonConfig.text).value() : '',\n      align: buttonConfig?.align ?? Align.Center,\n      size: buttonConfig?.size ?? 14,\n      api: getAPIConfig(),\n      style: buttonConfig?.style ?? defaultStyleConfig,\n    };\n\n    if (buttonConfig?.color) {\n      data.color = dimensionContext.getColor(buttonConfig.color).value();\n    }\n\n    return data;\n  },\n\n  // Heatmap overlay options\n  registerOptionsUI: (builder) => {\n    const category = ['Button'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'styleSelector',\n        path: 'config.style',\n        name: 'Style',\n        editor: ButtonStyleEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'apiSelector',\n        path: 'config.api',\n        name: 'API',\n        editor: APIEditor,\n      });\n  },\n};\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementProps,\n  CanvasElementOptions,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Cloud = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 110 70\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"110\" height=\"70\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"300\" height=\"300\"></image>\n          </pattern>\n          <clipPath id={`cloudClip-${uniqueId}`}>\n            <path d=\"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#cloudClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <path\n          d=\"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <path\n          d=\"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z\"\n          clipPath={`url(#cloudClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const cloudItem: CanvasElementItem = {\n  id: 'cloud',\n  name: 'Cloud',\n  description: 'Cloud',\n\n  display: Cloud,\n\n  defaultSize: {\n    width: 110,\n    height: 70,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 110,\n      height: options?.placement?.height ?? 70,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Cloud'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    { x: -0.58, y: 0.63 }, // Top Left\n    { x: -0.22, y: 0.99 }, // Top Middle\n    { x: 0.235, y: 0.75 }, // Top Right\n\n    { x: 0.8, y: 0.6 }, // Right Top\n    { x: 0.785, y: 0.06 }, // Right Middle\n    { x: 0.91, y: -0.51 }, // Right Bottom\n\n    { x: 0.62, y: -0.635 }, // Bottom Right\n    { x: 0.05, y: -0.98 }, // Bottom Middle\n    { x: -0.45, y: -0.635 }, // Bottom Left\n\n    { x: -0.8, y: -0.58 }, // Left Bottom\n    { x: -0.78, y: -0.06 }, // Left Middle\n    { x: -0.9, y: 0.48 }, // Left Top\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface DroneFrontData {\n  rollAngle?: number;\n}\n\ninterface DroneFrontConfig {\n  rollAngle?: ScalarDimensionConfig;\n}\n\nconst DroneFrontDisplay = ({ data }: CanvasElementProps<DroneFrontConfig, DroneFrontData>) => {\n  const styles = useStyles2(getStyles);\n\n  const droneFrontTransformStyle = `rotate(${data?.rollAngle ? data.rollAngle : 0}deg)`;\n\n  return (\n    <svg\n      className={styles.droneFront}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      viewBox=\"0 0 1300 290\"\n      style={{ transform: droneFrontTransformStyle, stroke: defaultBgColor }}\n    >\n      <g className=\"arms\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <line x1=\"510\" x2=\"320\" y1=\"100\" y2=\"150\" />\n        <line x1=\"510\" x2=\"320\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"100\" y2=\"150\" />\n      </g>\n      <g className=\"body\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          fill=\"none\"\n          d=\" M 510 130 C 510 124 510 110 510 100 C 510 90 530 71 540 70 C 640 61 670 60 760 70 C 770 71 790 90 790 100 Q 790 120 790 130 L 790 130 Q 790 177 790 196 C 790 207 770 225 760 226 C 670 236 640 236 540 226 C 530 226 510 206 510 196 Q 510 177 510 130 Q 510 133 510 130 Z \"\n        />\n        <circle cx=\"650\" cy=\"160\" r=\"40\" fill=\"none\" />\n      </g>\n      <g className=\"motors\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 320 60 L 250 60 L 250 230 L 260 290 L 310 290 L 320 230 L 320 60 Z \"\n        />\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 1050 60 L 980 60 L 980 230 L 990 290 L 1040 290 L 1050 230 L 1050 60 Z \"\n        />\n      </g>\n      <g className=\"propellers\" fill={defaultBgColor}>\n        <path\n          className=\"prop\"\n          d=\" M 270 60 L 300 60 L 300 20 Q 311 30 330 30 Q 349 30 570 10 L 300 10 Q 300 0 290 0 C 286 0 284 0 280 0 Q 270 0 270 10 L 0 10 Q 220 30 240 30 Q 260 30 270 20 L 270 60 Z \"\n        />\n        <path\n          className=\"prop\"\n          d=\" M 1000 60 L 1030 60 L 1030 20 Q 1041 30 1060 30 Q 1079 30 1300 10 L 1030 10 Q 1030 0 1020 0 C 1016 0 1014 0 1010 0 Q 1000 0 1000 10 L 730 10 Q 950 30 970 30 Q 990 30 1000 20 L 1000 60 Z \"\n        />\n      </g>\n    </svg>\n  );\n};\n\nexport const droneFrontItem: CanvasElementItem = {\n  id: 'droneFront',\n  name: 'Drone Front',\n  description: 'Drone front',\n\n  display: DroneFrontDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 26,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 26,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<DroneFrontConfig>) => {\n    const droneFrontConfig = elementOptions.config;\n\n    const data: DroneFrontData = {\n      rollAngle: droneFrontConfig?.rollAngle ? dimensionContext.getScalar(droneFrontConfig.rollAngle).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Drone Front'];\n    builder.addCustomEditor({\n      category,\n      id: 'rollAngle',\n      path: 'config.rollAngle',\n      name: 'Roll Angle',\n      editor: ScalarDimensionEditor,\n    });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  droneFront: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    transition: 'transform 0.4s',\n  }),\n});\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface DroneSideData {\n  pitchAngle?: number;\n}\n\ninterface DroneSideConfig {\n  pitchAngle?: ScalarDimensionConfig;\n}\n\nconst DroneSideDisplay = ({ data }: CanvasElementProps<DroneSideConfig, DroneSideData>) => {\n  const styles = useStyles2(getStyles);\n\n  const droneSidePitchTransformStyle = `rotate(${data?.pitchAngle ? data.pitchAngle : 0}deg)`;\n\n  return (\n    <svg\n      className={styles.droneSide}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      viewBox=\"0 0 1300 290\"\n      style={{ transform: droneSidePitchTransformStyle, stroke: defaultBgColor }}\n    >\n      <g className=\"arms\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <line x1=\"510\" x2=\"320\" y1=\"100\" y2=\"150\" />\n        <line x1=\"510\" x2=\"320\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"100\" y2=\"150\" />\n      </g>\n      <g className=\"body\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          fill=\"none\"\n          d=\" M 510 130 C 510 124 510 110 510 100 C 510 90 530 71 540 70 C 640 61 670 60 760 70 C 770 71 790 90 790 100 Q 790 120 790 130 L 790 130 Q 790 177 790 196 C 790 207 770 225 760 226 C 670 236 640 236 540 226 C 530 226 510 206 510 196 Q 510 177 510 130 Q 510 133 510 130 Z \"\n        />\n      </g>\n      <g className=\"motors\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 320 60 L 250 60 L 250 230 L 260 290 L 310 290 L 320 230 L 320 60 Z \"\n        />\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 1050 60 L 980 60 L 980 230 L 990 290 L 1040 290 L 1050 230 L 1050 60 Z \"\n        />\n      </g>\n      <g className=\"propellers\" fill={defaultBgColor}>\n        <path\n          className=\"prop\"\n          d=\" M 270 60 L 300 60 L 300 20 Q 311 30 330 30 Q 349 30 570 10 L 300 10 Q 300 0 290 0 C 286 0 284 0 280 0 Q 270 0 270 10 L 0 10 Q 220 30 240 30 Q 260 30 270 20 L 270 60 Z \"\n        />\n        <path\n          className=\"prop\"\n          d=\" M 1000 60 L 1030 60 L 1030 20 Q 1041 30 1060 30 Q 1079 30 1300 10 L 1030 10 Q 1030 0 1020 0 C 1016 0 1014 0 1010 0 Q 1000 0 1000 10 L 730 10 Q 950 30 970 30 Q 990 30 1000 20 L 1000 60 Z \"\n        />\n      </g>\n    </svg>\n  );\n};\n\nexport const droneSideItem: CanvasElementItem = {\n  id: 'droneSide',\n  name: 'Drone Side',\n  description: 'Drone Side',\n\n  display: DroneSideDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 26,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 26,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<DroneSideConfig>) => {\n    const droneSideConfig = elementOptions.config;\n\n    const data: DroneSideData = {\n      pitchAngle: droneSideConfig?.pitchAngle ? dimensionContext.getScalar(droneSideConfig.pitchAngle).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Drone Side'];\n    builder.addCustomEditor({\n      category,\n      id: 'pitchAngle',\n      path: 'config.pitchAngle',\n      name: 'Pitch Angle',\n      editor: ScalarDimensionEditor,\n    });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  droneSide: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    transition: 'transform 0.4s',\n  }),\n});\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface DroneTopData {\n  bRightRotorRPM?: number;\n  bLeftRotorRPM?: number;\n  fRightRotorRPM?: number;\n  fLeftRotorRPM?: number;\n  yawAngle?: number;\n}\n\ninterface DroneTopConfig {\n  bRightRotorRPM?: ScalarDimensionConfig;\n  bLeftRotorRPM?: ScalarDimensionConfig;\n  fRightRotorRPM?: ScalarDimensionConfig;\n  fLeftRotorRPM?: ScalarDimensionConfig;\n  yawAngle?: ScalarDimensionConfig;\n}\n\nconst DroneTopDisplay = ({ data }: CanvasElementProps<DroneTopConfig, DroneTopData>) => {\n  const styles = useStyles2(getStyles);\n\n  const fRightRotorAnimation = `spin ${data?.fRightRotorRPM ? 60 / Math.abs(data.fRightRotorRPM) : 0}s linear infinite`;\n\n  const fLeftRotorAnimation = `spin ${data?.fLeftRotorRPM ? 60 / Math.abs(data.fLeftRotorRPM) : 0}s linear infinite`;\n\n  const bRightRotorAnimation = `spin ${data?.bRightRotorRPM ? 60 / Math.abs(data.bRightRotorRPM) : 0}s linear infinite`;\n\n  const bLeftRotorAnimation = `spin ${data?.bLeftRotorRPM ? 60 / Math.abs(data.bLeftRotorRPM) : 0}s linear infinite`;\n\n  const droneTopTransformStyle = `rotate(${data?.yawAngle ? data.yawAngle : 0}deg)`;\n\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      viewBox=\"-43 -43 640 640\"\n      xmlSpace=\"preserve\"\n      style={{ transform: droneTopTransformStyle, fill: defaultBgColor }}\n    >\n      <path\n        fillRule=\"evenodd\"\n        d=\" M 137.95 127.967 C 137.14 127.157 136.189 126.58 135.178 126.218 C 138.173 121.545 139.967 116.036 140.125 110.123 L 217.64 151.862 C 214.049 157.411 211.8 163.922 211.386 170.95 L 209.694 199.712 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 Z  M 134.268 426.981 C 130.211 421.314 124.328 417.045 117.482 415.041 L 201.999 330.523 L 201.385 340.955 C 200.67 353.107 202.829 364.914 207.563 375.673 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 Z  M 324.765 373.673 L 228.527 373.673 Q 215.374 358.611 216.361 341.835 L 226.361 171.832 C 226.825 163.94 231.012 157.096 237.146 152.957 L 316.146 152.957 C 322.28 157.096 326.466 163.94 326.931 171.832 L 336.931 341.835 Q 337.918 358.611 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 Z  M 435.81 415.041 C 428.964 417.045 423.081 421.314 419.024 426.981 L 345.727 375.673 C 350.461 364.914 352.62 353.107 351.905 340.955 L 351.291 330.523 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 Z  M 343.596 199.713 L 341.904 170.951 C 341.49 163.923 339.242 157.411 335.651 151.863 L 413.167 110.124 C 413.325 116.037 415.119 121.546 418.114 126.219 C 417.103 126.581 416.152 127.158 415.342 127.968 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 Z  M 444.646 92.771 C 453.744 92.771 461.146 100.172 461.146 109.271 C 461.146 118.369 453.744 125.771 444.646 125.771 C 435.548 125.771 428.146 118.369 428.146 109.271 C 428.146 100.172 435.548 92.771 444.646 92.771 L 444.646 92.771 L 444.646 92.771 L 444.646 92.771 Z  M 108.647 92.771 C 117.745 92.771 125.147 100.172 125.147 109.271 C 125.147 118.369 117.745 125.771 108.647 125.771 C 99.549 125.771 92.147 118.369 92.147 109.271 C 92.147 100.172 99.549 92.771 108.647 92.771 L 108.647 92.771 L 108.647 92.771 Z  M 108.647 461.771 C 99.549 461.771 92.147 454.369 92.147 445.271 C 92.147 436.172 99.549 428.771 108.647 428.771 C 117.745 428.771 125.147 436.172 125.147 445.271 C 125.147 454.369 117.745 461.771 108.647 461.771 L 108.647 461.771 Z  M 92.322 136.202 C 97.086 139.1 102.675 140.771 108.647 140.771 C 114.883 140.771 120.697 138.941 125.594 135.802 C 125.956 136.813 126.534 137.764 127.343 138.573 L 207.342 218.573 C 207.711 218.942 208.109 219.264 208.528 219.54 L 203.212 309.908 C 201.794 310.182 200.44 310.869 199.342 311.967 L 95.343 415.967 C 94.954 416.356 94.62 416.779 94.335 417.224 C 93.651 417.575 92.976 417.942 92.322 418.34 Q 84.615 424.182 81.716 428.946 C 78.817 433.71 77.147 439.299 77.147 445.271 C 77.147 462.64 91.278 476.771 108.647 476.771 C 114.619 476.771 120.208 475.1 124.972 472.202 C 129.736 469.304 132.678 466.36 135.577 461.596 C 138.476 456.832 140.147 451.243 140.147 445.271 C 140.147 443.943 140.055 442.637 139.895 441.352 L 214.997 388.78 C 217.05 391.677 336.242 391.678 338.295 388.78 L 413.398 441.352 C 413.238 442.637 413.146 443.943 413.146 445.271 C 413.146 451.243 414.817 456.832 417.715 461.596 C 420.613 466.36 423.557 469.304 428.321 472.202 C 433.085 475.1 438.674 476.771 444.646 476.771 C 462.015 476.771 476.146 462.64 476.146 445.271 C 476.146 439.299 474.475 433.71 471.577 428.946 C 468.679 424.182 459.642 417.575 458.958 417.224 C 458.672 416.779 458.339 416.356 457.95 415.967 L 353.95 311.967 C 352.852 310.869 351.498 310.182 350.08 309.908 L 344.764 219.54 C 345.183 219.264 345.581 218.942 345.95 218.573 L 425.95 138.573 C 426.76 137.763 427.337 136.812 427.699 135.802 C 432.596 138.941 438.409 140.771 444.646 140.771 C 450.618 140.771 456.207 139.1 460.971 136.202 C 465.735 133.304 468.679 130.36 471.577 125.596 C 474.475 120.832 476.146 115.243 476.146 109.271 C 476.146 91.903 462.015 77.772 444.646 77.772 C 438.674 77.772 433.085 79.442 428.321 82.34 L 416.215 91.446 L 324.765 140.688 C 318.402 136.324 310.718 133.771 302.473 133.771 L 250.819 133.771 C 242.574 133.771 234.89 136.324 228.527 140.688 L 137.078 91.446 L 124.972 82.34 C 120.208 79.442 114.619 77.772 108.647 77.772 C 91.278 77.772 77.147 91.903 77.147 109.271 C 77.147 115.243 78.818 120.832 81.716 125.595 C 84.614 130.358 87.558 133.304 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 Z  M 444.646 461.771 C 435.548 461.771 428.146 454.369 428.146 445.271 C 428.146 436.172 435.548 428.771 444.646 428.771 C 453.744 428.771 461.146 436.172 461.146 445.271 C 461.146 454.369 453.744 461.771 444.646 461.771 Z \"\n      />\n      <path\n        fillRule=\"evenodd\"\n        d=\" M 259.458 334.235 L 259.458 337.211 L 254.514 337.211 L 254.514 350.795 L 250.842 350.795 L 250.842 337.211 L 245.898 337.211 L 245.898 334.235 L 259.458 334.235 Z  M 266.226 347.939 L 272.586 347.939 L 272.754 350.627 L 272.754 350.627 Q 270.498 350.867 265.074 350.867 L 265.074 350.867 L 265.074 350.867 Q 263.418 350.867 262.434 349.967 L 262.434 349.967 L 262.434 349.967 Q 261.45 349.067 261.426 347.531 L 261.426 347.531 L 261.426 337.499 L 261.426 337.499 Q 261.45 335.963 262.434 335.063 L 262.434 335.063 L 262.434 335.063 Q 263.418 334.163 265.074 334.163 L 265.074 334.163 L 265.074 334.163 Q 270.498 334.163 272.754 334.403 L 272.754 334.403 L 272.586 337.115 L 266.226 337.115 L 266.226 337.115 Q 265.626 337.115 265.362 337.403 L 265.362 337.403 L 265.362 337.403 Q 265.098 337.691 265.098 338.339 L 265.098 338.339 L 265.098 340.859 L 271.698 340.859 L 271.698 343.499 L 265.098 343.499 L 265.098 346.691 L 265.098 346.691 Q 265.098 347.363 265.362 347.651 L 265.362 347.651 L 265.362 347.651 Q 265.626 347.939 266.226 347.939 L 266.226 347.939 Z  M 275.202 333.995 L 278.73 333.995 L 278.73 346.931 L 278.73 346.931 Q 278.73 348.131 280.074 348.131 L 280.074 348.131 L 281.034 348.131 L 281.442 350.603 L 281.442 350.603 Q 280.53 351.083 278.61 351.083 L 278.61 351.083 L 278.61 351.083 Q 277.026 351.083 276.114 350.231 L 276.114 350.231 L 276.114 350.231 Q 275.202 349.379 275.202 347.819 L 275.202 347.819 L 275.202 333.995 Z  M 283.05 333.995 L 286.578 333.995 L 286.578 346.931 L 286.578 346.931 Q 286.578 348.131 287.922 348.131 L 287.922 348.131 L 288.882 348.131 L 289.29 350.603 L 289.29 350.603 Q 288.378 351.083 286.458 351.083 L 286.458 351.083 L 286.458 351.083 Q 284.874 351.083 283.962 350.231 L 283.962 350.231 L 283.962 350.231 Q 283.05 349.379 283.05 347.819 L 283.05 347.819 L 283.05 333.995 Z  M 292.086 335.759 L 292.086 335.759 L 292.086 335.759 Q 293.634 333.923 297.618 333.923 L 297.618 333.923 L 297.618 333.923 Q 301.602 333.923 303.162 335.759 L 303.162 335.759 L 303.162 335.759 Q 304.722 337.595 304.722 342.515 L 304.722 342.515 L 304.722 342.515 Q 304.722 347.435 303.162 349.271 L 303.162 349.271 L 303.162 349.271 Q 301.602 351.107 297.618 351.107 L 297.618 351.107 L 297.618 351.107 Q 293.634 351.107 292.086 349.271 L 292.086 349.271 L 292.086 349.271 Q 290.538 347.435 290.538 342.515 L 290.538 342.515 L 290.538 342.515 Q 290.538 337.595 292.086 335.759 Z  M 300.174 338.051 L 300.174 338.051 L 300.174 338.051 Q 299.49 336.875 297.618 336.875 L 297.618 336.875 L 297.618 336.875 Q 295.746 336.875 295.062 338.051 L 295.062 338.051 L 295.062 338.051 Q 294.378 339.227 294.378 342.515 L 294.378 342.515 L 294.378 342.515 Q 294.378 345.803 295.062 346.979 L 295.062 346.979 L 295.062 346.979 Q 295.746 348.155 297.618 348.155 L 297.618 348.155 L 297.618 348.155 Q 299.49 348.155 300.174 346.979 L 300.174 346.979 L 300.174 346.979 Q 300.858 345.803 300.858 342.515 L 300.858 342.515 L 300.858 342.515 Q 300.858 339.227 300.174 338.051 Z \"\n      />\n      <g className=\"propeller-group\">\n        <path\n          className={`${styles.propeller} ${styles.propellerCW}`}\n          style={{ animation: bRightRotorAnimation }}\n          d=\" M 461.563 418.77 L 463.992 416.34 Q 465.495 407.116 466.461 400.395 C 467.426 393.675 469.363 388.087 474.731 383.284 Q 533.862 341.514 538.196 338.859 C 542.529 336.203 548.345 334.299 551.492 338.29 C 554.639 342.282 553.481 346.02 549.419 350.082 L 471.147 428.354 L 461.563 418.77 Z  M 427.729 471.772 L 425.299 474.202 Q 423.797 483.426 422.831 490.146 C 421.866 496.867 419.929 502.454 414.561 507.257 Q 355.43 549.028 351.096 551.683 C 346.763 554.338 340.947 556.243 337.8 552.251 C 334.653 548.26 335.811 544.522 339.873 540.46 L 418.145 462.187 L 427.729 471.772 Z \"\n        />\n        <path\n          className={`${styles.propeller} ${styles.propellerCCW}`}\n          style={{ animation: fRightRotorAnimation }}\n          d=\" M 461.563 135.773 L 463.992 138.203 Q 465.495 147.426 466.461 154.147 C 467.426 160.868 469.363 166.455 474.731 171.258 Q 533.862 213.028 538.196 215.684 C 542.529 218.339 548.345 220.244 551.492 216.252 C 554.639 212.26 553.481 208.523 549.419 204.46 L 471.147 126.188 L 461.563 135.773 Z  M 427.729 82.77 L 425.299 80.34 Q 423.797 71.117 422.831 64.396 C 421.866 57.675 419.929 52.088 414.561 47.285 Q 355.43 5.515 351.096 2.859 C 346.763 0.204 340.947 -1.701 337.8 2.291 C 334.653 6.282 335.811 10.02 339.873 14.082 L 418.145 92.355 L 427.729 82.77 Z \"\n        />\n        <path\n          className={`${styles.propeller} ${styles.propellerCCW}`}\n          style={{ animation: bLeftRotorAnimation }}\n          d=\" M 125.563 471.772 L 127.993 474.202 Q 129.496 483.426 130.461 490.146 C 131.427 496.867 133.363 502.454 138.731 507.257 Q 197.863 549.028 202.196 551.683 C 206.53 554.338 212.345 556.243 215.492 552.251 C 218.639 548.26 217.482 544.522 213.419 540.46 L 135.148 462.187 L 125.563 471.772 Z  M 91.73 418.77 L 89.3 416.34 Q 87.797 407.116 86.832 400.395 C 85.866 393.675 83.93 388.087 78.562 383.284 Q 19.431 341.514 15.097 338.859 C 10.763 336.203 4.948 334.299 1.801 338.29 C -1.346 342.282 -0.189 346.02 3.874 350.082 L 82.146 428.354 L 91.73 418.77 Z \"\n        />\n        <path\n          className={`${styles.propeller} ${styles.propellerCW}`}\n          style={{ animation: fLeftRotorAnimation }}\n          d=\" M 125.563 82.77 L 127.993 80.34 Q 129.496 71.117 130.461 64.396 C 131.427 57.675 133.363 52.088 138.731 47.285 Q 197.863 5.515 202.196 2.859 C 206.53 0.204 212.345 -1.701 215.492 2.291 C 218.639 6.282 217.482 10.02 213.419 14.083 L 135.147 92.355 L 125.563 82.77 Z  M 91.73 135.773 L 89.3 138.203 Q 87.797 147.426 86.832 154.147 C 85.866 160.868 83.93 166.455 78.562 171.258 Q 19.431 213.028 15.097 215.684 C 10.763 218.339 4.948 220.243 1.801 216.252 C -1.346 212.26 -0.189 208.523 3.874 204.46 L 82.146 126.188 L 91.73 135.773 Z \"\n        />\n      </g>\n    </svg>\n  );\n};\n\nexport const droneTopItem: CanvasElementItem = {\n  id: 'droneTop',\n  name: 'Drone Top',\n  description: 'Drone top',\n\n  display: DroneTopDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 100,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<DroneTopConfig>) => {\n    const droneTopConfig = elementOptions.config;\n\n    const data: DroneTopData = {\n      bRightRotorRPM: droneTopConfig?.bRightRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.bRightRotorRPM).value()\n        : 0,\n      bLeftRotorRPM: droneTopConfig?.bLeftRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.bLeftRotorRPM).value()\n        : 0,\n      fRightRotorRPM: droneTopConfig?.fRightRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.fRightRotorRPM).value()\n        : 0,\n      fLeftRotorRPM: droneTopConfig?.fLeftRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.fLeftRotorRPM).value()\n        : 0,\n      yawAngle: droneTopConfig?.yawAngle ? dimensionContext.getScalar(droneTopConfig.yawAngle).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Drone Top'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'yawAngle',\n        path: 'config.yawAngle',\n        name: 'Yaw Angle',\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'fRightRotorRPM',\n        path: 'config.fRightRotorRPM',\n        name: 'Front Right Rotor RPM',\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'fLeftRotorRPM',\n        path: 'config.fLeftRotorRPM',\n        name: 'Front Left Rotor RPM',\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'bRightRotorRPM',\n        path: 'config.bRightRotorRPM',\n        name: 'Back Right Rotor RPM',\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'bLeftRotorRPM',\n        path: 'config.bLeftRotorRPM',\n        name: 'Back Left Rotor RPM',\n        editor: ScalarDimensionEditor,\n      });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  propeller: css({\n    transformOrigin: '50% 50%',\n    transformBox: 'fill-box',\n    display: 'block',\n    '@keyframes spin': {\n      from: {\n        transform: 'rotate(0deg)',\n      },\n      to: {\n        transform: 'rotate(360deg)',\n      },\n    },\n  }),\n  propellerCW: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    animationDirection: 'normal',\n  }),\n  propellerCCW: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    animationDirection: 'reverse',\n  }),\n});\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementOptions,\n  CanvasElementProps,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Ellipse = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 200 200\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"200\" height=\"200\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"300\" height=\"300\"></image>\n          </pattern>\n          <clipPath id={`ellipseClip-${uniqueId}`}>\n            <ellipse cx=\"50%\" cy=\"50%\" rx=\"50%\" ry=\"50%\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#ellipseClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <ellipse\n          cx=\"50%\"\n          cy=\"50%\"\n          rx=\"50%\"\n          ry=\"50%\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <ellipse\n          cx=\"50%\"\n          cy=\"50%\"\n          rx=\"50%\"\n          ry=\"50%\"\n          clipPath={`url(#ellipseClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const ellipseItem: CanvasElementItem<CanvasElementConfig, CanvasElementData> = {\n  id: 'ellipse',\n  name: 'Ellipse',\n  description: 'Ellipse',\n\n  display: Ellipse,\n\n  defaultSize: {\n    width: 160,\n    height: 160,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 160,\n      height: options?.placement?.height ?? 138,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Ellipse'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    // points along the left edge\n    { x: -1, y: 0 }, // middle left\n    { x: -0.7, y: 0.7 },\n\n    // points along the top edge\n    { x: 0, y: 1 }, // top\n    { x: 0.7, y: 0.7 },\n\n    // points along the right edge\n    { x: 1, y: 0 }, // middle right\n    { x: 0.7, y: -0.7 },\n\n    // points along the bottom edge\n    { x: 0, y: -1 }, // bottom\n    { x: -0.7, y: -0.7 },\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport { isString } from 'lodash';\nimport { CSSProperties } from 'react';\n\nimport { LinkModel, OneClickMode } from '@grafana/data';\nimport { ColorDimensionConfig, ResourceDimensionConfig, ResourceDimensionMode } from '@grafana/schema';\nimport { SanitizedSVG } from 'app/core/components/SVG/SanitizedSVG';\nimport { getPublicOrAbsoluteUrl } from 'app/features/dimensions';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor, ResourceDimensionEditor } from 'app/features/dimensions/editors';\nimport { LineConfig } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\nexport interface IconConfig {\n  path?: ResourceDimensionConfig;\n  fill?: ColorDimensionConfig;\n  stroke?: LineConfig;\n}\n\ninterface IconData {\n  path: string;\n  fill: string;\n  strokeColor?: string;\n  stroke?: number;\n  links?: LinkModel[];\n}\n\n// When a stoke is defined, we want the path to be in page units\nconst svgStrokePathClass = css({\n  path: {\n    vectorEffect: 'non-scaling-stroke',\n  },\n});\n\nexport function IconDisplay(props: CanvasElementProps<IconConfig, IconData>) {\n  const { data } = props;\n  if (!data?.path) {\n    return null;\n  }\n\n  const svgStyle: CSSProperties = {\n    fill: data?.fill,\n    stroke: data?.strokeColor,\n    strokeWidth: data?.stroke,\n    height: '100%',\n    width: '100%',\n  };\n\n  return (\n    <SanitizedSVG src={data.path} style={svgStyle} className={svgStyle.strokeWidth ? svgStrokePathClass : undefined} />\n  );\n}\n\nexport const iconItem: CanvasElementItem<IconConfig, IconData> = {\n  id: 'icon',\n  name: 'Icon',\n  description: 'SVG Icon display',\n\n  display: IconDisplay,\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      path: {\n        mode: ResourceDimensionMode.Fixed,\n        fixed: 'img/icons/unicons/question-circle.svg',\n      },\n      fill: { fixed: defaultBgColor },\n    },\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 100,\n      top: options?.placement?.top ?? 100,\n      left: options?.placement?.left ?? 100,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<IconConfig>) => {\n    const iconConfig = elementOptions.config;\n\n    let path: string | undefined = undefined;\n    if (iconConfig?.path) {\n      path = dimensionContext.getResource(iconConfig.path).value();\n    }\n    if (!path || !isString(path)) {\n      path = getPublicOrAbsoluteUrl('img/icons/unicons/question-circle.svg');\n    }\n\n    const data: IconData = {\n      path,\n      fill: iconConfig?.fill ? dimensionContext.getColor(iconConfig.fill).value() : defaultBgColor,\n    };\n\n    if (iconConfig?.stroke?.width && iconConfig?.stroke.color) {\n      if (iconConfig.stroke.width > 0) {\n        data.stroke = iconConfig.stroke?.width;\n        data.strokeColor = dimensionContext.getColor(iconConfig.stroke.color).value();\n      }\n    }\n\n    return data;\n  },\n\n  // Heatmap overlay options\n  registerOptionsUI: (builder) => {\n    const category = ['Icon'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'iconSelector',\n        path: 'config.path',\n        name: 'SVG Path',\n        editor: ResourceDimensionEditor,\n        settings: {\n          resourceType: 'icon',\n          maxFiles: 2000,\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.fill',\n        path: 'config.fill',\n        name: 'Fill color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          // Configured values\n          fixed: 'grey',\n        },\n      });\n    // .addSliderInput({\n    //   category,\n    //   path: 'config.stroke.width',\n    //   name: 'Stroke',\n    //   defaultValue: 0,\n    //   settings: {\n    //     min: 0,\n    //     max: 10,\n    //   },\n    // })\n    // .addCustomEditor({\n    //   category,\n    //   id: 'config.stroke.color',\n    //   path: 'config.stroke.color',\n    //   name: 'Stroke color',\n    //   editor: ColorDimensionEditor,\n    //   settings: {},\n    //   defaultValue: {\n    //     // Configured values\n    //     fixed: 'grey',\n    //   },\n    //   showIf: (cfg) => Boolean(cfg?.config?.stroke?.width),\n    // })\n  },\n};\n","import { css } from '@emotion/css';\nimport { useCallback } from 'react';\nimport { useObservable } from 'react-use';\nimport { of } from 'rxjs';\n\nimport {\n  DataFrame,\n  FieldNamePickerConfigSettings,\n  GrafanaTheme2,\n  OneClickMode,\n  StandardEditorsRegistryItem,\n} from '@grafana/data';\nimport { TextDimensionMode } from '@grafana/schema';\nimport { usePanelContext, useStyles2 } from '@grafana/ui';\nimport { FieldNamePicker } from '@grafana/ui/src/components/MatchersUI/FieldNamePicker';\nimport { frameHasName, getFrameFieldsDisplayNames } from '@grafana/ui/src/components/MatchersUI/utils';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementOptions,\n  CanvasElementProps,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { ElementState } from '../runtime/element';\nimport { Align, TextConfig, TextData, VAlign } from '../types';\n\n// eslint-disable-next-line\nconst dummyFieldSettings: StandardEditorsRegistryItem<string, FieldNamePickerConfigSettings> = {\n  settings: {},\n} as StandardEditorsRegistryItem<string, FieldNamePickerConfigSettings>;\n\nconst MetricValueDisplay = (props: CanvasElementProps<TextConfig, TextData>) => {\n  const { data, isSelected, config } = props;\n  const styles = useStyles2(getStyles(data));\n\n  const context = usePanelContext();\n  const scene = context.instanceState?.scene;\n  let panelData: DataFrame[];\n  panelData = context.instanceState?.scene?.data.series;\n\n  const isEditMode = useObservable<boolean>(scene?.editModeEnabled ?? of(false));\n\n  const getDisplayValue = () => {\n    if (panelData && config.text?.field && fieldNotFound()) {\n      return 'Field not found';\n    }\n\n    if (panelData && config.text?.field && !data?.text) {\n      return 'No data';\n    }\n\n    return data?.text ? data.text : 'Double click to set field';\n  };\n\n  const fieldNotFound = () => {\n    const fieldNames = getFrameFieldsDisplayNames(panelData);\n    return !frameHasName(config.text?.field, fieldNames);\n  };\n\n  if (isEditMode && isSelected) {\n    return <MetricValueEdit {...props} />;\n  }\n\n  return (\n    <div className={styles.container}>\n      <span className={styles.span}>{getDisplayValue()}</span>\n    </div>\n  );\n};\n\nconst MetricValueEdit = (props: CanvasElementProps<TextConfig, TextData>) => {\n  let { data, config } = props;\n  const context = usePanelContext();\n  let panelData: DataFrame[];\n  panelData = context.instanceState?.scene?.data.series;\n\n  const onFieldChange = useCallback(\n    (field: string | undefined) => {\n      let selectedElement: ElementState;\n      selectedElement = context.instanceState?.selected[0];\n      if (selectedElement) {\n        const options = selectedElement.options;\n        selectedElement.onChange({\n          ...options,\n          config: {\n            ...options.config,\n            text: { fixed: '', field: field, mode: TextDimensionMode.Field },\n          },\n          background: {\n            color: { field: field, fixed: options.background?.color?.fixed ?? '' },\n          },\n        });\n\n        // Force a re-render (update scene data after config update)\n        const scene = context.instanceState?.scene;\n        if (scene) {\n          scene.editModeEnabled.next(false);\n          scene.updateData(scene.data);\n        }\n      }\n    },\n    [context.instanceState?.scene, context.instanceState?.selected]\n  );\n\n  const styles = useStyles2(getStyles(data));\n  return (\n    <div className={styles.inlineEditorContainer}>\n      {panelData && (\n        <FieldNamePicker\n          context={{ data: panelData }}\n          value={config.text?.field ?? ''}\n          onChange={onFieldChange}\n          item={dummyFieldSettings}\n        />\n      )}\n    </div>\n  );\n};\n\nconst getStyles = (data: TextData | undefined) => (theme: GrafanaTheme2) => ({\n  container: css({\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    display: 'table',\n  }),\n  inlineEditorContainer: css({\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    padding: theme.spacing(1),\n  }),\n  span: css({\n    display: 'table-cell',\n    verticalAlign: data?.valign,\n    textAlign: data?.align,\n    fontSize: `${data?.size}px`,\n    color: data?.color,\n  }),\n});\n\nexport const metricValueItem: CanvasElementItem<TextConfig, TextData> = {\n  id: 'metric-value',\n  name: 'Metric Value',\n  description: 'Display a field value',\n\n  display: MetricValueDisplay,\n\n  hasEditMode: true,\n\n  defaultSize: {\n    width: 260,\n    height: 50,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n      text: { mode: TextDimensionMode.Field, fixed: '', field: '' },\n      size: 20,\n    },\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width,\n      height: options?.placement?.height,\n      top: options?.placement?.top ?? 100,\n      left: options?.placement?.left ?? 100,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TextConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: TextData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Metric value'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n};\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementProps,\n  CanvasElementOptions,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Parallelogram = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 250 150\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"250\" height=\"150\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"350\" height=\"200\"></image>\n          </pattern>\n          <clipPath id={`parallelogramClip-${uniqueId}`}>\n            <polygon points=\"0,150 50,0 250,0 200,150\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#parallelogramClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <polygon\n          points=\"0,150 50,0 250,0 200,150\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <polygon\n          points=\"0,150 50,0 250,0 200,150\"\n          clipPath={`url(#parallelogramClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const parallelogramItem: CanvasElementItem = {\n  id: 'parallelogram',\n  name: 'Parallelogram',\n  description: 'Parallelogram',\n\n  display: Parallelogram,\n\n  defaultSize: {\n    width: 250,\n    height: 150,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 250,\n      height: options?.placement?.height ?? 150,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Parallelogram'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    { x: -0.6, y: 1 }, // Angled Top Left\n    { x: -0.1, y: 1 }, // Top Middle\n    { x: 0.5, y: 1 }, // Angled Top Right\n    { x: 1, y: 1 }, // Top Right\n    { x: 0.925, y: 0.6 }, // Angled Right Top\n    { x: 0.84, y: 0.2 }, // Right Middle\n    { x: 0.76, y: -0.2 }, // Angled Right Bottom\n    { x: 0.675, y: -0.6 }, // Bottom Right\n    { x: -0.5, y: -1 }, // Angled Bottom Right\n    { x: 0.1, y: -1 }, // Bottom Middle\n    { x: 0.6, y: -1 }, // Angled Bottom Left\n    { x: -1, y: -1 }, // Bottom Left\n    { x: -0.925, y: -0.6 }, // Angled Left Bottom\n    { x: -0.84, y: -0.2 }, // Left Middle\n    { x: -0.76, y: 0.2 }, // Angled Left Top\n    { x: -0.675, y: 0.6 }, // Top Left 2\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport { PureComponent } from 'react';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { stylesFactory } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementOptions,\n  CanvasElementProps,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, TextConfig, TextData, VAlign } from '../types';\n\nclass RectangleDisplay extends PureComponent<CanvasElementProps<TextConfig, TextData>> {\n  render() {\n    const { data } = this.props;\n    const styles = getStyles(config.theme2, data);\n\n    return (\n      <div className={styles.container}>\n        <span className={styles.span}>{data?.text}</span>\n      </div>\n    );\n  }\n}\n\nconst getStyles = stylesFactory((theme: GrafanaTheme2, data) => ({\n  container: css({\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    display: 'table',\n  }),\n  span: css({\n    display: 'table-cell',\n    verticalAlign: data?.valign,\n    textAlign: data?.align,\n    fontSize: `${data?.size}px`,\n    color: data?.color,\n  }),\n}));\n\nexport const rectangleItem: CanvasElementItem<TextConfig, TextData> = {\n  id: 'rectangle',\n  name: 'Rectangle',\n  description: 'Rectangle',\n\n  display: RectangleDisplay,\n\n  defaultSize: {\n    width: 240,\n    height: 160,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TextConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: TextData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    return data;\n  },\n\n  // Heatmap overlay options\n  registerOptionsUI: (builder) => {\n    const category = ['Rectangle'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerDatabase = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g className={styles.outline}>\n      <g className={styles.server}>\n        <path d=\"m2.6953 37.5v20.883c0 7.6725 15.592 13.922 34.805 13.922s34.805-6.2493 34.805-13.922v-20.883\" />\n        <path d=\"m2.6953 16.617v20.883c0 7.7035 15.592 13.922 34.805 13.922s34.805-6.2184 34.805-13.922v-20.883\" />\n        <path d=\"m37.5 30.539c19.212 0 34.805-6.2185 34.805-13.922 0-7.7034-15.592-13.922-34.805-13.922s-34.805 6.2184-34.805 13.922c0 7.7035 15.592 13.922 34.805 13.922z\" />\n      </g>\n      <g className={styles.circleBack}>\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -132.86 -110.58)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -122.04 -111.7)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.21 -114.77)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n      <g className={styles.circle}>\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -52.337 -30.65)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -41.518 -31.769)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.688 -34.842)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n    </g>\n  );\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerSingle = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g>\n      <g className={styles.outline} transform=\"matrix(1.01 0 0 1.01 -.375 -.375)\">\n        <g className={styles.server}>\n          <path d=\"m3.2812 55.659 9.125-52.377h50.188l9.125 52.377\" />\n          <path d=\"m3.2812 56.328c0-2.5246 2.0379-4.5625 4.5625-4.5625h59.313c2.5245 0 4.5625 2.0379 4.5625 4.5625v10.828c0 2.5245-2.038 4.5625-4.5625 4.5625h-59.313c-2.5246 0-4.5625-2.038-4.5625-4.5625z\" />\n        </g>\n        <path d=\"m12.406 61.742h30.69\" />\n        <path d=\"m52.8 51.765v19.953\" />\n        <path\n          className={styles.circleBack}\n          transform=\"matrix(2.7592 0 0 2.7592 -109.42 -108.61)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          className={styles.circle}\n          transform=\"matrix(1.4775 0 0 1.4775 -29.697 -29.479)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n    </g>\n  );\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerStack = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g className={styles.outline} transform=\"translate(.5 .49865)\">\n      <g className={styles.server}>\n        <path d=\"m3.4834 21.768 8.0783-19.456h50.875l8.0784 19.456\" />\n        <path d=\"m2.3125 24.852c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n        <path d=\"m2.3125 42.031c0-2.5592 2.0658-4.6251 4.625-4.6251h60.125c2.5592 0 4.625 2.0659 4.625 4.6251v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n        <path d=\"m2.3125 59.172c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n      </g>\n      <path d=\"m11.562 28.797h31.111\" />\n      <path d=\"m52.508 20.227v17.143\" />\n      <path d=\"m11.562 63.117h31.111\" />\n      <path d=\"m52.508 54.547v17.143\" />\n      <path d=\"m11.562 45.977h31.111\" />\n      <path d=\"m52.508 37.406v17.143\" />\n      <g className={styles.circleBack}>\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.31 -143.2)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.31 -126.14)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.31 -108.86)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n      <g className={styles.circle}>\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.794 -63.277)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.794 -46.209)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.794 -28.93)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n    </g>\n  );\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerTerminal = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g className={styles.outline}>\n      <g className={styles.server}>\n        <path d=\"m5.3125 9.6562c0-3.5621 2.8754-6.4375 6.4375-6.4375h51.5c3.5621 0 6.4375 2.8754 6.4375 6.4375v28.625c0 3.5621-2.8754 6.4375-6.4375 6.4375h-51.5c-3.5621 0-6.4375-2.8754-6.4375-6.4375z\" />\n        <path d=\"m2.8125 59.859c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n      </g>\n      <path d=\"m37.5 46.719v2.875\" />\n      <path d=\"m24.625 51.343h25.75\" />\n      <path d=\"m12.062 63.804h31.111\" />\n      <path d=\"m53.008 55.234v17.143\" />\n      <path\n        className={styles.circleBack}\n        transform=\"matrix(2.7868 0 0 2.7868 -110.81 -108.2)\"\n        d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n      />\n      <path\n        className={styles.circle}\n        transform=\"matrix(1.4922 0 0 1.4922 -30.294 -28.27)\"\n        d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n      />\n    </g>\n  );\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, LinkModel, OneClickMode } from '@grafana/data';\nimport { ColorDimensionConfig, ScalarDimensionConfig } from '@grafana/schema';\nimport config from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ColorDimensionEditor, ScalarDimensionEditor } from 'app/features/dimensions/editors';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps } from '../../element';\n\nimport { ServerDatabase } from './types/database';\nimport { ServerSingle } from './types/single';\nimport { ServerStack } from './types/stack';\nimport { ServerTerminal } from './types/terminal';\n\ninterface ServerConfig {\n  blinkRate?: ScalarDimensionConfig;\n  statusColor?: ColorDimensionConfig;\n  bulbColor?: ColorDimensionConfig;\n  type: ServerType;\n}\n\nexport interface ServerData {\n  blinkRate?: number;\n  statusColor?: string;\n  bulbColor?: string;\n  type: ServerType;\n  links?: LinkModel[];\n}\n\nenum ServerType {\n  Single = 'Single',\n  Stack = 'Stack',\n  Database = 'Database',\n  Terminal = 'Terminal',\n}\n\ntype Props = CanvasElementProps<ServerConfig, ServerData>;\nconst outlineColor = config.theme2.colors.text.primary;\n\nconst ServerDisplay = ({ data }: Props) => {\n  return data ? (\n    <svg viewBox=\"0 0 75 75\">\n      {data.type === ServerType.Single ? (\n        <ServerSingle {...data} />\n      ) : data.type === ServerType.Stack ? (\n        <ServerStack {...data} />\n      ) : data.type === ServerType.Database ? (\n        <ServerDatabase {...data} />\n      ) : data.type === ServerType.Terminal ? (\n        <ServerTerminal {...data} />\n      ) : null}\n    </svg>\n  ) : null;\n};\n\nexport const serverItem: CanvasElementItem<ServerConfig, ServerData> = {\n  id: 'server',\n  name: 'Server',\n  description: 'Basic server with status',\n\n  display: ServerDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 100,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 100,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    config: {\n      type: ServerType.Single,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<ServerConfig>) => {\n    const serverConfig = elementOptions.config;\n\n    const data: ServerData = {\n      blinkRate: serverConfig?.blinkRate ? dimensionContext.getScalar(serverConfig.blinkRate).value() : 0,\n      statusColor: serverConfig?.statusColor\n        ? dimensionContext.getColor(serverConfig.statusColor).value()\n        : 'transparent',\n      bulbColor: serverConfig?.bulbColor ? dimensionContext.getColor(serverConfig.bulbColor).value() : 'green',\n      type: serverConfig?.type ?? ServerType.Single,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Server'];\n    builder\n      .addSelect({\n        category,\n        path: 'config.type',\n        name: 'Type',\n        settings: {\n          options: [\n            { value: ServerType.Single, label: ServerType.Single },\n            { value: ServerType.Stack, label: ServerType.Stack },\n            { value: ServerType.Database, label: ServerType.Database },\n            { value: ServerType.Terminal, label: ServerType.Terminal },\n          ],\n        },\n        defaultValue: ServerType.Single,\n      })\n      .addCustomEditor({\n        category,\n        id: 'statusColor',\n        path: 'config.statusColor',\n        name: 'Status color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          fixed: 'transparent',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'bulbColor',\n        path: 'config.bulbColor',\n        name: 'Bulb color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          fixed: 'green',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'blinkRate',\n        path: 'config.blinkRate',\n        name: 'Blink rate [hz] (0 = off)',\n        editor: ScalarDimensionEditor,\n        settings: { min: 0, max: 100 },\n      });\n  },\n};\n\nexport const getServerStyles = (data: ServerData | undefined) => (theme: GrafanaTheme2) => ({\n  bulb: css({\n    '@keyframes blink': {\n      '0%': {\n        fillOpacity: 0,\n      },\n      '50%': {\n        fillOpacity: 1,\n      },\n      '100%': {\n        fillOpacity: 0,\n      },\n    },\n  }),\n  server: css({\n    fill: data?.statusColor ?? 'transparent',\n  }),\n  circle: css({\n    [theme.transitions.handleMotion('no-preference', 'reduce')]: {\n      animation: `blink ${data?.blinkRate ? 1 / data.blinkRate : 0}s infinite step-end`,\n    },\n    fill: data?.bulbColor,\n    stroke: 'none',\n  }),\n  circleBack: css({\n    fill: outlineColor,\n    stroke: 'none',\n    opacity: 1,\n  }),\n  outline: css({\n    stroke: outlineColor,\n    strokeLinecap: 'round',\n    strokeLinejoin: 'round',\n    strokeWidth: '4px',\n  }),\n});\n","import { css } from '@emotion/css';\nimport { useCallback, useEffect, useRef } from 'react';\nimport * as React from 'react';\nimport { useObservable } from 'react-use';\nimport { of } from 'rxjs';\n\nimport { DataFrame, GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { Input, usePanelContext, useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultThemeTextColor } from '../element';\nimport { ElementState } from '../runtime/element';\nimport { Align, TextConfig, TextData, VAlign } from '../types';\n\nconst TextDisplay = (props: CanvasElementProps<TextConfig, TextData>) => {\n  const { data, isSelected } = props;\n  const styles = useStyles2(getStyles(data));\n\n  const context = usePanelContext();\n  const scene = context.instanceState?.scene;\n\n  const isEditMode = useObservable<boolean>(scene?.editModeEnabled ?? of(false));\n\n  if (isEditMode && isSelected) {\n    return <TextEdit {...props} />;\n  }\n  return (\n    <div className={styles.container}>\n      <span className={styles.span}>{data?.text ? data.text : 'Double click to set text'}</span>\n    </div>\n  );\n};\n\nconst TextEdit = (props: CanvasElementProps<TextConfig, TextData>) => {\n  let { data, config } = props;\n  const context = usePanelContext();\n  let panelData: DataFrame[];\n  panelData = context.instanceState?.scene?.data.series;\n\n  const textRef = useRef<string>(config.text?.fixed ?? '');\n\n  // Save text on TextEdit unmount\n  useEffect(() => {\n    return () => {\n      saveText(textRef.current);\n    };\n  });\n\n  const onKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.key === 'Enter') {\n      event.preventDefault();\n      const scene = context.instanceState?.scene;\n      if (scene) {\n        scene.editModeEnabled.next(false);\n      }\n    }\n  };\n\n  const onKeyUp = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    textRef.current = event.currentTarget.value;\n  };\n\n  const saveText = useCallback(\n    (textValue: string) => {\n      let selectedElement: ElementState;\n      selectedElement = context.instanceState?.selected[0];\n      if (selectedElement) {\n        const options = selectedElement.options;\n        selectedElement.onChange({\n          ...options,\n          config: {\n            ...options.config,\n            text: { ...selectedElement.options.config.text, fixed: textValue },\n          },\n        });\n\n        // Force a re-render (update scene data after config update)\n        const scene = context.instanceState?.scene;\n        if (scene) {\n          scene.updateData(scene.data);\n        }\n      }\n    },\n    [context.instanceState?.scene, context.instanceState?.selected]\n  );\n\n  const styles = useStyles2(getStyles(data));\n  return (\n    <div className={styles.inlineEditorContainer}>\n      {panelData && <Input defaultValue={config.text?.fixed ?? ''} onKeyDown={onKeyDown} onKeyUp={onKeyUp} autoFocus />}\n    </div>\n  );\n};\n\nconst getStyles = (data: TextData | undefined) => (theme: GrafanaTheme2) => ({\n  container: css({\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    display: 'table',\n  }),\n  inlineEditorContainer: css({\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    padding: theme.spacing(1),\n  }),\n  span: css({\n    display: 'table-cell',\n    verticalAlign: data?.valign,\n    textAlign: data?.align,\n    fontSize: `${data?.size}px`,\n    color: data?.color,\n  }),\n});\n\nexport const textItem: CanvasElementItem<TextConfig, TextData> = {\n  id: 'text',\n  name: 'Text',\n  description: 'Display text',\n\n  display: TextDisplay,\n\n  hasEditMode: true,\n\n  defaultSize: {\n    width: 100,\n    height: 50,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultThemeTextColor,\n      },\n      size: 16,\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 100,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TextConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: TextData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Text'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n};\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementProps,\n  CanvasElementOptions,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Triangle = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 200 200\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"200\" height=\"200\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"300\" height=\"300\"></image>\n          </pattern>\n          <clipPath id={`triangleClip-${uniqueId}`}>\n            <polygon points=\"100,0 200,200 0,200\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#triangleClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <polygon\n          points=\"100,0 200,200 0,200\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <polygon\n          points=\"100,0 200,200 0,200\"\n          clipPath={`url(#triangleClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const triangleItem: CanvasElementItem = {\n  id: 'triangle',\n  name: 'Triangle',\n  description: 'Triangle',\n\n  display: Triangle,\n\n  defaultSize: {\n    width: 160,\n    height: 138,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 160,\n      height: options?.placement?.height ?? 138,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Triangle'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    // points along the left edge\n    { x: -1, y: -1 }, // bottom left\n    { x: -0.8, y: -0.6 },\n    { x: -0.6, y: -0.2 },\n    { x: -0.4, y: 0.2 },\n    { x: -0.2, y: 0.6 },\n    { x: 0, y: 1 }, // top\n\n    // points along the right edge\n    { x: 0.2, y: 0.6 },\n    { x: 0.4, y: 0.2 },\n    { x: 0.6, y: -0.2 },\n    { x: 0.8, y: -0.6 },\n    { x: 1, y: -1 }, // bottom right\n\n    // points along the bottom edge\n    { x: 0.6, y: -1 },\n    { x: 0.2, y: -1 },\n    { x: -0.2, y: -1 },\n    { x: -0.6, y: -1 },\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, LinkModel, OneClickMode } from '@grafana/data';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface WindTurbineData {\n  rpm?: number;\n  links?: LinkModel[];\n}\n\ninterface WindTurbineConfig {\n  rpm?: ScalarDimensionConfig;\n}\n\nconst WindTurbineDisplay = ({ data }: CanvasElementProps<WindTurbineConfig, WindTurbineData>) => {\n  const styles = useStyles2(getStyles);\n\n  const windTurbineAnimation = `spin ${data?.rpm ? 60 / Math.abs(data.rpm) : 0}s linear infinite`;\n\n  return (\n    <svg viewBox=\"0 0 189.326 283.989\" preserveAspectRatio=\"xMidYMid meet\" style={{ fill: defaultBgColor }}>\n      <symbol id=\"blade\">\n        <path\n          fill=\"#e6e6e6\"\n          id=\"blade-front\"\n          d=\"M14.6491879,1.85011601 C14.2684455,-0.0535962877 10.7150812,-0.815081206 9.06473318,3.37308585 L0.434338747,70.7658933 L8.93805104,91.9607889 L15.4106729,90.437819 L17.5684455,78.3807425 L14.5218097,1.97679814 L14.6491879,1.85011601 Z\"\n        />\n        <path\n          fill=\"#d0d6d7\"\n          id=\"blade-side\"\n          d=\"M11.0951276,0.581206497 C10.3336427,0.961948956 9.57215777,1.85011601 8.93735499,3.24640371 L0.306960557,70.6392111 L8.81067285,91.8341067 L3.35359629,70.0044084 L11.0951276,0.581206497 Z\"\n        />\n      </symbol>\n\n      <g>\n        <g id=\"structure\" transform=\"translate(58.123, 82.664)\" fillRule=\"nonzero\">\n          <polygon id=\"tower\" fill=\"#e6e6e6\" points=\"33.111,10.984 39.965,10.984 44.28,196.176 28.796,196.176\" />\n          <path\n            id=\"yaw\"\n            fill=\"rgba(0,0,0,0.25)\"\n            d=\"M40.3454756,23.2948956 L40.7262181,34.8445476 C38.8225058,35.0986079 35.7765661,35.0986079 32.349884,34.337123 L32.7306265,23.2955916 L40.3454756,23.2955916 L40.3454756,23.2948956 Z\"\n          />\n          <path\n            id=\"base\"\n            fill=\"#d0d6d7\"\n            transform=\"translate(0 42)\"\n            d=\"M26.3846868,150.591647 L46.5640371,150.591647 C48.8484919,150.591647 50.7522042,152.49536 50.7522042,154.779814 L50.7522042,158.967981 L22.0691415,158.967981 L22.0691415,154.779814 C22.0691415,152.49536 23.9728538,150.591647 26.2573086,150.591647 L26.3846868,150.591647 Z\"\n          />\n          <circle id=\"nacelle\" fill=\"#e6e6e6\" cx=\"36.54\" cy=\"12\" r=\"11.93\" />\n          <circle id=\"gearbox\" fill=\"none\" stroke=\"#d0d6d7\" strokeWidth=\"2.75\" cx=\"36.538\" cy=\"11.999\" r=\"5.8\" />\n        </g>\n        <g className={styles.blade} style={{ animation: windTurbineAnimation }}>\n          <use id=\"blade1\" href=\"#blade\" x=\"83.24\" y=\"0\" />\n          <use id=\"blade2\" href=\"#blade\" x=\"83.24\" y=\"0\" transform=\"rotate(120 94.663 94.663)\" />\n          <use id=\"blade3\" href=\"#blade\" x=\"83.24\" y=\"0\" transform=\"rotate(-120 94.663 94.663)\" />\n        </g>\n      </g>\n    </svg>\n  );\n};\n\nexport const windTurbineItem: CanvasElementItem = {\n  id: 'windTurbine',\n  name: 'Wind Turbine',\n  description: 'Spinny spinny',\n\n  display: WindTurbineDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 155,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 155,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<WindTurbineConfig>) => {\n    const windTurbineConfig = elementOptions.config;\n\n    const data: WindTurbineData = {\n      rpm: windTurbineConfig?.rpm ? dimensionContext.getScalar(windTurbineConfig.rpm).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Wind Turbine'];\n    builder.addCustomEditor({\n      category,\n      id: 'rpm',\n      path: 'config.rpm',\n      name: 'RPM',\n      editor: ScalarDimensionEditor,\n    });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  blade: css({\n    transformOrigin: '94.663px 94.663px',\n    transform: 'rotate(15deg)',\n    '@keyframes spin': {\n      from: {\n        transform: 'rotate(0deg)',\n      },\n      to: {\n        transform: 'rotate(360deg)',\n      },\n    },\n  }),\n});\n","import { Registry } from '@grafana/data';\n\nimport { CanvasElementItem, CanvasElementOptions } from './element';\nimport { buttonItem } from './elements/button';\nimport { cloudItem } from './elements/cloud';\nimport { droneFrontItem } from './elements/droneFront';\nimport { droneSideItem } from './elements/droneSide';\nimport { droneTopItem } from './elements/droneTop';\nimport { ellipseItem } from './elements/ellipse';\nimport { iconItem } from './elements/icon';\nimport { metricValueItem } from './elements/metricValue';\nimport { parallelogramItem } from './elements/parallelogram';\nimport { rectangleItem } from './elements/rectangle';\nimport { serverItem } from './elements/server/server';\nimport { textItem } from './elements/text';\nimport { triangleItem } from './elements/triangle';\nimport { windTurbineItem } from './elements/windTurbine';\n\nexport const DEFAULT_CANVAS_ELEMENT_CONFIG: CanvasElementOptions = {\n  ...metricValueItem.getNewOptions(),\n  placement: { ...metricValueItem.getNewOptions().placement, ...metricValueItem.defaultSize },\n  type: metricValueItem.id,\n  name: `Element 1`,\n};\n\nexport const defaultElementItems = [\n  metricValueItem, // default for now\n  textItem,\n  ellipseItem,\n  rectangleItem,\n  iconItem,\n  serverItem,\n  triangleItem,\n  cloudItem,\n  parallelogramItem,\n];\n\nexport const advancedElementItems = [buttonItem, windTurbineItem, droneTopItem, droneFrontItem, droneSideItem];\n\nexport const canvasElementRegistry = new Registry<CanvasElementItem>(() => [\n  ...defaultElementItems,\n  ...advancedElementItems,\n]);\n","import * as React from 'react';\nimport { CSSProperties } from 'react';\nimport { OnDrag, OnResize, OnRotate } from 'react-moveable/declaration/types';\n\nimport { FieldType, getLinksSupplier, LinkModel, OneClickMode, ValueLinkConfig } from '@grafana/data';\nimport { LayerElement } from 'app/core/components/Layers/types';\nimport { notFoundItem } from 'app/features/canvas/elements/notFound';\nimport { DimensionContext } from 'app/features/dimensions';\nimport {\n  BackgroundImageSize,\n  Constraint,\n  HorizontalConstraint,\n  Placement,\n  VerticalConstraint,\n} from 'app/plugins/panel/canvas/panelcfg.gen';\nimport { getConnectionsByTarget, getRowIndex, isConnectionTarget } from 'app/plugins/panel/canvas/utils';\n\nimport { CanvasElementItem, CanvasElementOptions } from '../element';\nimport { canvasElementRegistry } from '../registry';\n\nimport { FrameState } from './frame';\nimport { RootElement } from './root';\nimport { Scene } from './scene';\n\nlet counter = 0;\n\nexport const SVGElements = new Set<string>(['parallelogram', 'triangle', 'cloud', 'ellipse']);\n\nexport class ElementState implements LayerElement {\n  // UID necessary for moveable to work (for now)\n  readonly UID = counter++;\n  revId = 0;\n  sizeStyle: CSSProperties = {};\n  dataStyle: CSSProperties = {};\n\n  // Temp stored constraint for visualization purposes (switch to top / left constraint to simplify some functionality)\n  tempConstraint: Constraint | undefined;\n\n  // Filled in by ref\n  div?: HTMLDivElement;\n\n  // Calculated\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  data?: any; // depends on the type\n\n  getLinks?: (config: ValueLinkConfig) => LinkModel[];\n\n  constructor(\n    public item: CanvasElementItem,\n    public options: CanvasElementOptions,\n    public parent?: FrameState\n  ) {\n    const fallbackName = `Element ${Date.now()}`;\n    if (!options) {\n      this.options = { type: item.id, name: fallbackName };\n    }\n\n    options.constraint = options.constraint ?? {\n      vertical: VerticalConstraint.Top,\n      horizontal: HorizontalConstraint.Left,\n    };\n    options.placement = options.placement ?? { width: 100, height: 100, top: 0, left: 0, rotation: 0 };\n    options.background = options.background ?? { color: { fixed: 'transparent' } };\n    options.border = options.border ?? { color: { fixed: 'dark-green' } };\n    options.oneClickMode = options.oneClickMode ?? OneClickMode.Off;\n    const scene = this.getScene();\n    if (!options.name) {\n      const newName = scene?.getNextElementName();\n      options.name = newName ?? fallbackName;\n    }\n    scene?.byName.set(options.name, this);\n  }\n\n  private getScene(): Scene | undefined {\n    let trav = this.parent;\n    while (trav) {\n      if (trav.isRoot()) {\n        return trav.scene;\n      }\n      trav = trav.parent;\n    }\n\n    return undefined;\n  }\n\n  getName() {\n    return this.options.name;\n  }\n\n  /** Use the configured options to update CSS style properties directly on the wrapper div **/\n  applyLayoutStylesToDiv(disablePointerEvents?: boolean) {\n    if (this.isRoot()) {\n      // Root supersedes layout engine and is always 100% width + height of panel\n      return;\n    }\n\n    const { constraint } = this.options;\n    const { vertical, horizontal } = constraint ?? {};\n    const placement: Placement = this.options.placement ?? {};\n\n    const editingEnabled = this.getScene()?.isEditingEnabled;\n\n    const style: React.CSSProperties = {\n      cursor: editingEnabled ? 'grab' : 'auto',\n      pointerEvents: disablePointerEvents ? 'none' : 'auto',\n      position: 'absolute',\n      // Minimum element size is 10x10\n      minWidth: '10px',\n      minHeight: '10px',\n      rotate: `${placement.rotation ?? 0}deg`,\n    };\n\n    const translate = ['0px', '0px'];\n\n    switch (vertical) {\n      case VerticalConstraint.Top:\n        placement.top = placement.top ?? 0;\n        placement.height = placement.height ?? 100;\n        style.top = `${placement.top}px`;\n        style.height = `${placement.height}px`;\n        delete placement.bottom;\n        break;\n      case VerticalConstraint.Bottom:\n        placement.bottom = placement.bottom ?? 0;\n        placement.height = placement.height ?? 100;\n        style.bottom = `${placement.bottom}px`;\n        style.height = `${placement.height}px`;\n        delete placement.top;\n        break;\n      case VerticalConstraint.TopBottom:\n        placement.top = placement.top ?? 0;\n        placement.bottom = placement.bottom ?? 0;\n        style.top = `${placement.top}px`;\n        style.bottom = `${placement.bottom}px`;\n        delete placement.height;\n        style.height = '';\n        break;\n      case VerticalConstraint.Center:\n        placement.top = placement.top ?? 0;\n        placement.height = placement.height ?? 100;\n        translate[1] = '-50%';\n        style.top = `calc(50% - ${placement.top}px)`;\n        style.height = `${placement.height}px`;\n        delete placement.bottom;\n        break;\n      case VerticalConstraint.Scale:\n        placement.top = placement.top ?? 0;\n        placement.bottom = placement.bottom ?? 0;\n        style.top = `${placement.top}%`;\n        style.bottom = `${placement.bottom}%`;\n        delete placement.height;\n        style.height = '';\n        break;\n    }\n\n    switch (horizontal) {\n      case HorizontalConstraint.Left:\n        placement.left = placement.left ?? 0;\n        placement.width = placement.width ?? 100;\n        style.left = `${placement.left}px`;\n        style.width = `${placement.width}px`;\n        delete placement.right;\n        break;\n      case HorizontalConstraint.Right:\n        placement.right = placement.right ?? 0;\n        placement.width = placement.width ?? 100;\n        style.right = `${placement.right}px`;\n        style.width = `${placement.width}px`;\n        delete placement.left;\n        break;\n      case HorizontalConstraint.LeftRight:\n        placement.left = placement.left ?? 0;\n        placement.right = placement.right ?? 0;\n        style.left = `${placement.left}px`;\n        style.right = `${placement.right}px`;\n        delete placement.width;\n        style.width = '';\n        break;\n      case HorizontalConstraint.Center:\n        placement.left = placement.left ?? 0;\n        placement.width = placement.width ?? 100;\n        translate[0] = '-50%';\n        style.left = `calc(50% - ${placement.left}px)`;\n        style.width = `${placement.width}px`;\n        delete placement.right;\n        break;\n      case HorizontalConstraint.Scale:\n        placement.left = placement.left ?? 0;\n        placement.right = placement.right ?? 0;\n        style.left = `${placement.left}%`;\n        style.right = `${placement.right}%`;\n        delete placement.width;\n        style.width = '';\n        break;\n    }\n\n    style.transform = `translate(${translate[0]}, ${translate[1]})`;\n    this.options.placement = placement;\n    this.sizeStyle = style;\n\n    if (this.div) {\n      for (const key in this.sizeStyle) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n        this.div.style[key as any] = (this.sizeStyle as any)[key];\n      }\n\n      // TODO: This is a hack, we should have a better way to handle this\n      const elementType = this.options.type;\n      if (!SVGElements.has(elementType)) {\n        // apply styles to div if it's not an SVG element\n        for (const key in this.dataStyle) {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n          this.div.style[key as any] = (this.dataStyle as any)[key];\n        }\n      } else {\n        // ELEMENT IS SVG\n        // clean data styles from div if it's an SVG element; SVG elements have their own data styles;\n        // this is necessary for changing type of element cases;\n        // wrapper div element (this.div) doesn't re-render (has static `key` property),\n        // so we have to clean styles manually;\n        for (const key in this.dataStyle) {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n          this.div.style[key as any] = '';\n        }\n      }\n    }\n  }\n\n  setPlacementFromConstraint(elementContainer?: DOMRect, parentContainer?: DOMRect, transformScale = 1) {\n    const { constraint } = this.options;\n    const { vertical, horizontal } = constraint ?? {};\n\n    if (!elementContainer) {\n      elementContainer = this.div && this.div.getBoundingClientRect();\n    }\n    let parentBorderWidth = 0;\n    if (!parentContainer) {\n      parentContainer = this.div && this.div.parentElement?.getBoundingClientRect();\n      parentBorderWidth = this.parent?.isRoot()\n        ? 0\n        : parseFloat(getComputedStyle(this.div?.parentElement!).borderWidth);\n    }\n\n    // For elements with rotation, a delta needs to be applied to account for bounding box rotation\n    // TODO: Fix behavior for top+bottom, left+right, center, and scale constraints\n    let rotationTopOffset = 0;\n    let rotationLeftOffset = 0;\n    if (this.options.placement?.rotation && this.options.placement?.width && this.options.placement?.height) {\n      const rotationDegrees = this.options.placement.rotation;\n      const rotationRadians = (Math.PI / 180) * rotationDegrees;\n      let rotationOffset = rotationRadians;\n\n      switch (true) {\n        case rotationDegrees >= 0 && rotationDegrees < 90:\n          // no-op\n          break;\n        case rotationDegrees >= 90 && rotationDegrees < 180:\n          rotationOffset = Math.PI - rotationRadians;\n          break;\n        case rotationDegrees >= 180 && rotationDegrees < 270:\n          rotationOffset = Math.PI + rotationRadians;\n          break;\n        case rotationDegrees >= 270:\n          rotationOffset = -rotationRadians;\n          break;\n      }\n\n      const calculateDelta = (dimension1: number, dimension2: number) =>\n        (dimension1 / 2) * Math.sin(rotationOffset) + (dimension2 / 2) * (Math.cos(rotationOffset) - 1);\n\n      rotationTopOffset = calculateDelta(this.options.placement.width, this.options.placement.height);\n      rotationLeftOffset = calculateDelta(this.options.placement.height, this.options.placement.width);\n    }\n\n    const relativeTop =\n      elementContainer && parentContainer\n        ? Math.round(elementContainer.top - parentContainer.top - parentBorderWidth + rotationTopOffset) /\n          transformScale\n        : 0;\n    const relativeBottom =\n      elementContainer && parentContainer\n        ? Math.round(parentContainer.bottom - parentBorderWidth - elementContainer.bottom + rotationTopOffset) /\n          transformScale\n        : 0;\n    const relativeLeft =\n      elementContainer && parentContainer\n        ? Math.round(elementContainer.left - parentContainer.left - parentBorderWidth + rotationLeftOffset) /\n          transformScale\n        : 0;\n    const relativeRight =\n      elementContainer && parentContainer\n        ? Math.round(parentContainer.right - parentBorderWidth - elementContainer.right + rotationLeftOffset) /\n          transformScale\n        : 0;\n\n    const placement: Placement = {};\n\n    const width = (elementContainer?.width ?? 100) / transformScale;\n    const height = (elementContainer?.height ?? 100) / transformScale;\n\n    switch (vertical) {\n      case VerticalConstraint.Top:\n        placement.top = relativeTop;\n        placement.height = height;\n        break;\n      case VerticalConstraint.Bottom:\n        placement.bottom = relativeBottom;\n        placement.height = height;\n        break;\n      case VerticalConstraint.TopBottom:\n        placement.top = relativeTop;\n        placement.bottom = relativeBottom;\n        break;\n      case VerticalConstraint.Center:\n        const elementCenter = elementContainer ? relativeTop + height / 2 : 0;\n        const parentCenter = parentContainer ? parentContainer.height / 2 : 0;\n        const distanceFromCenter = parentCenter - elementCenter;\n        placement.top = distanceFromCenter;\n        placement.height = height;\n        break;\n      case VerticalConstraint.Scale:\n        placement.top = (relativeTop / (parentContainer?.height ?? height)) * 100;\n        placement.bottom = (relativeBottom / (parentContainer?.height ?? height)) * 100;\n        break;\n    }\n\n    switch (horizontal) {\n      case HorizontalConstraint.Left:\n        placement.left = relativeLeft;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.Right:\n        placement.right = relativeRight;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.LeftRight:\n        placement.left = relativeLeft;\n        placement.right = relativeRight;\n        break;\n      case HorizontalConstraint.Center:\n        const elementCenter = elementContainer ? relativeLeft + width / 2 : 0;\n        const parentCenter = parentContainer ? parentContainer.width / 2 : 0;\n        const distanceFromCenter = parentCenter - elementCenter;\n        placement.left = distanceFromCenter;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.Scale:\n        placement.left = (relativeLeft / (parentContainer?.width ?? width)) * 100;\n        placement.right = (relativeRight / (parentContainer?.width ?? width)) * 100;\n        break;\n    }\n\n    if (this.options.placement?.rotation) {\n      placement.rotation = this.options.placement.rotation;\n      placement.width = this.options.placement.width;\n      placement.height = this.options.placement.height;\n    }\n\n    this.options.placement = placement;\n\n    this.applyLayoutStylesToDiv();\n    this.revId++;\n\n    this.getScene()?.save();\n  }\n\n  updateData(ctx: DimensionContext) {\n    if (this.item.prepareData) {\n      this.data = this.item.prepareData(ctx, this.options);\n      this.revId++; // rerender\n    }\n\n    const scene = this.getScene();\n    const frames = scene?.data?.series;\n\n    this.options.links = this.options.links?.filter((link) => link !== null);\n\n    if (frames) {\n      const defaultField = {\n        name: 'Default field',\n        type: FieldType.string,\n        config: { links: this.options.links ?? [] },\n        values: [],\n      };\n\n      this.getLinks = getLinksSupplier(\n        frames[0],\n        defaultField,\n        {\n          __dataContext: {\n            value: {\n              data: frames,\n              field: defaultField,\n              frame: frames[0],\n              frameIndex: 0,\n            },\n          },\n        },\n        scene?.panel.props.replaceVariables!\n      );\n    }\n\n    const { background, border } = this.options;\n    const css: CSSProperties = {};\n    if (background) {\n      if (background.color) {\n        const color = ctx.getColor(background.color);\n        css.backgroundColor = color.value();\n      }\n      if (background.image) {\n        const image = ctx.getResource(background.image);\n        if (image) {\n          const v = image.value();\n          if (v) {\n            css.backgroundImage = `url(\"${v}\")`;\n            switch (background.size ?? BackgroundImageSize.Contain) {\n              case BackgroundImageSize.Contain:\n                css.backgroundSize = 'contain';\n                css.backgroundRepeat = 'no-repeat';\n                break;\n              case BackgroundImageSize.Cover:\n                css.backgroundSize = 'cover';\n                css.backgroundRepeat = 'no-repeat';\n                break;\n              case BackgroundImageSize.Original:\n                css.backgroundRepeat = 'no-repeat';\n                break;\n              case BackgroundImageSize.Tile:\n                css.backgroundRepeat = 'repeat';\n                break;\n              case BackgroundImageSize.Fill:\n                css.backgroundSize = '100% 100%';\n                break;\n            }\n          } else {\n            css.backgroundImage = '';\n          }\n        }\n      }\n    }\n\n    if (border && border.color && border.width !== undefined) {\n      const color = ctx.getColor(border.color);\n      css.borderWidth = `${border.width}px`;\n      css.borderStyle = 'solid';\n      css.borderColor = color.value();\n\n      // Move the image to inside the border\n      if (css.backgroundImage) {\n        css.backgroundOrigin = 'padding-box';\n      }\n    }\n\n    if (border && border.radius !== undefined) {\n      css.borderRadius = `${border.radius}px`;\n    }\n\n    this.dataStyle = css;\n    this.applyLayoutStylesToDiv();\n  }\n\n  isRoot(): this is RootElement {\n    return false;\n  }\n\n  /** Recursively visit all nodes */\n  visit(visitor: (v: ElementState) => void) {\n    visitor(this);\n  }\n\n  onChange(options: CanvasElementOptions) {\n    if (this.item.id !== options.type) {\n      this.item = canvasElementRegistry.getIfExists(options.type) ?? notFoundItem;\n    }\n\n    // rename handling\n    const oldName = this.options.name;\n    const newName = options.name;\n\n    this.revId++;\n    this.options = { ...options };\n    let trav = this.parent;\n    while (trav) {\n      if (trav.isRoot()) {\n        trav.scene.save();\n        break;\n      }\n      trav.revId++;\n      trav = trav.parent;\n    }\n\n    const scene = this.getScene();\n    if (oldName !== newName && scene) {\n      if (isConnectionTarget(this, scene.byName)) {\n        getConnectionsByTarget(this, scene).forEach((connection) => {\n          connection.info.targetName = newName;\n        });\n      }\n\n      scene.byName.delete(oldName);\n      scene.byName.set(newName, this);\n    }\n  }\n\n  getSaveModel() {\n    return { ...this.options };\n  }\n\n  initElement = (target: HTMLDivElement) => {\n    this.div = target;\n    this.applyLayoutStylesToDiv();\n  };\n\n  applyDrag = (event: OnDrag) => {\n    const hasHorizontalCenterConstraint = this.options.constraint?.horizontal === HorizontalConstraint.Center;\n    const hasVerticalCenterConstraint = this.options.constraint?.vertical === VerticalConstraint.Center;\n    if (hasHorizontalCenterConstraint || hasVerticalCenterConstraint) {\n      const numberOfTargets = this.getScene()?.selecto?.getSelectedTargets().length ?? 0;\n      const isMultiSelection = numberOfTargets > 1;\n      if (!isMultiSelection) {\n        const elementContainer = this.div?.getBoundingClientRect();\n        const height = elementContainer?.height ?? 100;\n        const yOffset = hasVerticalCenterConstraint ? height / 4 : 0;\n        event.target.style.transform = `translate(${event.translate[0]}px, ${event.translate[1] - yOffset}px)`;\n        return;\n      }\n    }\n\n    event.target.style.transform = event.transform;\n  };\n\n  applyRotate = (event: OnRotate) => {\n    const rotationDelta = event.delta;\n    const placement = this.options.placement!;\n    const placementRotation = placement.rotation ?? 0;\n\n    const calculatedRotation = placementRotation + rotationDelta;\n\n    // Ensure rotation is between 0 and 360\n    placement.rotation = calculatedRotation - Math.floor(calculatedRotation / 360) * 360;\n    event.target.style.transform = event.transform;\n  };\n\n  // kinda like:\n  // https://github.com/grafana/grafana-edge-app/blob/main/src/panels/draw/WrapItem.tsx#L44\n  applyResize = (event: OnResize, transformScale = 1) => {\n    const placement = this.options.placement!;\n\n    const style = event.target.style;\n    let deltaX = event.delta[0] / transformScale;\n    let deltaY = event.delta[1] / transformScale;\n    let dirLR = event.direction[0];\n    let dirTB = event.direction[1];\n\n    // Handle case when element is rotated\n    if (placement.rotation) {\n      const rotation = placement.rotation ?? 0;\n      const rotationInRadians = (rotation * Math.PI) / 180;\n      const originalDirLR = dirLR;\n      const originalDirTB = dirTB;\n\n      dirLR = Math.sign(originalDirLR * Math.cos(rotationInRadians) - originalDirTB * Math.sin(rotationInRadians));\n      dirTB = Math.sign(originalDirLR * Math.sin(rotationInRadians) + originalDirTB * Math.cos(rotationInRadians));\n    }\n\n    if (dirLR === 1) {\n      placement.width = event.width;\n      style.width = `${placement.width}px`;\n    } else if (dirLR === -1) {\n      placement.left! -= deltaX;\n      placement.width = event.width;\n      style.left = `${placement.left}px`;\n      style.width = `${placement.width}px`;\n    }\n\n    if (dirTB === -1) {\n      placement.top! -= deltaY;\n      placement.height = event.height;\n      style.top = `${placement.top}px`;\n      style.height = `${placement.height}px`;\n    } else if (dirTB === 1) {\n      placement.height = event.height;\n      style.height = `${placement.height}px`;\n    }\n  };\n\n  handleMouseEnter = (event: React.MouseEvent, isSelected: boolean | undefined) => {\n    const scene = this.getScene();\n\n    const shouldHandleTooltip =\n      !scene?.isEditingEnabled && !scene?.tooltip?.isOpen && this.options.oneClickMode === OneClickMode.Off;\n    if (shouldHandleTooltip) {\n      this.handleTooltip(event);\n    } else if (!isSelected) {\n      scene?.connections.handleMouseEnter(event);\n    }\n\n    const shouldHandleOneClickLink =\n      this.options.oneClickMode === OneClickMode.Link && this.options.links && this.options.links.length > 0;\n    if (shouldHandleOneClickLink && this.div) {\n      const primaryDataLink = this.getPrimaryDataLink();\n      if (primaryDataLink) {\n        this.div.style.cursor = 'pointer';\n        this.div.title = `Navigate to ${primaryDataLink.title === '' ? 'data link' : primaryDataLink.title}`;\n      }\n    }\n  };\n\n  getPrimaryDataLink = () => {\n    if (this.getLinks) {\n      const links = this.getLinks({ valueRowIndex: getRowIndex(this.data.field, this.getScene()!) });\n      return links[0];\n    }\n\n    return undefined;\n  };\n\n  handleTooltip = (event: React.MouseEvent) => {\n    const scene = this.getScene();\n    if (scene?.tooltipCallback) {\n      const rect = this.div?.getBoundingClientRect();\n      scene.tooltipCallback({\n        anchorPoint: { x: rect?.right ?? event.pageX, y: rect?.top ?? event.pageY },\n        element: this,\n        isOpen: false,\n      });\n    }\n  };\n\n  handleMouseLeave = (event: React.MouseEvent) => {\n    const scene = this.getScene();\n    if (scene?.tooltipCallback && !scene?.tooltip?.isOpen && this.options.oneClickMode === OneClickMode.Off) {\n      scene.tooltipCallback(undefined);\n    }\n\n    if (this.options.oneClickMode !== OneClickMode.Off && this.div) {\n      this.div.style.cursor = 'auto';\n      this.div.title = '';\n    }\n  };\n\n  onElementClick = (event: React.MouseEvent) => {\n    // If one-click access is enabled, open the primary link\n    if (this.options.oneClickMode === OneClickMode.Link) {\n      let primaryDataLink = this.getPrimaryDataLink();\n      if (primaryDataLink) {\n        window.open(primaryDataLink.href, primaryDataLink.target);\n      }\n    } else {\n      this.handleTooltip(event);\n      this.onTooltipCallback();\n    }\n  };\n\n  onElementKeyDown = (event: React.KeyboardEvent) => {\n    if (\n      event.key === 'Enter' &&\n      (event.currentTarget instanceof HTMLElement || event.currentTarget instanceof SVGElement)\n    ) {\n      const scene = this.getScene();\n      scene?.select({ targets: [event.currentTarget] });\n    }\n  };\n\n  onTooltipCallback = () => {\n    const scene = this.getScene();\n    if (scene?.tooltipCallback && scene.tooltip?.anchorPoint) {\n      scene.tooltipCallback({\n        anchorPoint: { x: scene.tooltip.anchorPoint.x, y: scene.tooltip.anchorPoint.y },\n        element: this,\n        isOpen: true,\n      });\n    }\n  };\n\n  render() {\n    const { item, div } = this;\n    const scene = this.getScene();\n    const isSelected = div && scene && scene.selecto && scene.selecto.getSelectedTargets().includes(div);\n\n    return (\n      <div\n        key={this.UID}\n        ref={this.initElement}\n        onMouseEnter={(e: React.MouseEvent) => this.handleMouseEnter(e, isSelected)}\n        onMouseLeave={!scene?.isEditingEnabled ? this.handleMouseLeave : undefined}\n        onClick={!scene?.isEditingEnabled ? this.onElementClick : undefined}\n        onKeyDown={!scene?.isEditingEnabled ? this.onElementKeyDown : undefined}\n        role=\"button\"\n        tabIndex={0}\n      >\n        <item.display\n          key={`${this.UID}/${this.revId}`}\n          config={this.options.config}\n          data={this.data}\n          isSelected={isSelected}\n        />\n      </div>\n    );\n  }\n}\n","import { isNumber, isString } from 'lodash';\n\nimport { AppEvents, PluginState, SelectableValue } from '@grafana/data';\nimport appEvents from 'app/core/app_events';\nimport { hasAlphaPanels, config } from 'app/core/config';\nimport {\n  CanvasConnection,\n  CanvasElementItem,\n  CanvasElementOptions,\n  ConnectionDirection,\n} from 'app/features/canvas/element';\nimport { notFoundItem } from 'app/features/canvas/elements/notFound';\nimport { advancedElementItems, canvasElementRegistry, defaultElementItems } from 'app/features/canvas/registry';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene, SelectionParams } from 'app/features/canvas/runtime/scene';\n\nimport { AnchorPoint, ConnectionState, LineStyle, StrokeDasharray } from './types';\n\nexport function doSelect(scene: Scene, element: ElementState | FrameState) {\n  try {\n    let selection: SelectionParams = { targets: [] };\n    if (element instanceof FrameState) {\n      const targetElements: HTMLDivElement[] = [];\n      targetElements.push(element?.div!);\n      selection.targets = targetElements;\n      selection.frame = element;\n      scene.select(selection);\n    } else {\n      scene.currentLayer = element.parent;\n      selection.targets = [element?.div!];\n      scene.select(selection);\n    }\n  } catch (error) {\n    appEvents.emit(AppEvents.alertError, ['Unable to select element, try selecting element in panel instead']);\n  }\n}\n\nexport function getElementTypes(shouldShowAdvancedTypes: boolean | undefined, current?: string): RegistrySelectInfo {\n  if (shouldShowAdvancedTypes) {\n    return getElementTypesOptions([...defaultElementItems, ...advancedElementItems], current);\n  }\n\n  return getElementTypesOptions([...defaultElementItems], current);\n}\n\ninterface RegistrySelectInfo {\n  options: Array<SelectableValue<string>>;\n  current: Array<SelectableValue<string>>;\n}\n\nexport function getElementTypesOptions(items: CanvasElementItem[], current: string | undefined): RegistrySelectInfo {\n  const selectables: RegistrySelectInfo = { options: [], current: [] };\n  const alpha: Array<SelectableValue<string>> = [];\n\n  for (const item of items) {\n    const option: SelectableValue<string> = { label: item.name, value: item.id, description: item.description };\n    if (item.state === PluginState.alpha) {\n      if (!hasAlphaPanels) {\n        continue;\n      }\n      option.label = `${item.name} (Alpha)`;\n      alpha.push(option);\n    } else {\n      selectables.options.push(option);\n    }\n\n    if (item.id === current) {\n      selectables.current.push(option);\n    }\n  }\n\n  for (const a of alpha) {\n    selectables.options.push(a);\n  }\n\n  return selectables;\n}\n\nexport function onAddItem(sel: SelectableValue<string>, rootLayer: FrameState | undefined, anchorPoint?: AnchorPoint) {\n  const newItem = canvasElementRegistry.getIfExists(sel.value) ?? notFoundItem;\n  const newElementOptions: CanvasElementOptions = {\n    ...newItem.getNewOptions(),\n    type: newItem.id,\n    name: '',\n  };\n\n  if (anchorPoint) {\n    newElementOptions.placement = { ...newElementOptions.placement, top: anchorPoint.y, left: anchorPoint.x };\n  }\n\n  if (newItem.defaultSize) {\n    newElementOptions.placement = { ...newElementOptions.placement, ...newItem.defaultSize };\n  }\n\n  if (rootLayer) {\n    const newElement = new ElementState(newItem, newElementOptions, rootLayer);\n    newElement.updateData(rootLayer.scene.context);\n    rootLayer.elements.push(newElement);\n    rootLayer.scene.save();\n    rootLayer.reinitializeMoveable();\n\n    setTimeout(() => doSelect(rootLayer.scene, newElement));\n  }\n}\n\nexport function isConnectionSource(element: ElementState) {\n  return element.options.connections && element.options.connections.length > 0;\n}\nexport function isConnectionTarget(element: ElementState, sceneByName: Map<string, ElementState>) {\n  const connections = getConnections(sceneByName);\n  return connections.some((connection) => connection.target === element);\n}\n\nexport function getConnections(sceneByName: Map<string, ElementState>) {\n  const connections: ConnectionState[] = [];\n  for (let v of sceneByName.values()) {\n    if (v.options.connections) {\n      v.options.connections.forEach((c, index) => {\n        // @TODO Remove after v10.x\n        if (isString(c.color)) {\n          c.color = { fixed: c.color };\n        }\n\n        if (isNumber(c.size)) {\n          c.size = { fixed: 2, min: 1, max: 10 };\n        }\n\n        const target = c.targetName ? sceneByName.get(c.targetName) : v.parent;\n        if (target) {\n          connections.push({\n            index,\n            source: v,\n            target,\n            info: c,\n            vertices: c.vertices ?? undefined,\n            sourceOriginal: c.sourceOriginal ?? undefined,\n            targetOriginal: c.targetOriginal ?? undefined,\n          });\n        }\n      });\n    }\n  }\n\n  return connections;\n}\n\nexport function getConnectionsByTarget(element: ElementState, scene: Scene) {\n  return scene.connections.state.filter((connection) => connection.target === element);\n}\n\nexport function updateConnectionsForSource(element: ElementState, scene: Scene) {\n  const targetConnections = getConnectionsByTarget(element, scene);\n  targetConnections.forEach((connection) => {\n    const sourceConnections = connection.source.options.connections?.splice(0) ?? [];\n    const connections = sourceConnections.filter((con) => con.targetName !== element.getName());\n    connection.source.onChange({ ...connection.source.options, connections });\n  });\n\n  // Update scene connection state to clear out old connections\n  scene.connections.updateState();\n}\n\nexport const calculateCoordinates = (\n  sourceRect: DOMRect,\n  parentRect: DOMRect,\n  info: CanvasConnection,\n  target: ElementState,\n  transformScale: number\n) => {\n  const sourceHorizontalCenter = sourceRect.left - parentRect.left + sourceRect.width / 2;\n  const sourceVerticalCenter = sourceRect.top - parentRect.top + sourceRect.height / 2;\n\n  // Convert from connection coords to DOM coords\n  const x1 = (sourceHorizontalCenter + (info.source.x * sourceRect.width) / 2) / transformScale;\n  const y1 = (sourceVerticalCenter - (info.source.y * sourceRect.height) / 2) / transformScale;\n\n  let x2: number;\n  let y2: number;\n  const targetRect = target.div?.getBoundingClientRect();\n  if (info.targetName && targetRect) {\n    const targetHorizontalCenter = targetRect.left - parentRect.left + targetRect.width / 2;\n    const targetVerticalCenter = targetRect.top - parentRect.top + targetRect.height / 2;\n\n    x2 = targetHorizontalCenter + (info.target.x * targetRect.width) / 2;\n    y2 = targetVerticalCenter - (info.target.y * targetRect.height) / 2;\n  } else {\n    const parentHorizontalCenter = parentRect.width / 2;\n    const parentVerticalCenter = parentRect.height / 2;\n\n    x2 = parentHorizontalCenter + (info.target.x * parentRect.width) / 2;\n    y2 = parentVerticalCenter - (info.target.y * parentRect.height) / 2;\n  }\n  x2 /= transformScale;\n  y2 /= transformScale;\n\n  // TODO look into a better way to avoid division by zero\n  if (x2 - x1 === 0) {\n    x2 += 1;\n  }\n  if (y2 - y1 === 0) {\n    y2 += 1;\n  }\n  return { x1, y1, x2, y2 };\n};\n\nexport const calculateMidpoint = (x1: number, y1: number, x2: number, y2: number) => {\n  return { x: (x1 + x2) / 2, y: (y1 + y2) / 2 };\n};\n\nexport const calculateAbsoluteCoords = (\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number,\n  valueX: number,\n  valueY: number,\n  deltaX: number,\n  deltaY: number\n) => {\n  return { x: valueX * deltaX + x1, y: valueY * deltaY + y1 };\n};\n\n// Calculate angle between two points and return angle in radians\nexport const calculateAngle = (x1: number, y1: number, x2: number, y2: number) => {\n  return Math.atan2(y2 - y1, x2 - x1);\n};\n\nexport const calculateDistance = (x1: number, y1: number, x2: number, y2: number) => {\n  //TODO add sqrt approx option\n  return Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);\n};\n\n// @TODO revisit, currently returning last row index for field\nexport const getRowIndex = (fieldName: string | undefined, scene: Scene) => {\n  if (fieldName) {\n    const series = scene.data?.series[0];\n    const field = series?.fields.find((field) => field.name === fieldName);\n    const data = field?.values;\n    return data ? data.length - 1 : 0;\n  }\n  return 0;\n};\n\nexport const getConnectionStyles = (\n  info: CanvasConnection,\n  scene: Scene,\n  defaultArrowSize: number,\n  defaultArrowDirection: ConnectionDirection\n) => {\n  const defaultArrowColor = config.theme2.colors.text.primary;\n  const lastRowIndex = getRowIndex(info.size?.field, scene);\n  const strokeColor = info.color ? scene.context.getColor(info.color).value() : defaultArrowColor;\n  const strokeWidth = info.size ? scene.context.getScale(info.size).get(lastRowIndex) : defaultArrowSize;\n  const strokeRadius = info.radius ? scene.context.getScale(info.radius).get(lastRowIndex) : 0;\n  const arrowDirection = info.direction ? info.direction : defaultArrowDirection;\n  const lineStyle = getLineStyle(info.lineStyle?.style);\n  const shouldAnimate = info.lineStyle?.animate;\n\n  return { strokeColor, strokeWidth, strokeRadius, arrowDirection, lineStyle, shouldAnimate };\n};\n\nconst getLineStyle = (lineStyle?: LineStyle) => {\n  switch (lineStyle) {\n    case LineStyle.Dashed:\n      return StrokeDasharray.Dashed;\n    case LineStyle.Dotted:\n      return StrokeDasharray.Dotted;\n    default:\n      return StrokeDasharray.Solid;\n  }\n};\n\nexport const getParentBoundingClientRect = (scene: Scene) => {\n  if (config.featureToggles.canvasPanelPanZoom) {\n    const transformRef = scene.transformComponentRef?.current;\n    return transformRef?.instance.contentComponent?.getBoundingClientRect();\n  }\n\n  return scene.div?.getBoundingClientRect();\n};\n\nexport const getTransformInstance = (scene: Scene) => {\n  if (config.featureToggles.canvasPanelPanZoom) {\n    return scene.transformComponentRef?.current?.instance;\n  }\n  return undefined;\n};\n\nexport const getParent = (scene: Scene) => {\n  if (config.featureToggles.canvasPanelPanZoom) {\n    return scene.transformComponentRef?.current?.instance.contentComponent;\n  }\n  return scene.div;\n};\n","/*\nCopyright (c) 2019 Daybrush\nname: framework-utils\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/framework-utils.git\nversion: 1.1.0\n*/\nfunction prefixNames(prefix) {\n  var classNames = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    classNames[_i - 1] = arguments[_i];\n  }\n\n  return classNames.map(function (className) {\n    return className.split(\" \").map(function (name) {\n      return name ? \"\" + prefix + name : \"\";\n    }).join(\" \");\n  }).join(\" \");\n}\nfunction prefixCSS(prefix, css) {\n  return css.replace(/([^}{]*){/gm, function (_, selector) {\n    return selector.replace(/\\.([^{,\\s\\d.]+)/g, \".\" + prefix + \"$1\") + \"{\";\n  });\n}\n/* react */\n\nfunction ref(target, name) {\n  return function (e) {\n    e && (target[name] = e);\n  };\n}\nfunction refs(target, name, i) {\n  return function (e) {\n    e && (target[name][i] = e);\n  };\n}\n/* Class Decorator */\n\nfunction Properties(properties, action) {\n  return function (component) {\n    var prototype = component.prototype;\n    properties.forEach(function (property) {\n      action(prototype, property);\n    });\n  };\n}\n/* Property Decorator */\n\nfunction withMethods(methods, duplicate) {\n  if (duplicate === void 0) {\n    duplicate = {};\n  }\n\n  return function (prototype, propertyName) {\n    methods.forEach(function (name) {\n      var methodName = duplicate[name] || name;\n\n      if (methodName in prototype) {\n        return;\n      }\n\n      prototype[methodName] = function () {\n        var _a;\n\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        var result = (_a = this[propertyName])[name].apply(_a, args);\n\n        if (result === this[propertyName]) {\n          return this;\n        } else {\n          return result;\n        }\n      };\n    });\n  };\n}\n\nexport { Properties, prefixCSS, prefixNames, ref, refs, withMethods };\n//# sourceMappingURL=utils.esm.js.map\n","/*\nCopyright (c) 2018 Daybrush\n@name: @daybrush/utils\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/utils\n@version 1.13.0\n*/\n/**\n* @namespace\n* @name Consts\n*/\n/**\n* get string \"rgb\"\n* @memberof Color\n* @example\nimport {RGB} from \"@daybrush/utils\";\n\nconsole.log(RGB); // \"rgb\"\n*/\nvar RGB = \"rgb\";\n/**\n* get string \"rgba\"\n* @memberof Color\n* @example\nimport {RGBA} from \"@daybrush/utils\";\n\nconsole.log(RGBA); // \"rgba\"\n*/\nvar RGBA = \"rgba\";\n/**\n* get string \"hsl\"\n* @memberof Color\n* @example\nimport {HSL} from \"@daybrush/utils\";\n\nconsole.log(HSL); // \"hsl\"\n*/\nvar HSL = \"hsl\";\n/**\n* get string \"hsla\"\n* @memberof Color\n* @example\nimport {HSLA} from \"@daybrush/utils\";\n\nconsole.log(HSLA); // \"hsla\"\n*/\nvar HSLA = \"hsla\";\n/**\n* gets an array of color models.\n* @memberof Color\n* @example\nimport {COLOR_MODELS} from \"@daybrush/utils\";\n\nconsole.log(COLOR_MODELS); // [\"rgb\", \"rgba\", \"hsl\", \"hsla\"];\n*/\nvar COLOR_MODELS = [RGB, RGBA, HSL, HSLA];\n/**\n* get string \"function\"\n* @memberof Consts\n* @example\nimport {FUNCTION} from \"@daybrush/utils\";\n\nconsole.log(FUNCTION); // \"function\"\n*/\nvar FUNCTION = \"function\";\n/**\n* get string \"property\"\n* @memberof Consts\n* @example\nimport {PROPERTY} from \"@daybrush/utils\";\n\nconsole.log(PROPERTY); // \"property\"\n*/\nvar PROPERTY = \"property\";\n/**\n* get string \"array\"\n* @memberof Consts\n* @example\nimport {ARRAY} from \"@daybrush/utils\";\n\nconsole.log(ARRAY); // \"array\"\n*/\nvar ARRAY = \"array\";\n/**\n* get string \"object\"\n* @memberof Consts\n* @example\nimport {OBJECT} from \"@daybrush/utils\";\n\nconsole.log(OBJECT); // \"object\"\n*/\nvar OBJECT = \"object\";\n/**\n* get string \"string\"\n* @memberof Consts\n* @example\nimport {STRING} from \"@daybrush/utils\";\n\nconsole.log(STRING); // \"string\"\n*/\nvar STRING = \"string\";\n/**\n* get string \"number\"\n* @memberof Consts\n* @example\nimport {NUMBER} from \"@daybrush/utils\";\n\nconsole.log(NUMBER); // \"number\"\n*/\nvar NUMBER = \"number\";\n/**\n* get string \"undefined\"\n* @memberof Consts\n* @example\nimport {UNDEFINED} from \"@daybrush/utils\";\n\nconsole.log(UNDEFINED); // \"undefined\"\n*/\nvar UNDEFINED = \"undefined\";\n/**\n* Check whether the environment is window or node.js.\n* @memberof Consts\n* @example\nimport {IS_WINDOW} from \"@daybrush/utils\";\n\nconsole.log(IS_WINDOW); // false in node.js\nconsole.log(IS_WINDOW); // true in browser\n*/\nvar IS_WINDOW = typeof window !== UNDEFINED;\n/**\n* Check whether the environment is window or node.js.\n* @memberof Consts\n* @name document\n* @example\nimport {IS_WINDOW} from \"@daybrush/utils\";\n\nconsole.log(IS_WINDOW); // false in node.js\nconsole.log(IS_WINDOW); // true in browser\n*/\nvar doc = typeof document !== UNDEFINED && document; // FIXME: this type maybe false\nvar prefixes = [\"webkit\", \"ms\", \"moz\", \"o\"];\n/**\n * @namespace CrossBrowser\n */\n/**\n* Get a CSS property with a vendor prefix that supports cross browser.\n* @function\n* @param {string} property - A CSS property\n* @return {string} CSS property with cross-browser vendor prefix\n* @memberof CrossBrowser\n* @example\nimport {getCrossBrowserProperty} from \"@daybrush/utils\";\n\nconsole.log(getCrossBrowserProperty(\"transform\")); // \"transform\", \"-ms-transform\", \"-webkit-transform\"\nconsole.log(getCrossBrowserProperty(\"filter\")); // \"filter\", \"-webkit-filter\"\n*/\nvar getCrossBrowserProperty = /*#__PURE__*/function (property) {\n  if (!doc) {\n    return \"\";\n  }\n  var styles = (doc.body || doc.documentElement).style;\n  var length = prefixes.length;\n  if (typeof styles[property] !== UNDEFINED) {\n    return property;\n  }\n  for (var i = 0; i < length; ++i) {\n    var name = \"-\" + prefixes[i] + \"-\" + property;\n    if (typeof styles[name] !== UNDEFINED) {\n      return name;\n    }\n  }\n  return \"\";\n};\n/**\n* get string \"transfrom\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {TRANSFORM} from \"@daybrush/utils\";\n\nconsole.log(TRANSFORM); // \"transform\", \"-ms-transform\", \"-webkit-transform\"\n*/\nvar TRANSFORM = /*#__PURE__*/getCrossBrowserProperty(\"transform\");\n/**\n* get string \"filter\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {FILTER} from \"@daybrush/utils\";\n\nconsole.log(FILTER); // \"filter\", \"-ms-filter\", \"-webkit-filter\"\n*/\nvar FILTER = /*#__PURE__*/getCrossBrowserProperty(\"filter\");\n/**\n* get string \"animation\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {ANIMATION} from \"@daybrush/utils\";\n\nconsole.log(ANIMATION); // \"animation\", \"-ms-animation\", \"-webkit-animation\"\n*/\nvar ANIMATION = /*#__PURE__*/getCrossBrowserProperty(\"animation\");\n/**\n* get string \"keyframes\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {KEYFRAMES} from \"@daybrush/utils\";\n\nconsole.log(KEYFRAMES); // \"keyframes\", \"-ms-keyframes\", \"-webkit-keyframes\"\n*/\nvar KEYFRAMES = /*#__PURE__*/ANIMATION.replace(\"animation\", \"keyframes\");\nvar OPEN_CLOSED_CHARACTERS = [{\n  open: \"(\",\n  close: \")\"\n}, {\n  open: \"\\\"\",\n  close: \"\\\"\"\n}, {\n  open: \"'\",\n  close: \"'\"\n}, {\n  open: \"\\\\\\\"\",\n  close: \"\\\\\\\"\"\n}, {\n  open: \"\\\\'\",\n  close: \"\\\\'\"\n}];\nvar TINY_NUM = 0.0000001;\nvar REVERSE_TINY_NUM = 1 / TINY_NUM;\nvar DEFAULT_UNIT_PRESETS = {\n  \"cm\": function (pos) {\n    return pos * 96 / 2.54;\n  },\n  \"mm\": function (pos) {\n    return pos * 96 / 254;\n  },\n  \"in\": function (pos) {\n    return pos * 96;\n  },\n  \"pt\": function (pos) {\n    return pos * 96 / 72;\n  },\n  \"pc\": function (pos) {\n    return pos * 96 / 6;\n  },\n  \"%\": function (pos, size) {\n    return pos * size / 100;\n  },\n  \"vw\": function (pos, size) {\n    if (size === void 0) {\n      size = window.innerWidth;\n    }\n    return pos / 100 * size;\n  },\n  \"vh\": function (pos, size) {\n    if (size === void 0) {\n      size = window.innerHeight;\n    }\n    return pos / 100 * size;\n  },\n  \"vmax\": function (pos, size) {\n    if (size === void 0) {\n      size = Math.max(window.innerWidth, window.innerHeight);\n    }\n    return pos / 100 * size;\n  },\n  \"vmin\": function (pos, size) {\n    if (size === void 0) {\n      size = Math.min(window.innerWidth, window.innerHeight);\n    }\n    return pos / 100 * size;\n  }\n};\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n  return r;\n}\n\n/**\n* @namespace\n* @name Utils\n*/\n/**\n * Returns the inner product of two numbers(`a1`, `a2`) by two criteria(`b1`, `b2`).\n * @memberof Utils\n * @param - The first number\n * @param - The second number\n * @param - The first number to base on the inner product\n * @param - The second number to base on the inner product\n * @return - Returns the inner product\nimport { dot } from \"@daybrush/utils\";\n\nconsole.log(dot(0, 15, 2, 3)); // 6\nconsole.log(dot(5, 15, 2, 3)); // 9\nconsole.log(dot(5, 15, 1, 1)); // 10\n */\nfunction dot(a1, a2, b1, b2) {\n  return (a1 * b2 + a2 * b1) / (b1 + b2);\n}\n/**\n* Check the type that the value is undefined.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {boolean} true if the type is correct, false otherwise\n* @example\nimport {isUndefined} from \"@daybrush/utils\";\n\nconsole.log(isUndefined(undefined)); // true\nconsole.log(isUndefined(\"\")); // false\nconsole.log(isUndefined(1)); // false\nconsole.log(isUndefined(null)); // false\n*/\nfunction isUndefined(value) {\n  return typeof value === UNDEFINED;\n}\n/**\n* Check the type that the value is object.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isObject} from \"@daybrush/utils\";\n\nconsole.log(isObject({})); // true\nconsole.log(isObject(undefined)); // false\nconsole.log(isObject(\"\")); // false\nconsole.log(isObject(null)); // false\n*/\nfunction isObject(value) {\n  return value && typeof value === OBJECT;\n}\n/**\n* Check the type that the value is isArray.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isArray} from \"@daybrush/utils\";\n\nconsole.log(isArray([])); // true\nconsole.log(isArray({})); // false\nconsole.log(isArray(undefined)); // false\nconsole.log(isArray(null)); // false\n*/\nfunction isArray(value) {\n  return Array.isArray(value);\n}\n/**\n* Check the type that the value is string.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isString} from \"@daybrush/utils\";\n\nconsole.log(isString(\"1234\")); // true\nconsole.log(isString(undefined)); // false\nconsole.log(isString(1)); // false\nconsole.log(isString(null)); // false\n*/\nfunction isString(value) {\n  return typeof value === STRING;\n}\nfunction isNumber(value) {\n  return typeof value === NUMBER;\n}\n/**\n* Check the type that the value is function.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isFunction} from \"@daybrush/utils\";\n\nconsole.log(isFunction(function a() {})); // true\nconsole.log(isFunction(() => {})); // true\nconsole.log(isFunction(\"1234\")); // false\nconsole.log(isFunction(1)); // false\nconsole.log(isFunction(null)); // false\n*/\nfunction isFunction(value) {\n  return typeof value === FUNCTION;\n}\nfunction isEqualSeparator(character, separator) {\n  var isCharacterSpace = character === \"\" || character == \" \";\n  var isSeparatorSpace = separator === \"\" || separator == \" \";\n  return isSeparatorSpace && isCharacterSpace || character === separator;\n}\nfunction findOpen(openCharacter, texts, index, length, openCloseCharacters) {\n  var isIgnore = findIgnore(openCharacter, texts, index);\n  if (!isIgnore) {\n    return findClose(openCharacter, texts, index + 1, length, openCloseCharacters);\n  }\n  return index;\n}\nfunction findIgnore(character, texts, index) {\n  if (!character.ignore) {\n    return null;\n  }\n  var otherText = texts.slice(Math.max(index - 3, 0), index + 3).join(\"\");\n  return new RegExp(character.ignore).exec(otherText);\n}\nfunction findClose(closeCharacter, texts, index, length, openCloseCharacters) {\n  var _loop_1 = function (i) {\n    var character = texts[i].trim();\n    if (character === closeCharacter.close && !findIgnore(closeCharacter, texts, i)) {\n      return {\n        value: i\n      };\n    }\n    var nextIndex = i;\n    // re open\n    var openCharacter = find(openCloseCharacters, function (_a) {\n      var open = _a.open;\n      return open === character;\n    });\n    if (openCharacter) {\n      nextIndex = findOpen(openCharacter, texts, i, length, openCloseCharacters);\n    }\n    if (nextIndex === -1) {\n      return out_i_1 = i, \"break\";\n    }\n    i = nextIndex;\n    out_i_1 = i;\n  };\n  var out_i_1;\n  for (var i = index; i < length; ++i) {\n    var state_1 = _loop_1(i);\n    i = out_i_1;\n    if (typeof state_1 === \"object\") return state_1.value;\n    if (state_1 === \"break\") break;\n  }\n  return -1;\n}\nfunction splitText(text, splitOptions) {\n  var _a = isString(splitOptions) ? {\n      separator: splitOptions\n    } : splitOptions,\n    _b = _a.separator,\n    separator = _b === void 0 ? \",\" : _b,\n    isSeparateFirst = _a.isSeparateFirst,\n    isSeparateOnlyOpenClose = _a.isSeparateOnlyOpenClose,\n    _c = _a.isSeparateOpenClose,\n    isSeparateOpenClose = _c === void 0 ? isSeparateOnlyOpenClose : _c,\n    _d = _a.openCloseCharacters,\n    openCloseCharacters = _d === void 0 ? OPEN_CLOSED_CHARACTERS : _d;\n  var openClosedText = openCloseCharacters.map(function (_a) {\n    var open = _a.open,\n      close = _a.close;\n    if (open === close) {\n      return open;\n    }\n    return open + \"|\" + close;\n  }).join(\"|\");\n  var regexText = \"(\\\\s*\" + separator + \"\\\\s*|\" + openClosedText + \"|\\\\s+)\";\n  var regex = new RegExp(regexText, \"g\");\n  var texts = text.split(regex).filter(function (chr) {\n    return chr && chr !== \"undefined\";\n  });\n  var length = texts.length;\n  var values = [];\n  var tempValues = [];\n  function resetTemp() {\n    if (tempValues.length) {\n      values.push(tempValues.join(\"\"));\n      tempValues = [];\n      return true;\n    }\n    return false;\n  }\n  var _loop_2 = function (i) {\n    var character = texts[i].trim();\n    var nextIndex = i;\n    var openCharacter = find(openCloseCharacters, function (_a) {\n      var open = _a.open;\n      return open === character;\n    });\n    var closeCharacter = find(openCloseCharacters, function (_a) {\n      var close = _a.close;\n      return close === character;\n    });\n    if (openCharacter) {\n      nextIndex = findOpen(openCharacter, texts, i, length, openCloseCharacters);\n      if (nextIndex !== -1 && isSeparateOpenClose) {\n        if (resetTemp() && isSeparateFirst) {\n          return out_i_2 = i, \"break\";\n        }\n        values.push(texts.slice(i, nextIndex + 1).join(\"\"));\n        i = nextIndex;\n        if (isSeparateFirst) {\n          return out_i_2 = i, \"break\";\n        }\n        return out_i_2 = i, \"continue\";\n      }\n    } else if (closeCharacter && !findIgnore(closeCharacter, texts, i)) {\n      var nextOpenCloseCharacters = __spreadArrays(openCloseCharacters);\n      nextOpenCloseCharacters.splice(openCloseCharacters.indexOf(closeCharacter), 1);\n      return {\n        value: splitText(text, {\n          separator: separator,\n          isSeparateFirst: isSeparateFirst,\n          isSeparateOnlyOpenClose: isSeparateOnlyOpenClose,\n          isSeparateOpenClose: isSeparateOpenClose,\n          openCloseCharacters: nextOpenCloseCharacters\n        })\n      };\n    } else if (isEqualSeparator(character, separator) && !isSeparateOnlyOpenClose) {\n      resetTemp();\n      if (isSeparateFirst) {\n        return out_i_2 = i, \"break\";\n      }\n      return out_i_2 = i, \"continue\";\n    }\n    if (nextIndex === -1) {\n      nextIndex = length - 1;\n    }\n    tempValues.push(texts.slice(i, nextIndex + 1).join(\"\"));\n    i = nextIndex;\n    out_i_2 = i;\n  };\n  var out_i_2;\n  for (var i = 0; i < length; ++i) {\n    var state_2 = _loop_2(i);\n    i = out_i_2;\n    if (typeof state_2 === \"object\") return state_2.value;\n    if (state_2 === \"break\") break;\n  }\n  if (tempValues.length) {\n    values.push(tempValues.join(\"\"));\n  }\n  return values;\n}\n/**\n* divide text by space.\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {Array} divided texts\n* @example\nimport {spliceSpace} from \"@daybrush/utils\";\n\nconsole.log(splitSpace(\"a b c d e f g\"));\n// [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"]\nconsole.log(splitSpace(\"'a,b' c 'd,e' f g\"));\n// [\"'a,b'\", \"c\", \"'d,e'\", \"f\", \"g\"]\n*/\nfunction splitSpace(text) {\n  // divide comma(space)\n  return splitText(text, \"\");\n}\n/**\n* divide text by comma.\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {Array} divided texts\n* @example\nimport {splitComma} from \"@daybrush/utils\";\n\nconsole.log(splitComma(\"a,b,c,d,e,f,g\"));\n// [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"]\nconsole.log(splitComma(\"'a,b',c,'d,e',f,g\"));\n// [\"'a,b'\", \"c\", \"'d,e'\", \"f\", \"g\"]\n*/\nfunction splitComma(text) {\n  // divide comma(,)\n  // \"[^\"]*\"|'[^']*'\n  return splitText(text, \",\");\n}\n/**\n* divide text by bracket \"(\", \")\".\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {object} divided texts\n* @example\nimport {splitBracket} from \"@daybrush/utils\";\n\nconsole.log(splitBracket(\"a(1, 2)\"));\n// {prefix: \"a\", value: \"1, 2\", suffix: \"\"}\nconsole.log(splitBracket(\"a(1, 2)b\"));\n// {prefix: \"a\", value: \"1, 2\", suffix: \"b\"}\n*/\nfunction splitBracket(text) {\n  var matches = /([^(]*)\\(([\\s\\S]*)\\)([\\s\\S]*)/g.exec(text);\n  if (!matches || matches.length < 4) {\n    return {};\n  } else {\n    return {\n      prefix: matches[1],\n      value: matches[2],\n      suffix: matches[3]\n    };\n  }\n}\n/**\n* divide text by number and unit.\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {} divided texts\n* @example\nimport {splitUnit} from \"@daybrush/utils\";\n\nconsole.log(splitUnit(\"10px\"));\n// {prefix: \"\", value: 10, unit: \"px\"}\nconsole.log(splitUnit(\"-10px\"));\n// {prefix: \"\", value: -10, unit: \"px\"}\nconsole.log(splitUnit(\"a10%\"));\n// {prefix: \"a\", value: 10, unit: \"%\"}\n*/\nfunction splitUnit(text) {\n  var matches = /^([^\\d|e|\\-|\\+]*)((?:\\d|\\.|-|e-|e\\+)+)(\\S*)$/g.exec(text);\n  if (!matches) {\n    return {\n      prefix: \"\",\n      unit: \"\",\n      value: NaN\n    };\n  }\n  var prefix = matches[1];\n  var value = matches[2];\n  var unit = matches[3];\n  return {\n    prefix: prefix,\n    unit: unit,\n    value: parseFloat(value)\n  };\n}\n/**\n* transform strings to camel-case\n* @memberof Utils\n* @param {String} text - string\n* @return {String} camel-case string\n* @example\nimport {camelize} from \"@daybrush/utils\";\n\nconsole.log(camelize(\"transform-origin\")); // transformOrigin\nconsole.log(camelize(\"abcd_efg\")); // abcdEfg\nconsole.log(camelize(\"abcd efg\")); // abcdEfg\n*/\nfunction camelize(str) {\n  return str.replace(/[\\s-_]+([^\\s-_])/g, function (all, letter) {\n    return letter.toUpperCase();\n  });\n}\n/**\n* transform a camelized string into a lowercased string.\n* @memberof Utils\n* @param {string} text - a camel-cased string\n* @param {string} [separator=\"-\"] - a separator\n* @return {string}  a lowercased string\n* @example\nimport {decamelize} from \"@daybrush/utils\";\n\nconsole.log(decamelize(\"transformOrigin\")); // transform-origin\nconsole.log(decamelize(\"abcdEfg\", \"_\")); // abcd_efg\n*/\nfunction decamelize(str, separator) {\n  if (separator === void 0) {\n    separator = \"-\";\n  }\n  return str.replace(/([a-z])([A-Z])/g, function (all, letter, letter2) {\n    return \"\" + letter + separator + letter2.toLowerCase();\n  });\n}\n/**\n* transforms something in an array into an array.\n* @memberof Utils\n* @param - Array form\n* @return an array\n* @example\nimport {toArray} from \"@daybrush/utils\";\n\nconst arr1 = toArray(document.querySelectorAll(\".a\")); // Element[]\nconst arr2 = toArray(document.querySelectorAll<HTMLElement>(\".a\")); // HTMLElement[]\n*/\nfunction toArray(value) {\n  return [].slice.call(value);\n}\n/**\n* Date.now() method\n* @memberof CrossBrowser\n* @return {number} milliseconds\n* @example\nimport {now} from \"@daybrush/utils\";\n\nconsole.log(now()); // 12121324241(milliseconds)\n*/\nfunction now() {\n  return Date.now ? Date.now() : new Date().getTime();\n}\n/**\n* Returns the index of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findIndex` was called upon.\n* @param - A function to execute on each value in the array until the function returns true, indicating that the satisfying element was found.\n* @param - Returns defaultIndex if not found by the function.\n* @example\nimport { findIndex } from \"@daybrush/utils\";\n\nfindIndex([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // 1\n*/\nfunction findIndex(arr, callback, defaultIndex) {\n  if (defaultIndex === void 0) {\n    defaultIndex = -1;\n  }\n  var length = arr.length;\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i, arr)) {\n      return i;\n    }\n  }\n  return defaultIndex;\n}\n/**\n* Returns the reverse direction index of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findLastIndex` was called upon.\n* @param - A function to execute on each value in the array until the function returns true, indicating that the satisfying element was found.\n* @param - Returns defaultIndex if not found by the function.\n* @example\nimport { findLastIndex } from \"@daybrush/utils\";\n\nfindLastIndex([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // 1\n*/\nfunction findLastIndex(arr, callback, defaultIndex) {\n  if (defaultIndex === void 0) {\n    defaultIndex = -1;\n  }\n  var length = arr.length;\n  for (var i = length - 1; i >= 0; --i) {\n    if (callback(arr[i], i, arr)) {\n      return i;\n    }\n  }\n  return defaultIndex;\n}\n/**\n* Returns the value of the reverse direction element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findLast` was called upon.\n* @param - A function to execute on each value in the array,\n* @param - Returns defalutValue if not found by the function.\n* @example\nimport { find } from \"@daybrush/utils\";\n\nfind([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // {a: 2}\n*/\nfunction findLast(arr, callback, defalutValue) {\n  var index = findLastIndex(arr, callback);\n  return index > -1 ? arr[index] : defalutValue;\n}\n/**\n* Returns the value of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `find` was called upon.\n* @param - A function to execute on each value in the array,\n* @param - Returns defalutValue if not found by the function.\n* @example\nimport { find } from \"@daybrush/utils\";\n\nfind([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // {a: 2}\n*/\nfunction find(arr, callback, defalutValue) {\n  var index = findIndex(arr, callback);\n  return index > -1 ? arr[index] : defalutValue;\n}\n/**\n* window.requestAnimationFrame() method with cross browser.\n* @function\n* @memberof CrossBrowser\n* @param {FrameRequestCallback} callback - The function to call when it's time to update your animation for the next repaint.\n* @return {number} id\n* @example\nimport {requestAnimationFrame} from \"@daybrush/utils\";\n\nrequestAnimationFrame((timestamp) => {\n  console.log(timestamp);\n});\n*/\nvar requestAnimationFrame = /*#__PURE__*/function () {\n  var firstTime = now();\n  var raf = IS_WINDOW && (window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame);\n  return raf ? raf.bind(window) : function (callback) {\n    var currTime = now();\n    var id = setTimeout(function () {\n      callback(currTime - firstTime);\n    }, 1000 / 60);\n    return id;\n  };\n}();\n/**\n* window.cancelAnimationFrame() method with cross browser.\n* @function\n* @memberof CrossBrowser\n* @param {number} handle - the id obtained through requestAnimationFrame method\n* @return {void}\n* @example\nimport { requestAnimationFrame, cancelAnimationFrame } from \"@daybrush/utils\";\n\nconst id = requestAnimationFrame((timestamp) => {\n  console.log(timestamp);\n});\n\ncancelAnimationFrame(id);\n*/\nvar cancelAnimationFrame = /*#__PURE__*/function () {\n  var caf = IS_WINDOW && (window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.msCancelAnimationFrame);\n  return caf ? caf.bind(window) : function (handle) {\n    clearTimeout(handle);\n  };\n}();\n/**\n* @function\n* @memberof Utils\n*/\nfunction getKeys(obj) {\n  return Object.keys(obj);\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction getValues(obj) {\n  var keys = getKeys(obj);\n  return keys.map(function (key) {\n    return obj[key];\n  });\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction getEntries(obj) {\n  var keys = getKeys(obj);\n  return keys.map(function (key) {\n    return [key, obj[key]];\n  });\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction sortOrders(keys, orders) {\n  if (orders === void 0) {\n    orders = [];\n  }\n  keys.sort(function (a, b) {\n    var index1 = orders.indexOf(a);\n    var index2 = orders.indexOf(b);\n    if (index2 === -1 && index1 === -1) {\n      return 0;\n    }\n    if (index1 === -1) {\n      return 1;\n    }\n    if (index2 === -1) {\n      return -1;\n    }\n    return index1 - index2;\n  });\n}\n/**\n* convert unit size to px size\n* @function\n* @memberof Utils\n*/\nfunction convertUnitSize(pos, size) {\n  var _a = splitUnit(pos),\n    value = _a.value,\n    unit = _a.unit;\n  if (isObject(size)) {\n    var sizeFunction = size[unit];\n    if (sizeFunction) {\n      if (isFunction(sizeFunction)) {\n        return sizeFunction(value);\n      } else if (DEFAULT_UNIT_PRESETS[unit]) {\n        return DEFAULT_UNIT_PRESETS[unit](value, sizeFunction);\n      }\n    }\n  } else if (unit === \"%\") {\n    return value * size / 100;\n  }\n  if (DEFAULT_UNIT_PRESETS[unit]) {\n    return DEFAULT_UNIT_PRESETS[unit](value);\n  }\n  return value;\n}\n/**\n* calculate between min, max\n* @function\n* @memberof Utils\n*/\nfunction between(value, min, max) {\n  return Math.max(min, Math.min(value, max));\n}\nfunction checkBoundSize(targetSize, compareSize, isMax, ratio) {\n  if (ratio === void 0) {\n    ratio = targetSize[0] / targetSize[1];\n  }\n  return [[throttle(compareSize[0], TINY_NUM), throttle(compareSize[0] / ratio, TINY_NUM)], [throttle(compareSize[1] * ratio, TINY_NUM), throttle(compareSize[1], TINY_NUM)]].filter(function (size) {\n    return size.every(function (value, i) {\n      var defaultSize = compareSize[i];\n      var throttledSize = throttle(defaultSize, TINY_NUM);\n      return isMax ? value <= defaultSize || value <= throttledSize : value >= defaultSize || value >= throttledSize;\n    });\n  })[0] || targetSize;\n}\n/**\n* calculate bound size\n* @function\n* @memberof Utils\n*/\nfunction calculateBoundSize(size, minSize, maxSize, keepRatio) {\n  if (!keepRatio) {\n    return size.map(function (value, i) {\n      return between(value, minSize[i], maxSize[i]);\n    });\n  }\n  var width = size[0],\n    height = size[1];\n  var ratio = keepRatio === true ? width / height : keepRatio;\n  // width : height = minWidth : minHeight;\n  var _a = checkBoundSize(size, minSize, false, ratio),\n    minWidth = _a[0],\n    minHeight = _a[1];\n  var _b = checkBoundSize(size, maxSize, true, ratio),\n    maxWidth = _b[0],\n    maxHeight = _b[1];\n  if (width < minWidth || height < minHeight) {\n    width = minWidth;\n    height = minHeight;\n  } else if (width > maxWidth || height > maxHeight) {\n    width = maxWidth;\n    height = maxHeight;\n  }\n  return [width, height];\n}\n/**\n* Add all the numbers.\n* @function\n* @memberof Utils\n*/\nfunction sum(nums) {\n  var length = nums.length;\n  var total = 0;\n  for (var i = length - 1; i >= 0; --i) {\n    total += nums[i];\n  }\n  return total;\n}\n/**\n* Average all numbers.\n* @function\n* @memberof Utils\n*/\nfunction average(nums) {\n  var length = nums.length;\n  var total = 0;\n  for (var i = length - 1; i >= 0; --i) {\n    total += nums[i];\n  }\n  return length ? total / length : 0;\n}\n/**\n* Get the angle of two points. (0 <= rad < 359)\n* @function\n* @memberof Utils\n*/\nfunction getRad(pos1, pos2) {\n  var distX = pos2[0] - pos1[0];\n  var distY = pos2[1] - pos1[1];\n  var rad = Math.atan2(distY, distX);\n  return rad >= 0 ? rad : rad + Math.PI * 2;\n}\n/**\n* Get the average point of all points.\n* @function\n* @memberof Utils\n*/\nfunction getCenterPoint(points) {\n  return [0, 1].map(function (i) {\n    return average(points.map(function (pos) {\n      return pos[i];\n    }));\n  });\n}\n/**\n* Gets the direction of the shape.\n* @function\n* @memberof Utils\n*/\nfunction getShapeDirection(points) {\n  var center = getCenterPoint(points);\n  var pos1Rad = getRad(center, points[0]);\n  var pos2Rad = getRad(center, points[1]);\n  return pos1Rad < pos2Rad && pos2Rad - pos1Rad < Math.PI || pos1Rad > pos2Rad && pos2Rad - pos1Rad < -Math.PI ? 1 : -1;\n}\n/**\n* Get the distance between two points.\n* @function\n* @memberof Utils\n*/\nfunction getDist(a, b) {\n  return Math.sqrt(Math.pow((b ? b[0] : 0) - a[0], 2) + Math.pow((b ? b[1] : 0) - a[1], 2));\n}\n/**\n* throttle number depending on the unit.\n* @function\n* @memberof Utils\n*/\nfunction throttle(num, unit) {\n  if (!unit) {\n    return num;\n  }\n  var reverseUnit = 1 / unit;\n  return Math.round(num / unit) / reverseUnit;\n}\n/**\n* throttle number array depending on the unit.\n* @function\n* @memberof Utils\n*/\nfunction throttleArray(nums, unit) {\n  nums.forEach(function (_, i) {\n    nums[i] = throttle(nums[i], unit);\n  });\n  return nums;\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction counter(num) {\n  var nums = [];\n  for (var i = 0; i < num; ++i) {\n    nums.push(i);\n  }\n  return nums;\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction replaceOnce(text, fromText, toText) {\n  var isOnce = false;\n  return text.replace(fromText, function () {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n    if (isOnce) {\n      return args[0];\n    }\n    isOnce = true;\n    return isString(toText) ? toText : toText.apply(void 0, args);\n  });\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction flat(arr) {\n  return arr.reduce(function (prev, cur) {\n    return prev.concat(cur);\n  }, []);\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction deepFlat(arr) {\n  return arr.reduce(function (prev, cur) {\n    if (isArray(cur)) {\n      prev.push.apply(prev, deepFlat(cur));\n    } else {\n      prev.push(cur);\n    }\n    return prev;\n  }, []);\n}\n/**\n * @function\n * @memberof Utils\n */\nfunction pushSet(elements, element) {\n  if (elements.indexOf(element) === -1) {\n    elements.push(element);\n  }\n}\n\n/**\n* @namespace\n* @name Color\n*/\n/**\n* Remove the # from the hex color.\n* @memberof Color\n* @param {} hex - hex color\n* @return {} hex color\n* @example\nimport {cutHex} from \"@daybrush/utils\";\n\nconsole.log(cutHex(\"#000000\")) // \"000000\"\n*/\nfunction cutHex(hex) {\n  return hex.replace(\"#\", \"\");\n}\n/**\n* convert hex color to rgb color.\n* @memberof Color\n* @param {} hex - hex color\n* @return {} rgb color\n* @example\nimport {hexToRGBA} from \"@daybrush/utils\";\n\nconsole.log(hexToRGBA(\"#00000005\"));\n// [0, 0, 0, 1]\nconsole.log(hexToRGBA(\"#201045\"));\n// [32, 16, 69, 1]\n*/\nfunction hexToRGBA(hex) {\n  var h = cutHex(hex);\n  var r = parseInt(h.substring(0, 2), 16);\n  var g = parseInt(h.substring(2, 4), 16);\n  var b = parseInt(h.substring(4, 6), 16);\n  var a = parseInt(h.substring(6, 8), 16) / 255;\n  if (isNaN(a)) {\n    a = 1;\n  }\n  return [r, g, b, a];\n}\n/**\n* convert 3(or 4)-digit hex color to 6(or 8)-digit hex color.\n* @memberof Color\n* @param {} hex - 3(or 4)-digit hex color\n* @return {} 6(or 8)-digit hex color\n* @example\nimport {toFullHex} from \"@daybrush/utils\";\n\nconsole.log(toFullHex(\"#123\")); // \"#112233\"\nconsole.log(toFullHex(\"#123a\")); // \"#112233aa\"\n*/\nfunction toFullHex(h) {\n  var r = h.charAt(1);\n  var g = h.charAt(2);\n  var b = h.charAt(3);\n  var a = h.charAt(4);\n  var arr = [\"#\", r, r, g, g, b, b, a, a];\n  return arr.join(\"\");\n}\n/**\n* convert hsl color to rgba color.\n* @memberof Color\n* @param {} hsl - hsl color(hue: 0 ~ 360, saturation: 0 ~ 1, lightness: 0 ~ 1, alpha: 0 ~ 1)\n* @return {} rgba color\n* @example\nimport {hslToRGBA} from \"@daybrush/utils\";\n\nconsole.log(hslToRGBA([150, 0.5, 0.4]));\n// [51, 153, 102, 1]\n*/\nfunction hslToRGBA(hsl) {\n  var _a;\n  var h = hsl[0];\n  var s = hsl[1];\n  var l = hsl[2];\n  if (h < 0) {\n    h += Math.floor((Math.abs(h) + 360) / 360) * 360;\n  }\n  h %= 360;\n  var c = (1 - Math.abs(2 * l - 1)) * s;\n  var x = c * (1 - Math.abs(h / 60 % 2 - 1));\n  var m = l - c / 2;\n  var rgb;\n  if (h < 60) {\n    rgb = [c, x, 0];\n  } else if (h < 120) {\n    rgb = [x, c, 0];\n  } else if (h < 180) {\n    rgb = [0, c, x];\n  } else if (h < 240) {\n    rgb = [0, x, c];\n  } else if (h < 300) {\n    rgb = [x, 0, c];\n  } else if (h < 360) {\n    rgb = [c, 0, x];\n  } else {\n    rgb = [0, 0, 0];\n  }\n  return [Math.round((rgb[0] + m) * 255), Math.round((rgb[1] + m) * 255), Math.round((rgb[2] + m) * 255), (_a = hsl[3]) !== null && _a !== void 0 ? _a : 1];\n}\n/**\n* convert string to rgba color.\n* @memberof Color\n* @param {} - 3-hex(#000), 4-hex(#0000) 6-hex(#000000), 8-hex(#00000000) or RGB(A), or HSL(A)\n* @return {} rgba color\n* @example\nimport {stringToRGBA} from \"@daybrush/utils\";\n\nconsole.log(stringToRGBA(\"#000000\")); // [0, 0, 0, 1]\nconsole.log(stringToRGBA(\"rgb(100, 100, 100)\")); // [100, 100, 100, 1]\nconsole.log(stringToRGBA(\"hsl(150, 0.5, 0.4)\")); // [51, 153, 102, 1]\n*/\nfunction stringToRGBA(color) {\n  if (color.charAt(0) === \"#\") {\n    if (color.length === 4 || color.length === 5) {\n      return hexToRGBA(toFullHex(color));\n    } else {\n      return hexToRGBA(color);\n    }\n  } else if (color.indexOf(\"(\") !== -1) {\n    // in bracket.\n    var _a = splitBracket(color),\n      prefix = _a.prefix,\n      value = _a.value;\n    if (!prefix || !value) {\n      return undefined;\n    }\n    var arr = splitComma(value);\n    var colorArr = [0, 0, 0, 1];\n    var length = arr.length;\n    switch (prefix) {\n      case RGB:\n      case RGBA:\n        for (var i = 0; i < length; ++i) {\n          colorArr[i] = parseFloat(arr[i]);\n        }\n        return colorArr;\n      case HSL:\n      case HSLA:\n        for (var i = 0; i < length; ++i) {\n          if (arr[i].indexOf(\"%\") !== -1) {\n            colorArr[i] = parseFloat(arr[i]) / 100;\n          } else {\n            colorArr[i] = parseFloat(arr[i]);\n          }\n        }\n        // hsl, hsla to rgba\n        return hslToRGBA(colorArr);\n    }\n  }\n  return undefined;\n}\n\n/**\n * Returns all element descendants of node that\n * match selectors.\n */\n/**\n * Checks if the specified class value exists in the element's class attribute.\n * @memberof DOM\n * @param - A DOMString containing one or more selectors to match\n * @param - If multi is true, a DOMString containing one or more selectors to match against.\n * @example\nimport {$} from \"@daybrush/utils\";\n\nconsole.log($(\"div\")); // div element\nconsole.log($(\"div\", true)); // [div, div] elements\n*/\nfunction $(selectors, multi) {\n  if (!doc) {\n    return multi ? [] : null;\n  }\n  return multi ? doc.querySelectorAll(selectors) : doc.querySelector(selectors);\n}\n/**\n* Checks if the specified class value exists in the element's class attribute.\n* @memberof DOM\n* @param element - target\n* @param className - the class name to search\n* @return {boolean} return false if the class is not found.\n* @example\nimport {hasClass} from \"@daybrush/utils\";\n\nconsole.log(hasClass(element, \"start\")); // true or false\n*/\nfunction hasClass(element, className) {\n  if (element.classList) {\n    return element.classList.contains(className);\n  }\n  return !!element.className.match(new RegExp(\"(\\\\s|^)\" + className + \"(\\\\s|$)\"));\n}\n/**\n* Add the specified class value. If these classe already exist in the element's class attribute they are ignored.\n* @memberof DOM\n* @param element - target\n* @param className - the class name to add\n* @example\nimport {addClass} from \"@daybrush/utils\";\n\naddClass(element, \"start\");\n*/\nfunction addClass(element, className) {\n  if (element.classList) {\n    element.classList.add(className);\n  } else {\n    element.className += \" \" + className;\n  }\n}\n/**\n* Removes the specified class value.\n* @memberof DOM\n* @param element - target\n* @param className - the class name to remove\n* @example\nimport {removeClass} from \"@daybrush/utils\";\n\nremoveClass(element, \"start\");\n*/\nfunction removeClass(element, className) {\n  if (element.classList) {\n    element.classList.remove(className);\n  } else {\n    var reg = new RegExp(\"(\\\\s|^)\" + className + \"(\\\\s|$)\");\n    element.className = element.className.replace(reg, \" \");\n  }\n}\n/**\n* Gets the CSS properties from the element.\n* @memberof DOM\n* @param elements - elements\n* @param properites - the CSS properties\n* @return returns CSS properties and values.\n* @example\nimport {fromCSS} from \"@daybrush/utils\";\n\nconsole.log(fromCSS(element, [\"left\", \"opacity\", \"top\"])); // {\"left\": \"10px\", \"opacity\": 1, \"top\": \"10px\"}\n*/\nfunction fromCSS(elements, properties) {\n  if (!elements || !properties || !properties.length) {\n    return {};\n  }\n  var element;\n  if (elements instanceof Element) {\n    element = elements;\n  } else if (elements.length) {\n    element = elements[0];\n  } else {\n    return {};\n  }\n  var cssObject = {};\n  var styles = getWindow(element).getComputedStyle(element);\n  var length = properties.length;\n  for (var i = 0; i < length; ++i) {\n    cssObject[properties[i]] = styles[properties[i]];\n  }\n  return cssObject;\n}\n/**\n* Sets up a function that will be called whenever the specified event is delivered to the target\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The object which receives a notification (an object that implements the Event interface) when an event of the specified type occurs\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent} from \"@daybrush/utils\";\n\naddEvent(el, \"click\", e => {\n  console.log(e);\n});\n*/\nfunction addEvent(el, type, listener, options) {\n  el.addEventListener(type, listener, options);\n}\n/**\n* removes from the EventTarget an event listener previously registered with EventTarget.addEventListener()\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The EventListener function of the event handler to remove from the event target.\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent, removeEvent} from \"@daybrush/utils\";\nconst listener = e => {\n  console.log(e);\n};\naddEvent(el, \"click\", listener);\nremoveEvent(el, \"click\", listener);\n*/\nfunction removeEvent(el, type, listener, options) {\n  el.removeEventListener(type, listener, options);\n}\nfunction getDocument(el) {\n  return (el === null || el === void 0 ? void 0 : el.ownerDocument) || doc;\n}\nfunction getDocumentElement(el) {\n  return getDocument(el).documentElement;\n}\nfunction getDocumentBody(el) {\n  return getDocument(el).body;\n}\nfunction getWindow(el) {\n  var _a;\n  return ((_a = el === null || el === void 0 ? void 0 : el.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView) || window;\n}\nfunction isWindow(val) {\n  return val && \"postMessage\" in val && \"blur\" in val && \"self\" in val;\n}\nfunction isNode(el) {\n  return isObject(el) && el.nodeName && el.nodeType && \"ownerDocument\" in el;\n}\n\nexport { RGB, RGBA, HSL, HSLA, COLOR_MODELS, FUNCTION, PROPERTY, ARRAY, OBJECT, STRING, NUMBER, UNDEFINED, IS_WINDOW, doc as document, getCrossBrowserProperty, TRANSFORM, FILTER, ANIMATION, KEYFRAMES, OPEN_CLOSED_CHARACTERS, TINY_NUM, REVERSE_TINY_NUM, DEFAULT_UNIT_PRESETS, cutHex, hexToRGBA, toFullHex, hslToRGBA, stringToRGBA, dot, isUndefined, isObject, isArray, isString, isNumber, isFunction, splitText, splitSpace, splitComma, splitBracket, splitUnit, camelize, decamelize, toArray, now, findIndex, findLastIndex, findLast, find, requestAnimationFrame, cancelAnimationFrame, getKeys, getValues, getEntries, sortOrders, convertUnitSize, between, checkBoundSize, calculateBoundSize, sum, average, getRad, getCenterPoint, getShapeDirection, getDist, throttle, throttleArray, counter, replaceOnce, flat, deepFlat, pushSet, $, hasClass, addClass, removeClass, fromCSS, addEvent, removeEvent, getDocument, getDocumentElement, getDocumentBody, getWindow, isWindow, isNode };\n//# sourceMappingURL=utils.esm.js.map\n","/*\nCopyright (c) 2019-present NAVER Corp.\nname: @egjs/list-differ\nlicense: MIT\nauthor: NAVER Corp.\nrepository: https://github.com/naver/egjs-list-differ\nversion: 1.0.0\n*/\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar PolyMap =\n/*#__PURE__*/\nfunction () {\n  function PolyMap() {\n    this.keys = [];\n    this.values = [];\n  }\n\n  var __proto = PolyMap.prototype;\n\n  __proto.get = function (key) {\n    return this.values[this.keys.indexOf(key)];\n  };\n\n  __proto.set = function (key, value) {\n    var keys = this.keys;\n    var values = this.values;\n    var prevIndex = keys.indexOf(key);\n    var index = prevIndex === -1 ? keys.length : prevIndex;\n    keys[index] = key;\n    values[index] = value;\n  };\n\n  return PolyMap;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar HashMap =\n/*#__PURE__*/\nfunction () {\n  function HashMap() {\n    this.object = {};\n  }\n\n  var __proto = HashMap.prototype;\n\n  __proto.get = function (key) {\n    return this.object[key];\n  };\n\n  __proto.set = function (key, value) {\n    this.object[key] = value;\n  };\n\n  return HashMap;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar SUPPORT_MAP = typeof Map === \"function\";\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar Link =\n/*#__PURE__*/\nfunction () {\n  function Link() {}\n\n  var __proto = Link.prototype;\n\n  __proto.connect = function (prevLink, nextLink) {\n    this.prev = prevLink;\n    this.next = nextLink;\n    prevLink && (prevLink.next = this);\n    nextLink && (nextLink.prev = this);\n  };\n\n  __proto.disconnect = function () {\n    // In double linked list, diconnect the interconnected relationship.\n    var prevLink = this.prev;\n    var nextLink = this.next;\n    prevLink && (prevLink.next = nextLink);\n    nextLink && (nextLink.prev = prevLink);\n  };\n\n  __proto.getIndex = function () {\n    var link = this;\n    var index = -1;\n\n    while (link) {\n      link = link.prev;\n      ++index;\n    }\n\n    return index;\n  };\n\n  return Link;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n\nfunction orderChanged(changed, fixed) {\n  // It is roughly in the order of these examples.\n  // 4, 6, 0, 2, 1, 3, 5, 7\n  var fromLinks = []; // 0, 1, 2, 3, 4, 5, 6, 7\n\n  var toLinks = [];\n  changed.forEach(function (_a) {\n    var from = _a[0],\n        to = _a[1];\n    var link = new Link();\n    fromLinks[from] = link;\n    toLinks[to] = link;\n  }); // `fromLinks` are connected to each other by double linked list.\n\n  fromLinks.forEach(function (link, i) {\n    link.connect(fromLinks[i - 1]);\n  });\n  return changed.filter(function (_, i) {\n    return !fixed[i];\n  }).map(function (_a, i) {\n    var from = _a[0],\n        to = _a[1];\n\n    if (from === to) {\n      return [0, 0];\n    }\n\n    var fromLink = fromLinks[from];\n    var toLink = toLinks[to - 1];\n    var fromIndex = fromLink.getIndex(); // Disconnect the link connected to `fromLink`.\n\n    fromLink.disconnect(); // Connect `fromLink` to the right of `toLink`.\n\n    if (!toLink) {\n      fromLink.connect(undefined, fromLinks[0]);\n    } else {\n      fromLink.connect(toLink, toLink.next);\n    }\n\n    var toIndex = fromLink.getIndex();\n    return [fromIndex, toIndex];\n  });\n}\n\nvar Result =\n/*#__PURE__*/\nfunction () {\n  function Result(prevList, list, added, removed, changed, maintained, changedBeforeAdded, fixed) {\n    this.prevList = prevList;\n    this.list = list;\n    this.added = added;\n    this.removed = removed;\n    this.changed = changed;\n    this.maintained = maintained;\n    this.changedBeforeAdded = changedBeforeAdded;\n    this.fixed = fixed;\n  }\n\n  var __proto = Result.prototype;\n  Object.defineProperty(__proto, \"ordered\", {\n    get: function () {\n      if (!this.cacheOrdered) {\n        this.caculateOrdered();\n      }\n\n      return this.cacheOrdered;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(__proto, \"pureChanged\", {\n    get: function () {\n      if (!this.cachePureChanged) {\n        this.caculateOrdered();\n      }\n\n      return this.cachePureChanged;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  __proto.caculateOrdered = function () {\n    var ordered = orderChanged(this.changedBeforeAdded, this.fixed);\n    var changed = this.changed;\n    var pureChanged = [];\n    this.cacheOrdered = ordered.filter(function (_a, i) {\n      var from = _a[0],\n          to = _a[1];\n      var _b = changed[i],\n          fromBefore = _b[0],\n          toBefore = _b[1];\n\n      if (from !== to) {\n        pureChanged.push([fromBefore, toBefore]);\n        return true;\n      }\n    });\n    this.cachePureChanged = pureChanged;\n  };\n\n  return Result;\n}();\n\n/**\n *\n * @memberof eg.ListDiffer\n * @static\n * @function\n * @param - Previous List <ko>   </ko>\n * @param - List to Update <ko>    </ko>\n * @param - This callback function returns the key of the item. <ko>     .</ko>\n * @return - Returns the diff between `prevList` and `list` <ko> `prevList` `list`   .</ko>\n * @example\n * import { diff } from \"@egjs/list-differ\";\n * // script => eg.ListDiffer.diff\n * const result = diff([0, 1, 2, 3, 4, 5], [7, 8, 0, 4, 3, 6, 2, 1], e => e);\n * // List before update\n * // [1, 2, 3, 4, 5]\n * console.log(result.prevList);\n * // Updated list\n * // [4, 3, 6, 2, 1]\n * console.log(result.list);\n * // Index array of values added to `list`\n * // [0, 1, 5]\n * console.log(result.added);\n * // Index array of values removed in `prevList`\n * // [5]\n * console.log(result.removed);\n * // An array of index pairs of `prevList` and `list` with different indexes from `prevList` and `list`\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.changed);\n * // The subset of `changed` and an array of index pairs that moved data directly. Indicate an array of absolute index pairs of `ordered`.(Formatted by: Array<[index of prevList, index of list]>)\n * // [[4, 3], [3, 4], [2, 6]]\n * console.log(result.pureChanged);\n * // An array of index pairs to be `ordered` that can synchronize `list` before adding data. (Formatted by: Array<[prevIndex, nextIndex]>)\n * // [[4, 1], [4, 2], [4, 3]]\n * console.log(result.ordered);\n * // An array of index pairs of `prevList` and `list` that have not been added/removed so data is preserved\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.maintained);\n */\n\nfunction diff(prevList, list, findKeyCallback) {\n  var mapClass = SUPPORT_MAP ? Map : findKeyCallback ? HashMap : PolyMap;\n\n  var callback = findKeyCallback || function (e) {\n    return e;\n  };\n\n  var added = [];\n  var removed = [];\n  var maintained = [];\n  var prevKeys = prevList.map(callback);\n  var keys = list.map(callback);\n  var prevKeyMap = new mapClass();\n  var keyMap = new mapClass();\n  var changedBeforeAdded = [];\n  var fixed = [];\n  var removedMap = {};\n  var changed = [];\n  var addedCount = 0;\n  var removedCount = 0; // Add prevKeys and keys to the hashmap.\n\n  prevKeys.forEach(function (key, prevListIndex) {\n    prevKeyMap.set(key, prevListIndex);\n  });\n  keys.forEach(function (key, listIndex) {\n    keyMap.set(key, listIndex);\n  }); // Compare `prevKeys` and `keys` and add them to `removed` if they are not in `keys`.\n\n  prevKeys.forEach(function (key, prevListIndex) {\n    var listIndex = keyMap.get(key); // In prevList, but not in list, it is removed.\n\n    if (typeof listIndex === \"undefined\") {\n      ++removedCount;\n      removed.push(prevListIndex);\n    } else {\n      removedMap[listIndex] = removedCount;\n    }\n  }); // Compare `prevKeys` and `keys` and add them to `added` if they are not in `prevKeys`.\n\n  keys.forEach(function (key, listIndex) {\n    var prevListIndex = prevKeyMap.get(key); // In list, but not in prevList, it is added.\n\n    if (typeof prevListIndex === \"undefined\") {\n      added.push(listIndex);\n      ++addedCount;\n    } else {\n      maintained.push([prevListIndex, listIndex]);\n      removedCount = removedMap[listIndex] || 0;\n      changedBeforeAdded.push([prevListIndex - removedCount, listIndex - addedCount]);\n      fixed.push(listIndex === prevListIndex);\n\n      if (prevListIndex !== listIndex) {\n        changed.push([prevListIndex, listIndex]);\n      }\n    }\n  }); // Sort by ascending order of 'to(list's index).\n\n  removed.reverse();\n  return new Result(prevList, list, added, removed, changed, maintained, changedBeforeAdded, fixed);\n}\n\n/**\n * A module that checks diff when values are added, removed, or changed in an array.\n * @ko          .\n * @memberof eg\n */\n\nvar ListDiffer =\n/*#__PURE__*/\nfunction () {\n  /**\n   * @param - Initializing Data Array. <ko>    .</ko>\n   * @param - This callback function returns the key of the item. <ko>     .</ko>\n   * @example\n   * import ListDiffer from \"@egjs/list-differ\";\n   * // script => eg.ListDiffer\n   * const differ = new ListDiffer([0, 1, 2, 3, 4, 5], e => e);\n   * const result = differ.update([7, 8, 0, 4, 3, 6, 2, 1]);\n   * // List before update\n   * // [1, 2, 3, 4, 5]\n   * console.log(result.prevList);\n   * // Updated list\n   * // [4, 3, 6, 2, 1]\n   * console.log(result.list);\n   * // Index array of values added to `list`.\n   * // [0, 1, 5]\n   * console.log(result.added);\n   * // Index array of values removed in `prevList`.\n   * // [5]\n   * console.log(result.removed);\n   * // An array of index pairs of `prevList` and `list` with different indexes from `prevList` and `list`.\n   * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n   * console.log(result.changed);\n   * // The subset of `changed` and an array of index pairs that moved data directly. Indicate an array of absolute index pairs of `ordered`.(Formatted by: Array<[index of prevList, index of list]>)\n   * // [[4, 3], [3, 4], [2, 6]]\n   * console.log(result.pureChanged);\n   * // An array of index pairs to be `ordered` that can synchronize `list` before adding data. (Formatted by: Array<[prevIndex, nextIndex]>)\n   * // [[4, 1], [4, 2], [4, 3]]\n   * console.log(result.ordered);\n   * // An array of index pairs of `prevList` and `list` that have not been added/removed so data is preserved.\n   * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n   * console.log(result.maintained);\n   */\n  function ListDiffer(list, findKeyCallback) {\n    if (list === void 0) {\n      list = [];\n    }\n\n    this.findKeyCallback = findKeyCallback;\n    this.list = [].slice.call(list);\n  }\n  /**\n   * Update list.\n   * @ko   .\n   * @param - List to update <ko>   </ko>\n   * @return - Returns the results of an update from `prevList` to `list`.<ko> `prevList` `list`   . </ko>\n   */\n\n\n  var __proto = ListDiffer.prototype;\n\n  __proto.update = function (list) {\n    var newData = [].slice.call(list);\n    var result = diff(this.list, newData, this.findKeyCallback);\n    this.list = newData;\n    return result;\n  };\n\n  return ListDiffer;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n\nexport default ListDiffer;\nexport { diff };\n//# sourceMappingURL=list-differ.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: croact\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/croact.git\nversion: 1.0.4\n*/\nimport { isNode, isArray, isUndefined, getValues, find, isString, removeEvent, addEvent, getDocument, getKeys, decamelize, flat as flat$1, isNumber, pushSet, isFunction, getEntries } from '@daybrush/utils';\nimport { diff } from '@egjs/list-differ';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nfunction fillKeys(keys) {\n  var index = 0;\n  return keys.map(function (key) {\n    return key == null ? \"$compat\".concat(++index) : \"\".concat(key);\n  });\n}\nfunction flat(arr) {\n  var arr2 = [];\n  arr.forEach(function (el) {\n    arr2 = arr2.concat(isArray(el) ? flat(el) : el);\n  });\n  return arr2;\n}\nfunction fillProps(props, defaultProps) {\n  if (!defaultProps) {\n    return props;\n  }\n  for (var name_1 in defaultProps) {\n    if (isUndefined(props[name_1])) {\n      props[name_1] = defaultProps[name_1];\n    }\n  }\n  return props;\n}\nfunction isDiff(a, b) {\n  if (a === b) {\n    return false;\n  }\n  for (var i in a) {\n    if (!(i in b)) {\n      return true;\n    }\n  }\n  for (var i in b) {\n    if (a[i] !== b[i]) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction getAttributes(props) {\n  var className = props.className,\n    otherProps = __rest(props, [\"className\"]);\n  if (className != null) {\n    otherProps.class = className;\n  }\n  delete otherProps.style;\n  delete otherProps.children;\n  return otherProps;\n}\nfunction splitProps(props) {\n  var attributes = {};\n  var events = {};\n  for (var name_2 in props) {\n    if (name_2.indexOf(\"on\") === 0) {\n      events[name_2] = props[name_2];\n    } else {\n      attributes[name_2] = props[name_2];\n    }\n  }\n  return [attributes, events];\n}\nfunction findContainerNode(provider) {\n  if (!provider) {\n    return null;\n  }\n  var base = provider.b;\n  if (isNode(base)) {\n    return base;\n  }\n  return findContainerNode(provider.c);\n}\nfunction removeNode(node) {\n  var parentNode = node.parentNode;\n  if (parentNode) {\n    parentNode.removeChild(node);\n  }\n}\nfunction executeHooks(hooks) {\n  hooks.forEach(function (hook) {\n    hook();\n  });\n}\nfunction renderFunctionComponent() {\n  return this.constructor(this.props, this.context);\n}\n\nvar hooksIndex = 0;\nvar Provider = /*#__PURE__*/function () {\n  function Provider(\n  /**\n   * Type\n   */\n  t,\n  /**\n   * Depth\n   */\n  d,\n  /**\n   * Key\n   */\n  k,\n  /**\n   * index\n   */\n  i,\n  /**\n   * Container\n   */\n  c,\n  /**\n   * Ref\n   */\n  ref,\n  /**\n   * Props\n   */\n  ps) {\n    if (ps === void 0) {\n      ps = {};\n    }\n    this.t = t;\n    this.d = d;\n    this.k = k;\n    this.i = i;\n    this.c = c;\n    this.ref = ref;\n    this.ps = ps;\n    this.typ = \"prov\";\n    /**\n     * providers\n     */\n    this._ps = [];\n    /**\n     * Contexts\n     */\n    this._cs = {};\n    /**\n     * Whether to hydrate\n     */\n    this._hyd = null;\n    /**\n     * is self render\n     */\n    this._sel = false;\n  }\n  var __proto = Provider.prototype;\n  __proto.s = function () {\n    return true;\n  };\n  /**\n   * Update\n   */\n  __proto.u = function (hooks, contexts, nextElement, nextState, isForceUpdate) {\n    var self = this;\n    var currentDepth = self.d;\n    var scheduledContexts = getValues(contexts).filter(function (context) {\n      return context.$_req;\n    });\n    var scheduledSubs = flat(scheduledContexts.map(function (context) {\n      return context.$_subs;\n    }));\n    var isContextUpdate = find(scheduledSubs, function (provider) {\n      return provider.d === currentDepth;\n    });\n    if (self.b && !isString(nextElement) && !isForceUpdate && !self.s(nextElement.props, nextState) && !isContextUpdate) {\n      var nextChildSubs = scheduledSubs.reduce(function (childs, sub) {\n        var depth = sub.d;\n        if (childs[0]) {\n          if (childs[0].d === depth) {\n            childs.push(sub);\n          }\n        } else if (depth > currentDepth) {\n          childs.push(sub);\n        }\n        return childs;\n      }, []);\n      nextChildSubs.forEach(function (child) {\n        // provider.container!,\n        // [provider],\n        // [provider.original],\n        // hooks,\n        // provider._cs,\n        // { ...self.state, ...self.$_state },\n        // isForceUpdate,\n        renderProviders(child, child._ps, [child.o], hooks, contexts, true);\n      });\n      return false;\n    }\n    self.o = nextElement;\n    self.ss(nextState);\n    // render\n    var prevProps = self.ps;\n    if (!isString(nextElement)) {\n      self.ps = nextElement.props;\n      self.ref = nextElement.ref;\n    }\n    setCurrentInstance(this);\n    self.r(hooks, contexts, self.b ? prevProps : {}, nextState);\n    return true;\n  };\n  __proto.md = function () {\n    this.rr();\n  };\n  __proto.ss = function () {\n    return;\n  };\n  __proto.ud = function () {\n    this.rr();\n  };\n  /**\n   * register refs\n   */\n  __proto.rr = function () {\n    var self = this;\n    var ref = self.ref;\n    var fr = self.fr;\n    ref && ref(fr ? fr.current : self.b);\n  };\n  return Provider;\n}();\nfunction getCurrentInstance() {\n  return Object.__CROACT_CURRENT_INSTNACE__;\n}\nfunction getHooksIndex() {\n  return hooksIndex;\n}\nfunction setHooksInex(nextHooksIndex) {\n  hooksIndex = nextHooksIndex;\n}\nfunction setCurrentInstance(provider) {\n  Object.__CROACT_CURRENT_INSTNACE__ = provider;\n  hooksIndex = 0;\n  return provider;\n}\n\nvar Component = /*#__PURE__*/function () {\n  function Component(props, context) {\n    if (props === void 0) {\n      props = {};\n    }\n    this.props = props;\n    this.context = context;\n    this.state = {};\n    this.$_timer = 0;\n    this.$_state = {};\n    this.$_subs = [];\n    this.$_cs = {};\n  }\n  var __proto = Component.prototype;\n  __proto.render = function () {\n    return null;\n  };\n  __proto.shouldComponentUpdate = function (props, state) {\n    return this.props !== props || this.state !== state;\n  };\n  __proto.setState = function (state, callback, isForceUpdate) {\n    var self = this;\n    if (!self.$_timer) {\n      self.$_state = {};\n    }\n    clearTimeout(self.$_timer);\n    self.$_timer = 0;\n    self.$_state = __assign(__assign({}, self.$_state), state);\n    if (!isForceUpdate) {\n      self.$_timer = window.setTimeout(function () {\n        self.$_timer = 0;\n        self.$_setState(callback, isForceUpdate);\n      });\n    } else {\n      self.$_setState(callback, isForceUpdate);\n    }\n    return;\n  };\n  __proto.forceUpdate = function (callback) {\n    this.setState({}, callback, true);\n  };\n  __proto.componentDidMount = function () {};\n  __proto.componentDidUpdate = function (prevProps, prevState) {};\n  __proto.componentWillUnmount = function () {};\n  __proto.$_setState = function (callback, isForceUpdate) {\n    var hooks = [];\n    var provider = this.$_p;\n    var isUpdate = renderProviders(provider.c, [provider], [provider.o], hooks, provider._cs, __assign(__assign({}, this.state), this.$_state), isForceUpdate);\n    if (isUpdate) {\n      if (callback) {\n        hooks.push(callback);\n      }\n      executeHooks(hooks);\n      setCurrentInstance(null);\n    }\n  };\n  return Component;\n}();\nvar PureComponent = /*#__PURE__*/function (_super) {\n  __extends(PureComponent, _super);\n  function PureComponent() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  var __proto = PureComponent.prototype;\n  __proto.shouldComponentUpdate = function (props, state) {\n    return isDiff(this.props, props) || isDiff(this.state, state);\n  };\n  return PureComponent;\n}(Component);\n\nfunction createRef(defaultValue) {\n  var refCallback = function (e) {\n    refCallback.current = e;\n  };\n  refCallback.current = defaultValue;\n  return refCallback;\n}\nfunction forwardRef(func) {\n  func._fr = true;\n  return func;\n}\n\nfunction createComponent(type, props, contextValue, self) {\n  var _a;\n  var base;\n  if ((_a = type === null || type === void 0 ? void 0 : type.prototype) === null || _a === void 0 ? void 0 : _a.render) {\n    base = new type(props, contextValue);\n  } else {\n    base = new Component(props, contextValue);\n    base.constructor = type;\n    if (type._fr) {\n      self.fr = createRef();\n      base.render = function () {\n        return this.constructor(this.props, self.fr);\n      };\n    } else {\n      base.render = renderFunctionComponent;\n    }\n  }\n  base.$_p = self;\n  return base;\n}\nvar ComponentProvider = /*#__PURE__*/function (_super) {\n  __extends(ComponentProvider, _super);\n  function ComponentProvider(type, depth, key, index, container, ref, props) {\n    if (props === void 0) {\n      props = {};\n    }\n    var _this = _super.call(this, type, depth, key, index, container, ref, fillProps(props, type.defaultProps)) || this;\n    _this.typ = \"comp\";\n    /**\n     * Update shift effects\n     */\n    _this._usefs = [];\n    /**\n     * Update effects\n     */\n    _this._uefs = [];\n    /**\n     * Destroy effects\n     */\n    _this._defs = [];\n    return _this;\n  }\n  var __proto = ComponentProvider.prototype;\n  __proto.s = function (nextProps, nextState) {\n    var base = this.b;\n    return base.shouldComponentUpdate(fillProps(nextProps, this.t.defaultProps), nextState || base.state) !== false;\n  };\n  __proto.r = function (hooks, contexts, prevProps) {\n    var _a, _b;\n    var self = this;\n    var type = self.t;\n    self.ps = fillProps(self.ps, self.t.defaultProps);\n    var props = self.ps;\n    var isMount = !self.b;\n    var contextType = type.contextType;\n    var base = self.b;\n    var contextValue = contextType === null || contextType === void 0 ? void 0 : contextType.get(self);\n    self._cs = contexts;\n    if (isMount) {\n      base = createComponent(type, props, contextValue, self);\n      self.b = base;\n    } else {\n      base.props = props;\n      base.context = contextValue;\n    }\n    var prevState = base.state;\n    self._usefs = [];\n    self._uefs = [];\n    var template = base.render();\n    if (((_b = (_a = template === null || template === void 0 ? void 0 : template.props) === null || _a === void 0 ? void 0 : _a.children) === null || _b === void 0 ? void 0 : _b.length) === 0) {\n      template.props.children = self.ps.children;\n    }\n    var nextContexts = __assign(__assign({}, contexts), base.$_cs);\n    renderProviders(self, self._ps, template ? [template] : [], hooks, nextContexts);\n    if (isMount) {\n      self._uefs.push(function () {\n        contextType === null || contextType === void 0 ? void 0 : contextType.register(self);\n        base.componentDidMount();\n      });\n    } else {\n      self._uefs.push(function () {\n        base.componentDidUpdate(prevProps, prevState);\n      });\n    }\n    hooks.push(function () {\n      self._usefs.forEach(function (ef) {\n        ef();\n      });\n      if (isMount) {\n        self.md();\n      } else {\n        self.ud();\n      }\n      self._defs = self._uefs.map(function (ef) {\n        return ef();\n      });\n    });\n  };\n  __proto.ss = function (nextState) {\n    var base = this.b;\n    if (!base || !nextState) {\n      return;\n    }\n    base.state = nextState;\n  };\n  __proto.un = function () {\n    var _a;\n    var self = this;\n    self._ps.forEach(function (provider) {\n      provider.un();\n    });\n    var type = self.t;\n    (_a = type.contextType) === null || _a === void 0 ? void 0 : _a.unregister(self);\n    clearTimeout(self.b.$_timer);\n    self._defs.forEach(function (def) {\n      def && def();\n    });\n    self.b.componentWillUnmount();\n  };\n  return ComponentProvider;\n}(Provider);\n\nfunction diffAttributes(attrs1, attrs2, el) {\n  var _a = diffObject(getAttributes(attrs1), getAttributes(attrs2)),\n    added = _a.added,\n    removed = _a.removed,\n    changed = _a.changed;\n  for (var name_1 in added) {\n    el.setAttribute(name_1, added[name_1]);\n  }\n  for (var name_2 in changed) {\n    el.setAttribute(name_2, changed[name_2][1]);\n  }\n  for (var name_3 in removed) {\n    el.removeAttribute(name_3);\n  }\n}\nfunction diffEvents(events1, events2, provier) {\n  var _a = diffObject(events1, events2),\n    added = _a.added,\n    removed = _a.removed;\n  for (var name_4 in removed) {\n    provier.e(name_4, true);\n  }\n  for (var name_5 in added) {\n    provier.e(name_5);\n  }\n}\nfunction diffObject(a, b) {\n  var keys1 = getKeys(a);\n  var keys2 = getKeys(b);\n  var result = diff(keys1, keys2, function (key) {\n    return key;\n  });\n  var added = {};\n  var removed = {};\n  var changed = {};\n  result.added.forEach(function (index) {\n    var name = keys2[index];\n    added[name] = b[name];\n  });\n  result.removed.forEach(function (index) {\n    var name = keys1[index];\n    removed[name] = a[name];\n  });\n  result.maintained.forEach(function (_a) {\n    var index = _a[0];\n    var name = keys1[index];\n    var values = [a[name], b[name]];\n    if (a[name] !== b[name]) {\n      changed[name] = values;\n    }\n  });\n  return {\n    added: added,\n    removed: removed,\n    changed: changed\n  };\n}\nfunction diffStyle(style1, style2, el) {\n  var style = el.style;\n  var _a = diffObject(style1, style2),\n    added = _a.added,\n    removed = _a.removed,\n    changed = _a.changed;\n  for (var beforeName in added) {\n    var name_6 = decamelize(beforeName, \"-\");\n    style.setProperty(name_6, added[beforeName]);\n  }\n  for (var beforeName in changed) {\n    var name_7 = decamelize(beforeName, \"-\");\n    style.setProperty(name_7, changed[beforeName][1]);\n  }\n  for (var beforeName in removed) {\n    var name_8 = decamelize(beforeName, \"-\");\n    style.removeProperty(name_8);\n  }\n}\nfunction getNativeEventName(name) {\n  return name.replace(/^on/g, \"\").toLowerCase();\n}\nvar ElementProvider = /*#__PURE__*/function (_super) {\n  __extends(ElementProvider, _super);\n  function ElementProvider() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.typ = \"elem\";\n    /**\n     * Events\n     */\n    _this._es = {};\n    /**\n     * is svg\n     */\n    _this._svg = false;\n    return _this;\n  }\n  var __proto = ElementProvider.prototype;\n  __proto.e = function (name, isRemove) {\n    var self = this;\n    var events = self._es;\n    var base = self.b;\n    var eventName = getNativeEventName(name);\n    if (isRemove) {\n      removeEvent(base, eventName, events[name]);\n      delete events[name];\n    } else {\n      events[name] = function (e) {\n        var _a, _b;\n        (_b = (_a = self.ps)[name]) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n      };\n      addEvent(base, eventName, events[name]);\n    }\n  };\n  __proto.s = function (nextProps) {\n    return isDiff(this.ps, nextProps);\n  };\n  __proto.r = function (hooks, contextValues, prevProps) {\n    var _a;\n    var self = this;\n    var isMount = !self.b;\n    var nextProps = self.ps;\n    if (isMount) {\n      var containerNode = findContainerNode(self.c);\n      var isSVG = false;\n      if (self._svg || self.t === \"svg\") {\n        isSVG = true;\n      } else {\n        isSVG = containerNode && containerNode.ownerSVGElement;\n      }\n      self._svg = isSVG;\n      var element = (_a = self._hyd) === null || _a === void 0 ? void 0 : _a.splice(0, 1)[0];\n      var type = self.t;\n      if (element) {\n        self._hyd = [].slice.call(element.children || []);\n      } else {\n        var doc = getDocument(containerNode);\n        if (isSVG) {\n          element = doc.createElementNS(\"http://www.w3.org/2000/svg\", type);\n        } else {\n          element = doc.createElement(type);\n        }\n      }\n      self.b = element;\n    }\n    renderProviders(self, self._ps, nextProps.children, hooks, contextValues);\n    var base = self.b;\n    var _b = splitProps(prevProps),\n      prevAttributes = _b[0],\n      prevEvents = _b[1];\n    var _c = splitProps(nextProps),\n      nextAttributes = _c[0],\n      nextEvents = _c[1];\n    diffAttributes(prevAttributes, nextAttributes, base);\n    diffEvents(prevEvents, nextEvents, self);\n    diffStyle(prevProps.style || {}, nextProps.style || {}, base);\n    hooks.push(function () {\n      if (isMount) {\n        self.md();\n      } else {\n        self.ud();\n      }\n    });\n    return true;\n  };\n  __proto.un = function () {\n    var self = this;\n    var events = self._es;\n    var base = self.b;\n    for (var name_9 in events) {\n      removeEvent(base, name_9, events[name_9]);\n    }\n    self._ps.forEach(function (provider) {\n      provider.un();\n    });\n    self._es = {};\n    if (!self._sel) {\n      removeNode(base);\n    }\n  };\n  return ElementProvider;\n}(Provider);\n\nfunction findDOMNode(comp) {\n  if (!comp || isNode(comp)) {\n    return comp;\n  }\n  var providers = comp.$_p._ps;\n  if (!providers.length) {\n    return null;\n  }\n  return findDOMNode(providers[0].b);\n}\nfunction findNodeProvider(provider) {\n  if (!provider) {\n    return;\n  }\n  if (provider.b && isNode(provider.b)) {\n    return provider;\n  }\n  var providers = provider._ps;\n  if (!providers.length) {\n    return null;\n  }\n  return findNodeProvider(providers[0]);\n}\nfunction createElement(type, props) {\n  var children = [];\n  for (var _i = 2; _i < arguments.length; _i++) {\n    children[_i - 2] = arguments[_i];\n  }\n  var _a = props || {},\n    key = _a.key,\n    ref = _a.ref,\n    otherProps = __rest(_a, [\"key\", \"ref\"]);\n  return {\n    type: type,\n    key: key,\n    ref: ref,\n    props: __assign(__assign({}, otherProps), {\n      children: flat$1(children).filter(function (child) {\n        return child != null && child !== false;\n      })\n    })\n  };\n}\n\nvar ContainerProvider = /*#__PURE__*/function (_super) {\n  __extends(ContainerProvider, _super);\n  function ContainerProvider(base, depth) {\n    if (depth === void 0) {\n      depth = 0;\n    }\n    var _this = _super.call(this, \"container\", depth, \"container\", 0, null) || this;\n    _this.typ = \"container\";\n    _this.b = base;\n    return _this;\n  }\n  var __proto = ContainerProvider.prototype;\n  __proto.r = function () {\n    return true;\n  };\n  __proto.un = function () {\n    return;\n  };\n  return ContainerProvider;\n}(Provider);\nvar TextProvider = /*#__PURE__*/function (_super) {\n  __extends(TextProvider, _super);\n  function TextProvider() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.typ = \"text\";\n    return _this;\n  }\n  var __proto = TextProvider.prototype;\n  __proto.r = function (hooks) {\n    var _a;\n    var self = this;\n    var isMount = !self.b;\n    if (isMount) {\n      var containerNode = findContainerNode(self.c);\n      var b = (_a = self._hyd) === null || _a === void 0 ? void 0 : _a.splice(0, 1)[0];\n      self.b = b || getDocument(containerNode).createTextNode(self.t.replace(\"text_\", \"\"));\n    }\n    hooks.push(function () {\n      if (isMount) {\n        self.md();\n      } else {\n        self.ud();\n      }\n    });\n    return true;\n  };\n  __proto.un = function () {\n    removeNode(this.b);\n  };\n  return TextProvider;\n}(Provider);\nfunction diffProviders(containerProvider, providers, children) {\n  var childrenKeys = children.map(function (p) {\n    return isString(p) ? null : p.key;\n  });\n  var keys1 = fillKeys(providers.map(function (p) {\n    return p.k;\n  }));\n  var keys2 = fillKeys(childrenKeys);\n  var result = diff(keys1, keys2, function (key) {\n    return key;\n  });\n  result.removed.forEach(function (index) {\n    providers.splice(index, 1)[0].un();\n  });\n  result.ordered.forEach(function (_a) {\n    var from = _a[0],\n      to = _a[1];\n    var childrenProvider = providers.splice(from, 1)[0];\n    providers.splice(to, 0, childrenProvider);\n    var el = findDOMNode(childrenProvider.b);\n    var next = findDOMNode(providers[to + 1] && providers[to + 1].b);\n    if (el) {\n      el.parentNode.insertBefore(el, next);\n    }\n  });\n  result.added.forEach(function (index) {\n    providers.splice(index, 0, createProvider(children[index], childrenKeys[index], index, containerProvider));\n  });\n  var changed = result.maintained.filter(function (_a) {\n    _a[0];\n      var to = _a[1];\n    var el = children[to];\n    var childProvider = providers[to];\n    var type = isString(el) ? \"text_\".concat(el) : el.type;\n    if (type !== childProvider.t) {\n      childProvider.un();\n      providers.splice(to, 1, createProvider(el, childrenKeys[to], to, containerProvider));\n      return true;\n    }\n    childProvider.i = to;\n    return false;\n  });\n  return __spreadArray(__spreadArray([], result.added, true), changed.map(function (_a) {\n    _a[0];\n      var to = _a[1];\n    return to;\n  }), true);\n}\n\nfunction getNextSibiling(provider, childProvider) {\n  var childProviders = provider._ps;\n  var length = childProviders.length;\n  for (var i = childProvider.i + 1; i < length; ++i) {\n    var el = findDOMNode(childProviders[i].b);\n    if (el) {\n      return el;\n    }\n  }\n  return null;\n}\nfunction createProvider(el, key, index, containerProvider) {\n  var depth = containerProvider.d + 1;\n  if (isString(el) || isNumber(el)) {\n    return new TextProvider(\"text_\".concat(el), depth, key, index, containerProvider, null, {});\n  }\n  var type = el.type;\n  var providerClass = typeof type === \"string\" ? ElementProvider : ComponentProvider;\n  return new providerClass(type, depth, key, index, containerProvider, el.ref, el.props);\n}\nfunction renderProviders(containerProvider, providers, children, updatedHooks, nextContexts, nextState, isForceUpdate) {\n  var result = diffProviders(containerProvider, providers, children);\n  var hyd = containerProvider._hyd;\n  var updated = providers.filter(function (childProvider, i) {\n    childProvider._hyd = hyd;\n    return childProvider.u(updatedHooks, nextContexts, children[i], nextState, isForceUpdate);\n  });\n  if (containerProvider.typ === \"container\" && containerProvider._sel) {\n    providers.forEach(function (provider) {\n      var nodeProvider = findNodeProvider(provider);\n      if (nodeProvider) {\n        nodeProvider._sel = true;\n      }\n    });\n  }\n  containerProvider._hyd = null;\n  var containerNode = findContainerNode(containerProvider);\n  if (containerNode) {\n    result.reverse().forEach(function (index) {\n      var childProvider = providers[index];\n      var el = findDOMNode(childProvider.b);\n      if (!el) {\n        return;\n      }\n      if (containerNode !== el && !el.parentNode) {\n        var nextElement = getNextSibiling(containerProvider, childProvider);\n        containerNode.insertBefore(el, nextElement);\n      }\n    });\n  }\n  return updated.length > 0;\n}\nfunction renderProvider(element, container, provider, contexts) {\n  if (provider === void 0) {\n    provider = container.__CROACT__;\n  }\n  if (contexts === void 0) {\n    contexts = {};\n  }\n  var isProvider = !!provider;\n  if (!provider) {\n    provider = new ContainerProvider(container);\n  }\n  var hooks = [];\n  renderProviders(provider, provider._ps, element ? [element] : [], hooks, contexts, undefined, undefined);\n  executeHooks(hooks);\n  setCurrentInstance(null);\n  if (!isProvider) {\n    container.__CROACT__ = provider;\n  }\n  return provider;\n}\nfunction render(element, container, callback) {\n  var provider = container.__CROACT__;\n  if (element && !provider) {\n    container.innerHTML = \"\";\n  }\n  renderProvider(element, container, provider);\n  callback && callback();\n}\nfunction renderSelf(element, self, containerProvider) {\n  if (!containerProvider && element) {\n    containerProvider = new ContainerProvider(self.parentElement);\n    containerProvider._hyd = [self];\n    containerProvider._sel = true;\n  }\n  renderProvider(element, self, containerProvider);\n  return containerProvider;\n}\n\nvar i  = 0;\nfunction createContext(defaultValue) {\n  var id = \"c\".concat(++i);\n  function Provider(props) {\n    var self = this;\n    if (!self.$_cs[id]) {\n      self.$_cs[id] = self;\n      var $_subs = [];\n      self.shouldComponentUpdate = function (nextProps) {\n        if (nextProps.value !== self.props.value) {\n          // request\n          self.$_req = true;\n        }\n      };\n      self.render = function () {\n        return self.props.children[0];\n      };\n      self.$_subs = $_subs;\n    }\n    return props.children[0];\n  }\n  function Consumer(props, contextValue) {\n    return props.children(contextValue);\n  }\n  function getContext(provider) {\n    return provider._cs[id];\n  }\n  var context = {\n    $_id: id,\n    $_dv: defaultValue,\n    Consumer: Consumer,\n    Provider: Provider,\n    get: function (provider) {\n      var _a, _b;\n      return (_b = (_a = getContext(provider)) === null || _a === void 0 ? void 0 : _a.props.value) !== null && _b !== void 0 ? _b : defaultValue;\n    },\n    register: function (provider) {\n      var mainComponent = getContext(provider);\n      if (mainComponent) {\n        pushSet(mainComponent.$_subs, provider);\n      }\n    },\n    unregister: function (provider) {\n      var mainComponent = getContext(provider);\n      if (mainComponent) {\n        var subs = mainComponent.$_subs;\n        var index = subs.indexOf(provider);\n        if (index > -1) {\n          subs.splice(index, 1);\n        }\n      }\n    }\n  };\n  Consumer.contextType = context;\n  return context;\n}\n\nvar Portal = /*#__PURE__*/function (_super) {\n  __extends(Portal, _super);\n  function Portal() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  var __proto = Portal.prototype;\n  __proto.componentDidMount = function () {\n    var self = this;\n    var _a = self.props,\n      element = _a.element,\n      container = _a.container;\n    var parentProvider = self.$_p;\n    self._pp = new ContainerProvider(container, parentProvider.d + 1);\n    renderProvider(element, container, self._pp, parentProvider._cs);\n  };\n  __proto.componentDidUpdate = function () {\n    var self = this;\n    var _a = self.props,\n      element = _a.element,\n      container = _a.container;\n    renderProvider(element, container, self._pp, self.$_p._cs);\n  };\n  __proto.componentWillUnmount = function () {\n    var self = this;\n    var container = self.props.container;\n    renderProvider(null, container, self._pp, self.$_p._cs);\n    this._pp = null;\n  };\n  return Portal;\n}(PureComponent);\nfunction createPortal(el, container) {\n  return createElement(Portal, {\n    element: el,\n    container: container\n  });\n}\n\nfunction _renderToString(node, parentContexts, self) {\n  if (node == null) {\n    return \"\";\n  }\n  if (isString(node) || isNumber(node) || isFunction(node)) {\n    return node;\n  }\n  var type = node.type,\n    props = node.props;\n  if (isString(type)) {\n    var stringProps_1 = {};\n    getEntries(props).forEach(function (_a) {\n      var name = _a[0],\n        value = _a[1];\n      if (name === \"style\") {\n        stringProps_1[name] = getEntries(value).map(function (_a) {\n          var styleName = _a[0],\n            styleValue = _a[1];\n          return \"\".concat(decamelize(styleName), \": \").concat(styleValue, \";\");\n        }).join(\"\");\n      } else if (name === \"children\") {\n        return;\n      } else if (!name.match(/^on[^a-z]/g)) {\n        stringProps_1[name] = \"\".concat(value);\n      }\n    });\n    var children = props.children.map(function (child) {\n      return _renderToString(child, parentContexts);\n    }).join(\"\");\n    if (self) {\n      return {\n        tagName: type,\n        props: stringProps_1,\n        children: children\n      };\n    }\n    var strings = __spreadArray([type], getEntries(stringProps_1).map(function (_a) {\n      var name = _a[0],\n        value = _a[1];\n      return \"\".concat(name, \"=\\\"\").concat(value.replace(/\"/g, \"\\\\\\\"\"), \"\\\"\");\n    }), true);\n    return \"<\".concat(strings.join(\" \"), \">\").concat(children, \"</\").concat(type, \">\");\n  } else if (isFunction(type)) {\n    var contextType = type.contextType;\n    var provider = {\n      b: null,\n      _hs: [],\n      _usefs: [],\n      _uefs: [],\n      _defs: [],\n      _cs: parentContexts\n    };\n    setCurrentInstance(provider);\n    var contextValue = contextType === null || contextType === void 0 ? void 0 : contextType.get(provider);\n    var base = createComponent(type, props, contextValue, {});\n    var nextContexts = __assign(__assign({}, parentContexts), base.$_cs);\n    provider.b = base;\n    return _renderToString(base.render(), nextContexts, self);\n  }\n  return \"\";\n}\nfunction renderToString(node) {\n  return _renderToString(node, {});\n}\nfunction renderSelfToString(node) {\n  return _renderToString(node, {}, true);\n}\n\nfunction checkHookInfo(info) {\n  var inst = getCurrentInstance();\n  var hooks = inst._hs || (inst._hs = []);\n  var index = getHooksIndex();\n  var prevHt = hooks[index];\n  setHooksInex(index + 1);\n  if (prevHt) {\n    if (!isDiff(prevHt.deps, info.deps)) {\n      prevHt.updated = false;\n      return prevHt;\n    }\n    hooks[index] = info;\n  } else {\n    hooks.push(info);\n  }\n  info.value = info.func();\n  info.updated = true;\n  return info;\n}\nfunction useMemo(defaultFunction, deps) {\n  var info = checkHookInfo({\n    func: defaultFunction,\n    deps: deps\n  });\n  return info.value;\n}\nfunction useRef(defaultValue) {\n  return useMemo(function () {\n    return createRef(defaultValue);\n  }, []);\n}\nfunction useContext(context) {\n  var inst = getCurrentInstance();\n  var contextId = context.$_id;\n  var contexts = inst._cs;\n  var providerComponent;\n  if (contextId in contexts) {\n    providerComponent = contexts[contextId];\n    providerComponent.props.value;\n  } else {\n    context.$_dv;\n  }\n  useEffect(function () {\n    context.register(inst);\n    return function () {\n      context.unregister(inst);\n    };\n  }, []);\n  return context.get(inst);\n}\nfunction useState(st) {\n  var inst = getCurrentInstance();\n  var index = getHooksIndex();\n  var comp = inst.b;\n  checkHookInfo({\n    func: function () {\n      comp.state[index] = isFunction(st) ? st() : st;\n    },\n    deps: []\n  });\n  return [comp.state[index], function (nextValue) {\n    var _a;\n    return comp.setState((_a = {}, _a[index] = nextValue, _a));\n  }];\n}\nfunction useEffect(effect, deps, unshift) {\n  var inst = getCurrentInstance();\n  var info = checkHookInfo({\n    func: function () {\n      return effect;\n    },\n    deps: deps\n  });\n  var effects = unshift ? inst._usefs : inst._uefs;\n  if (info.updated) {\n    effects.push(function () {\n      info.effect && info.effect();\n      info.effect = effect();\n      return info.effect;\n    });\n  } else {\n    effects.push(function () {\n      return info.effect;\n    });\n  }\n}\nfunction useImperativeHandle(ref, func, deps) {\n  useEffect(function () {\n    ref === null || ref === void 0 ? void 0 : ref(func());\n  }, deps, true);\n}\n\nvar version = \"simple-1.0.0\";\n\nexport { Component, ContainerProvider, PureComponent, createContext, createElement, createPortal, createRef, findDOMNode, findNodeProvider, forwardRef, render, renderSelf, renderSelfToString, renderToString, useContext, useEffect, useImperativeHandle, useMemo, useRef, useState, version };\n//# sourceMappingURL=croact.esm.js.map\n","/*\nCopyright (c) 2015 NAVER Corp.\nname: @egjs/agent\nlicense: MIT\nauthor: NAVER Corp.\nrepository: git+https://github.com/naver/agent.git\nversion: 2.3.0\n*/\nfunction some(arr, callback) {\n  var length = arr.length;\n\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i)) {\n      return true;\n    }\n  }\n\n  return false;\n}\nfunction find(arr, callback) {\n  var length = arr.length;\n\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i)) {\n      return arr[i];\n    }\n  }\n\n  return null;\n}\nfunction getUserAgent(agent) {\n  var userAgent = agent;\n\n  if (typeof userAgent === \"undefined\") {\n    if (typeof navigator === \"undefined\" || !navigator) {\n      return \"\";\n    }\n\n    userAgent = navigator.userAgent || \"\";\n  }\n\n  return userAgent.toLowerCase();\n}\nfunction execRegExp(pattern, text) {\n  try {\n    return new RegExp(pattern, \"g\").exec(text);\n  } catch (e) {\n    return null;\n  }\n}\nfunction hasUserAgentData() {\n  if (typeof navigator === \"undefined\" || !navigator || !navigator.userAgentData) {\n    return false;\n  }\n\n  var userAgentData = navigator.userAgentData;\n  var brands = userAgentData.brands || userAgentData.uaList;\n  return !!(brands && brands.length);\n}\nfunction findVersion(versionTest, userAgent) {\n  var result = execRegExp(\"(\" + versionTest + \")((?:\\\\/|\\\\s|:)([0-9|\\\\.|_]+))\", userAgent);\n  return result ? result[3] : \"\";\n}\nfunction convertVersion(text) {\n  return text.replace(/_/g, \".\");\n}\nfunction findPreset(presets, userAgent) {\n  var userPreset = null;\n  var version = \"-1\";\n  some(presets, function (preset) {\n    var result = execRegExp(\"(\" + preset.test + \")((?:\\\\/|\\\\s|:)([0-9|\\\\.|_]+))?\", userAgent);\n\n    if (!result || preset.brand) {\n      return false;\n    }\n\n    userPreset = preset;\n    version = result[3] || \"-1\";\n\n    if (preset.versionAlias) {\n      version = preset.versionAlias;\n    } else if (preset.versionTest) {\n      version = findVersion(preset.versionTest.toLowerCase(), userAgent) || version;\n    }\n\n    version = convertVersion(version);\n    return true;\n  });\n  return {\n    preset: userPreset,\n    version: version\n  };\n}\nfunction findPresetBrand(presets, brands) {\n  var brandInfo = {\n    brand: \"\",\n    version: \"-1\"\n  };\n  some(presets, function (preset) {\n    var result = findBrand(brands, preset);\n\n    if (!result) {\n      return false;\n    }\n\n    brandInfo.brand = preset.id;\n    brandInfo.version = preset.versionAlias || result.version;\n    return brandInfo.version !== \"-1\";\n  });\n  return brandInfo;\n}\nfunction findBrand(brands, preset) {\n  return find(brands, function (_a) {\n    var brand = _a.brand;\n    return execRegExp(\"\" + preset.test, brand.toLowerCase());\n  });\n}\n\nvar BROWSER_PRESETS = [{\n  test: \"phantomjs\",\n  id: \"phantomjs\"\n}, {\n  test: \"whale\",\n  id: \"whale\"\n}, {\n  test: \"edgios|edge|edg\",\n  id: \"edge\"\n}, {\n  test: \"msie|trident|windows phone\",\n  id: \"ie\",\n  versionTest: \"iemobile|msie|rv\"\n}, {\n  test: \"miuibrowser\",\n  id: \"miui browser\"\n}, {\n  test: \"samsungbrowser\",\n  id: \"samsung internet\"\n}, {\n  test: \"samsung\",\n  id: \"samsung internet\",\n  versionTest: \"version\"\n}, {\n  test: \"chrome|crios\",\n  id: \"chrome\"\n}, {\n  test: \"firefox|fxios\",\n  id: \"firefox\"\n}, {\n  test: \"android\",\n  id: \"android browser\",\n  versionTest: \"version\"\n}, {\n  test: \"safari|iphone|ipad|ipod\",\n  id: \"safari\",\n  versionTest: \"version\"\n}]; // chromium's engine(blink) is based on applewebkit 537.36.\n\nvar CHROMIUM_PRESETS = [{\n  test: \"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\\\schrome)\",\n  id: \"chrome\",\n  versionTest: \"chrome\"\n}, {\n  test: \"chromium\",\n  id: \"chrome\"\n}, {\n  test: \"whale\",\n  id: \"chrome\",\n  versionAlias: \"-1\",\n  brand: true\n}];\nvar WEBKIT_PRESETS = [{\n  test: \"applewebkit\",\n  id: \"webkit\",\n  versionTest: \"applewebkit|safari\"\n}];\nvar WEBVIEW_PRESETS = [{\n  test: \"(?=(iphone|ipad))(?!(.*version))\",\n  id: \"webview\"\n}, {\n  test: \"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))\",\n  id: \"webview\"\n}, {\n  // test webview\n  test: \"webview\",\n  id: \"webview\"\n}];\nvar OS_PRESETS = [{\n  test: \"windows phone\",\n  id: \"windows phone\"\n}, {\n  test: \"windows 2000\",\n  id: \"window\",\n  versionAlias: \"5.0\"\n}, {\n  test: \"windows nt\",\n  id: \"window\"\n}, {\n  test: \"iphone|ipad|ipod\",\n  id: \"ios\",\n  versionTest: \"iphone os|cpu os\"\n}, {\n  test: \"mac os x\",\n  id: \"mac\"\n}, {\n  test: \"android\",\n  id: \"android\"\n}, {\n  test: \"tizen\",\n  id: \"tizen\"\n}, {\n  test: \"webos|web0s\",\n  id: \"webos\"\n}];\n\nfunction parseUserAgentData(osData) {\n  var userAgentData = navigator.userAgentData;\n  var brands = (userAgentData.uaList || userAgentData.brands).slice();\n  var isMobile = userAgentData.mobile || false;\n  var firstBrand = brands[0];\n  var browser = {\n    name: firstBrand.brand,\n    version: firstBrand.version,\n    majorVersion: -1,\n    webkit: false,\n    webkitVersion: \"-1\",\n    chromium: false,\n    chromiumVersion: \"-1\",\n    webview: !!findPresetBrand(WEBVIEW_PRESETS, brands).brand\n  };\n  var os = {\n    name: \"unknown\",\n    version: \"-1\",\n    majorVersion: -1\n  };\n  browser.webkit = !browser.chromium && some(WEBKIT_PRESETS, function (preset) {\n    return findBrand(brands, preset);\n  });\n  var chromiumBrand = findPresetBrand(CHROMIUM_PRESETS, brands);\n  browser.chromium = !!chromiumBrand.brand;\n  browser.chromiumVersion = chromiumBrand.version;\n\n  if (!browser.chromium) {\n    var webkitBrand = findPresetBrand(WEBKIT_PRESETS, brands);\n    browser.webkit = !!webkitBrand.brand;\n    browser.webkitVersion = webkitBrand.version;\n  }\n\n  if (osData) {\n    var platform_1 = osData.platform.toLowerCase();\n    var result = find(OS_PRESETS, function (preset) {\n      return new RegExp(\"\" + preset.test, \"g\").exec(platform_1);\n    });\n    os.name = result ? result.id : platform_1;\n    os.version = osData.platformVersion;\n  }\n\n  var browserBrand = findPresetBrand(BROWSER_PRESETS, brands);\n\n  if (browserBrand.brand) {\n    browser.name = browserBrand.brand;\n    browser.version = osData ? osData.uaFullVersion : browserBrand.version;\n  }\n\n  if (navigator.platform === \"Linux armv8l\") {\n    os.name = \"android\";\n  } else if (browser.webkit) {\n    os.name = isMobile ? \"ios\" : \"mac\";\n  }\n\n  if (os.name === \"ios\" && browser.webview) {\n    browser.version = \"-1\";\n  }\n\n  os.version = convertVersion(os.version);\n  browser.version = convertVersion(browser.version);\n  os.majorVersion = parseInt(os.version, 10);\n  browser.majorVersion = parseInt(browser.version, 10);\n  return {\n    browser: browser,\n    os: os,\n    isMobile: isMobile,\n    isHints: true\n  };\n}\n\nfunction parseUserAgent(userAgent) {\n  var nextAgent = getUserAgent(userAgent);\n  var isMobile = !!/mobi/g.exec(nextAgent);\n  var browser = {\n    name: \"unknown\",\n    version: \"-1\",\n    majorVersion: -1,\n    webview: !!findPreset(WEBVIEW_PRESETS, nextAgent).preset,\n    chromium: false,\n    chromiumVersion: \"-1\",\n    webkit: false,\n    webkitVersion: \"-1\"\n  };\n  var os = {\n    name: \"unknown\",\n    version: \"-1\",\n    majorVersion: -1\n  };\n\n  var _a = findPreset(BROWSER_PRESETS, nextAgent),\n      browserPreset = _a.preset,\n      browserVersion = _a.version;\n\n  var _b = findPreset(OS_PRESETS, nextAgent),\n      osPreset = _b.preset,\n      osVersion = _b.version;\n\n  var chromiumPreset = findPreset(CHROMIUM_PRESETS, nextAgent);\n  browser.chromium = !!chromiumPreset.preset;\n  browser.chromiumVersion = chromiumPreset.version;\n\n  if (!browser.chromium) {\n    var webkitPreset = findPreset(WEBKIT_PRESETS, nextAgent);\n    browser.webkit = !!webkitPreset.preset;\n    browser.webkitVersion = webkitPreset.version;\n  }\n\n  if (osPreset) {\n    os.name = osPreset.id;\n    os.version = osVersion;\n    os.majorVersion = parseInt(osVersion, 10);\n  }\n\n  if (browserPreset) {\n    browser.name = browserPreset.id;\n    browser.version = browserVersion;\n\n    if (browser.webview && os.name === \"ios\" && browser.name !== \"safari\") {\n      browser.webview = false;\n    }\n  }\n\n  browser.majorVersion = parseInt(browser.version, 10);\n  return {\n    browser: browser,\n    os: os,\n    isMobile: isMobile,\n    isHints: false\n  };\n}\n\n/**\n * @namespace eg.agent\n */\n\n/**\n* Extracts accuate browser and operating system information from the user agent string or client hints.\n* @ko     client hints     .\n* @function eg.agent#getAccurateAgent\n* @param - Callback function to get the accuate agent <ko>    callback </ko>\n* @return - get the accuate agent promise. If Promise are not supported, null is returned. <ko>   promise . Promise    , null . </ko>\n* @example\nimport { getAccurateAgent } from \"@egjs/agent\";\n// eg.agent.getAccurateAgent()\ngetAccurateAgent().then(agent => {\n   const { os, browser, isMobile } = agent;\n});\ngetAccurateAgent(agent => {\n    const { os, browser, isMobile } = agent;\n});\n*/\n\nfunction getAccurateAgent(callback) {\n  if (hasUserAgentData()) {\n    return navigator.userAgentData.getHighEntropyValues([\"architecture\", \"model\", \"platform\", \"platformVersion\", \"uaFullVersion\"]).then(function (info) {\n      var agentInfo = parseUserAgentData(info);\n      callback && callback(agentInfo);\n      return agentInfo;\n    });\n  }\n\n  callback && callback(agent());\n\n  if (typeof Promise === \"undefined\" || !Promise) {\n    return null;\n  }\n\n  return Promise.resolve(agent());\n}\n/**\n * Extracts browser and operating system information from the user agent string.\n * @ko       .\n * @function eg.agent#agent\n * @param - user agent string to parse <ko>  </ko>\n * @return - agent Info <ko>   </ko>\n * @example\nimport agent from \"@egjs/agent\";\n// eg.agent();\nconst { os, browser, isMobile } = agent();\n */\n\nfunction agent(userAgent) {\n  if (typeof userAgent === \"undefined\" && hasUserAgentData()) {\n    return parseUserAgentData();\n  } else {\n    return parseUserAgent(userAgent);\n  }\n}\n\nexport default agent;\nexport { getAccurateAgent };\n//# sourceMappingURL=agent.esm.js.map\n","/*\nCopyright (c) 2020 Daybrush\nname: @scena/matrix\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/matrix\nversion: 1.1.1\n*/\nimport { throttle, TINY_NUM, average } from '@daybrush/utils';\n\nfunction add(matrix, inverseMatrix, startIndex, fromIndex, n, k) {\n  for (var i = 0; i < n; ++i) {\n    var x = startIndex + i * n;\n    var fromX = fromIndex + i * n;\n    matrix[x] += matrix[fromX] * k;\n    inverseMatrix[x] += inverseMatrix[fromX] * k;\n  }\n}\n\nfunction swap(matrix, inverseMatrix, startIndex, fromIndex, n) {\n  for (var i = 0; i < n; ++i) {\n    var x = startIndex + i * n;\n    var fromX = fromIndex + i * n;\n    var v = matrix[x];\n    var iv = inverseMatrix[x];\n    matrix[x] = matrix[fromX];\n    matrix[fromX] = v;\n    inverseMatrix[x] = inverseMatrix[fromX];\n    inverseMatrix[fromX] = iv;\n  }\n}\n\nfunction divide(matrix, inverseMatrix, startIndex, n, k) {\n  for (var i = 0; i < n; ++i) {\n    var x = startIndex + i * n;\n    matrix[x] /= k;\n    inverseMatrix[x] /= k;\n  }\n}\n/**\n *\n * @namespace Matrix\n */\n\n/**\n * @memberof Matrix\n */\n\n\nfunction ignoreDimension(matrix, m, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = matrix.slice();\n\n  for (var i = 0; i < n; ++i) {\n    newMatrix[i * n + m - 1] = 0;\n    newMatrix[(m - 1) * n + i] = 0;\n  }\n\n  newMatrix[(m - 1) * (n + 1)] = 1;\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction invert(matrix, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = matrix.slice();\n  var inverseMatrix = createIdentityMatrix(n);\n\n  for (var i = 0; i < n; ++i) {\n    // diagonal\n    var identityIndex = n * i + i;\n\n    if (!throttle(newMatrix[identityIndex], TINY_NUM)) {\n      // newMatrix[identityIndex] = 0;\n      for (var j = i + 1; j < n; ++j) {\n        if (newMatrix[n * i + j]) {\n          swap(newMatrix, inverseMatrix, i, j, n);\n          break;\n        }\n      }\n    }\n\n    if (!throttle(newMatrix[identityIndex], TINY_NUM)) {\n      // no inverse matrix\n      return [];\n    }\n\n    divide(newMatrix, inverseMatrix, i, n, newMatrix[identityIndex]);\n\n    for (var j = 0; j < n; ++j) {\n      var targetStartIndex = j;\n      var targetIndex = j + i * n;\n      var target = newMatrix[targetIndex];\n\n      if (!throttle(target, TINY_NUM) || i === j) {\n        continue;\n      }\n\n      add(newMatrix, inverseMatrix, targetStartIndex, i, n, -target);\n    }\n  }\n\n  return inverseMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction transpose(matrix, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = [];\n\n  for (var i = 0; i < n; ++i) {\n    for (var j = 0; j < n; ++j) {\n      newMatrix[j * n + i] = matrix[n * i + j];\n    }\n  }\n\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction getOrigin(matrix, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var originMatrix = [];\n  var w = matrix[n * n - 1];\n\n  for (var i = 0; i < n - 1; ++i) {\n    originMatrix[i] = matrix[n * (n - 1) + i] / w;\n  }\n\n  originMatrix[n - 1] = 0;\n  return originMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction fromTranslation(pos, n) {\n  var newMatrix = createIdentityMatrix(n);\n\n  for (var i = 0; i < n - 1; ++i) {\n    newMatrix[n * (n - 1) + i] = pos[i] || 0;\n  }\n\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertPositionMatrix(matrix, n) {\n  var newMatrix = matrix.slice();\n\n  for (var i = matrix.length; i < n - 1; ++i) {\n    newMatrix[i] = 0;\n  }\n\n  newMatrix[n - 1] = 1;\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertDimension(matrix, n, m) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  } // n < m\n\n\n  if (n === m) {\n    return matrix;\n  }\n\n  var newMatrix = createIdentityMatrix(m);\n  var length = Math.min(n, m);\n\n  for (var i = 0; i < length - 1; ++i) {\n    for (var j = 0; j < length - 1; ++j) {\n      newMatrix[i * m + j] = matrix[i * n + j];\n    }\n\n    newMatrix[(i + 1) * m - 1] = matrix[(i + 1) * n - 1];\n    newMatrix[(m - 1) * m + i] = matrix[(n - 1) * n + i];\n  }\n\n  newMatrix[m * m - 1] = matrix[n * n - 1];\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction multiplies(n) {\n  var matrixes = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    matrixes[_i - 1] = arguments[_i];\n  }\n\n  var m = createIdentityMatrix(n);\n  matrixes.forEach(function (matrix) {\n    m = multiply(m, matrix, n);\n  });\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction multiply(matrix, matrix2, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = []; // 1 y: n\n  // 1 x: m\n  // 2 x: m\n  // 2 y: k\n  // n * m X m * k\n\n  var m = matrix.length / n;\n  var k = matrix2.length / m;\n\n  if (!m) {\n    return matrix2;\n  } else if (!k) {\n    return matrix;\n  }\n\n  for (var i = 0; i < n; ++i) {\n    for (var j = 0; j < k; ++j) {\n      newMatrix[j * n + i] = 0;\n\n      for (var l = 0; l < m; ++l) {\n        // m1 x: m(l), y: n(i)\n        // m2 x: k(j):  y: m(l)\n        // nw x: n(i), y: k(j)\n        newMatrix[j * n + i] += matrix[l * n + i] * matrix2[j * m + l];\n      }\n    }\n  } // n * k\n\n\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction plus(pos1, pos2) {\n  var length = Math.min(pos1.length, pos2.length);\n  var nextPos = pos1.slice();\n\n  for (var i = 0; i < length; ++i) {\n    nextPos[i] = nextPos[i] + pos2[i];\n  }\n\n  return nextPos;\n}\n/**\n * @memberof Matrix\n */\n\nfunction minus(pos1, pos2) {\n  var length = Math.min(pos1.length, pos2.length);\n  var nextPos = pos1.slice();\n\n  for (var i = 0; i < length; ++i) {\n    nextPos[i] = nextPos[i] - pos2[i];\n  }\n\n  return nextPos;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertCSStoMatrix(a, is2d) {\n  if (is2d === void 0) {\n    is2d = a.length === 6;\n  }\n\n  if (is2d) {\n    return [a[0], a[1], 0, a[2], a[3], 0, a[4], a[5], 1];\n  }\n\n  return a;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertMatrixtoCSS(a, is2d) {\n  if (is2d === void 0) {\n    is2d = a.length === 9;\n  }\n\n  if (is2d) {\n    return [a[0], a[1], a[3], a[4], a[6], a[7]];\n  }\n\n  return a;\n}\n/**\n * @memberof Matrix\n */\n\nfunction calculate(matrix, matrix2, n) {\n  if (n === void 0) {\n    n = matrix2.length;\n  }\n\n  var result = multiply(matrix, matrix2, n);\n  var k = result[n - 1];\n  return result.map(function (v) {\n    return v / k;\n  });\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotateX3d(matrix, rad) {\n  return multiply(matrix, [1, 0, 0, 0, 0, Math.cos(rad), Math.sin(rad), 0, 0, -Math.sin(rad), Math.cos(rad), 0, 0, 0, 0, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotateY3d(matrix, rad) {\n  return multiply(matrix, [Math.cos(rad), 0, -Math.sin(rad), 0, 0, 1, 0, 0, Math.sin(rad), 0, Math.cos(rad), 0, 0, 0, 0, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotateZ3d(matrix, rad) {\n  return multiply(matrix, createRotateMatrix(rad, 4));\n}\n/**\n * @memberof Matrix\n */\n\nfunction scale3d(matrix, _a) {\n  var _b = _a[0],\n      sx = _b === void 0 ? 1 : _b,\n      _c = _a[1],\n      sy = _c === void 0 ? 1 : _c,\n      _d = _a[2],\n      sz = _d === void 0 ? 1 : _d;\n  return multiply(matrix, [sx, 0, 0, 0, 0, sy, 0, 0, 0, 0, sz, 0, 0, 0, 0, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotate(pos, rad) {\n  return calculate(createRotateMatrix(rad, 3), convertPositionMatrix(pos, 3));\n}\n/**\n * @memberof Matrix\n */\n\nfunction translate3d(matrix, _a) {\n  var _b = _a[0],\n      tx = _b === void 0 ? 0 : _b,\n      _c = _a[1],\n      ty = _c === void 0 ? 0 : _c,\n      _d = _a[2],\n      tz = _d === void 0 ? 0 : _d;\n  return multiply(matrix, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, tx, ty, tz, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction matrix3d(matrix1, matrix2) {\n  return multiply(matrix1, matrix2, 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction createRotateMatrix(rad, n) {\n  var cos = Math.cos(rad);\n  var sin = Math.sin(rad);\n  var m = createIdentityMatrix(n); // cos -sin\n  // sin cos\n\n  m[0] = cos;\n  m[1] = sin;\n  m[n] = -sin;\n  m[n + 1] = cos;\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createIdentityMatrix(n) {\n  var length = n * n;\n  var matrix = [];\n\n  for (var i = 0; i < length; ++i) {\n    matrix[i] = i % (n + 1) ? 0 : 1;\n  }\n\n  return matrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createScaleMatrix(scale, n) {\n  var m = createIdentityMatrix(n);\n  var length = Math.min(scale.length, n - 1);\n\n  for (var i = 0; i < length; ++i) {\n    m[(n + 1) * i] = scale[i];\n  }\n\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createOriginMatrix(origin, n) {\n  var m = createIdentityMatrix(n);\n  var length = Math.min(origin.length, n - 1);\n\n  for (var i = 0; i < length; ++i) {\n    m[n * (n - 1) + i] = origin[i];\n  }\n\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createWarpMatrix(pos0, pos1, pos2, pos3, nextPos0, nextPos1, nextPos2, nextPos3) {\n  var x0 = pos0[0],\n      y0 = pos0[1];\n  var x1 = pos1[0],\n      y1 = pos1[1];\n  var x2 = pos2[0],\n      y2 = pos2[1];\n  var x3 = pos3[0],\n      y3 = pos3[1];\n  var u0 = nextPos0[0],\n      v0 = nextPos0[1];\n  var u1 = nextPos1[0],\n      v1 = nextPos1[1];\n  var u2 = nextPos2[0],\n      v2 = nextPos2[1];\n  var u3 = nextPos3[0],\n      v3 = nextPos3[1];\n  var matrix = [x0, 0, x1, 0, x2, 0, x3, 0, y0, 0, y1, 0, y2, 0, y3, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, x0, 0, x1, 0, x2, 0, x3, 0, y0, 0, y1, 0, y2, 0, y3, 0, 1, 0, 1, 0, 1, 0, 1, -u0 * x0, -v0 * x0, -u1 * x1, -v1 * x1, -u2 * x2, -v2 * x2, -u3 * x3, -v3 * x3, -u0 * y0, -v0 * y0, -u1 * y1, -v1 * y1, -u2 * y2, -v2 * y2, -u3 * y3, -v3 * y3];\n  var inverseMatrix = invert(matrix, 8);\n\n  if (!inverseMatrix.length) {\n    return [];\n  }\n\n  var h = multiply(inverseMatrix, [u0, v0, u1, v1, u2, v2, u3, v3], 8);\n  h[8] = 1;\n  return convertDimension(transpose(h), 3, 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction getCenter(points) {\n  return [0, 1].map(function (i) {\n    return average(points.map(function (pos) {\n      return pos[i];\n    }));\n  });\n}\n\nexport { calculate, convertCSStoMatrix, convertDimension, convertMatrixtoCSS, convertPositionMatrix, createIdentityMatrix, createOriginMatrix, createRotateMatrix, createScaleMatrix, createWarpMatrix, fromTranslation, getCenter, getOrigin, ignoreDimension, invert, matrix3d, minus, multiplies, multiply, plus, rotate, rotateX3d, rotateY3d, rotateZ3d, scale3d, translate3d, transpose };\n//# sourceMappingURL=matrix.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: css-to-mat\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/css-to-mat.git\nversion: 1.1.0\n*/\nimport { isArray, splitSpace, splitBracket, isObject, splitComma, convertUnitSize, splitUnit } from '@daybrush/utils';\nimport { calculate, matrix3d, invert, translate3d, scale3d, rotateZ3d, rotateX3d, rotateY3d } from '@scena/matrix';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nfunction createMatrix() {\n    return [\n        1, 0, 0, 0,\n        0, 1, 0, 0,\n        0, 0, 1, 0,\n        0, 0, 0, 1,\n    ];\n}\nfunction parseMat(transform, size) {\n    if (size === void 0) { size = 0; }\n    return toMat(parse(transform, size));\n}\nfunction getElementMatrix(el) {\n    return parseMat(getComputedStyle(el).transform);\n}\nfunction calculateMatrixDist(matrix, pos) {\n    var res = calculate(matrix, [pos[0], pos[1] || 0, pos[2] || 0, 1], 4);\n    var w = res[3] || 1;\n    return [\n        res[0] / w,\n        res[1] / w,\n        res[2] / w,\n    ];\n}\nfunction getDistElementMatrix(el, container) {\n    if (container === void 0) { container = document.body; }\n    var target = el;\n    var matrix = createMatrix();\n    while (target) {\n        var transform = getComputedStyle(target).transform;\n        matrix = matrix3d(parseMat(transform), matrix);\n        if (target === container) {\n            break;\n        }\n        target = target.parentElement;\n    }\n    matrix = invert(matrix, 4);\n    matrix[12] = 0;\n    matrix[13] = 0;\n    matrix[14] = 0;\n    return matrix;\n}\nfunction toMat(matrixInfos) {\n    var target = createMatrix();\n    matrixInfos.forEach(function (info) {\n        var matrixFunction = info.matrixFunction, functionValue = info.functionValue;\n        if (!matrixFunction) {\n            return;\n        }\n        target = matrixFunction(target, functionValue);\n    });\n    return target;\n}\nfunction parse(transform, size) {\n    if (size === void 0) { size = 0; }\n    var transforms = isArray(transform) ? transform : splitSpace(transform);\n    return transforms.map(function (t) {\n        var _a = splitBracket(t), name = _a.prefix, value = _a.value;\n        var matrixFunction = null;\n        var functionName = name;\n        var functionValue = \"\";\n        if (name === \"translate\" || name === \"translateX\" || name === \"translate3d\") {\n            var nextSize_1 = isObject(size) ? __assign(__assign({}, size), { \"o%\": size[\"%\"] }) : {\n                \"%\": size,\n                \"o%\": size,\n            };\n            var _b = splitComma(value).map(function (v, i) {\n                if (i === 0 && \"x%\" in nextSize_1) {\n                    nextSize_1[\"%\"] = size[\"x%\"];\n                }\n                else if (i === 1 && \"y%\" in nextSize_1) {\n                    nextSize_1[\"%\"] = size[\"y%\"];\n                }\n                else {\n                    nextSize_1[\"%\"] = size[\"o%\"];\n                }\n                return convertUnitSize(v, nextSize_1);\n            }), posX = _b[0], _c = _b[1], posY = _c === void 0 ? 0 : _c, _d = _b[2], posZ = _d === void 0 ? 0 : _d;\n            matrixFunction = translate3d;\n            functionValue = [posX, posY, posZ];\n        }\n        else if (name === \"translateY\") {\n            var nextSize = isObject(size) ? __assign({ \"%\": size[\"y%\"] }, size) : {\n                \"%\": size,\n            };\n            var posY = convertUnitSize(value, nextSize);\n            matrixFunction = translate3d;\n            functionValue = [0, posY, 0];\n        }\n        else if (name === \"translateZ\") {\n            var posZ = parseFloat(value);\n            matrixFunction = translate3d;\n            functionValue = [0, 0, posZ];\n        }\n        else if (name === \"scale\" || name === \"scale3d\") {\n            var _e = splitComma(value).map(function (v) { return parseFloat(v); }), sx = _e[0], _f = _e[1], sy = _f === void 0 ? sx : _f, _g = _e[2], sz = _g === void 0 ? 1 : _g;\n            matrixFunction = scale3d;\n            functionValue = [sx, sy, sz];\n        }\n        else if (name === \"scaleX\") {\n            var sx = parseFloat(value);\n            matrixFunction = scale3d;\n            functionValue = [sx, 1, 1];\n        }\n        else if (name === \"scaleY\") {\n            var sy = parseFloat(value);\n            matrixFunction = scale3d;\n            functionValue = [1, sy, 1];\n        }\n        else if (name === \"scaleZ\") {\n            var sz = parseFloat(value);\n            matrixFunction = scale3d;\n            functionValue = [1, 1, sz];\n        }\n        else if (name === \"rotate\" || name === \"rotateZ\" || name === \"rotateX\" || name === \"rotateY\") {\n            var _h = splitUnit(value), unit = _h.unit, unitValue = _h.value;\n            var rad = unit === \"rad\" ? unitValue : unitValue * Math.PI / 180;\n            if (name === \"rotate\" || name === \"rotateZ\") {\n                functionName = \"rotateZ\";\n                matrixFunction = rotateZ3d;\n            }\n            else if (name === \"rotateX\") {\n                matrixFunction = rotateX3d;\n            }\n            else if (name === \"rotateY\") {\n                matrixFunction = rotateY3d;\n            }\n            functionValue = rad;\n        }\n        else if (name === \"matrix3d\") {\n            matrixFunction = matrix3d;\n            functionValue = splitComma(value).map(function (v) { return parseFloat(v); });\n        }\n        else if (name === \"matrix\") {\n            var m = splitComma(value).map(function (v) { return parseFloat(v); });\n            matrixFunction = matrix3d;\n            functionValue = [\n                m[0], m[1], 0, 0,\n                m[2], m[3], 0, 0,\n                0, 0, 1, 0,\n                m[4], m[5], 0, 1,\n            ];\n        }\n        else {\n            functionName = \"\";\n        }\n        return {\n            name: name,\n            functionName: functionName,\n            value: value,\n            matrixFunction: matrixFunction,\n            functionValue: functionValue,\n        };\n    });\n}\n\nexport { calculateMatrixDist, createMatrix, getDistElementMatrix, getElementMatrix, parse, parseMat, toMat };\n//# sourceMappingURL=css-to-mat.esm.js.map\n","/*\nCopyright (c) 2019-present NAVER Corp.\nname: @egjs/children-differ\nlicense: MIT\nauthor: NAVER Corp.\nrepository: https://github.com/naver/egjs-children-differ\nversion: 1.0.1\n*/\nimport ListDiffer, { diff as diff$1 } from '@egjs/list-differ';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\n/*\negjs-children-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar findKeyCallback = typeof Map === \"function\" ? undefined : function () {\n  var childrenCount = 0;\n  return function (el) {\n    return el.__DIFF_KEY__ || (el.__DIFF_KEY__ = ++childrenCount);\n  };\n}();\n\n/**\n * A module that checks diff when child are added, removed, or changed .\n * @ko           .\n * @memberof eg\n * @extends eg.ListDiffer\n */\n\nvar ChildrenDiffer =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(ChildrenDiffer, _super);\n  /**\n   * @param - Initializing Children <ko>    </ko>\n   */\n\n\n  function ChildrenDiffer(list) {\n    if (list === void 0) {\n      list = [];\n    }\n\n    return _super.call(this, list, findKeyCallback) || this;\n  }\n\n  return ChildrenDiffer;\n}(ListDiffer);\n\n/*\negjs-children-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n/**\n *\n * @memberof eg.ChildrenDiffer\n * @static\n * @function\n * @param - Previous List <ko>   </ko>\n * @param - List to Update <ko>    </ko>\n * @return - Returns the diff between `prevList` and `list` <ko> `prevList` `list`   .</ko>\n * @example\n * import { diff } from \"@egjs/children-differ\";\n * // script => eg.ChildrenDiffer.diff\n * const result = diff([0, 1, 2, 3, 4, 5], [7, 8, 0, 4, 3, 6, 2, 1]);\n * // List before update\n * // [1, 2, 3, 4, 5]\n * console.log(result.prevList);\n * // Updated list\n * // [4, 3, 6, 2, 1]\n * console.log(result.list);\n * // Index array of values added to `list`\n * // [0, 1, 5]\n * console.log(result.added);\n * // Index array of values removed in `prevList`\n * // [5]\n * console.log(result.removed);\n * // An array of index pairs of `prevList` and `list` with different indexes from `prevList` and `list`\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.changed);\n * // The subset of `changed` and an array of index pairs that moved data directly. Indicate an array of absolute index pairs of `ordered`.(Formatted by: Array<[index of prevList, index of list]>)\n * // [[4, 3], [3, 4], [2, 6]]\n * console.log(result.pureChanged);\n * // An array of index pairs to be `ordered` that can synchronize `list` before adding data. (Formatted by: Array<[prevIndex, nextIndex]>)\n * // [[4, 1], [4, 2], [4, 3]]\n * console.log(result.ordered);\n * // An array of index pairs of `prevList` and `list` that have not been added/removed so data is preserved\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.maintained);\n */\n\nfunction diff(prevList, list) {\n  return diff$1(prevList, list, findKeyCallback);\n}\n\n/*\negjs-children-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n\nexport default ChildrenDiffer;\nexport { diff };\n//# sourceMappingURL=children-differ.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: @scena/event-emitter\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/gesture.git\nversion: 1.0.5\n*/\nimport { isObject, findIndex } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n}\n\n/**\n * Implement EventEmitter on object or component.\n */\n\nvar EventEmitter =\n/*#__PURE__*/\nfunction () {\n  function EventEmitter() {\n    this._events = {};\n  }\n  /**\n   * Add a listener to the registered event.\n   * @param - Name of the event to be added\n   * @param - listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add listener in \"a\" event\n   * emitter.on(\"a\", () => {\n   * });\n   * // Add listeners\n   * emitter.on({\n   *  a: () => {},\n   *  b: () => {},\n   * });\n   */\n\n\n  var __proto = EventEmitter.prototype;\n\n  __proto.on = function (eventName, listener) {\n    if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.on(name, eventName[name]);\n      }\n    } else {\n      this._addEvent(eventName, listener, {});\n    }\n\n    return this;\n  };\n  /**\n   * Remove listeners registered in the event target.\n   * @param - Name of the event to be removed\n   * @param - listener function of the event to be removed\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Remove all listeners.\n   * emitter.off();\n   *\n   * // Remove all listeners in \"A\" event.\n   * emitter.off(\"a\");\n   *\n   *\n   * // Remove \"listener\" listener in \"a\" event.\n   * emitter.off(\"a\", listener);\n   */\n\n\n  __proto.off = function (eventName, listener) {\n    if (!eventName) {\n      this._events = {};\n    } else if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.off(name);\n      }\n    } else if (!listener) {\n      this._events[eventName] = [];\n    } else {\n      var events = this._events[eventName];\n\n      if (events) {\n        var index = findIndex(events, function (e) {\n          return e.listener === listener;\n        });\n\n        if (index > -1) {\n          events.splice(index, 1);\n        }\n      }\n    }\n\n    return this;\n  };\n  /**\n   * Add a disposable listener and Use promise to the registered event.\n   * @param - Name of the event to be added\n   * @param - disposable listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add a disposable listener in \"a\" event\n   * emitter.once(\"a\", () => {\n   * });\n   *\n   * // Use Promise\n   * emitter.once(\"a\").then(e => {\n   * });\n   */\n\n\n  __proto.once = function (eventName, listener) {\n    var _this = this;\n\n    if (listener) {\n      this._addEvent(eventName, listener, {\n        once: true\n      });\n    }\n\n    return new Promise(function (resolve) {\n      _this._addEvent(eventName, resolve, {\n        once: true\n      });\n    });\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n\n  __proto.emit = function (eventName, param) {\n    var _this = this;\n\n    if (param === void 0) {\n      param = {};\n    }\n\n    var events = this._events[eventName];\n\n    if (!eventName || !events) {\n      return true;\n    }\n\n    var isStop = false;\n    param.eventType = eventName;\n\n    param.stop = function () {\n      isStop = true;\n    };\n\n    param.currentTarget = this;\n\n    __spreadArrays(events).forEach(function (info) {\n      info.listener(param);\n\n      if (info.once) {\n        _this.off(eventName, info.listener);\n      }\n    });\n\n    return !isStop;\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n  /**\n  * Fires an event to call listeners.\n  * @param - Event name\n  * @param - Event parameter\n  * @return If false, stop the event.\n  * @example\n  *\n  * import EventEmitter from \"@scena/event-emitter\";\n  *\n  *\n  * const emitter = new EventEmitter();\n  *\n  * emitter.on(\"a\", e => {\n  * });\n  *\n  * // emit\n  * emitter.trigger(\"a\", {\n  *   a: 1,\n  * });\n  */\n\n\n  __proto.trigger = function (eventName, param) {\n    if (param === void 0) {\n      param = {};\n    }\n\n    return this.emit(eventName, param);\n  };\n\n  __proto._addEvent = function (eventName, listener, options) {\n    var events = this._events;\n    events[eventName] = events[eventName] || [];\n    var listeners = events[eventName];\n    listeners.push(__assign({\n      listener: listener\n    }, options));\n  };\n\n  return EventEmitter;\n}();\n\nexport default EventEmitter;\n//# sourceMappingURL=event-emitter.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: @scena/dragscroll\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/dragscroll.git\nversion: 1.4.0\n*/\nimport EventEmitter from '@scena/event-emitter';\nimport { now, isString, isFunction } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n  return extendStatics(d, b);\n};\nfunction __extends(d, b) {\n  extendStatics(d, b);\n  function __() {\n    this.constructor = d;\n  }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\n\nfunction getDefaultScrollPosition(e) {\n  var container = e.container;\n  if (container === document.body) {\n    return [container.scrollLeft || document.documentElement.scrollLeft, container.scrollTop || document.documentElement.scrollTop];\n  }\n  return [container.scrollLeft, container.scrollTop];\n}\nfunction checkDefaultScrollEvent(container, callback) {\n  container.addEventListener(\"scroll\", callback);\n  return function () {\n    container.removeEventListener(\"scroll\", callback);\n  };\n}\nfunction getContainerElement(container) {\n  if (!container) {\n    return null;\n  } else if (isString(container)) {\n    return document.querySelector(container);\n  }\n  if (isFunction(container)) {\n    return container();\n  } else if (container instanceof Element) {\n    return container;\n  } else if (\"current\" in container) {\n    return container.current;\n  } else if (\"value\" in container) {\n    return container.value;\n  }\n}\n/**\n * @sort 1\n */\nvar DragScroll = /*#__PURE__*/function (_super) {\n  __extends(DragScroll, _super);\n  function DragScroll() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this._startRect = null;\n    _this._startPos = [];\n    _this._prevTime = 0;\n    _this._timer = 0;\n    _this._prevScrollPos = [0, 0];\n    _this._isWait = false;\n    _this._flag = false;\n    _this._currentOptions = null;\n    _this._lock = false;\n    _this._unregister = null;\n    _this._onScroll = function () {\n      var options = _this._currentOptions;\n      if (_this._lock || !options) {\n        return;\n      }\n      _this.emit(\"scrollDrag\", {\n        next: function (inputEvent) {\n          _this.checkScroll({\n            container: options.container,\n            inputEvent: inputEvent\n          });\n        }\n      });\n    };\n    return _this;\n  }\n  /**\n   */\n  var __proto = DragScroll.prototype;\n  __proto.dragStart = function (e, options) {\n    var container = getContainerElement(options.container);\n    if (!container) {\n      this._flag = false;\n      return;\n    }\n    var top = 0;\n    var left = 0;\n    var width = 0;\n    var height = 0;\n    if (container === document.body) {\n      width = window.innerWidth;\n      height = window.innerHeight;\n    } else {\n      var rect = container.getBoundingClientRect();\n      top = rect.top;\n      left = rect.left;\n      width = rect.width;\n      height = rect.height;\n    }\n    this._flag = true;\n    this._startPos = [e.clientX, e.clientY];\n    this._startRect = {\n      top: top,\n      left: left,\n      width: width,\n      height: height\n    };\n    this._prevScrollPos = this._getScrollPosition([0, 0], options);\n    this._currentOptions = options;\n    this._registerScrollEvent(options);\n  };\n  __proto.drag = function (e, options) {\n    clearTimeout(this._timer);\n    if (!this._flag) {\n      return;\n    }\n    var clientX = e.clientX,\n      clientY = e.clientY;\n    var _a = options.threshold,\n      threshold = _a === void 0 ? 0 : _a;\n    var _b = this,\n      _startRect = _b._startRect,\n      _startPos = _b._startPos;\n    this._currentOptions = options;\n    var direction = [0, 0];\n    if (_startRect.top > clientY - threshold) {\n      if (_startPos[1] > _startRect.top || clientY < _startPos[1]) {\n        direction[1] = -1;\n      }\n    } else if (_startRect.top + _startRect.height < clientY + threshold) {\n      if (_startPos[1] < _startRect.top + _startRect.height || clientY > _startPos[1]) {\n        direction[1] = 1;\n      }\n    }\n    if (_startRect.left > clientX - threshold) {\n      if (_startPos[0] > _startRect.left || clientX < _startPos[0]) {\n        direction[0] = -1;\n      }\n    } else if (_startRect.left + _startRect.width < clientX + threshold) {\n      if (_startPos[0] < _startRect.left + _startRect.width || clientX > _startPos[0]) {\n        direction[0] = 1;\n      }\n    }\n    if (!direction[0] && !direction[1]) {\n      return false;\n    }\n    return this._continueDrag(__assign(__assign({}, options), {\n      direction: direction,\n      inputEvent: e,\n      isDrag: true\n    }));\n  };\n  /**\n   */\n  __proto.checkScroll = function (options) {\n    var _this = this;\n    if (this._isWait) {\n      return false;\n    }\n    var _a = options.prevScrollPos,\n      prevScrollPos = _a === void 0 ? this._prevScrollPos : _a,\n      direction = options.direction,\n      _b = options.throttleTime,\n      throttleTime = _b === void 0 ? 0 : _b,\n      inputEvent = options.inputEvent,\n      isDrag = options.isDrag;\n    var nextScrollPos = this._getScrollPosition(direction || [0, 0], options);\n    var offsetX = nextScrollPos[0] - prevScrollPos[0];\n    var offsetY = nextScrollPos[1] - prevScrollPos[1];\n    var nextDirection = direction || [offsetX ? Math.abs(offsetX) / offsetX : 0, offsetY ? Math.abs(offsetY) / offsetY : 0];\n    this._prevScrollPos = nextScrollPos;\n    this._lock = false;\n    if (!offsetX && !offsetY) {\n      return false;\n    }\n    /**\n     * @event DragScroll#move\n     */\n    this.emit(\"move\", {\n      offsetX: nextDirection[0] ? offsetX : 0,\n      offsetY: nextDirection[1] ? offsetY : 0,\n      inputEvent: inputEvent\n    });\n    if (throttleTime && isDrag) {\n      clearTimeout(this._timer);\n      this._timer = window.setTimeout(function () {\n        _this._continueDrag(options);\n      }, throttleTime);\n    }\n    return true;\n  };\n  /**\n   *\n   */\n  __proto.dragEnd = function () {\n    this._flag = false;\n    this._lock = false;\n    clearTimeout(this._timer);\n    this._unregisterScrollEvent();\n  };\n  __proto._getScrollPosition = function (direction, options) {\n    var container = options.container,\n      _a = options.getScrollPosition,\n      getScrollPosition = _a === void 0 ? getDefaultScrollPosition : _a;\n    return getScrollPosition({\n      container: getContainerElement(container),\n      direction: direction\n    });\n  };\n  __proto._continueDrag = function (options) {\n    var _this = this;\n    var _a;\n    var container = options.container,\n      direction = options.direction,\n      throttleTime = options.throttleTime,\n      useScroll = options.useScroll,\n      isDrag = options.isDrag,\n      inputEvent = options.inputEvent;\n    if (!this._flag || isDrag && this._isWait) {\n      return;\n    }\n    var nowTime = now();\n    var distTime = Math.max(throttleTime + this._prevTime - nowTime, 0);\n    if (distTime > 0) {\n      clearTimeout(this._timer);\n      this._timer = window.setTimeout(function () {\n        _this._continueDrag(options);\n      }, distTime);\n      return false;\n    }\n    this._prevTime = nowTime;\n    var prevScrollPos = this._getScrollPosition(direction, options);\n    this._prevScrollPos = prevScrollPos;\n    if (isDrag) {\n      this._isWait = true;\n    }\n    // unregister native scroll event\n    if (!useScroll) {\n      this._lock = true;\n    }\n    var param = {\n      container: getContainerElement(container),\n      direction: direction,\n      inputEvent: inputEvent\n    };\n    (_a = options.requestScroll) === null || _a === void 0 ? void 0 : _a.call(options, param);\n    /**\n     * @event DragScroll#scroll\n     */\n    this.emit(\"scroll\", param);\n    this._isWait = false;\n    return useScroll || this.checkScroll(__assign(__assign({}, options), {\n      prevScrollPos: prevScrollPos,\n      direction: direction,\n      inputEvent: inputEvent\n    }));\n  };\n  __proto._registerScrollEvent = function (options) {\n    this._unregisterScrollEvent();\n    var checkScrollEvent = options.checkScrollEvent;\n    if (!checkScrollEvent) {\n      return;\n    }\n    var callback = checkScrollEvent === true ? checkDefaultScrollEvent : checkScrollEvent;\n    var container = getContainerElement(options.container);\n    if (checkScrollEvent === true && (container === document.body || container === document.documentElement)) {\n      this._unregister = checkDefaultScrollEvent(window, this._onScroll);\n    } else {\n      this._unregister = callback(container, this._onScroll);\n    }\n  };\n  __proto._unregisterScrollEvent = function () {\n    var _a;\n    (_a = this._unregister) === null || _a === void 0 ? void 0 : _a.call(this);\n    this._unregister = null;\n  };\n  return DragScroll;\n}(EventEmitter);\n\nexport default DragScroll;\n//# sourceMappingURL=dragscroll.esm.js.map\n","/*\nCopyright (c) 2020 Daybrush\nname: overlap-area\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/overlap-area.git\nversion: 1.1.0\n*/\nimport { throttle, TINY_NUM, sum, find, getDist, getShapeDirection, findIndex } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n}\n\nfunction tinyThrottle(num) {\n  return throttle(num, TINY_NUM);\n}\nfunction isSameConstants(linearConstants1, linearConstants2) {\n  return linearConstants1.every(function (v, i) {\n    return tinyThrottle(v - linearConstants2[i]) === 0;\n  });\n}\nfunction isSamePoint(point1, point2) {\n  return !tinyThrottle(point1[0] - point2[0]) && !tinyThrottle(point1[1] - point2[1]);\n}\nfunction flat(arr) {\n  return arr.reduce(function (prev, current) {\n    prev.push.apply(prev, current);\n    return prev;\n  }, []);\n}\n\n/**\n * @namespace OverlapArea\n */\n\n/**\n * Gets the size of a shape (polygon) made of points.\n * @memberof OverlapArea\n */\n\nfunction getAreaSize(points) {\n  if (points.length < 3) {\n    return 0;\n  }\n\n  return Math.abs(sum(points.map(function (point, i) {\n    var nextPoint = points[i + 1] || points[0];\n    return point[0] * nextPoint[1] - nextPoint[0] * point[1];\n  }))) / 2;\n}\n/**\n * Get points that fit the rect,\n * @memberof OverlapArea\n */\n\nfunction fitPoints(points, rect) {\n  var width = rect.width,\n      height = rect.height,\n      left = rect.left,\n      top = rect.top;\n\n  var _a = getMinMaxs(points),\n      minX = _a.minX,\n      minY = _a.minY,\n      maxX = _a.maxX,\n      maxY = _a.maxY;\n\n  var ratioX = width / (maxX - minX);\n  var ratioY = height / (maxY - minY);\n  return points.map(function (point) {\n    return [left + (point[0] - minX) * ratioX, top + (point[1] - minY) * ratioY];\n  });\n}\n/**\n * Get the minimum and maximum points of the points.\n * @memberof OverlapArea\n */\n\nfunction getMinMaxs(points) {\n  var xs = points.map(function (point) {\n    return point[0];\n  });\n  var ys = points.map(function (point) {\n    return point[1];\n  });\n  return {\n    minX: Math.min.apply(Math, xs),\n    minY: Math.min.apply(Math, ys),\n    maxX: Math.max.apply(Math, xs),\n    maxY: Math.max.apply(Math, ys)\n  };\n}\n/**\n * Whether the point is in shape\n * @param - point pos\n * @param - shape points\n * @param - whether to check except line\n * @memberof OverlapArea\n */\n\nfunction isInside(pos, points, excludeLine) {\n  var x = pos[0],\n      y = pos[1];\n\n  var _a = getMinMaxs(points),\n      minX = _a.minX,\n      maxX = _a.maxX;\n\n  var xLine = [[minX, y], [maxX, y]];\n  var xLinearConstants = getLinearConstants(xLine[0], xLine[1]);\n  var lines = convertLines(points);\n  var intersectionPosInfos = [];\n  lines.forEach(function (line) {\n    var linearConstants = getLinearConstants(line[0], line[1]);\n    var standardPoint = line[0];\n\n    if (isSameConstants(xLinearConstants, linearConstants)) {\n      intersectionPosInfos.push({\n        pos: pos,\n        line: line,\n        type: \"line\"\n      });\n    } else {\n      var xPoints = getPointsOnLines(getIntersectionPointsByConstants(xLinearConstants, linearConstants), [xLine, line]);\n      xPoints.forEach(function (point) {\n        if (line.some(function (linePoint) {\n          return isSamePoint(linePoint, point);\n        })) {\n          intersectionPosInfos.push({\n            pos: point,\n            line: line,\n            type: \"point\"\n          });\n        } else if (tinyThrottle(standardPoint[1] - y) !== 0) {\n          intersectionPosInfos.push({\n            pos: point,\n            line: line,\n            type: \"intersection\"\n          });\n        }\n      });\n    }\n  });\n\n  if (!excludeLine) {\n    // on line\n    if (find(intersectionPosInfos, function (p) {\n      return p[0] === x;\n    })) {\n      return true;\n    }\n  }\n\n  var intersectionCount = 0;\n  var xMap = {};\n  intersectionPosInfos.forEach(function (_a) {\n    var pos = _a.pos,\n        type = _a.type,\n        line = _a.line;\n\n    if (pos[0] > x) {\n      return;\n    }\n\n    if (type === \"intersection\") {\n      ++intersectionCount;\n    } else if (type === \"line\") {\n      return;\n    } else if (type === \"point\") {\n      var point = find(line, function (linePoint) {\n        return linePoint[1] !== y;\n      });\n      var prevValue = xMap[pos[0]];\n      var nextValue = point[1] > y ? 1 : -1;\n\n      if (!prevValue) {\n        xMap[pos[0]] = nextValue;\n      } else if (prevValue !== nextValue) {\n        ++intersectionCount;\n      }\n    }\n  });\n  return intersectionCount % 2 === 1;\n}\n/**\n * Get distance from point to constants. [a, b, c] (ax + by + c = 0)\n * @return [a, b, c]\n * @memberof OverlapArea\n */\n\nfunction getDistanceFromPointToConstants(_a, pos) {\n  var a = _a[0],\n      b = _a[1],\n      c = _a[2];\n  return (a * pos[0] + b * pos[1] + c) / (a * a + b * b);\n}\n/**\n * Get the coefficient of the linear function. [a, b, c] (ax + by + c = 0)\n * @return [a, b, c]\n * @memberof OverlapArea\n */\n\nfunction getLinearConstants(point1, point2) {\n  var x1 = point1[0],\n      y1 = point1[1];\n  var x2 = point2[0],\n      y2 = point2[1]; // ax + by + c = 0\n  // [a, b, c]\n\n  var dx = x2 - x1;\n  var dy = y2 - y1;\n\n  if (Math.abs(dx) < TINY_NUM) {\n    dx = 0;\n  }\n\n  if (Math.abs(dy) < TINY_NUM) {\n    dy = 0;\n  } // b > 0\n  // ax + by + c = 0\n\n\n  var a = 0;\n  var b = 0;\n  var c = 0;\n\n  if (!dx) {\n    if (dy) {\n      // -x + 1 = 0\n      a = -1;\n      c = x1;\n    }\n  } else if (!dy) {\n    // y - 1 = 0\n    b = 1;\n    c = -y1;\n  } else {\n    // y = -a(x - x1) + y1\n    // ax + y + a * x1 - y1 = 0\n    a = -dy / dx;\n    b = 1;\n    c = -a * x1 - y1;\n  }\n\n  return [a, b, c];\n}\n/**\n * Get intersection points with linear functions.\n * @memberof OverlapArea\n */\n\nfunction getIntersectionPointsByConstants(linearConstants1, linearConstants2) {\n  var a1 = linearConstants1[0],\n      b1 = linearConstants1[1],\n      c1 = linearConstants1[2];\n  var a2 = linearConstants2[0],\n      b2 = linearConstants2[1],\n      c2 = linearConstants2[2];\n  var isZeroA = a1 === 0 && a2 === 0;\n  var isZeroB = b1 === 0 && b2 === 0;\n  var results = [];\n\n  if (isZeroA && isZeroB) {\n    return [];\n  } else if (isZeroA) {\n    // b1 * y + c1 = 0\n    // b2 * y + c2 = 0\n    var y1 = -c1 / b1;\n    var y2 = -c2 / b2;\n\n    if (y1 !== y2) {\n      return [];\n    } else {\n      return [[-Infinity, y1], [Infinity, y1]];\n    }\n  } else if (isZeroB) {\n    // a1 * x + c1 = 0\n    // a2 * x + c2 = 0\n    var x1 = -c1 / a1;\n    var x2 = -c2 / a2;\n\n    if (x1 !== x2) {\n      return [];\n    } else {\n      return [[x1, -Infinity], [x1, Infinity]];\n    }\n  } else if (a1 === 0) {\n    // b1 * y + c1 = 0\n    // y = - c1 / b1;\n    // a2 * x + b2 * y + c2 = 0\n    var y = -c1 / b1;\n    var x = -(b2 * y + c2) / a2;\n    results = [[x, y]];\n  } else if (a2 === 0) {\n    // b2 * y + c2 = 0\n    // y = - c2 / b2;\n    // a1 * x + b1 * y + c1 = 0\n    var y = -c2 / b2;\n    var x = -(b1 * y + c1) / a1;\n    results = [[x, y]];\n  } else if (b1 === 0) {\n    // a1 * x + c1 = 0\n    // x = - c1 / a1;\n    // a2 * x + b2 * y + c2 = 0\n    var x = -c1 / a1;\n    var y = -(a2 * x + c2) / b2;\n    results = [[x, y]];\n  } else if (b2 === 0) {\n    // a2 * x + c2 = 0\n    // x = - c2 / a2;\n    // a1 * x + b1 * y + c1 = 0\n    var x = -c2 / a2;\n    var y = -(a1 * x + c1) / b1;\n    results = [[x, y]];\n  } else {\n    // a1 * x + b1 * y + c1 = 0\n    // a2 * x + b2 * y + c2 = 0\n    // b2 * a1 * x + b2 * b1 * y + b2 * c1 = 0\n    // b1 * a2 * x + b1 * b2 * y + b1 * c2 = 0\n    // (b2 * a1 - b1 * a2)  * x = (b1 * c2 - b2 * c1)\n    var x = (b1 * c2 - b2 * c1) / (b2 * a1 - b1 * a2);\n    var y = -(a1 * x + c1) / b1;\n    results = [[x, y]];\n  }\n\n  return results.map(function (result) {\n    return [result[0], result[1]];\n  });\n}\n/**\n * Get intersection points to the two lines.\n * @memberof OverlapArea\n */\n\nfunction getIntersectionPoints(line1, line2, isLimit) {\n  var points = getIntersectionPointsByConstants(getLinearConstants(line1[0], line1[1]), getLinearConstants(line2[0], line2[1]));\n\n  if (isLimit) {\n    return getPointsOnLines(points, [line1, line2]);\n  }\n\n  return points;\n}\nfunction isPointOnLine(pos, line) {\n  var linearConstants = getLinearConstants(line[0], line[1]);\n  return tinyThrottle(getDistanceFromPointToConstants(linearConstants, pos)) === 0;\n}\n/**\n * Get the points on the lines (between two points).\n * @memberof OverlapArea\n */\n\nfunction getPointsOnLines(points, lines) {\n  var minMaxs = lines.map(function (line) {\n    return [0, 1].map(function (order) {\n      return [Math.min(line[0][order], line[1][order]), Math.max(line[0][order], line[1][order])];\n    });\n  });\n  var results = [];\n\n  if (points.length === 2) {\n    var _a = points[0],\n        x = _a[0],\n        y = _a[1];\n\n    if (!tinyThrottle(x - points[1][0])) {\n      /// Math.max(minY1, minY2)\n      var top = Math.max.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[1][0];\n      })); /// Math.min(maxY1, miax2)\n\n      var bottom = Math.min.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[1][1];\n      }));\n\n      if (tinyThrottle(top - bottom) > 0) {\n        return [];\n      }\n\n      results = [[x, top], [x, bottom]];\n    } else if (!tinyThrottle(y - points[1][1])) {\n      /// Math.max(minY1, minY2)\n      var left = Math.max.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[0][0];\n      })); /// Math.min(maxY1, miax2)\n\n      var right = Math.min.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[0][1];\n      }));\n\n      if (tinyThrottle(left - right) > 0) {\n        return [];\n      }\n\n      results = [[left, y], [right, y]];\n    }\n  }\n\n  if (!results.length) {\n    results = points.filter(function (point) {\n      var pointX = point[0],\n          pointY = point[1];\n      return minMaxs.every(function (minMax) {\n        return 0 <= tinyThrottle(pointX - minMax[0][0]) && 0 <= tinyThrottle(minMax[0][1] - pointX) && 0 <= tinyThrottle(pointY - minMax[1][0]) && 0 <= tinyThrottle(minMax[1][1] - pointY);\n      });\n    });\n  }\n\n  return results.map(function (result) {\n    return [tinyThrottle(result[0]), tinyThrottle(result[1])];\n  });\n}\n/**\n* Convert two points into lines.\n* @function\n* @memberof OverlapArea\n*/\n\nfunction convertLines(points) {\n  return __spreadArrays(points.slice(1), [points[0]]).map(function (point, i) {\n    return [points[i], point];\n  });\n}\n\nfunction getOverlapPointInfos(points1, points2) {\n  var targetPoints1 = points1.slice();\n  var targetPoints2 = points2.slice();\n\n  if (getShapeDirection(targetPoints1) === -1) {\n    targetPoints1.reverse();\n  }\n\n  if (getShapeDirection(targetPoints2) === -1) {\n    targetPoints2.reverse();\n  }\n\n  var lines1 = convertLines(targetPoints1);\n  var lines2 = convertLines(targetPoints2);\n  var linearConstantsList1 = lines1.map(function (line1) {\n    return getLinearConstants(line1[0], line1[1]);\n  });\n  var linearConstantsList2 = lines2.map(function (line2) {\n    return getLinearConstants(line2[0], line2[1]);\n  });\n  var overlapInfos = [];\n  linearConstantsList1.forEach(function (linearConstants1, i) {\n    var line1 = lines1[i];\n    var linePointInfos = [];\n    linearConstantsList2.forEach(function (linearConstants2, j) {\n      var intersectionPoints = getIntersectionPointsByConstants(linearConstants1, linearConstants2);\n      var points = getPointsOnLines(intersectionPoints, [line1, lines2[j]]);\n      linePointInfos.push.apply(linePointInfos, points.map(function (pos) {\n        return {\n          index1: i,\n          index2: j,\n          pos: pos,\n          type: \"intersection\"\n        };\n      }));\n    });\n    linePointInfos.sort(function (a, b) {\n      return getDist(line1[0], a.pos) - getDist(line1[0], b.pos);\n    });\n    overlapInfos.push.apply(overlapInfos, linePointInfos);\n\n    if (isInside(line1[1], targetPoints2)) {\n      overlapInfos.push({\n        index1: i,\n        index2: -1,\n        pos: line1[1],\n        type: \"inside\"\n      });\n    }\n  });\n  lines2.forEach(function (line2, i) {\n    if (!isInside(line2[1], targetPoints1)) {\n      return;\n    }\n\n    var isNext = false;\n    var index = findIndex(overlapInfos, function (_a) {\n      var index2 = _a.index2;\n\n      if (index2 === i) {\n        isNext = true;\n        return false;\n      }\n\n      if (isNext) {\n        return true;\n      }\n\n      return false;\n    });\n\n    if (index === -1) {\n      isNext = false;\n      index = findIndex(overlapInfos, function (_a) {\n        var index1 = _a.index1,\n            index2 = _a.index2;\n\n        if (index1 === -1 && index2 + 1 === i) {\n          isNext = true;\n          return false;\n        }\n\n        if (isNext) {\n          return true;\n        }\n\n        return false;\n      });\n    }\n\n    if (index === -1) {\n      overlapInfos.push({\n        index1: -1,\n        index2: i,\n        pos: line2[1],\n        type: \"inside\"\n      });\n    } else {\n      overlapInfos.splice(index, 0, {\n        index1: -1,\n        index2: i,\n        pos: line2[1],\n        type: \"inside\"\n      });\n    }\n  });\n  var pointMap = {};\n  return overlapInfos.filter(function (_a) {\n    var pos = _a.pos;\n    var key = pos[0] + \"x\" + pos[1];\n\n    if (pointMap[key]) {\n      return false;\n    }\n\n    pointMap[key] = true;\n    return true;\n  });\n}\n/**\n* Get the points of the overlapped part of two shapes.\n* @function\n* @memberof OverlapArea\n*/\n\n\nfunction getOverlapPoints(points1, points2) {\n  var infos = getOverlapPointInfos(points1, points2);\n  return infos.map(function (_a) {\n    var pos = _a.pos;\n    return pos;\n  });\n}\n\nfunction isConnectedLine(line) {\n  var _a = line[0],\n      prevIndex1 = _a.index1,\n      prevIndex2 = _a.index2,\n      _b = line[1],\n      nextIndex1 = _b.index1,\n      nextIndex2 = _b.index2;\n\n  if (prevIndex1 !== -1) {\n    // same line\n    if (prevIndex1 === nextIndex1) {\n      return true;\n    }\n\n    if (prevIndex1 + 1 === nextIndex1) {\n      return true;\n    }\n  }\n\n  if (prevIndex2 !== -1) {\n    // same line\n    if (prevIndex2 === nextIndex2) {\n      return true;\n    }\n\n    if (prevIndex2 + 1 === nextIndex2) {\n      return true;\n    }\n  }\n\n  return false;\n}\n/**\n* Get the areas of the overlapped part of two shapes.\n* @function\n* @memberof OverlapArea\n*/\n\n\nfunction getOverlapAreas(points1, points2) {\n  var infos = getOverlapPointInfos(points1, points2);\n  var areas = [];\n  var area;\n  getOverlapPointInfos(points1, points2).forEach(function (info, i, arr) {\n    if (i === 0 || !isConnectedLine([arr[i - 1], info])) {\n      area = [info];\n      areas.push(area);\n    } else {\n      area.push(info);\n    }\n  });\n  return areas.map(function (area) {\n    return area.map(function (_a) {\n      var pos = _a.pos;\n      return pos;\n    });\n  });\n}\n\nfunction findReversedAreas(points1, points2, index, areas) {\n  if (index === void 0) {\n    index = 0;\n  }\n\n  if (areas === void 0) {\n    areas = [];\n  }\n\n  var isFirst = areas.length === 0;\n  var length = points1.length;\n  var nextIndex = points1[index] ? index : 0;\n\n  var nextPoints1 = __spreadArrays(points1.slice(nextIndex), points1.slice(0, nextIndex));\n\n  var _loop_1 = function (i) {\n    var point1 = nextPoints1[i];\n\n    if (find(points2, function (point2) {\n      return point2[0] === point1[0] && point2[1] === point1[1];\n    })) {\n      return \"continue\";\n    }\n\n    if (areas.some(function (nextArea) {\n      return find(nextArea, function (areaPoint) {\n        return areaPoint[0] === point1[0] && areaPoint[1] === point1[1];\n      });\n    })) {\n      if (isFirst) {\n        return \"continue\";\n      } else {\n        return \"break\";\n      }\n    }\n\n    var nextArea = void 0;\n\n    if (isFirst) {\n      nextArea = [];\n      areas.push(nextArea);\n    } else {\n      nextArea = areas[areas.length - 1];\n    }\n\n    nextArea.push(point1);\n    var line = [point1, points1[index + 1] || points1[0]];\n    var nextPoint2 = points2.filter(function (point2) {\n      return isPointOnLine(point2, line);\n    }).sort(function (a, b) {\n      return getDist(point1, a) - getDist(point1, b);\n    })[0];\n\n    if (!nextPoint2) {\n      findReversedAreas(nextPoints1, points2, i + 1, areas);\n      return \"break\";\n    } else {\n      var point2Index = points2.indexOf(nextPoint2);\n      findReversedAreas(points2, points1, point2Index, areas);\n\n      if (!isFirst) {\n        return \"break\";\n      }\n    }\n  };\n\n  for (var i = 0; i < length; ++i) {\n    var state_1 = _loop_1(i);\n\n    if (state_1 === \"break\") break;\n  }\n\n  return areas;\n}\n\nfunction findConnectedAreas(points1, points2) {\n  return findReversedAreas(points1, __spreadArrays(points2).reverse());\n}\n/**\n* Get non-overlapping areas of two shapes based on points1.\n* @memberof OverlapArea\n*/\n\nfunction getUnoverlapAreas(points1, points2) {\n  if (!points2.length) {\n    return [__spreadArrays(points1)];\n  }\n\n  var overlapAreas = getOverlapAreas(points1, points2);\n  var unoverlapAreas = [points1];\n  overlapAreas.forEach(function (overlapArea) {\n    var nextOverlapArea = __spreadArrays(overlapArea).reverse();\n\n    unoverlapAreas = flat(unoverlapAreas.map(function (area) {\n      var connectedAreas = findReversedAreas(area, nextOverlapArea);\n      var firstConnectedArea = connectedAreas[0];\n\n      if (connectedAreas.length === 1 && nextOverlapArea.every(function (point) {\n        return firstConnectedArea.indexOf(point) === -1;\n      })) {\n        var lastPoint_1 = firstConnectedArea[firstConnectedArea.length - 1];\n\n        var firstPoint = __spreadArrays(nextOverlapArea).sort(function (a, b) {\n          return getDist(lastPoint_1, a) - getDist(lastPoint_1, b);\n        })[0];\n\n        var firstIndex = nextOverlapArea.indexOf(firstPoint);\n        firstConnectedArea.push.apply(firstConnectedArea, __spreadArrays(nextOverlapArea.slice(firstIndex), nextOverlapArea.slice(0, firstIndex), [nextOverlapArea[firstIndex], lastPoint_1]));\n      }\n\n      return connectedAreas;\n    }));\n  });\n  return unoverlapAreas;\n}\n/**\n* Gets the size of the overlapped part of two shapes.\n* @function\n* @memberof OverlapArea\n*/\n\nfunction getOverlapSize(points1, points2) {\n  var points = getOverlapPoints(points1, points2);\n  return getAreaSize(points);\n}\n\nexport { convertLines, findConnectedAreas, fitPoints, getAreaSize, getDistanceFromPointToConstants, getIntersectionPoints, getIntersectionPointsByConstants, getLinearConstants, getMinMaxs, getOverlapAreas, getOverlapPoints, getOverlapSize, getPointsOnLines, getUnoverlapAreas, isInside, isPointOnLine };\n//# sourceMappingURL=overlap-area.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: gesto\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/gesto.git\nversion: 1.19.4\n*/\nimport EventEmitter from '@scena/event-emitter';\nimport { removeEvent, addEvent, now, isWindow, getWindow } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nfunction getRad(pos1, pos2) {\n    var distX = pos2[0] - pos1[0];\n    var distY = pos2[1] - pos1[1];\n    var rad = Math.atan2(distY, distX);\n    return rad >= 0 ? rad : rad + Math.PI * 2;\n}\nfunction getRotatiion(touches) {\n    return getRad([\n        touches[0].clientX,\n        touches[0].clientY,\n    ], [\n        touches[1].clientX,\n        touches[1].clientY,\n    ]) / Math.PI * 180;\n}\nfunction isMultiTouch(e) {\n    return e.touches && e.touches.length >= 2;\n}\nfunction getEventClients(e) {\n    if (!e) {\n        return [];\n    }\n    if (e.touches) {\n        return getClients(e.touches);\n    }\n    else {\n        return [getClient(e)];\n    }\n}\nfunction isMouseEvent(e) {\n    return e && (e.type.indexOf(\"mouse\") > -1 || \"button\" in e);\n}\nfunction getPosition(clients, prevClients, startClients) {\n    var length = startClients.length;\n    var _a = getAverageClient(clients, length), clientX = _a.clientX, clientY = _a.clientY, originalClientX = _a.originalClientX, originalClientY = _a.originalClientY;\n    var _b = getAverageClient(prevClients, length), prevX = _b.clientX, prevY = _b.clientY;\n    var _c = getAverageClient(startClients, length), startX = _c.clientX, startY = _c.clientY;\n    var deltaX = clientX - prevX;\n    var deltaY = clientY - prevY;\n    var distX = clientX - startX;\n    var distY = clientY - startY;\n    return {\n        clientX: originalClientX,\n        clientY: originalClientY,\n        deltaX: deltaX,\n        deltaY: deltaY,\n        distX: distX,\n        distY: distY,\n    };\n}\nfunction getDist(clients) {\n    return Math.sqrt(Math.pow(clients[0].clientX - clients[1].clientX, 2)\n        + Math.pow(clients[0].clientY - clients[1].clientY, 2));\n}\nfunction getClients(touches) {\n    var length = Math.min(touches.length, 2);\n    var clients = [];\n    for (var i = 0; i < length; ++i) {\n        clients.push(getClient(touches[i]));\n    }\n    return clients;\n}\nfunction getClient(e) {\n    return {\n        clientX: e.clientX,\n        clientY: e.clientY,\n    };\n}\nfunction getAverageClient(clients, length) {\n    if (length === void 0) { length = clients.length; }\n    var sumClient = {\n        clientX: 0,\n        clientY: 0,\n        originalClientX: 0,\n        originalClientY: 0,\n    };\n    var minLength = Math.min(clients.length, length);\n    for (var i = 0; i < minLength; ++i) {\n        var client = clients[i];\n        sumClient.originalClientX += \"originalClientX\" in client ? client.originalClientX : client.clientX;\n        sumClient.originalClientY += \"originalClientY\" in client ? client.originalClientY : client.clientY;\n        sumClient.clientX += client.clientX;\n        sumClient.clientY += client.clientY;\n    }\n    if (!length) {\n        return sumClient;\n    }\n    return {\n        clientX: sumClient.clientX / length,\n        clientY: sumClient.clientY / length,\n        originalClientX: sumClient.originalClientX / length,\n        originalClientY: sumClient.originalClientY / length,\n    };\n}\n\nvar ClientStore = /*#__PURE__*/ (function () {\n    function ClientStore(clients) {\n        this.prevClients = [];\n        this.startClients = [];\n        this.movement = 0;\n        this.length = 0;\n        this.startClients = clients;\n        this.prevClients = clients;\n        this.length = clients.length;\n    }\n    ClientStore.prototype.getAngle = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getRotatiion(clients);\n    };\n    ClientStore.prototype.getRotation = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getRotatiion(clients) - getRotatiion(this.startClients);\n    };\n    ClientStore.prototype.getPosition = function (clients, isAdd) {\n        if (clients === void 0) { clients = this.prevClients; }\n        var position = getPosition(clients || this.prevClients, this.prevClients, this.startClients);\n        var deltaX = position.deltaX, deltaY = position.deltaY;\n        this.movement += Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n        this.prevClients = clients;\n        return position;\n    };\n    ClientStore.prototype.getPositions = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        var prevClients = this.prevClients;\n        var startClients = this.startClients;\n        var minLength = Math.min(this.length, prevClients.length);\n        var positions = [];\n        for (var i = 0; i < minLength; ++i) {\n            positions[i] = getPosition([clients[i]], [prevClients[i]], [startClients[i]]);\n        }\n        return positions;\n    };\n    ClientStore.prototype.getMovement = function (clients) {\n        var movement = this.movement;\n        if (!clients) {\n            return movement;\n        }\n        var currentClient = getAverageClient(clients, this.length);\n        var prevClient = getAverageClient(this.prevClients, this.length);\n        var deltaX = currentClient.clientX - prevClient.clientX;\n        var deltaY = currentClient.clientY - prevClient.clientY;\n        return Math.sqrt(deltaX * deltaX + deltaY * deltaY) + movement;\n    };\n    ClientStore.prototype.getDistance = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getDist(clients);\n    };\n    ClientStore.prototype.getScale = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getDist(clients) / getDist(this.startClients);\n    };\n    ClientStore.prototype.move = function (deltaX, deltaY) {\n        this.startClients.forEach(function (client) {\n            client.clientX -= deltaX;\n            client.clientY -= deltaY;\n        });\n        this.prevClients.forEach(function (client) {\n            client.clientX -= deltaX;\n            client.clientY -= deltaY;\n        });\n    };\n    return ClientStore;\n}());\n\nvar INPUT_TAGNAMES = [\"textarea\", \"input\"];\n/**\n * You can set up drag, pinch events in any browser.\n */\nvar Gesto = /*#__PURE__*/ (function (_super) {\n    __extends(Gesto, _super);\n    /**\n     *\n     */\n    function Gesto(targets, options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this) || this;\n        _this.options = {};\n        _this.flag = false;\n        _this.pinchFlag = false;\n        _this.data = {};\n        _this.isDrag = false;\n        _this.isPinch = false;\n        _this.clientStores = [];\n        _this.targets = [];\n        _this.prevTime = 0;\n        _this.doubleFlag = false;\n        _this._useMouse = false;\n        _this._useTouch = false;\n        _this._useDrag = false;\n        _this._dragFlag = false;\n        _this._isTrusted = false;\n        _this._isMouseEvent = false;\n        _this._isSecondaryButton = false;\n        _this._preventMouseEvent = false;\n        _this._prevInputEvent = null;\n        _this._isDragAPI = false;\n        _this._isIdle = true;\n        _this._preventMouseEventId = 0;\n        _this._window = window;\n        _this.onDragStart = function (e, isTrusted) {\n            if (isTrusted === void 0) { isTrusted = true; }\n            if (!_this.flag && e.cancelable === false) {\n                return;\n            }\n            var isDragAPI = e.type.indexOf(\"drag\") >= -1;\n            if (_this.flag && isDragAPI) {\n                return;\n            }\n            _this._isDragAPI = true;\n            var _a = _this.options, container = _a.container, pinchOutside = _a.pinchOutside, preventWheelClick = _a.preventWheelClick, preventRightClick = _a.preventRightClick, preventDefault = _a.preventDefault, checkInput = _a.checkInput, dragFocusedInput = _a.dragFocusedInput, preventClickEventOnDragStart = _a.preventClickEventOnDragStart, preventClickEventOnDrag = _a.preventClickEventOnDrag, preventClickEventByCondition = _a.preventClickEventByCondition;\n            var useTouch = _this._useTouch;\n            var isDragStart = !_this.flag;\n            _this._isSecondaryButton = e.which === 3 || e.button === 2;\n            if ((preventWheelClick && (e.which === 2 || e.button === 1))\n                || (preventRightClick && (e.which === 3 || e.button === 2))) {\n                _this.stop();\n                return false;\n            }\n            if (isDragStart) {\n                var activeElement = _this._window.document.activeElement;\n                var target = e.target;\n                if (target) {\n                    var tagName = target.tagName.toLowerCase();\n                    var hasInput = INPUT_TAGNAMES.indexOf(tagName) > -1;\n                    var hasContentEditable = target.isContentEditable;\n                    if (hasInput || hasContentEditable) {\n                        if (checkInput || (!dragFocusedInput && activeElement === target)) {\n                            // force false or already focused.\n                            return false;\n                        }\n                        // no focus\n                        if (activeElement && (activeElement === target\n                            || (hasContentEditable && activeElement.isContentEditable && activeElement.contains(target)))) {\n                            if (dragFocusedInput) {\n                                target.blur();\n                            }\n                            else {\n                                return false;\n                            }\n                        }\n                    }\n                    else if ((preventDefault || e.type === \"touchstart\") && activeElement) {\n                        var activeTagName = activeElement.tagName.toLowerCase();\n                        if (activeElement.isContentEditable || INPUT_TAGNAMES.indexOf(activeTagName) > -1) {\n                            activeElement.blur();\n                        }\n                    }\n                    if (preventClickEventOnDragStart || preventClickEventOnDrag || preventClickEventByCondition) {\n                        addEvent(_this._window, \"click\", _this._onClick, true);\n                    }\n                }\n                _this.clientStores = [new ClientStore(getEventClients(e))];\n                _this._isIdle = false;\n                _this.flag = true;\n                _this.isDrag = false;\n                _this._isTrusted = isTrusted;\n                _this._dragFlag = true;\n                _this._prevInputEvent = e;\n                _this.data = {};\n                _this.doubleFlag = now() - _this.prevTime < 200;\n                _this._isMouseEvent = isMouseEvent(e);\n                if (!_this._isMouseEvent && _this._preventMouseEvent) {\n                    _this._allowMouseEvent();\n                }\n                var result = _this._preventMouseEvent || _this.emit(\"dragStart\", __assign(__assign({ data: _this.data, datas: _this.data, inputEvent: e, isMouseEvent: _this._isMouseEvent, isSecondaryButton: _this._isSecondaryButton, isTrusted: isTrusted, isDouble: _this.doubleFlag }, _this.getCurrentStore().getPosition()), { preventDefault: function () {\n                        e.preventDefault();\n                    }, preventDrag: function () {\n                        _this._dragFlag = false;\n                    } }));\n                if (result === false) {\n                    _this.stop();\n                }\n                if (_this._isMouseEvent && _this.flag && preventDefault) {\n                    e.preventDefault();\n                }\n            }\n            if (!_this.flag) {\n                return false;\n            }\n            var timer = 0;\n            if (isDragStart) {\n                _this._attchDragEvent();\n                // wait pinch\n                if (useTouch && pinchOutside) {\n                    timer = setTimeout(function () {\n                        addEvent(container, \"touchstart\", _this.onDragStart, {\n                            passive: false\n                        });\n                    });\n                }\n            }\n            else if (useTouch && pinchOutside) {\n                // pinch is occured\n                removeEvent(container, \"touchstart\", _this.onDragStart);\n            }\n            if (_this.flag && isMultiTouch(e)) {\n                clearTimeout(timer);\n                if (isDragStart && (e.touches.length !== e.changedTouches.length)) {\n                    return;\n                }\n                if (!_this.pinchFlag) {\n                    _this.onPinchStart(e);\n                }\n            }\n        };\n        _this.onDrag = function (e, isScroll) {\n            if (!_this.flag) {\n                return;\n            }\n            var preventDefault = _this.options.preventDefault;\n            if (!_this._isMouseEvent && preventDefault) {\n                e.preventDefault();\n            }\n            _this._prevInputEvent = e;\n            var clients = getEventClients(e);\n            var result = _this.moveClients(clients, e, false);\n            if (_this._dragFlag) {\n                if (_this.pinchFlag || result.deltaX || result.deltaY) {\n                    var dragResult = _this._preventMouseEvent || _this.emit(\"drag\", __assign(__assign({}, result), { isScroll: !!isScroll, inputEvent: e }));\n                    if (dragResult === false) {\n                        _this.stop();\n                        return;\n                    }\n                }\n                if (_this.pinchFlag) {\n                    _this.onPinch(e, clients);\n                }\n            }\n            _this.getCurrentStore().getPosition(clients, true);\n        };\n        _this.onDragEnd = function (e) {\n            if (!_this.flag) {\n                return;\n            }\n            var _a = _this.options, pinchOutside = _a.pinchOutside, container = _a.container, preventClickEventOnDrag = _a.preventClickEventOnDrag, preventClickEventOnDragStart = _a.preventClickEventOnDragStart, preventClickEventByCondition = _a.preventClickEventByCondition;\n            var isDrag = _this.isDrag;\n            if (preventClickEventOnDrag || preventClickEventOnDragStart || preventClickEventByCondition) {\n                requestAnimationFrame(function () {\n                    _this._allowClickEvent();\n                });\n            }\n            if (!preventClickEventByCondition && !preventClickEventOnDragStart && preventClickEventOnDrag && !isDrag) {\n                _this._allowClickEvent();\n            }\n            if (_this._useTouch && pinchOutside) {\n                removeEvent(container, \"touchstart\", _this.onDragStart);\n            }\n            if (_this.pinchFlag) {\n                _this.onPinchEnd(e);\n            }\n            var clients = (e === null || e === void 0 ? void 0 : e.touches) ? getEventClients(e) : [];\n            var clientsLength = clients.length;\n            if (clientsLength === 0 || !_this.options.keepDragging) {\n                _this.flag = false;\n            }\n            else {\n                _this._addStore(new ClientStore(clients));\n            }\n            var position = _this._getPosition();\n            var currentTime = now();\n            var isDouble = !isDrag && _this.doubleFlag;\n            _this._prevInputEvent = null;\n            _this.prevTime = isDrag || isDouble ? 0 : currentTime;\n            if (!_this.flag) {\n                _this._dettachDragEvent();\n                _this._preventMouseEvent || _this.emit(\"dragEnd\", __assign({ data: _this.data, datas: _this.data, isDouble: isDouble, isDrag: isDrag, isClick: !isDrag, isMouseEvent: _this._isMouseEvent, isSecondaryButton: _this._isSecondaryButton, inputEvent: e, isTrusted: _this._isTrusted }, position));\n                _this.clientStores = [];\n                if (!_this._isMouseEvent) {\n                    _this._preventMouseEvent = true;\n                    // Prevent the problem of touch event and mouse event occurring simultaneously\n                    clearTimeout(_this._preventMouseEventId);\n                    _this._preventMouseEventId = setTimeout(function () {\n                        _this._preventMouseEvent = false;\n                    }, 200);\n                }\n                _this._isIdle = true;\n            }\n        };\n        _this.onBlur = function () {\n            _this.onDragEnd();\n        };\n        _this._allowClickEvent = function () {\n            removeEvent(_this._window, \"click\", _this._onClick, true);\n        };\n        _this._onClick = function (e) {\n            _this._allowClickEvent();\n            _this._allowMouseEvent();\n            var preventClickEventByCondition = _this.options.preventClickEventByCondition;\n            if (preventClickEventByCondition === null || preventClickEventByCondition === void 0 ? void 0 : preventClickEventByCondition(e)) {\n                return;\n            }\n            e.stopPropagation();\n            e.preventDefault();\n        };\n        _this._onContextMenu = function (e) {\n            var options = _this.options;\n            if (!options.preventRightClick) {\n                e.preventDefault();\n            }\n            else {\n                _this.onDragEnd(e);\n            }\n        };\n        _this._passCallback = function () { };\n        var elements = [].concat(targets);\n        var firstTarget = elements[0];\n        _this._window = isWindow(firstTarget) ? firstTarget : getWindow(firstTarget);\n        _this.options = __assign({ checkInput: false, container: firstTarget && !(\"document\" in firstTarget) ? getWindow(firstTarget) : firstTarget, preventRightClick: true, preventWheelClick: true, preventClickEventOnDragStart: false, preventClickEventOnDrag: false, preventClickEventByCondition: null, preventDefault: true, checkWindowBlur: false, keepDragging: false, pinchThreshold: 0, events: [\"touch\", \"mouse\"] }, options);\n        var _a = _this.options, container = _a.container, events = _a.events, checkWindowBlur = _a.checkWindowBlur;\n        _this._useDrag = events.indexOf(\"drag\") > -1;\n        _this._useTouch = events.indexOf(\"touch\") > -1;\n        _this._useMouse = events.indexOf(\"mouse\") > -1;\n        _this.targets = elements;\n        if (_this._useDrag) {\n            elements.forEach(function (el) {\n                addEvent(el, \"dragstart\", _this.onDragStart);\n            });\n        }\n        if (_this._useMouse) {\n            elements.forEach(function (el) {\n                addEvent(el, \"mousedown\", _this.onDragStart);\n                addEvent(el, \"mousemove\", _this._passCallback);\n            });\n            addEvent(container, \"contextmenu\", _this._onContextMenu);\n        }\n        if (checkWindowBlur) {\n            addEvent(getWindow(), \"blur\", _this.onBlur);\n        }\n        if (_this._useTouch) {\n            var passive_1 = {\n                passive: false,\n            };\n            elements.forEach(function (el) {\n                addEvent(el, \"touchstart\", _this.onDragStart, passive_1);\n                addEvent(el, \"touchmove\", _this._passCallback, passive_1);\n            });\n        }\n        return _this;\n    }\n    /**\n     * Stop Gesto's drag events.\n     */\n    Gesto.prototype.stop = function () {\n        this.isDrag = false;\n        this.data = {};\n        this.clientStores = [];\n        this.pinchFlag = false;\n        this.doubleFlag = false;\n        this.prevTime = 0;\n        this.flag = false;\n        this._isIdle = true;\n        this._allowClickEvent();\n        this._dettachDragEvent();\n        this._isDragAPI = false;\n    };\n    /**\n     * The total moved distance\n     */\n    Gesto.prototype.getMovement = function (clients) {\n        return this.getCurrentStore().getMovement(clients) + this.clientStores.slice(1).reduce(function (prev, cur) {\n            return prev + cur.movement;\n        }, 0);\n    };\n    /**\n     * Whether to drag\n     */\n    Gesto.prototype.isDragging = function () {\n        return this.isDrag;\n    };\n    /**\n     * Whether the operation of gesto is finished and is in idle state\n     */\n    Gesto.prototype.isIdle = function () {\n        return this._isIdle;\n    };\n    /**\n     * Whether to start drag\n     */\n    Gesto.prototype.isFlag = function () {\n        return this.flag;\n    };\n    /**\n     * Whether to start pinch\n     */\n    Gesto.prototype.isPinchFlag = function () {\n        return this.pinchFlag;\n    };\n    /**\n     * Whether to start double click\n     */\n    Gesto.prototype.isDoubleFlag = function () {\n        return this.doubleFlag;\n    };\n    /**\n     * Whether to pinch\n     */\n    Gesto.prototype.isPinching = function () {\n        return this.isPinch;\n    };\n    /**\n     * If a scroll event occurs, it is corrected by the scroll distance.\n     */\n    Gesto.prototype.scrollBy = function (deltaX, deltaY, e, isCallDrag) {\n        if (isCallDrag === void 0) { isCallDrag = true; }\n        if (!this.flag) {\n            return;\n        }\n        this.clientStores[0].move(deltaX, deltaY);\n        isCallDrag && this.onDrag(e, true);\n    };\n    /**\n     * Create a virtual drag event.\n     */\n    Gesto.prototype.move = function (_a, inputEvent) {\n        var deltaX = _a[0], deltaY = _a[1];\n        var store = this.getCurrentStore();\n        var nextClients = store.prevClients;\n        return this.moveClients(nextClients.map(function (_a) {\n            var clientX = _a.clientX, clientY = _a.clientY;\n            return {\n                clientX: clientX + deltaX,\n                clientY: clientY + deltaY,\n                originalClientX: clientX,\n                originalClientY: clientY,\n            };\n        }), inputEvent, true);\n    };\n    /**\n     * The dragStart event is triggered by an external event.\n     */\n    Gesto.prototype.triggerDragStart = function (e) {\n        this.onDragStart(e, false);\n    };\n    /**\n     * Set the event data while dragging.\n     */\n    Gesto.prototype.setEventData = function (data) {\n        var currentData = this.data;\n        for (var name_1 in data) {\n            currentData[name_1] = data[name_1];\n        }\n        return this;\n    };\n    /**\n     * Set the event data while dragging.\n     * Use `setEventData`\n     * @deprecated\n     */\n    Gesto.prototype.setEventDatas = function (data) {\n        return this.setEventData(data);\n    };\n    /**\n     * Get the current event state while dragging.\n     */\n    Gesto.prototype.getCurrentEvent = function (inputEvent) {\n        if (inputEvent === void 0) { inputEvent = this._prevInputEvent; }\n        return __assign(__assign({ data: this.data, datas: this.data }, this._getPosition()), { movement: this.getMovement(), isDrag: this.isDrag, isPinch: this.isPinch, isScroll: false, inputEvent: inputEvent });\n    };\n    /**\n     * Get & Set the event data while dragging.\n     */\n    Gesto.prototype.getEventData = function () {\n        return this.data;\n    };\n    /**\n     * Get & Set the event data while dragging.\n     * Use getEventData method\n     * @depreacated\n     */\n    Gesto.prototype.getEventDatas = function () {\n        return this.data;\n    };\n    /**\n     * Unset Gesto\n     */\n    Gesto.prototype.unset = function () {\n        var _this = this;\n        var targets = this.targets;\n        var container = this.options.container;\n        this.off();\n        removeEvent(this._window, \"blur\", this.onBlur);\n        if (this._useDrag) {\n            targets.forEach(function (el) {\n                removeEvent(el, \"dragstart\", _this.onDragStart);\n            });\n        }\n        if (this._useMouse) {\n            targets.forEach(function (target) {\n                removeEvent(target, \"mousedown\", _this.onDragStart);\n            });\n            removeEvent(container, \"contextmenu\", this._onContextMenu);\n        }\n        if (this._useTouch) {\n            targets.forEach(function (target) {\n                removeEvent(target, \"touchstart\", _this.onDragStart);\n            });\n            removeEvent(container, \"touchstart\", this.onDragStart);\n        }\n        this._prevInputEvent = null;\n        this._allowClickEvent();\n        this._dettachDragEvent();\n    };\n    Gesto.prototype.onPinchStart = function (e) {\n        var _this = this;\n        var pinchThreshold = this.options.pinchThreshold;\n        if (this.isDrag && this.getMovement() > pinchThreshold) {\n            return;\n        }\n        var store = new ClientStore(getEventClients(e));\n        this.pinchFlag = true;\n        this._addStore(store);\n        var result = this.emit(\"pinchStart\", __assign(__assign({ data: this.data, datas: this.data, angle: store.getAngle(), touches: this.getCurrentStore().getPositions() }, store.getPosition()), { inputEvent: e, isTrusted: this._isTrusted, preventDefault: function () {\n                e.preventDefault();\n            }, preventDrag: function () {\n                _this._dragFlag = false;\n            } }));\n        if (result === false) {\n            this.pinchFlag = false;\n        }\n    };\n    Gesto.prototype.onPinch = function (e, clients) {\n        if (!this.flag || !this.pinchFlag || clients.length < 2) {\n            return;\n        }\n        var store = this.getCurrentStore();\n        this.isPinch = true;\n        this.emit(\"pinch\", __assign(__assign({ data: this.data, datas: this.data, movement: this.getMovement(clients), angle: store.getAngle(clients), rotation: store.getRotation(clients), touches: store.getPositions(clients), scale: store.getScale(clients), distance: store.getDistance(clients) }, store.getPosition(clients)), { inputEvent: e, isTrusted: this._isTrusted }));\n    };\n    Gesto.prototype.onPinchEnd = function (e) {\n        if (!this.pinchFlag) {\n            return;\n        }\n        var isPinch = this.isPinch;\n        this.isPinch = false;\n        this.pinchFlag = false;\n        var store = this.getCurrentStore();\n        this.emit(\"pinchEnd\", __assign(__assign({ data: this.data, datas: this.data, isPinch: isPinch, touches: store.getPositions() }, store.getPosition()), { inputEvent: e }));\n    };\n    Gesto.prototype.getCurrentStore = function () {\n        return this.clientStores[0];\n    };\n    Gesto.prototype.moveClients = function (clients, inputEvent, isAdd) {\n        var position = this._getPosition(clients, isAdd);\n        var isPrevDrag = this.isDrag;\n        if (position.deltaX || position.deltaY) {\n            this.isDrag = true;\n        }\n        var isFirstDrag = false;\n        if (!isPrevDrag && this.isDrag) {\n            isFirstDrag = true;\n        }\n        return __assign(__assign({ data: this.data, datas: this.data }, position), { movement: this.getMovement(clients), isDrag: this.isDrag, isPinch: this.isPinch, isScroll: false, isMouseEvent: this._isMouseEvent, isSecondaryButton: this._isSecondaryButton, inputEvent: inputEvent, isTrusted: this._isTrusted, isFirstDrag: isFirstDrag });\n    };\n    Gesto.prototype._addStore = function (store) {\n        this.clientStores.splice(0, 0, store);\n    };\n    Gesto.prototype._getPosition = function (clients, isAdd) {\n        var store = this.getCurrentStore();\n        var position = store.getPosition(clients, isAdd);\n        var _a = this.clientStores.slice(1).reduce(function (prev, cur) {\n            var storePosition = cur.getPosition();\n            prev.distX += storePosition.distX;\n            prev.distY += storePosition.distY;\n            return prev;\n        }, position), distX = _a.distX, distY = _a.distY;\n        return __assign(__assign({}, position), { distX: distX, distY: distY });\n    };\n    Gesto.prototype._attchDragEvent = function () {\n        var win = this._window;\n        var container = this.options.container;\n        var passive = {\n            passive: false\n        };\n        if (this._isDragAPI) {\n            addEvent(container, \"dragover\", this.onDrag, passive);\n            addEvent(win, \"dragend\", this.onDragEnd);\n        }\n        if (this._useMouse) {\n            addEvent(container, \"mousemove\", this.onDrag);\n            addEvent(win, \"mouseup\", this.onDragEnd);\n        }\n        if (this._useTouch) {\n            addEvent(container, \"touchmove\", this.onDrag, passive);\n            addEvent(win, \"touchend\", this.onDragEnd, passive);\n            addEvent(win, \"touchcancel\", this.onDragEnd, passive);\n        }\n    };\n    Gesto.prototype._dettachDragEvent = function () {\n        var win = this._window;\n        var container = this.options.container;\n        if (this._isDragAPI) {\n            removeEvent(container, \"dragover\", this.onDrag);\n            removeEvent(win, \"dragend\", this.onDragEnd);\n        }\n        if (this._useMouse) {\n            removeEvent(container, \"mousemove\", this.onDrag);\n            removeEvent(win, \"mouseup\", this.onDragEnd);\n        }\n        if (this._useTouch) {\n            removeEvent(container, \"touchstart\", this.onDragStart);\n            removeEvent(container, \"touchmove\", this.onDrag);\n            removeEvent(win, \"touchend\", this.onDragEnd);\n            removeEvent(win, \"touchcancel\", this.onDragEnd);\n        }\n    };\n    Gesto.prototype._allowMouseEvent = function () {\n        this._preventMouseEvent = false;\n        clearTimeout(this._preventMouseEventId);\n    };\n    return Gesto;\n}(EventEmitter));\n\nexport { Gesto as default };\n//# sourceMappingURL=gesto.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: css-styled\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/css-styled.git\nversion: 1.0.8\n*/\nimport { getDocument, splitComma } from '@daybrush/utils';\n\nfunction hash(str) {\n  var hash = 5381,\n      i    = str.length;\n\n  while(i) {\n    hash = (hash * 33) ^ str.charCodeAt(--i);\n  }\n\n  /* JavaScript does bitwise operations (like XOR, above) on 32-bit signed\n   * integers. Since we want the results to be always positive, convert the\n   * signed int to an unsigned by doing an unsigned bitshift. */\n  return hash >>> 0;\n}\n\nvar stringHash = hash;\n\nfunction getHash(str) {\n  return stringHash(str).toString(36);\n}\nfunction getShadowRoot(parentElement) {\n  if (parentElement && parentElement.getRootNode) {\n    var rootNode = parentElement.getRootNode();\n    if (rootNode.nodeType === 11) {\n      return rootNode;\n    }\n  }\n  return;\n}\nfunction replaceStyle(className, css, options) {\n  if (options.original) {\n    return css;\n  }\n  return css.replace(/([^};{\\s}][^};{]*|^\\s*){/mg, function (_, selector) {\n    var trimmedSelector = selector.trim();\n    return (trimmedSelector ? splitComma(trimmedSelector) : [\"\"]).map(function (subSelector) {\n      var trimmedSubSelector = subSelector.trim();\n      if (trimmedSubSelector.indexOf(\"@\") === 0) {\n        return trimmedSubSelector;\n      } else if (trimmedSubSelector.indexOf(\":global\") > -1) {\n        return trimmedSubSelector.replace(/\\:global/g, \"\");\n      } else if (trimmedSubSelector.indexOf(\":host\") > -1) {\n        return \"\".concat(trimmedSubSelector.replace(/\\:host/g, \".\".concat(className)));\n      } else if (trimmedSubSelector) {\n        return \".\".concat(className, \" \").concat(trimmedSubSelector);\n      } else {\n        return \".\".concat(className);\n      }\n    }).join(\", \") + \" {\";\n  });\n}\nfunction injectStyle(className, css, options, el, shadowRoot) {\n  var doc = getDocument(el);\n  var style = doc.createElement(\"style\");\n  style.setAttribute(\"type\", \"text/css\");\n  style.setAttribute(\"data-styled-id\", className);\n  style.setAttribute(\"data-styled-count\", \"1\");\n  if (options.nonce) {\n    style.setAttribute(\"nonce\", options.nonce);\n  }\n  style.innerHTML = replaceStyle(className, css, options);\n  (shadowRoot || doc.head || doc.body).appendChild(style);\n  return style;\n}\n\n/**\n * Create an styled object that can be defined and inserted into the css.\n * @param - css styles\n */\nfunction styled(css) {\n  var injectClassName = \"rCS\" + getHash(css);\n  return {\n    className: injectClassName,\n    inject: function (el, options) {\n      if (options === void 0) {\n        options = {};\n      }\n      var shadowRoot = getShadowRoot(el);\n      var styleElement = (shadowRoot || el.ownerDocument || document).querySelector(\"style[data-styled-id=\\\"\".concat(injectClassName, \"\\\"]\"));\n      if (!styleElement) {\n        styleElement = injectStyle(injectClassName, css, options, el, shadowRoot);\n      } else {\n        var count = parseFloat(styleElement.getAttribute(\"data-styled-count\")) || 0;\n        styleElement.setAttribute(\"data-styled-count\", \"\".concat(count + 1));\n      }\n      return {\n        destroy: function () {\n          var _a;\n          var injectCount = parseFloat(styleElement.getAttribute(\"data-styled-count\")) || 0;\n          if (injectCount <= 1) {\n            if (styleElement.remove) {\n              styleElement.remove();\n            } else {\n              (_a = styleElement.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(styleElement);\n            }\n            styleElement = null;\n          } else {\n            styleElement.setAttribute(\"data-styled-count\", \"\".concat(injectCount - 1));\n          }\n        }\n      };\n    }\n  };\n}\n\nexport default styled;\n//# sourceMappingURL=styled.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: croact-css-styled\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/css-styled.git\nversion: 1.1.9\n*/\nimport cssStyled from 'css-styled';\nimport { version, createElement, forwardRef, useRef, useImperativeHandle, useEffect, Component } from 'croact';\nimport { ref } from 'framework-utils';\n\n/*\nCopyright (c) 2019 Daybrush\nname: react-css-styled\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/css-styled/tree/master/packages/react-css-styled\nversion: 1.1.9\n*/\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n  return extendStatics(d, b);\n};\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() {\n    this.constructor = d;\n  }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nfunction __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\nvar StyledElement = /*#__PURE__*/function (_super) {\n  __extends(StyledElement, _super);\n  function StyledElement() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.injectResult = null;\n    _this.tag = \"div\";\n    return _this;\n  }\n  var __proto = StyledElement.prototype;\n  __proto.render = function () {\n    var _a = this.props,\n      _b = _a.className,\n      className = _b === void 0 ? \"\" : _b,\n      cspNonce = _a.cspNonce,\n      portalContainer = _a.portalContainer,\n      attributes = __rest(_a, [\"className\", \"cspNonce\", \"portalContainer\"]);\n    var cssId = this.injector.className;\n    var Tag = this.tag;\n    var portalAttributes = {};\n    if ((version || \"\").indexOf(\"simple\") > -1 && portalContainer) {\n      portalAttributes = {\n        portalContainer: portalContainer\n      };\n    }\n    return createElement(Tag, __assign(__assign({\n      \"ref\": ref(this, \"element\"),\n      \"data-styled-id\": cssId,\n      \"className\": \"\".concat(className, \" \").concat(cssId)\n    }, portalAttributes), attributes));\n  };\n  __proto.componentDidMount = function () {\n    this.injectResult = this.injector.inject(this.element, {\n      nonce: this.props.cspNonce\n    });\n  };\n  __proto.componentWillUnmount = function () {\n    this.injectResult.destroy();\n    this.injectResult = null;\n  };\n  __proto.getElement = function () {\n    return this.element;\n  };\n  return StyledElement;\n}(Component);\nfunction defaultStyled(tag, css) {\n  var injector = cssStyled(css);\n  return /*#__PURE__*/function (_super) {\n    __extends(Styled, _super);\n    function Styled() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n      _this.injector = injector;\n      _this.tag = tag;\n      return _this;\n    }\n    return Styled;\n  }(StyledElement);\n}\nfunction styled(Tag, css) {\n  var injector = cssStyled(css);\n  var cssId = injector.className;\n  return forwardRef(function (props, ref) {\n    var _a = props.className,\n      className = _a === void 0 ? \"\" : _a,\n      cspNonce = props.cspNonce,\n      attributes = __rest(props, [\"className\", \"cspNonce\"]);\n    var targetRef = useRef();\n    useImperativeHandle(ref, function () {\n      return targetRef.current;\n    }, []);\n    useEffect(function () {\n      var injectResult = injector.inject(targetRef.current, {\n        nonce: props.cspNonce\n      });\n      return function () {\n        injectResult.destroy();\n      };\n    }, []);\n    return createElement(Tag, __assign({\n      \"ref\": targetRef,\n      \"data-styled-id\": cssId,\n      \"className\": \"\".concat(className, \" \").concat(cssId)\n    }, attributes));\n  });\n}\n\nexport default defaultStyled;\nexport { StyledElement, styled };\n","/*\nCopyright (c) 2019 Daybrush\nname: croact-moveable\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/moveable/blob/master/packages/croact-moveable\nversion: 0.9.0\n*/\nimport getAgent from '@egjs/agent';\nimport { prefixNames, prefixCSS, ref, withMethods, refs } from 'framework-utils';\nimport { getRad, throttle, throttleArray, isString, calculateBoundSize, getKeys, isArray, hasClass, getDist as getDist$1, isObject, decamelize, convertUnitSize, pushSet, find, findIndex, splitSpace, isNumber, isNode, isFunction, isWindow, counter, dot, addClass, requestAnimationFrame, splitBracket, splitComma, splitUnit, cancelAnimationFrame, removeClass, getWindow, TINY_NUM as TINY_NUM$1, flat as flat$1, isUndefined, getDocumentBody, between, getDocumentElement, average } from '@daybrush/utils';\nimport { plus, minus, convertDimension, calculate, convertPositionMatrix, ignoreDimension, invert, createIdentityMatrix, createWarpMatrix, multiply, fromTranslation, createRotateMatrix, getOrigin, rotate, multiplies, createOriginMatrix, convertMatrixtoCSS, createScaleMatrix, convertCSStoMatrix } from '@scena/matrix';\nimport { parseMat, parse, toMat, calculateMatrixDist } from 'css-to-mat';\nimport ChildrenDiffer, { diff } from '@egjs/children-differ';\nimport DragScroll from '@scena/dragscroll';\nimport { getMinMaxs, fitPoints, getOverlapSize, getAreaSize, isInside, getIntersectionPointsByConstants } from 'overlap-area';\nimport * as React from 'croact';\nimport { createElement } from 'croact';\nimport Gesto from 'gesto';\nimport { styled } from 'croact-css-styled';\nimport EventEmitter from '@scena/event-emitter';\nimport { diff as diff$1 } from '@egjs/list-differ';\n\n/*\nCopyright (c) 2019 Daybrush\nname: react-moveable\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/moveable/blob/master/packages/react-moveable\nversion: 0.56.0\n*/\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nfunction __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nfunction makeAble(name, able) {\r\n    return __assign({ events: [], props: [], name: name }, able);\r\n}\n\nvar DIRECTIONS4 = [\"n\", \"w\", \"s\", \"e\"];\r\nvar DIRECTIONS = [\"n\", \"w\", \"s\", \"e\", \"nw\", \"ne\", \"sw\", \"se\"];\r\nfunction getSVGCursor(scale, degree) {\r\n    return \"data:image/svg+xml;utf8,<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"\".concat(32 * scale, \"px\\\" height=\\\"\").concat(32 * scale, \"px\\\" viewBox=\\\"0 0 32 32\\\" ><path d=\\\"M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"1.2\\\" fill=\\\"black\\\" stroke=\\\"white\\\" style=\\\"transform:rotate(\").concat(degree, \"deg);transform-origin: 16px 16px\\\"></path></svg>\");\r\n}\r\nfunction getCursorCSS(degree) {\r\n    var x1 = getSVGCursor(1, degree);\r\n    // const x2 = getSVGCursor(2, degree);\r\n    var degree45 = (Math.round(degree / 45) * 45) % 180;\r\n    var defaultCursor = \"ns-resize\";\r\n    if (degree45 === 135) {\r\n        defaultCursor = \"nwse-resize\";\r\n    }\r\n    else if (degree45 === 45) {\r\n        defaultCursor = \"nesw-resize\";\r\n    }\r\n    else if (degree45 === 90) {\r\n        defaultCursor = \"ew-resize\";\r\n    }\r\n    // tslint:disable-next-line: max-line-length\r\n    return \"cursor:\".concat(defaultCursor, \";cursor: url('\").concat(x1, \"') 16 16, \").concat(defaultCursor, \";\");\r\n}\r\nvar agent = getAgent();\r\nvar IS_WEBKIT = agent.browser.webkit;\r\nvar IS_WEBKIT605 = IS_WEBKIT && (function () {\r\n    var navi = typeof window === \"undefined\" ? { userAgent: \"\" } : window.navigator;\r\n    var res = /applewebkit\\/([^\\s]+)/g.exec(navi.userAgent.toLowerCase());\r\n    return res ? parseFloat(res[1]) < 605 : false;\r\n})();\r\nvar browserName = agent.browser.name;\r\nvar browserVersion = parseInt(agent.browser.version, 10);\r\nvar IS_CHROME = browserName === \"chrome\";\r\nvar IS_CHROMIUM = agent.browser.chromium;\r\nvar chromiumVersion = parseInt(agent.browser.chromiumVersion, 10) || 0;\r\nvar IS_CHROMIUM109 = (IS_CHROME && browserVersion >= 109)\r\n    || (IS_CHROMIUM && chromiumVersion >= 109);\r\nvar IS_FIREFOX = browserName === \"firefox\";\r\nvar IS_SAFARI_ABOVE15 = parseInt(agent.browser.webkitVersion, 10) >= 612\r\n    || browserVersion >= 15;\r\nvar PREFIX = \"moveable-\";\r\nvar directionCSS = DIRECTIONS.map(function (dir) {\r\n    var top = \"\";\r\n    var left = \"\";\r\n    var originX = \"center\";\r\n    var originY = \"center\";\r\n    var offset = \"calc(var(--moveable-control-padding, 20) * -1px)\";\r\n    if (dir.indexOf(\"n\") > -1) {\r\n        top = \"top: \".concat(offset, \";\");\r\n        originY = \"bottom\";\r\n    }\r\n    if (dir.indexOf(\"s\") > -1) {\r\n        top = \"top: 0px;\";\r\n        originY = \"top\";\r\n    }\r\n    if (dir.indexOf(\"w\") > -1) {\r\n        left = \"left: \".concat(offset, \";\");\r\n        originX = \"right\";\r\n    }\r\n    if (dir.indexOf(\"e\") > -1) {\r\n        left = \"left: 0px;\";\r\n        originX = \"left\";\r\n    }\r\n    return \".around-control[data-direction*=\\\"\".concat(dir, \"\\\"] {\\n        \").concat(left).concat(top, \"\\n        transform-origin: \").concat(originX, \" \").concat(originY, \";\\n    }\");\r\n}).join(\"\\n\");\r\nvar MOVEABLE_CSS = \"\\n{\\nposition: absolute;\\nwidth: 1px;\\nheight: 1px;\\nleft: 0;\\ntop: 0;\\nz-index: 3000;\\n--moveable-color: #4af;\\n--zoom: 1;\\n--zoompx: 1px;\\n--moveable-line-padding: 0;\\n--moveable-control-padding: 0;\\nwill-change: transform;\\noutline: 1px solid transparent;\\n}\\n.control-box {\\nz-index: 0;\\n}\\n.line, .control {\\nposition: absolute;\\nleft: 0;\\ntop: 0;\\nwill-change: transform;\\n}\\n.control {\\nwidth: 14px;\\nheight: 14px;\\nborder-radius: 50%;\\nborder: 2px solid #fff;\\nbox-sizing: border-box;\\nbackground: #4af;\\nbackground: var(--moveable-color);\\nmargin-top: -7px;\\nmargin-left: -7px;\\nborder: 2px solid #fff;\\nz-index: 10;\\n}\\n.around-control {\\nposition: absolute;\\nwill-change: transform;\\nwidth: calc(var(--moveable-control-padding, 20) * 1px);\\nheight: calc(var(--moveable-control-padding, 20) * 1px);\\nleft: calc(var(--moveable-control-padding, 20) * -0.5px);\\ntop: calc(var(--moveable-control-padding, 20) * -0.5px);\\nbox-sizing: border-box;\\nbackground: transparent;\\nz-index: 8;\\ncursor: alias;\\ntransform-origin: center center;\\n}\\n\".concat(directionCSS, \"\\n.padding {\\nposition: absolute;\\ntop: 0px;\\nleft: 0px;\\nwidth: 100px;\\nheight: 100px;\\ntransform-origin: 0 0;\\n}\\n.line {\\nwidth: 1px;\\nheight: 1px;\\nbackground: #4af;\\nbackground: var(--moveable-color);\\ntransform-origin: 0px 50%;\\n}\\n.line.edge {\\nz-index: 1;\\nbackground: transparent;\\n}\\n.line.dashed {\\nbox-sizing: border-box;\\nbackground: transparent;\\n}\\n.line.dashed.horizontal {\\nborder-top: 1px dashed #4af;\\nborder-top-color: #4af;\\nborder-top-color: var(--moveable-color);\\n}\\n.line.dashed.vertical {\\nborder-left: 1px dashed #4af;\\nborder-left-color: #4af;\\nborder-left-color: var(--moveable-color);\\n}\\n.line.vertical {\\ntransform: translateX(-50%);\\n}\\n.line.horizontal {\\ntransform: translateY(-50%);\\n}\\n.line.vertical.bold {\\nwidth: 2px;\\n}\\n.line.horizontal.bold {\\nheight: 2px;\\n}\\n\\n.control.origin {\\nborder-color: #f55;\\nbackground: #fff;\\nwidth: 12px;\\nheight: 12px;\\nmargin-top: -6px;\\nmargin-left: -6px;\\npointer-events: none;\\n}\\n\").concat([0, 15, 30, 45, 60, 75, 90, 105, 120, 135, 150, 165].map(function (degree) { return \"\\n.direction[data-rotation=\\\"\".concat(degree, \"\\\"], :global .view-control-rotation\").concat(degree, \" {\\n\").concat(getCursorCSS(degree), \"\\n}\\n\"); }).join(\"\\n\"), \"\\n\\n.line.direction:before {\\ncontent: \\\"\\\";\\nposition: absolute;\\nwidth: 100%;\\nheight: calc(var(--moveable-line-padding, 0) * 1px);\\nbottom: 0;\\nleft: 0;\\n}\\n.group {\\nz-index: -1;\\n}\\n.area {\\nposition: absolute;\\n}\\n.area-pieces {\\nposition: absolute;\\ntop: 0;\\nleft: 0;\\ndisplay: none;\\n}\\n.area.avoid, .area.pass {\\npointer-events: none;\\n}\\n.area.avoid+.area-pieces {\\ndisplay: block;\\n}\\n.area-piece {\\nposition: absolute;\\n}\\n\\n\").concat(IS_WEBKIT605 ? \":global svg *:before {\\ncontent:\\\"\\\";\\ntransform-origin: inherit;\\n}\" : \"\", \"\\n\");\r\nvar NEARBY_POS = [\r\n    [0, 1, 2],\r\n    [1, 0, 3],\r\n    [2, 0, 3],\r\n    [3, 1, 2],\r\n];\r\nvar FLOAT_POINT_NUM = 0.0001;\r\nvar TINY_NUM = 0.0000001;\r\nvar MIN_SCALE = 0.000000001;\r\nvar MAX_NUM = Math.pow(10, 10);\r\nvar MIN_NUM = -MAX_NUM;\r\nvar DIRECTION_REGION_TO_DIRECTION = {\r\n    n: [0, -1],\r\n    e: [1, 0],\r\n    s: [0, 1],\r\n    w: [-1, 0],\r\n    nw: [-1, -1],\r\n    ne: [1, -1],\r\n    sw: [-1, 1],\r\n    se: [1, 1],\r\n};\r\nvar DIRECTION_INDEXES = {\r\n    n: [0, 1],\r\n    e: [1, 3],\r\n    s: [3, 2],\r\n    w: [2, 0],\r\n    nw: [0],\r\n    ne: [1],\r\n    sw: [2],\r\n    se: [3],\r\n};\r\nvar DIRECTION_ROTATIONS = {\r\n    n: 0,\r\n    s: 180,\r\n    w: 270,\r\n    e: 90,\r\n    nw: 315,\r\n    ne: 45,\r\n    sw: 225,\r\n    se: 135,\r\n};\r\nvar MOVEABLE_METHODS = [\r\n    \"isMoveableElement\",\r\n    \"updateRect\",\r\n    \"updateTarget\",\r\n    \"destroy\",\r\n    \"dragStart\",\r\n    \"isInside\",\r\n    \"hitTest\",\r\n    \"setState\",\r\n    \"getRect\",\r\n    \"request\",\r\n    \"isDragging\",\r\n    \"getManager\",\r\n    \"forceUpdate\",\r\n    \"waitToChangeTarget\",\r\n    \"updateSelectors\",\r\n    \"getTargets\",\r\n    \"stopDrag\",\r\n    \"getControlBoxElement\",\r\n    \"getMoveables\",\r\n    \"getDragElement\",\r\n];\n\nfunction setCustomDrag(e, state, delta, isPinch, isConvert, ableName) {\r\n    var _a, _b;\r\n    if (ableName === void 0) { ableName = \"draggable\"; }\r\n    var result = (_b = (_a = state.gestos[ableName]) === null || _a === void 0 ? void 0 : _a.move(delta, e.inputEvent)) !== null && _b !== void 0 ? _b : {};\r\n    var datas = result.originalDatas || result.datas;\r\n    var ableDatas = datas[ableName] || (datas[ableName] = {});\r\n    return __assign(__assign({}, (isConvert ? convertDragDist(state, result) : result)), { isPinch: !!isPinch, parentEvent: true, datas: ableDatas, originalDatas: e.originalDatas });\r\n}\r\nvar CustomGesto = /*#__PURE__*/ (function () {\r\n    function CustomGesto(ableName) {\r\n        var _a;\r\n        if (ableName === void 0) { ableName = \"draggable\"; }\r\n        this.ableName = ableName;\r\n        this.prevX = 0;\r\n        this.prevY = 0;\r\n        this.startX = 0;\r\n        this.startY = 0;\r\n        this.isDrag = false;\r\n        this.isFlag = false;\r\n        this.datas = {\r\n            draggable: {},\r\n        };\r\n        this.datas = (_a = {},\r\n            _a[ableName] = {},\r\n            _a);\r\n    }\r\n    CustomGesto.prototype.dragStart = function (client, e) {\r\n        this.isDrag = false;\r\n        this.isFlag = false;\r\n        var originalDatas = e.originalDatas;\r\n        this.datas = originalDatas;\r\n        if (!originalDatas[this.ableName]) {\r\n            originalDatas[this.ableName] = {};\r\n        }\r\n        return __assign(__assign({}, this.move(client, e.inputEvent)), { type: \"dragstart\" });\r\n    };\r\n    CustomGesto.prototype.drag = function (client, inputEvent) {\r\n        return this.move([\r\n            client[0] - this.prevX,\r\n            client[1] - this.prevY,\r\n        ], inputEvent);\r\n    };\r\n    CustomGesto.prototype.move = function (delta, inputEvent) {\r\n        var clientX;\r\n        var clientY;\r\n        var isFirstDrag = false;\r\n        if (!this.isFlag) {\r\n            this.prevX = delta[0];\r\n            this.prevY = delta[1];\r\n            this.startX = delta[0];\r\n            this.startY = delta[1];\r\n            clientX = delta[0];\r\n            clientY = delta[1];\r\n            this.isFlag = true;\r\n        }\r\n        else {\r\n            var isPrevDrag = this.isDrag;\r\n            clientX = this.prevX + delta[0];\r\n            clientY = this.prevY + delta[1];\r\n            if (delta[0] || delta[1]) {\r\n                this.isDrag = true;\r\n            }\r\n            if (!isPrevDrag && this.isDrag) {\r\n                isFirstDrag = true;\r\n            }\r\n        }\r\n        this.prevX = clientX;\r\n        this.prevY = clientY;\r\n        return {\r\n            type: \"drag\",\r\n            clientX: clientX,\r\n            clientY: clientY,\r\n            inputEvent: inputEvent,\r\n            isFirstDrag: isFirstDrag,\r\n            isDrag: this.isDrag,\r\n            distX: clientX - this.startX,\r\n            distY: clientY - this.startY,\r\n            deltaX: delta[0],\r\n            deltaY: delta[1],\r\n            datas: this.datas[this.ableName],\r\n            originalDatas: this.datas,\r\n            parentEvent: true,\r\n            parentGesto: this,\r\n        };\r\n    };\r\n    return CustomGesto;\r\n}());\n\nfunction calculateElementPosition(matrix, origin, width, height) {\r\n    var is3d = matrix.length === 16;\r\n    var n = is3d ? 4 : 3;\r\n    var poses = calculatePoses(matrix, width, height, n);\r\n    var _a = __read(poses, 4), _b = __read(_a[0], 2), x1 = _b[0], y1 = _b[1], _c = __read(_a[1], 2), x2 = _c[0], y2 = _c[1], _d = __read(_a[2], 2), x3 = _d[0], y3 = _d[1], _e = __read(_a[3], 2), x4 = _e[0], y4 = _e[1];\r\n    var _f = __read(calculatePosition(matrix, origin, n), 2), originX = _f[0], originY = _f[1];\r\n    var left = Math.min(x1, x2, x3, x4);\r\n    var top = Math.min(y1, y2, y3, y4);\r\n    var right = Math.max(x1, x2, x3, x4);\r\n    var bottom = Math.max(y1, y2, y3, y4);\r\n    x1 = (x1 - left) || 0;\r\n    x2 = (x2 - left) || 0;\r\n    x3 = (x3 - left) || 0;\r\n    x4 = (x4 - left) || 0;\r\n    y1 = (y1 - top) || 0;\r\n    y2 = (y2 - top) || 0;\r\n    y3 = (y3 - top) || 0;\r\n    y4 = (y4 - top) || 0;\r\n    originX = (originX - left) || 0;\r\n    originY = (originY - top) || 0;\r\n    var sx = matrix[0];\r\n    var sy = matrix[n + 1];\r\n    var direction = sign(sx * sy);\r\n    return {\r\n        left: left,\r\n        top: top,\r\n        right: right,\r\n        bottom: bottom,\r\n        origin: [originX, originY],\r\n        pos1: [x1, y1],\r\n        pos2: [x2, y2],\r\n        pos3: [x3, y3],\r\n        pos4: [x4, y4],\r\n        direction: direction,\r\n    };\r\n}\n\nfunction calculatePointerDist(moveable, e) {\r\n    var clientX = e.clientX, clientY = e.clientY, datas = e.datas;\r\n    var _a = moveable.state, moveableClientRect = _a.moveableClientRect, rootMatrix = _a.rootMatrix, is3d = _a.is3d, pos1 = _a.pos1;\r\n    var left = moveableClientRect.left, top = moveableClientRect.top;\r\n    var n = is3d ? 4 : 3;\r\n    var _b = __read(minus(calculateInversePosition(rootMatrix, [clientX - left, clientY - top], n), pos1), 2), posX = _b[0], posY = _b[1];\r\n    var _c = __read(getDragDist({ datas: datas, distX: posX, distY: posY }), 2), distX = _c[0], distY = _c[1];\r\n    return [distX, distY];\r\n}\r\nfunction setDragStart(moveable, _a) {\r\n    var datas = _a.datas;\r\n    var _b = moveable.state, allMatrix = _b.allMatrix, beforeMatrix = _b.beforeMatrix, is3d = _b.is3d, left = _b.left, top = _b.top, origin = _b.origin, offsetMatrix = _b.offsetMatrix, targetMatrix = _b.targetMatrix, transformOrigin = _b.transformOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    datas.is3d = is3d;\r\n    datas.matrix = allMatrix;\r\n    datas.targetMatrix = targetMatrix;\r\n    datas.beforeMatrix = beforeMatrix;\r\n    datas.offsetMatrix = offsetMatrix;\r\n    datas.transformOrigin = transformOrigin;\r\n    datas.inverseMatrix = invert(allMatrix, n);\r\n    datas.inverseBeforeMatrix = invert(beforeMatrix, n);\r\n    datas.absoluteOrigin = convertPositionMatrix(plus([left, top], origin), n);\r\n    datas.startDragBeforeDist = calculate(datas.inverseBeforeMatrix, datas.absoluteOrigin, n);\r\n    datas.startDragDist = calculate(datas.inverseMatrix, datas.absoluteOrigin, n);\r\n}\r\nfunction getTransformDirection(e) {\r\n    return calculateElementPosition(e.datas.beforeTransform, [50, 50], 100, 100).direction;\r\n}\r\nfunction resolveTransformEvent(moveable, event, functionName) {\r\n    var datas = event.datas, originalDatas = event.originalDatas.beforeRenderable;\r\n    var index = datas.transformIndex;\r\n    var nextTransforms = originalDatas.nextTransforms;\r\n    var length = nextTransforms.length;\r\n    var nextTransformAppendedIndexes = originalDatas.nextTransformAppendedIndexes;\r\n    var nextIndex = -1;\r\n    if (index === -1) {\r\n        // translate => rotate => scale\r\n        if (functionName === \"translate\") {\r\n            nextIndex = 0;\r\n        }\r\n        else if (functionName === \"rotate\") {\r\n            nextIndex = findIndex(nextTransforms, function (text) { return text.match(/scale\\(/g); });\r\n        }\r\n        if (nextIndex === -1) {\r\n            nextIndex = nextTransforms.length;\r\n        }\r\n        datas.transformIndex = nextIndex;\r\n    }\r\n    else if (find(nextTransformAppendedIndexes, function (info) { return info.index === index && info.functionName === functionName; })) {\r\n        nextIndex = index;\r\n    }\r\n    else {\r\n        nextIndex = index + nextTransformAppendedIndexes.filter(function (info) { return info.index < index; }).length;\r\n    }\r\n    var result = convertTransformInfo(nextTransforms, moveable.state, nextIndex);\r\n    var targetFunction = result.targetFunction;\r\n    var matFunctionName = functionName === \"rotate\" ? \"rotateZ\" : functionName;\r\n    datas.beforeFunctionTexts = result.beforeFunctionTexts;\r\n    datas.afterFunctionTexts = result.afterFunctionTexts;\r\n    datas.beforeTransform = result.beforeFunctionMatrix;\r\n    datas.beforeTransform2 = result.beforeFunctionMatrix2;\r\n    datas.targetTansform = result.targetFunctionMatrix;\r\n    datas.afterTransform = result.afterFunctionMatrix;\r\n    datas.afterTransform2 = result.afterFunctionMatrix2;\r\n    datas.targetAllTransform = result.allFunctionMatrix;\r\n    if (targetFunction.functionName === matFunctionName) {\r\n        datas.afterFunctionTexts.splice(0, 1);\r\n        datas.isAppendTransform = false;\r\n    }\r\n    else if (length > nextIndex) {\r\n        datas.isAppendTransform = true;\r\n        originalDatas.nextTransformAppendedIndexes = __spreadArray(__spreadArray([], __read(nextTransformAppendedIndexes), false), [{\r\n                functionName: functionName,\r\n                index: nextIndex,\r\n                isAppend: true,\r\n            }], false);\r\n    }\r\n}\r\nfunction convertTransformFormat(datas, value, dist) {\r\n    return \"\".concat(datas.beforeFunctionTexts.join(\" \"), \" \").concat(datas.isAppendTransform ? dist : value, \" \").concat(datas.afterFunctionTexts.join(\" \"));\r\n}\r\nfunction getTransformDist(_a) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    var _b = __read(getBeforeDragDist({ datas: datas, distX: distX, distY: distY }), 2), bx = _b[0], by = _b[1];\r\n    // B * [tx, ty] * A = [bx, by] * targetMatrix;\r\n    // [tx, ty] = B-1 * [bx, by] * targetMatrix * A-1 * [0, 0];\r\n    var res = getTransfromMatrix(datas, fromTranslation([bx, by], 4));\r\n    return calculate(res, convertPositionMatrix([0, 0, 0], 4), 4);\r\n}\r\nfunction getTransfromMatrix(datas, targetMatrix, isAfter) {\r\n    var beforeTransform = datas.beforeTransform, afterTransform = datas.afterTransform, beforeTransform2 = datas.beforeTransform2, afterTransform2 = datas.afterTransform2, targetAllTransform = datas.targetAllTransform;\r\n    // B * afterTargetMatrix * A = (targetMatrix * targetAllTransform)\r\n    // afterTargetMatrix = B-1 * targetMatrix * targetAllTransform * A-1\r\n    // nextTargetMatrix = (targetMatrix * targetAllTransform)\r\n    var nextTargetMatrix = isAfter\r\n        ? multiply(targetAllTransform, targetMatrix, 4)\r\n        : multiply(targetMatrix, targetAllTransform, 4);\r\n    // res1 = B-1 * nextTargetMatrix\r\n    var res1 = multiply(invert(isAfter ? beforeTransform2 : beforeTransform, 4), nextTargetMatrix, 4);\r\n    // res3 = res2 * A-1\r\n    var afterTargetMatrix = multiply(res1, invert(isAfter ? afterTransform2 : afterTransform, 4), 4);\r\n    return afterTargetMatrix;\r\n}\r\nfunction getBeforeDragDist(_a) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    // TT = BT\r\n    var inverseBeforeMatrix = datas.inverseBeforeMatrix, is3d = datas.is3d, startDragBeforeDist = datas.startDragBeforeDist, absoluteOrigin = datas.absoluteOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    // ABS_ORIGIN * [distX, distY] = BM * (ORIGIN + [tx, ty])\r\n    // BM -1 * ABS_ORIGIN * [distX, distY] - ORIGIN = [tx, ty]\r\n    return minus(calculate(inverseBeforeMatrix, plus(absoluteOrigin, [distX, distY]), n), startDragBeforeDist);\r\n}\r\nfunction getDragDist(_a, isBefore) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    var inverseBeforeMatrix = datas.inverseBeforeMatrix, inverseMatrix = datas.inverseMatrix, is3d = datas.is3d, startDragBeforeDist = datas.startDragBeforeDist, startDragDist = datas.startDragDist, absoluteOrigin = datas.absoluteOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    return minus(calculate(isBefore ? inverseBeforeMatrix : inverseMatrix, plus(absoluteOrigin, [distX, distY]), n), isBefore ? startDragBeforeDist : startDragDist);\r\n}\r\nfunction getInverseDragDist(_a, isBefore) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    var beforeMatrix = datas.beforeMatrix, matrix = datas.matrix, is3d = datas.is3d, startDragBeforeDist = datas.startDragBeforeDist, startDragDist = datas.startDragDist, absoluteOrigin = datas.absoluteOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    return minus(calculate(isBefore ? beforeMatrix : matrix, plus(isBefore ? startDragBeforeDist : startDragDist, [distX, distY]), n), absoluteOrigin);\r\n}\r\nfunction calculateTransformOrigin(transformOrigin, width, height, prevWidth, prevHeight, prevOrigin) {\r\n    if (prevWidth === void 0) { prevWidth = width; }\r\n    if (prevHeight === void 0) { prevHeight = height; }\r\n    if (prevOrigin === void 0) { prevOrigin = [0, 0]; }\r\n    if (!transformOrigin) {\r\n        return prevOrigin;\r\n    }\r\n    return transformOrigin.map(function (pos, i) {\r\n        var _a = splitUnit(pos), value = _a.value, unit = _a.unit;\r\n        var prevSize = (i ? prevHeight : prevWidth);\r\n        var size = (i ? height : width);\r\n        if (pos === \"%\" || isNaN(value)) {\r\n            // no value but %\r\n            var measureRatio = prevSize ? prevOrigin[i] / prevSize : 0;\r\n            return size * measureRatio;\r\n        }\r\n        else if (unit !== \"%\") {\r\n            return value;\r\n        }\r\n        return size * value / 100;\r\n    });\r\n}\r\nfunction getPosIndexesByDirection(direction) {\r\n    var indexes = [];\r\n    if (direction[1] >= 0) {\r\n        if (direction[0] >= 0) {\r\n            indexes.push(3);\r\n        }\r\n        if (direction[0] <= 0) {\r\n            indexes.push(2);\r\n        }\r\n    }\r\n    if (direction[1] <= 0) {\r\n        if (direction[0] >= 0) {\r\n            indexes.push(1);\r\n        }\r\n        if (direction[0] <= 0) {\r\n            indexes.push(0);\r\n        }\r\n    }\r\n    return indexes;\r\n}\r\nfunction getPosesByDirection(poses, direction) {\r\n    /*\r\n    [-1, -1](pos1)       [0, -1](pos1,pos2)       [1, -1](pos2)\r\n    [-1, 0](pos1, pos3)                           [1, 0](pos2, pos4)\r\n    [-1, 1](pos3)        [0, 1](pos3, pos4)       [1, 1](pos4)\r\n    */\r\n    return getPosIndexesByDirection(direction).map(function (index) { return poses[index]; });\r\n}\r\nfunction getPosBySingleDirection(poses, direction) {\r\n    var ratio = (direction + 1) / 2;\r\n    return [\r\n        dot(poses[0][0], poses[1][0], ratio, 1 - ratio),\r\n        dot(poses[0][1], poses[1][1], ratio, 1 - ratio),\r\n    ];\r\n}\r\nfunction getPosByDirection(poses, direction) {\r\n    var top = getPosBySingleDirection([poses[0], poses[1]], direction[0]);\r\n    var bottom = getPosBySingleDirection([poses[2], poses[3]], direction[0]);\r\n    return getPosBySingleDirection([top, bottom], direction[1]);\r\n}\r\nfunction getDist(startPos, matrix, width, height, n, fixedDirection) {\r\n    var poses = calculatePoses(matrix, width, height, n);\r\n    var fixedPos = getPosByDirection(poses, fixedDirection);\r\n    var distX = startPos[0] - fixedPos[0];\r\n    var distY = startPos[1] - fixedPos[1];\r\n    return [distX, distY];\r\n}\r\nfunction getNextMatrix(offsetMatrix, targetMatrix, origin, n) {\r\n    return multiply(offsetMatrix, getAbsoluteMatrix(targetMatrix, n, origin), n);\r\n}\r\nfunction getNextTransformMatrix(state, datas, transform, isAllTransform) {\r\n    var transformOrigin = state.transformOrigin, offsetMatrix = state.offsetMatrix, is3d = state.is3d;\r\n    var n = is3d ? 4 : 3;\r\n    var targetTransform;\r\n    if (isString(transform)) {\r\n        var beforeTransform = datas.beforeTransform, afterTransform = datas.afterTransform;\r\n        if (isAllTransform) {\r\n            targetTransform = convertDimension(parseMat(transform), 4, n);\r\n        }\r\n        else {\r\n            targetTransform = convertDimension(multiply(multiply(beforeTransform, parseMat([transform]), 4), afterTransform, 4), 4, n);\r\n        }\r\n    }\r\n    else {\r\n        targetTransform = transform;\r\n    }\r\n    return getNextMatrix(offsetMatrix, targetTransform, transformOrigin, n);\r\n}\r\nfunction scaleMatrix(state, scale) {\r\n    var transformOrigin = state.transformOrigin, offsetMatrix = state.offsetMatrix, is3d = state.is3d, targetMatrix = state.targetMatrix, targetAllTransform = state.targetAllTransform;\r\n    var n = is3d ? 4 : 3;\r\n    return getNextMatrix(offsetMatrix, multiply(targetAllTransform || targetMatrix, createScaleMatrix(scale, n), n), transformOrigin, n);\r\n}\r\nfunction fillTransformStartEvent(moveable, e) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    return {\r\n        setTransform: function (transform, index) {\r\n            if (index === void 0) { index = -1; }\r\n            originalDatas.startTransforms = isArray(transform) ? transform : splitSpace(transform);\r\n            setTransformIndex(moveable, e, index);\r\n        },\r\n        setTransformIndex: function (index) {\r\n            setTransformIndex(moveable, e, index);\r\n        },\r\n    };\r\n}\r\nfunction setDefaultTransformIndex(moveable, e, property) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    var startTransforms = originalDatas.startTransforms;\r\n    setTransformIndex(moveable, e, findIndex(startTransforms, function (func) { return func.indexOf(\"\".concat(property, \"(\")) === 0; }));\r\n}\r\nfunction setTransformIndex(moveable, e, index) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    var datas = e.datas;\r\n    datas.transformIndex = index;\r\n    if (index === -1) {\r\n        return;\r\n    }\r\n    var transform = originalDatas.startTransforms[index];\r\n    if (!transform) {\r\n        return;\r\n    }\r\n    var state = moveable.state;\r\n    var info = parse([transform], {\r\n        \"x%\": function (v) { return v / 100 * state.offsetWidth; },\r\n        \"y%\": function (v) { return v / 100 * state.offsetHeight; },\r\n    });\r\n    datas.startValue = info[0].functionValue;\r\n}\r\nfunction fillOriginalTransform(e, transform) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    originalDatas.nextTransforms = splitSpace(transform);\r\n    // originalDatas.nextTargetMatrix = parseMat(transform);\r\n}\r\nfunction getBeforeRenderableDatas(e) {\r\n    return e.originalDatas.beforeRenderable;\r\n}\r\nfunction getNextTransforms(e) {\r\n    var originalDatas = e.originalDatas.beforeRenderable;\r\n    return originalDatas.nextTransforms;\r\n}\r\nfunction getNextTransformText(e) {\r\n    return (getNextTransforms(e) || []).join(\" \");\r\n}\r\nfunction getNextStyle(e) {\r\n    return getBeforeRenderableDatas(e).nextStyle;\r\n}\r\nfunction fillTransformEvent(moveable, nextTransform, delta, isPinch, e) {\r\n    fillOriginalTransform(e, nextTransform);\r\n    var drag = Draggable.drag(moveable, setCustomDrag(e, moveable.state, delta, isPinch, false));\r\n    var afterTransform = drag ? drag.transform : nextTransform;\r\n    return __assign(__assign({ transform: nextTransform, drag: drag }, fillCSSObject({\r\n        transform: afterTransform,\r\n    }, e)), { afterTransform: afterTransform });\r\n}\r\nfunction getTranslateFixedPosition(moveable, transform, fixedDirection, fixedOffset, datas, isAllTransform) {\r\n    var nextMatrix = getNextTransformMatrix(moveable.state, datas, transform, isAllTransform);\r\n    var nextFixedPosition = getDirectionOffset(moveable, fixedDirection, fixedOffset, nextMatrix);\r\n    return nextFixedPosition;\r\n}\r\nfunction getTranslateDist(moveable, transform, fixedDirection, fixedPosition, fixedOffset, datas, isAllTransform) {\r\n    var nextFixedPosition = getTranslateFixedPosition(moveable, transform, fixedDirection, fixedOffset, datas, isAllTransform);\r\n    var state = moveable.state;\r\n    var left = state.left, top = state.top;\r\n    var groupable = moveable.props.groupable;\r\n    var groupLeft = groupable ? left : 0;\r\n    var groupTop = groupable ? top : 0;\r\n    var dist = minus(fixedPosition, nextFixedPosition);\r\n    return minus(dist, [groupLeft, groupTop]);\r\n}\r\nfunction getScaleDist(moveable, transform, fixedDirection, fixedPosition, fixedOffset, datas, isAllTransform) {\r\n    var dist = getTranslateDist(moveable, transform, fixedDirection, fixedPosition, fixedOffset, datas, isAllTransform);\r\n    return dist;\r\n}\r\nfunction getDirectionByPos(pos, width, height) {\r\n    return [\r\n        width ? -1 + pos[0] / (width / 2) : 0,\r\n        height ? -1 + pos[1] / (height / 2) : 0,\r\n    ];\r\n}\r\nfunction getDirectionOffset(moveable, fixedDirection, fixedOffset, nextMatrix) {\r\n    if (nextMatrix === void 0) { nextMatrix = moveable.state.allMatrix; }\r\n    var _a = moveable.state, width = _a.width, height = _a.height, is3d = _a.is3d;\r\n    var n = is3d ? 4 : 3;\r\n    var fixedOffsetPosition = [\r\n        width / 2 * (1 + fixedDirection[0]) + fixedOffset[0],\r\n        height / 2 * (1 + fixedDirection[1]) + fixedOffset[1],\r\n    ];\r\n    return calculatePosition(nextMatrix, fixedOffsetPosition, n);\r\n}\r\nfunction getRotateDist(moveable, rotateDist, datas) {\r\n    var fixedDirection = datas.fixedDirection;\r\n    var fixedPosition = datas.fixedPosition;\r\n    var fixedOffset = datas.fixedOffset;\r\n    return getTranslateDist(moveable, \"rotate(\".concat(rotateDist, \"deg)\"), fixedDirection, fixedPosition, fixedOffset, datas);\r\n}\r\nfunction getResizeDist(moveable, width, height, fixedPosition, transformOrigin, datas) {\r\n    var groupable = moveable.props.groupable;\r\n    var state = moveable.state;\r\n    var prevOrigin = state.transformOrigin, offsetMatrix = state.offsetMatrix, is3d = state.is3d, prevWidth = state.width, prevHeight = state.height, left = state.left, top = state.top;\r\n    var fixedDirection = datas.fixedDirection;\r\n    var targetMatrix = datas.nextTargetMatrix || state.targetMatrix;\r\n    var n = is3d ? 4 : 3;\r\n    var nextOrigin = calculateTransformOrigin(transformOrigin, width, height, prevWidth, prevHeight, prevOrigin);\r\n    var groupLeft = groupable ? left : 0;\r\n    var groupTop = groupable ? top : 0;\r\n    var nextMatrix = getNextMatrix(offsetMatrix, targetMatrix, nextOrigin, n);\r\n    var dist = getDist(fixedPosition, nextMatrix, width, height, n, fixedDirection);\r\n    return minus(dist, [groupLeft, groupTop]);\r\n}\r\nfunction getAbsolutePosition(moveable, direction) {\r\n    return getPosByDirection(getAbsolutePosesByState(moveable.state), direction);\r\n}\n\nfunction getGestoData(moveable, ableName) {\r\n    var targetGesto = moveable.targetGesto;\r\n    var controlGesto = moveable.controlGesto;\r\n    var data;\r\n    if (targetGesto === null || targetGesto === void 0 ? void 0 : targetGesto.isFlag()) {\r\n        data = targetGesto.getEventData()[ableName];\r\n    }\r\n    if (!data && (controlGesto === null || controlGesto === void 0 ? void 0 : controlGesto.isFlag())) {\r\n        data = controlGesto.getEventData()[ableName];\r\n    }\r\n    return data || {};\r\n}\n\nfunction getShadowRoot(parentElement) {\r\n    if (parentElement && parentElement.getRootNode) {\r\n        var rootNode = parentElement.getRootNode();\r\n        if (rootNode.nodeType === 11) {\r\n            return rootNode;\r\n        }\r\n    }\r\n    return;\r\n}\r\nfunction getIndividualTransforms(getStyle) {\r\n    var scale = getStyle(\"scale\");\r\n    var rotate = getStyle(\"rotate\");\r\n    var translate = getStyle(\"translate\");\r\n    var individualTransforms = [];\r\n    if (translate && translate !== \"0px\" && translate !== \"none\") {\r\n        individualTransforms.push(\"translate(\".concat(translate.split(/\\s+/).join(\",\"), \")\"));\r\n    }\r\n    if (rotate && rotate !== \"1\" && rotate !== \"none\") {\r\n        individualTransforms.push(\"rotate(\".concat(rotate, \")\"));\r\n    }\r\n    if (scale && scale !== \"1\" && scale !== \"none\") {\r\n        individualTransforms.push(\"scale(\".concat(scale.split(/\\s+/).join(\",\"), \")\"));\r\n    }\r\n    return individualTransforms;\r\n}\r\nfunction getMatrixStackInfo(target, container, checkContainer) {\r\n    var el = target;\r\n    var matrixes = [];\r\n    var documentElement = getDocumentElement(target) || getDocumentBody(target);\r\n    var requestEnd = !checkContainer && target === container || target === documentElement;\r\n    var isEnd = requestEnd;\r\n    var is3d = false;\r\n    var n = 3;\r\n    var transformOrigin;\r\n    var targetTransformOrigin;\r\n    var targetMatrix;\r\n    var hasFixed = false;\r\n    var offsetContainer = getOffsetInfo(container, container, true).offsetParent;\r\n    var zoom = 1;\r\n    while (el && !isEnd) {\r\n        isEnd = requestEnd;\r\n        var getStyle = getCachedStyle(el);\r\n        var position = getStyle(\"position\");\r\n        var transform = getElementTransform(el);\r\n        var isFixed = position === \"fixed\";\r\n        var individualTransforms = getIndividualTransforms(getStyle);\r\n        var matrix = convertCSStoMatrix(getTransformMatrix(transform));\r\n        var offsetParent = void 0;\r\n        var isOffsetEnd = false;\r\n        var isStatic = false;\r\n        var parentClientLeft = 0;\r\n        var parentClientTop = 0;\r\n        var fixedClientLeft = 0;\r\n        var fixedClientTop = 0;\r\n        var fixedInfo = {\r\n            hasTransform: false,\r\n            fixedContainer: null,\r\n        };\r\n        if (isFixed) {\r\n            hasFixed = true;\r\n            fixedInfo = getPositionFixedInfo(el);\r\n            offsetContainer = fixedInfo.fixedContainer;\r\n        }\r\n        // convert 3 to 4\r\n        var length_1 = matrix.length;\r\n        if (!is3d && (length_1 === 16 || individualTransforms.length)) {\r\n            is3d = true;\r\n            n = 4;\r\n            convert3DMatrixes(matrixes);\r\n            if (targetMatrix) {\r\n                targetMatrix = convertDimension(targetMatrix, 3, 4);\r\n            }\r\n        }\r\n        if (is3d && length_1 === 9) {\r\n            matrix = convertDimension(matrix, 3, 4);\r\n        }\r\n        var _a = getOffsetPosInfo(el, target), tagName = _a.tagName, hasOffset = _a.hasOffset, isSVG = _a.isSVG, origin_1 = _a.origin, targetOrigin = _a.targetOrigin, offsetPos = _a.offset;\r\n        var _b = __read(offsetPos, 2), offsetLeft = _b[0], offsetTop = _b[1];\r\n        // no target with svg\r\n        if (tagName === \"svg\" && !el.ownerSVGElement && targetMatrix) {\r\n            // scale matrix for svg's SVGElements.\r\n            matrixes.push({\r\n                type: \"target\",\r\n                target: el,\r\n                matrix: getSVGMatrix(el, n),\r\n            });\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                matrix: createIdentityMatrix(n),\r\n            });\r\n        }\r\n        var targetZoom = parseFloat(getStyle(\"zoom\")) || 1;\r\n        if (isFixed) {\r\n            offsetParent = fixedInfo.fixedContainer;\r\n            isOffsetEnd = true;\r\n        }\r\n        else {\r\n            var offsetInfo = getOffsetInfo(el, container, false, true, getStyle);\r\n            var offsetZoom = offsetInfo.offsetZoom;\r\n            offsetParent = offsetInfo.offsetParent;\r\n            isOffsetEnd = offsetInfo.isEnd;\r\n            isStatic = offsetInfo.isStatic;\r\n            zoom *= offsetZoom;\r\n            if ((offsetInfo.isCustomElement || offsetZoom !== 1) && isStatic) {\r\n                offsetLeft -= offsetParent.offsetLeft;\r\n                offsetTop -= offsetParent.offsetTop;\r\n            }\r\n            else if (IS_FIREFOX || IS_CHROMIUM109) {\r\n                var parentSlotElement = offsetInfo.parentSlotElement;\r\n                if (parentSlotElement) {\r\n                    var customOffsetParent = offsetParent;\r\n                    var customOffsetLeft = 0;\r\n                    var customOffsetTop = 0;\r\n                    while (customOffsetParent) {\r\n                        if (!getShadowRoot(customOffsetParent)) {\r\n                            break;\r\n                        }\r\n                        customOffsetLeft += customOffsetParent.offsetLeft;\r\n                        customOffsetTop += customOffsetParent.offsetTop;\r\n                        customOffsetParent = customOffsetParent.offsetParent;\r\n                    }\r\n                    offsetLeft -= customOffsetLeft;\r\n                    offsetTop -= customOffsetTop;\r\n                }\r\n            }\r\n        }\r\n        if (IS_WEBKIT && !IS_SAFARI_ABOVE15\r\n            && hasOffset && !isSVG && isStatic\r\n            && (position === \"relative\" || position === \"static\")) {\r\n            offsetLeft -= offsetParent.offsetLeft;\r\n            offsetTop -= offsetParent.offsetTop;\r\n            requestEnd = requestEnd || isOffsetEnd;\r\n        }\r\n        if (isFixed) {\r\n            if (hasOffset && fixedInfo.hasTransform) {\r\n                // border\r\n                fixedClientLeft = offsetParent.clientLeft;\r\n                fixedClientTop = offsetParent.clientTop;\r\n            }\r\n        }\r\n        else {\r\n            if (hasOffset && offsetContainer !== offsetParent) {\r\n                // border\r\n                parentClientLeft = offsetParent.clientLeft;\r\n                parentClientTop = offsetParent.clientTop;\r\n            }\r\n            if (hasOffset && offsetParent === documentElement) {\r\n                var margin = getBodyOffset(el, false);\r\n                offsetLeft += margin[0];\r\n                offsetTop += margin[1];\r\n            }\r\n        }\r\n        matrixes.push({\r\n            type: \"target\",\r\n            target: el,\r\n            matrix: getAbsoluteMatrix(matrix, n, origin_1),\r\n        });\r\n        if (individualTransforms.length) {\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                matrix: createIdentityMatrix(n),\r\n            });\r\n            matrixes.push({\r\n                type: \"target\",\r\n                target: el,\r\n                matrix: getAbsoluteMatrix(parseMat(individualTransforms), n, origin_1),\r\n            });\r\n        }\r\n        if (hasOffset) {\r\n            var isElementTarget = el === target;\r\n            var scrollLeft = isElementTarget ? 0 : el.scrollLeft;\r\n            var scrollTop = isElementTarget ? 0 : el.scrollTop;\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                matrix: createOriginMatrix([\r\n                    offsetLeft - scrollLeft + parentClientLeft - fixedClientLeft,\r\n                    offsetTop - scrollTop + parentClientTop - fixedClientTop,\r\n                ], n),\r\n            });\r\n        }\r\n        else {\r\n            // svg\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                origin: origin_1,\r\n            });\r\n        }\r\n        // transform   zoom  (0, 0)   matrix .\r\n        if (targetZoom !== 1) {\r\n            matrixes.push({\r\n                type: \"zoom\",\r\n                target: el,\r\n                matrix: getAbsoluteMatrix(createScaleMatrix([targetZoom, targetZoom], n), n, [0, 0]),\r\n            });\r\n        }\r\n        if (!targetMatrix) {\r\n            targetMatrix = matrix;\r\n        }\r\n        if (!transformOrigin) {\r\n            transformOrigin = origin_1;\r\n        }\r\n        if (!targetTransformOrigin) {\r\n            targetTransformOrigin = targetOrigin;\r\n        }\r\n        if (isEnd || isFixed) {\r\n            break;\r\n        }\r\n        else {\r\n            el = offsetParent;\r\n            requestEnd = isOffsetEnd;\r\n        }\r\n        if (!checkContainer || el === documentElement) {\r\n            isEnd = requestEnd;\r\n        }\r\n    }\r\n    if (!targetMatrix) {\r\n        targetMatrix = createIdentityMatrix(n);\r\n    }\r\n    if (!transformOrigin) {\r\n        transformOrigin = [0, 0];\r\n    }\r\n    if (!targetTransformOrigin) {\r\n        targetTransformOrigin = [0, 0];\r\n    }\r\n    return {\r\n        zoom: zoom,\r\n        offsetContainer: offsetContainer,\r\n        matrixes: matrixes,\r\n        targetMatrix: targetMatrix,\r\n        transformOrigin: transformOrigin,\r\n        targetOrigin: targetTransformOrigin,\r\n        is3d: is3d,\r\n        hasFixed: hasFixed,\r\n    };\r\n}\n\nvar cacheStyleMap = null;\r\nvar clientRectStyleMap = null;\r\nvar matrixContainerInfos = null;\r\nfunction setStoreCache(useCache) {\r\n    if (useCache) {\r\n        if (window.Map) {\r\n            cacheStyleMap = new Map();\r\n            clientRectStyleMap = new Map();\r\n        }\r\n        matrixContainerInfos = [];\r\n    }\r\n    else {\r\n        cacheStyleMap = null;\r\n        matrixContainerInfos = null;\r\n        clientRectStyleMap = null;\r\n    }\r\n}\r\nfunction getCachedClientRect(el) {\r\n    var clientRect = clientRectStyleMap === null || clientRectStyleMap === void 0 ? void 0 : clientRectStyleMap.get(el);\r\n    if (clientRect) {\r\n        return clientRect;\r\n    }\r\n    var nextClientRect = getClientRect(el, true);\r\n    if (clientRectStyleMap) {\r\n        clientRectStyleMap.set(el, nextClientRect);\r\n    }\r\n    return nextClientRect;\r\n}\r\nfunction getCachedMatrixContainerInfo(target, container) {\r\n    if (matrixContainerInfos) {\r\n        var result_1 = find(matrixContainerInfos, function (info) { return info[0][0] == target && info[0][1] == container; });\r\n        if (result_1) {\r\n            return result_1[1];\r\n        }\r\n    }\r\n    var result = getMatrixStackInfo(target, container, true);\r\n    if (matrixContainerInfos) {\r\n        matrixContainerInfos.push([[target, container], result]);\r\n    }\r\n    return result;\r\n}\r\nfunction getCachedStyle(element) {\r\n    var cache = cacheStyleMap === null || cacheStyleMap === void 0 ? void 0 : cacheStyleMap.get(element);\r\n    if (!cache) {\r\n        var nextStyle_1 = getWindow(element).getComputedStyle(element);\r\n        if (!cacheStyleMap) {\r\n            return function (property) {\r\n                return nextStyle_1[property];\r\n            };\r\n        }\r\n        cache = {\r\n            style: nextStyle_1,\r\n            cached: {},\r\n        };\r\n        cacheStyleMap.set(element, cache);\r\n    }\r\n    var cached = cache.cached;\r\n    var style = cache.style;\r\n    return function (property) {\r\n        if (!(property in cached)) {\r\n            cached[property] = style[property];\r\n        }\r\n        return cached[property];\r\n    };\r\n}\n\nfunction fillChildEvents(moveable, name, e) {\r\n    var datas = e.originalDatas;\r\n    datas.groupable = datas.groupable || {};\r\n    var groupableDatas = datas.groupable;\r\n    groupableDatas.childDatas = groupableDatas.childDatas || [];\r\n    var childDatas = groupableDatas.childDatas;\r\n    return moveable.moveables.map(function (_, i) {\r\n        childDatas[i] = childDatas[i] || {};\r\n        childDatas[i][name] = childDatas[i][name] || {};\r\n        return __assign(__assign({}, e), { isRequestChild: true, datas: childDatas[i][name], originalDatas: childDatas[i] });\r\n    });\r\n}\r\nfunction triggerChildGesto(moveable, able, type, delta, e, isConvert, ableName) {\r\n    var isStart = !!type.match(/Start$/g);\r\n    var isEnd = !!type.match(/End$/g);\r\n    var isPinch = e.isPinch;\r\n    var datas = e.datas;\r\n    var events = fillChildEvents(moveable, able.name, e);\r\n    var moveables = moveable.moveables;\r\n    var childEvents = [];\r\n    var eventParams = events.map(function (ev, i) {\r\n        var childMoveable = moveables[i];\r\n        var state = childMoveable.state;\r\n        var gestos = state.gestos;\r\n        var childEvent = ev;\r\n        if (isStart) {\r\n            childEvent = new CustomGesto(ableName).dragStart(delta, ev);\r\n            childEvents.push(childEvent);\r\n        }\r\n        else {\r\n            if (!gestos[ableName]) {\r\n                gestos[ableName] = datas.childGestos[i];\r\n            }\r\n            if (!gestos[ableName]) {\r\n                return;\r\n            }\r\n            childEvent = setCustomDrag(ev, state, delta, isPinch, isConvert, ableName);\r\n            childEvents.push(childEvent);\r\n        }\r\n        var result = able[type](childMoveable, __assign(__assign({}, childEvent), { parentFlag: true }));\r\n        if (isEnd) {\r\n            gestos[ableName] = null;\r\n        }\r\n        return result;\r\n    });\r\n    if (isStart) {\r\n        datas.childGestos = moveables.map(function (child) { return child.state.gestos[ableName]; });\r\n    }\r\n    return {\r\n        eventParams: eventParams,\r\n        childEvents: childEvents,\r\n    };\r\n}\r\nfunction triggerChildAbles(moveable, able, type, e, eachEvent, callback) {\r\n    if (eachEvent === void 0) { eachEvent = function (_, ev) { return ev; }; }\r\n    var isEnd = !!type.match(/End$/g);\r\n    var events = fillChildEvents(moveable, able.name, e);\r\n    var moveables = moveable.moveables;\r\n    var childs = events.map(function (ev, i) {\r\n        var childMoveable = moveables[i];\r\n        var childEvent = ev;\r\n        childEvent = eachEvent(childMoveable, ev);\r\n        var result = able[type](childMoveable, __assign(__assign({}, childEvent), { parentFlag: true }));\r\n        result && callback && callback(childMoveable, ev, result, i);\r\n        if (isEnd) {\r\n            childMoveable.state.gestos = {};\r\n        }\r\n        return result;\r\n    });\r\n    return childs;\r\n}\r\nfunction startChildDist(moveable, child, parentDatas, childEvent) {\r\n    var fixedDirection = parentDatas.fixedDirection;\r\n    var fixedPosition = parentDatas.fixedPosition;\r\n    var startPositions = childEvent.datas.startPositions || getAbsolutePosesByState(child.state);\r\n    var pos = getPosByDirection(startPositions, fixedDirection);\r\n    var _a = __read(calculate(createRotateMatrix(-moveable.rotation / 180 * Math.PI, 3), [pos[0] - fixedPosition[0], pos[1] - fixedPosition[1], 1], 3), 2), originalX = _a[0], originalY = _a[1];\r\n    childEvent.datas.originalX = originalX;\r\n    childEvent.datas.originalY = originalY;\r\n    return childEvent;\r\n}\n\nfunction renderDirectionControlsByInfos(moveable, ableName, renderDirections, React) {\r\n    var _a = moveable.getState(), renderPoses = _a.renderPoses, rotationRad = _a.rotation, direction = _a.direction;\r\n    var zoom = getProps(moveable.props, ableName).zoom;\r\n    var degRotation = absDegree(rotationRad / Math.PI * 180);\r\n    var directionMap = {};\r\n    var renderState = moveable.renderState;\r\n    if (!renderState.renderDirectionMap) {\r\n        renderState.renderDirectionMap = {};\r\n    }\r\n    var renderDirectionMap = renderState.renderDirectionMap;\r\n    renderDirections.forEach(function (_a) {\r\n        var dir = _a.dir;\r\n        directionMap[dir] = true;\r\n    });\r\n    var directionSign = sign(direction);\r\n    return renderDirections.map(function (_a) {\r\n        var data = _a.data, classNames = _a.classNames, dir = _a.dir;\r\n        var indexes = DIRECTION_INDEXES[dir];\r\n        if (!indexes || !directionMap[dir]) {\r\n            return null;\r\n        }\r\n        renderDirectionMap[dir] = true;\r\n        var directionRotation = (throttle(degRotation, 15) + directionSign * DIRECTION_ROTATIONS[dir] + 720) % 180;\r\n        var dataAttrs = {};\r\n        getKeys(data).forEach(function (name) {\r\n            dataAttrs[\"data-\".concat(name)] = data[name];\r\n        });\r\n        return (React.createElement(\"div\", __assign({ className: prefix.apply(void 0, __spreadArray([\"control\", \"direction\", dir, ableName], __read(classNames), false)), \"data-rotation\": directionRotation, \"data-direction\": dir }, dataAttrs, { key: \"direction-\".concat(dir), style: getControlTransform.apply(void 0, __spreadArray([rotationRad, zoom], __read(indexes.map(function (index) { return renderPoses[index]; })), false)) })));\r\n    });\r\n}\r\nfunction renderDirectionControls(moveable, defaultDirections, ableName, React) {\r\n    var _a = getProps(moveable.props, ableName), _b = _a.renderDirections, directions = _b === void 0 ? defaultDirections : _b, displayAroundControls = _a.displayAroundControls;\r\n    if (!directions) {\r\n        return [];\r\n    }\r\n    var renderDirections = directions === true ? DIRECTIONS : directions;\r\n    return __spreadArray(__spreadArray([], __read((displayAroundControls ? renderAroundControls(moveable, React, ableName, renderDirections) : [])), false), __read(renderDirectionControlsByInfos(moveable, ableName, renderDirections.map(function (dir) {\r\n        return {\r\n            data: {},\r\n            classNames: [],\r\n            dir: dir,\r\n        };\r\n    }), React)), false);\r\n}\r\nfunction renderLine(React, direction, pos1, pos2, zoom, key) {\r\n    var classNames = [];\r\n    for (var _i = 6; _i < arguments.length; _i++) {\r\n        classNames[_i - 6] = arguments[_i];\r\n    }\r\n    var rad = getRad(pos1, pos2);\r\n    var rotation = direction ? (throttle(rad / Math.PI * 180, 15)) % 180 : -1;\r\n    return React.createElement(\"div\", { key: \"line-\".concat(key), className: prefix.apply(void 0, __spreadArray([\"line\", \"direction\", direction ? \"edge\" : \"\", direction], __read(classNames), false)), \"data-rotation\": rotation, \"data-line-key\": key, \"data-direction\": direction, style: getLineStyle(pos1, pos2, zoom, rad) });\r\n}\r\nfunction renderEdgeLines(React, ableName, edge, poses, zoom) {\r\n    var directions = edge === true ? DIRECTIONS4 : edge;\r\n    return directions.map(function (direction, i) {\r\n        var _a = __read(DIRECTION_INDEXES[direction], 2), index1 = _a[0], index2 = _a[1];\r\n        if (index2 == null) {\r\n            return;\r\n        }\r\n        return renderLine(React, direction, poses[index1], poses[index2], zoom, \"\".concat(ableName, \"Edge\").concat(i), ableName);\r\n    }).filter(Boolean);\r\n}\r\nfunction getRenderDirections(ableName) {\r\n    return function (moveable, React) {\r\n        var edge = getProps(moveable.props, ableName).edge;\r\n        if (edge && (edge === true || edge.length)) {\r\n            return __spreadArray(__spreadArray([], __read(renderEdgeLines(React, ableName, edge, moveable.getState().renderPoses, moveable.props.zoom)), false), __read(renderDiagonalDirections(moveable, ableName, React)), false);\r\n        }\r\n        return renderAllDirections(moveable, ableName, React);\r\n    };\r\n}\r\nfunction renderAllDirections(moveable, ableName, React) {\r\n    return renderDirectionControls(moveable, DIRECTIONS, ableName, React);\r\n}\r\nfunction renderDiagonalDirections(moveable, ableName, React) {\r\n    return renderDirectionControls(moveable, [\"nw\", \"ne\", \"sw\", \"se\"], ableName, React);\r\n}\r\nfunction renderAroundControls(moveable, React, ableName, renderDirections) {\r\n    var renderState = moveable.renderState;\r\n    if (!renderState.renderDirectionMap) {\r\n        renderState.renderDirectionMap = {};\r\n    }\r\n    var _a = moveable.getState(), renderPoses = _a.renderPoses, rotationRad = _a.rotation, direction = _a.direction;\r\n    var renderDirectionMap = renderState.renderDirectionMap;\r\n    var zoom = moveable.props.zoom;\r\n    var directionSign = sign(direction);\r\n    var degRotation = rotationRad / Math.PI * 180;\r\n    return (renderDirections || getKeys(renderDirectionMap)).map(function (dir) {\r\n        var indexes = DIRECTION_INDEXES[dir];\r\n        if (!indexes) {\r\n            return null;\r\n        }\r\n        var directionRotation = (throttle(degRotation, 15) + directionSign * DIRECTION_ROTATIONS[dir] + 720) % 180;\r\n        var classNames = [\"around-control\"];\r\n        if (ableName) {\r\n            classNames.push(\"direction\", ableName);\r\n        }\r\n        return (React.createElement(\"div\", { className: prefix.apply(void 0, __spreadArray([], __read(classNames), false)), \"data-rotation\": directionRotation, \"data-direction\": dir, key: \"direction-around-\".concat(dir), style: getControlTransform.apply(void 0, __spreadArray([rotationRad, zoom], __read(indexes.map(function (index) { return renderPoses[index]; })), false)) }));\r\n    });\r\n}\n\nfunction checkBoundPoses(bounds, verticalPoses, horizontalPoses) {\r\n    var _a = bounds || {}, _b = _a.position, position = _b === void 0 ? \"client\" : _b, _c = _a.left, left = _c === void 0 ? -Infinity : _c, _d = _a.top, top = _d === void 0 ? -Infinity : _d, _e = _a.right, right = _e === void 0 ? Infinity : _e, _f = _a.bottom, bottom = _f === void 0 ? Infinity : _f;\r\n    var nextBounds = {\r\n        position: position,\r\n        left: left,\r\n        top: top,\r\n        right: right,\r\n        bottom: bottom,\r\n    };\r\n    return {\r\n        vertical: checkBounds(nextBounds, verticalPoses, true),\r\n        horizontal: checkBounds(nextBounds, horizontalPoses, false),\r\n    };\r\n}\r\nfunction getBounds(moveable, externalBounds) {\r\n    var _a = moveable.state, _b = _a.containerClientRect, containerHeight = _b.clientHeight, containerWidth = _b.clientWidth, clientLeft = _b.clientLeft, clientTop = _b.clientTop, _c = _a.snapOffset, snapOffsetLeft = _c.left, snapOffsetTop = _c.top, snapOffsetRight = _c.right, snapOffsetBottom = _c.bottom;\r\n    var bounds = externalBounds || moveable.props.bounds || {};\r\n    var position = bounds.position || \"client\";\r\n    var isCSS = position === \"css\";\r\n    var _d = bounds.left, left = _d === void 0 ? -Infinity : _d, _e = bounds.top, top = _e === void 0 ? -Infinity : _e;\r\n    var _f = bounds.right, right = _f === void 0 ? isCSS ? -Infinity : Infinity : _f, _g = bounds.bottom, bottom = _g === void 0 ? isCSS ? -Infinity : Infinity : _g;\r\n    if (isCSS) {\r\n        right = containerWidth + snapOffsetRight - snapOffsetLeft - right;\r\n        bottom = containerHeight + snapOffsetBottom - snapOffsetTop - bottom;\r\n    }\r\n    return {\r\n        left: left + snapOffsetLeft - clientLeft,\r\n        right: right + snapOffsetLeft - clientLeft,\r\n        top: top + snapOffsetTop - clientTop,\r\n        bottom: bottom + snapOffsetTop - clientTop,\r\n    };\r\n}\r\nfunction checkBoundKeepRatio(moveable, startPos, endPos) {\r\n    var _a = getBounds(moveable), left = _a.left, top = _a.top, right = _a.right, bottom = _a.bottom;\r\n    var _b = __read(endPos, 2), endX = _b[0], endY = _b[1];\r\n    var _c = __read(minus(endPos, startPos), 2), dx = _c[0], dy = _c[1];\r\n    if (abs(dx) < TINY_NUM) {\r\n        dx = 0;\r\n    }\r\n    if (abs(dy) < TINY_NUM) {\r\n        dy = 0;\r\n    }\r\n    var isBottom = dy > 0;\r\n    var isRight = dx > 0;\r\n    var verticalInfo = {\r\n        isBound: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    var horizontalInfo = {\r\n        isBound: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    if (dx === 0 && dy === 0) {\r\n        return {\r\n            vertical: verticalInfo,\r\n            horizontal: horizontalInfo,\r\n        };\r\n    }\r\n    else if (dx === 0) {\r\n        if (isBottom) {\r\n            if (bottom < endY) {\r\n                horizontalInfo.pos = bottom;\r\n                horizontalInfo.offset = endY - bottom;\r\n            }\r\n        }\r\n        else {\r\n            if (top > endY) {\r\n                horizontalInfo.pos = top;\r\n                horizontalInfo.offset = endY - top;\r\n            }\r\n        }\r\n    }\r\n    else if (dy === 0) {\r\n        if (isRight) {\r\n            if (right < endX) {\r\n                verticalInfo.pos = right;\r\n                verticalInfo.offset = endX - right;\r\n            }\r\n        }\r\n        else {\r\n            if (left > endX) {\r\n                verticalInfo.pos = left;\r\n                verticalInfo.offset = endX - left;\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        // y - y1 = a * (x - x1)\r\n        var a = dy / dx;\r\n        var b = endPos[1] - a * endX;\r\n        var y = 0;\r\n        var x = 0;\r\n        var isBound = false;\r\n        if (isRight && right <= endX) {\r\n            y = a * right + b;\r\n            x = right;\r\n            isBound = true;\r\n        }\r\n        else if (!isRight && endX <= left) {\r\n            y = a * left + b;\r\n            x = left;\r\n            isBound = true;\r\n        }\r\n        if (isBound) {\r\n            if (y < top || y > bottom) {\r\n                isBound = false;\r\n            }\r\n        }\r\n        if (!isBound) {\r\n            if (isBottom && bottom <= endY) {\r\n                y = bottom;\r\n                x = (y - b) / a;\r\n                isBound = true;\r\n            }\r\n            else if (!isBottom && endY <= top) {\r\n                y = top;\r\n                x = (y - b) / a;\r\n                isBound = true;\r\n            }\r\n        }\r\n        if (isBound) {\r\n            verticalInfo.isBound = true;\r\n            verticalInfo.pos = x;\r\n            verticalInfo.offset = endX - x;\r\n            horizontalInfo.isBound = true;\r\n            horizontalInfo.pos = y;\r\n            horizontalInfo.offset = endY - y;\r\n        }\r\n    }\r\n    return {\r\n        vertical: verticalInfo,\r\n        horizontal: horizontalInfo,\r\n    };\r\n}\r\nfunction checkBounds(bounds, poses, isVertical) {\r\n    // 0   [100 - 200]  300\r\n    var startBoundPos = bounds[isVertical ? \"left\" : \"top\"];\r\n    var endBoundPos = bounds[isVertical ? \"right\" : \"bottom\"];\r\n    // 450\r\n    var minPos = Math.min.apply(Math, __spreadArray([], __read(poses), false));\r\n    var maxPos = Math.max.apply(Math, __spreadArray([], __read(poses), false));\r\n    var boundInfos = [];\r\n    if (startBoundPos + 1 > minPos) {\r\n        boundInfos.push({\r\n            direction: \"start\",\r\n            isBound: true,\r\n            offset: minPos - startBoundPos,\r\n            pos: startBoundPos,\r\n        });\r\n    }\r\n    if (endBoundPos - 1 < maxPos) {\r\n        boundInfos.push({\r\n            direction: \"end\",\r\n            isBound: true,\r\n            offset: maxPos - endBoundPos,\r\n            pos: endBoundPos,\r\n        });\r\n    }\r\n    if (!boundInfos.length) {\r\n        boundInfos.push({\r\n            isBound: false,\r\n            offset: 0,\r\n            pos: 0,\r\n        });\r\n    }\r\n    return boundInfos.sort(function (a, b) { return abs(b.offset) - abs(a.offset); });\r\n}\r\nfunction isBoundRotate$1(relativePoses, boundRect, rad) {\r\n    var nextPoses = rad ? relativePoses.map(function (pos) { return rotate(pos, rad); }) : relativePoses;\r\n    return nextPoses.some(function (pos) {\r\n        return (pos[0] < boundRect.left && abs(pos[0] - boundRect.left) > 0.1)\r\n            || (pos[0] > boundRect.right && abs(pos[0] - boundRect.right) > 0.1)\r\n            || (pos[1] < boundRect.top && abs(pos[1] - boundRect.top) > 0.1)\r\n            || (pos[1] > boundRect.bottom && abs(pos[1] - boundRect.bottom) > 0.1);\r\n    });\r\n}\r\nfunction boundRotate(vec, boundPos, index) {\r\n    var r = getDistSize(vec);\r\n    var nextPos = Math.sqrt(r * r - boundPos * boundPos) || 0;\r\n    return [nextPos, -nextPos].sort(function (a, b) {\r\n        return abs(a - vec[index ? 0 : 1]) - abs(b - vec[index ? 0 : 1]);\r\n    }).map(function (pos) {\r\n        return getRad([0, 0], index ? [pos, boundPos] : [boundPos, pos]);\r\n    });\r\n}\r\nfunction checkRotateBounds(moveable, prevPoses, nextPoses, origin, rotation) {\r\n    if (!moveable.props.bounds) {\r\n        return [];\r\n    }\r\n    var rad = rotation * Math.PI / 180;\r\n    var _a = getBounds(moveable), left = _a.left, top = _a.top, right = _a.right, bottom = _a.bottom;\r\n    var relativeLeft = left - origin[0];\r\n    var relativeRight = right - origin[0];\r\n    var relativeTop = top - origin[1];\r\n    var relativeBottom = bottom - origin[1];\r\n    var boundRect = {\r\n        left: relativeLeft,\r\n        top: relativeTop,\r\n        right: relativeRight,\r\n        bottom: relativeBottom,\r\n    };\r\n    if (!isBoundRotate$1(nextPoses, boundRect, 0)) {\r\n        return [];\r\n    }\r\n    var result = [];\r\n    [\r\n        [relativeLeft, 0],\r\n        [relativeRight, 0],\r\n        [relativeTop, 1],\r\n        [relativeBottom, 1],\r\n    ].forEach(function (_a) {\r\n        var _b = __read(_a, 2), boundPos = _b[0], index = _b[1];\r\n        nextPoses.forEach(function (nextPos) {\r\n            var relativeRad1 = getRad([0, 0], nextPos);\r\n            result.push.apply(result, __spreadArray([], __read(boundRotate(nextPos, boundPos, index)\r\n                .map(function (relativeRad2) { return rad + relativeRad2 - relativeRad1; })\r\n                .filter(function (nextRad) { return !isBoundRotate$1(prevPoses, boundRect, nextRad); })\r\n                .map(function (nextRad) { return throttle(nextRad * 180 / Math.PI, TINY_NUM); })), false));\r\n        });\r\n    });\r\n    return result;\r\n}\n\nvar VERTICAL_NAMES = [\"left\", \"right\", \"center\"];\r\nvar HORIZONTAL_NAMES = [\"top\", \"bottom\", \"middle\"];\r\nvar SNAP_SKIP_NAMES_MAP = {\r\n    \"left\": \"start\",\r\n    \"right\": \"end\",\r\n    \"center\": \"center\",\r\n    \"top\": \"start\",\r\n    \"bottom\": \"end\",\r\n    \"middle\": \"center\",\r\n};\r\nvar VERTICAL_NAMES_MAP = {\r\n    start: \"left\",\r\n    end: \"right\",\r\n    center: \"center\",\r\n};\r\nvar HORIZONTAL_NAMES_MAP = {\r\n    start: \"top\",\r\n    end: \"bottom\",\r\n    center: \"middle\",\r\n};\r\nfunction getInitialBounds() {\r\n    return {\r\n        left: false,\r\n        top: false,\r\n        right: false,\r\n        bottom: false,\r\n    };\r\n}\r\nfunction hasGuidelines(moveable, ableName) {\r\n    var _a = moveable.props, snappable = _a.snappable, bounds = _a.bounds, innerBounds = _a.innerBounds, verticalGuidelines = _a.verticalGuidelines, horizontalGuidelines = _a.horizontalGuidelines, snapGridWidth = _a.snapGridWidth, snapGridHeight = _a.snapGridHeight, _b = moveable.state, guidelines = _b.guidelines, enableSnap = _b.enableSnap;\r\n    if (!snappable ||\r\n        !enableSnap ||\r\n        (ableName && snappable !== true && snappable.indexOf(ableName) < 0)) {\r\n        return false;\r\n    }\r\n    if (snapGridWidth ||\r\n        snapGridHeight ||\r\n        bounds ||\r\n        innerBounds ||\r\n        (guidelines && guidelines.length) ||\r\n        (verticalGuidelines && verticalGuidelines.length) ||\r\n        (horizontalGuidelines && horizontalGuidelines.length)) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction getSnapDirections(snapDirections) {\r\n    if (snapDirections === false) {\r\n        return {};\r\n    }\r\n    else if (snapDirections === true || !snapDirections) {\r\n        return { left: true, right: true, top: true, bottom: true };\r\n    }\r\n    return snapDirections;\r\n}\r\nfunction mapSnapDirectionPoses(snapDirections, snapPoses) {\r\n    var nextSnapDirections = getSnapDirections(snapDirections);\r\n    var nextSnapPoses = {};\r\n    for (var name_1 in nextSnapDirections) {\r\n        if (name_1 in snapPoses && nextSnapDirections[name_1]) {\r\n            nextSnapPoses[name_1] = snapPoses[name_1];\r\n        }\r\n    }\r\n    return nextSnapPoses;\r\n}\r\nfunction splitSnapDirectionPoses(snapDirections, snapPoses) {\r\n    var nextSnapPoses = mapSnapDirectionPoses(snapDirections, snapPoses);\r\n    var horizontalNames = HORIZONTAL_NAMES.filter(function (name) { return name in nextSnapPoses; });\r\n    var verticalNames = VERTICAL_NAMES.filter(function (name) { return name in nextSnapPoses; });\r\n    return {\r\n        horizontalNames: horizontalNames,\r\n        verticalNames: verticalNames,\r\n        horizontal: horizontalNames.map(function (name) { return nextSnapPoses[name]; }),\r\n        vertical: verticalNames.map(function (name) { return nextSnapPoses[name]; }),\r\n    };\r\n}\r\nfunction calculateContainerPos(rootMatrix, containerRect, n) {\r\n    var clientPos = calculatePosition(rootMatrix, [containerRect.clientLeft, containerRect.clientTop], n);\r\n    return [\r\n        containerRect.left + clientPos[0],\r\n        containerRect.top + clientPos[1],\r\n    ];\r\n}\r\nfunction solveLineConstants(_a) {\r\n    var _b = __read(_a, 2), point1 = _b[0], point2 = _b[1];\r\n    var dx = point2[0] - point1[0];\r\n    var dy = point2[1] - point1[1];\r\n    if (Math.abs(dx) < TINY_NUM$1) {\r\n        dx = 0;\r\n    }\r\n    if (Math.abs(dy) < TINY_NUM$1) {\r\n        dy = 0;\r\n    }\r\n    // b > 0\r\n    // ax + by + c = 0\r\n    var a = 0;\r\n    var b = 0;\r\n    var c = 0;\r\n    if (!dx) {\r\n        // -x + 1 = 0\r\n        a = -1;\r\n        c = point1[0];\r\n    }\r\n    else if (!dy) {\r\n        // y - 1 = 0\r\n        b = 1;\r\n        c = -point1[1];\r\n    }\r\n    else {\r\n        // y = -a(x - x1) + y1\r\n        // ax + y + a * x1 - y1 = 0\r\n        a = -dy / dx;\r\n        b = 1;\r\n        c = a * point1[0] - point1[1];\r\n    }\r\n    return [a, b, c].map(function (v) { return throttle(v, TINY_NUM$1); });\r\n}\n\nvar NAME_snapRotationThreshold = \"snapRotationThreshold\";\r\nvar NAME_snapRotationDegrees = \"snapRotationDegrees\";\r\nvar NAME_snapHorizontalThreshold = \"snapHorizontalThreshold\";\r\nvar NAME_snapVerticalThreshold = \"snapVerticalThreshold\";\n\nfunction checkMoveableSnapPoses(moveable, posesX, posesY, dirXs, dirYs, customSnapVerticalThreshold, customSnapHorizontalThreshold) {\r\n    var _a;\r\n    if (dirXs === void 0) { dirXs = []; }\r\n    if (dirYs === void 0) { dirYs = []; }\r\n    var props = moveable.props;\r\n    var snapThresholdMultiples = ((_a = moveable.state.snapThresholdInfo) === null || _a === void 0 ? void 0 : _a.multiples) || [1, 1];\r\n    var snapHorizontalThreshold = selectValue(customSnapHorizontalThreshold, props[NAME_snapHorizontalThreshold], 5);\r\n    var snapVerticalThreshold = selectValue(customSnapVerticalThreshold, props[NAME_snapVerticalThreshold], 5);\r\n    return checkSnapPoses(moveable.state.guidelines, posesX, posesY, dirXs, dirYs, snapHorizontalThreshold, snapVerticalThreshold, snapThresholdMultiples);\r\n}\r\nfunction checkSnapPoses(guidelines, posesX, posesY, dirXs, dirYs, snapHorizontalThreshold, snapVerticalThreshold, multiples) {\r\n    return {\r\n        vertical: checkSnap(guidelines, \"vertical\", posesX, snapVerticalThreshold * multiples[0], dirXs),\r\n        horizontal: checkSnap(guidelines, \"horizontal\", posesY, snapHorizontalThreshold * multiples[1], dirYs),\r\n    };\r\n}\r\nfunction checkSnapKeepRatio(moveable, startPos, endPos) {\r\n    var _a = __read(endPos, 2), endX = _a[0], endY = _a[1];\r\n    var _b = __read(startPos, 2), startX = _b[0], startY = _b[1];\r\n    var _c = __read(minus(endPos, startPos), 2), dx = _c[0], dy = _c[1];\r\n    var isBottom = dy > 0;\r\n    var isRight = dx > 0;\r\n    dx = getTinyDist(dx);\r\n    dy = getTinyDist(dy);\r\n    var verticalInfo = {\r\n        isSnap: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    var horizontalInfo = {\r\n        isSnap: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    if (dx === 0 && dy === 0) {\r\n        return {\r\n            vertical: verticalInfo,\r\n            horizontal: horizontalInfo,\r\n        };\r\n    }\r\n    var _d = checkMoveableSnapPoses(moveable, dx ? [endX] : [], dy ? [endY] : [], [], [], undefined, undefined), verticalSnapInfo = _d.vertical, horizontalSnapInfo = _d.horizontal;\r\n    verticalSnapInfo.posInfos.filter(function (_a) {\r\n        var pos = _a.pos;\r\n        return isRight ? pos >= startX : pos <= startX;\r\n    });\r\n    horizontalSnapInfo.posInfos.filter(function (_a) {\r\n        var pos = _a.pos;\r\n        return isBottom ? pos >= startY : pos <= startY;\r\n    });\r\n    verticalSnapInfo.isSnap = verticalSnapInfo.posInfos.length > 0;\r\n    horizontalSnapInfo.isSnap = horizontalSnapInfo.posInfos.length > 0;\r\n    var _e = getNearestSnapGuidelineInfo(verticalSnapInfo), isVerticalSnap = _e.isSnap, verticalGuideline = _e.guideline;\r\n    var _f = getNearestSnapGuidelineInfo(horizontalSnapInfo), isHorizontalSnap = _f.isSnap, horizontalGuideline = _f.guideline;\r\n    var horizontalPos = isHorizontalSnap ? horizontalGuideline.pos[1] : 0;\r\n    var verticalPos = isVerticalSnap ? verticalGuideline.pos[0] : 0;\r\n    if (dx === 0) {\r\n        if (isHorizontalSnap) {\r\n            horizontalInfo.isSnap = true;\r\n            horizontalInfo.pos = horizontalGuideline.pos[1];\r\n            horizontalInfo.offset = endY - horizontalInfo.pos;\r\n        }\r\n    }\r\n    else if (dy === 0) {\r\n        if (isVerticalSnap) {\r\n            verticalInfo.isSnap = true;\r\n            verticalInfo.pos = verticalPos;\r\n            verticalInfo.offset = endX - verticalPos;\r\n        }\r\n    }\r\n    else {\r\n        // y - y1 = a * (x - x1)\r\n        var a = dy / dx;\r\n        var b = endPos[1] - a * endX;\r\n        var y = 0;\r\n        var x = 0;\r\n        var isSnap = false;\r\n        if (isVerticalSnap) {\r\n            x = verticalPos;\r\n            y = a * x + b;\r\n            isSnap = true;\r\n        }\r\n        else if (isHorizontalSnap) {\r\n            y = horizontalPos;\r\n            x = (y - b) / a;\r\n            isSnap = true;\r\n        }\r\n        if (isSnap) {\r\n            verticalInfo.isSnap = true;\r\n            verticalInfo.pos = x;\r\n            verticalInfo.offset = endX - x;\r\n            horizontalInfo.isSnap = true;\r\n            horizontalInfo.pos = y;\r\n            horizontalInfo.offset = endY - y;\r\n        }\r\n    }\r\n    return {\r\n        vertical: verticalInfo,\r\n        horizontal: horizontalInfo,\r\n    };\r\n}\r\nfunction getStringDirection(dir) {\r\n    var stringDirection = \"\";\r\n    if (dir === -1 || dir === \"top\" || dir === \"left\") {\r\n        stringDirection = \"start\";\r\n    }\r\n    else if (dir === 0 || dir === \"center\" || dir === \"middle\") {\r\n        stringDirection = \"center\";\r\n    }\r\n    else if (dir === 1 || dir === \"right\" || dir === \"bottom\") {\r\n        stringDirection = \"end\";\r\n    }\r\n    return stringDirection;\r\n}\r\nfunction checkSnaps(moveable, rect, customSnapVerticalThreshold, customSnapHorizontalThreshold) {\r\n    var poses = splitSnapDirectionPoses(moveable.props.snapDirections, rect);\r\n    var result = checkMoveableSnapPoses(moveable, poses.vertical, poses.horizontal, poses.verticalNames.map(function (name) { return getStringDirection(name); }), poses.horizontalNames.map(function (name) { return getStringDirection(name); }), customSnapVerticalThreshold, customSnapHorizontalThreshold);\r\n    var horizontalDirection = getStringDirection(poses.horizontalNames[result.horizontal.index]);\r\n    var verticalDirection = getStringDirection(poses.verticalNames[result.vertical.index]);\r\n    return {\r\n        vertical: __assign(__assign({}, result.vertical), { direction: verticalDirection }),\r\n        horizontal: __assign(__assign({}, result.horizontal), { direction: horizontalDirection }),\r\n    };\r\n}\r\nfunction getNearestSnapGuidelineInfo(snapInfo) {\r\n    var isSnap = snapInfo.isSnap;\r\n    if (!isSnap) {\r\n        return {\r\n            isSnap: false,\r\n            offset: 0,\r\n            dist: -1,\r\n            pos: 0,\r\n            guideline: null,\r\n        };\r\n    }\r\n    var posInfo = snapInfo.posInfos[0];\r\n    var guidelineInfo = posInfo.guidelineInfos[0];\r\n    var offset = guidelineInfo.offset;\r\n    var dist = guidelineInfo.dist;\r\n    var guideline = guidelineInfo.guideline;\r\n    return {\r\n        isSnap: isSnap,\r\n        offset: offset,\r\n        dist: dist,\r\n        pos: posInfo.pos,\r\n        guideline: guideline,\r\n    };\r\n}\r\nfunction checkSnap(guidelines, targetType, targetPoses, snapThreshold, dirs) {\r\n    var _a, _b;\r\n    if (dirs === void 0) { dirs = []; }\r\n    if (!guidelines || !guidelines.length) {\r\n        return {\r\n            isSnap: false,\r\n            index: -1,\r\n            direction: \"\",\r\n            posInfos: [],\r\n        };\r\n    }\r\n    var isVertical = targetType === \"vertical\";\r\n    var posType = isVertical ? 0 : 1;\r\n    var snapPosInfos = targetPoses.map(function (targetPos, index) {\r\n        var direction = dirs[index] || \"\";\r\n        var guidelineInfos = guidelines.map(function (guideline) {\r\n            var pos = guideline.pos;\r\n            var offset = targetPos - pos[posType];\r\n            return {\r\n                offset: offset,\r\n                dist: abs(offset),\r\n                guideline: guideline,\r\n                direction: direction,\r\n            };\r\n        }).filter(function (_a) {\r\n            var guideline = _a.guideline, dist = _a.dist;\r\n            var type = guideline.type;\r\n            if (type !== targetType\r\n                || dist > snapThreshold) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }).sort(function (a, b) { return a.dist - b.dist; });\r\n        return {\r\n            pos: targetPos,\r\n            index: index,\r\n            guidelineInfos: guidelineInfos,\r\n            direction: direction,\r\n        };\r\n    }).filter(function (snapPosInfo) {\r\n        return snapPosInfo.guidelineInfos.length > 0;\r\n    }).sort(function (a, b) {\r\n        return a.guidelineInfos[0].dist - b.guidelineInfos[0].dist;\r\n    });\r\n    var isSnap = snapPosInfos.length > 0;\r\n    return {\r\n        isSnap: isSnap,\r\n        index: isSnap ? snapPosInfos[0].index : -1,\r\n        direction: (_b = (_a = snapPosInfos[0]) === null || _a === void 0 ? void 0 : _a.direction) !== null && _b !== void 0 ? _b : \"\",\r\n        posInfos: snapPosInfos,\r\n    };\r\n}\r\nfunction getSnapInfosByDirection(moveable, \r\n// pos1 pos2 pos3 pos4\r\nposes, snapDirection, customSnapVerticalThreshold, customSnapHorizontalThreshold) {\r\n    var dirs = [];\r\n    if (snapDirection[0] && snapDirection[1]) {\r\n        dirs = [\r\n            snapDirection,\r\n            [-snapDirection[0], snapDirection[1]],\r\n            [snapDirection[0], -snapDirection[1]],\r\n        ];\r\n    }\r\n    else if (!snapDirection[0] && !snapDirection[1]) {\r\n        [\r\n            [-1, -1],\r\n            [1, -1],\r\n            [1, 1],\r\n            [-1, 1],\r\n        ].forEach(function (dir, i, arr) {\r\n            var nextDir = (arr[i + 1] || arr[0]);\r\n            dirs.push(dir);\r\n            dirs.push([\r\n                (dir[0] + nextDir[0]) / 2,\r\n                (dir[1] + nextDir[1]) / 2,\r\n            ]);\r\n        });\r\n    }\r\n    else {\r\n        if (moveable.props.keepRatio) {\r\n            dirs.push([-1, -1], [-1, 1], [1, -1], [1, 1], snapDirection);\r\n        }\r\n        else {\r\n            dirs.push.apply(dirs, __spreadArray([], __read(getPosesByDirection([\r\n                [-1, -1],\r\n                [1, -1],\r\n                [-1, -1],\r\n                [1, 1],\r\n            ], snapDirection)), false));\r\n            if (dirs.length > 1) {\r\n                dirs.push([\r\n                    (dirs[0][0] + dirs[1][0]) / 2,\r\n                    (dirs[0][1] + dirs[1][1]) / 2,\r\n                ]);\r\n            }\r\n        }\r\n    }\r\n    var nextPoses = dirs.map(function (dir) { return getPosByDirection(poses, dir); });\r\n    var xs = nextPoses.map(function (pos) { return pos[0]; });\r\n    var ys = nextPoses.map(function (pos) { return pos[1]; });\r\n    var result = checkMoveableSnapPoses(moveable, xs, ys, dirs.map(function (dir) { return getStringDirection(dir[0]); }), dirs.map(function (dir) { return getStringDirection(dir[1]); }), customSnapVerticalThreshold, customSnapHorizontalThreshold);\r\n    var verticalDirection = getStringDirection(dirs.map(function (dir) { return dir[0]; })[result.vertical.index]);\r\n    var horizontalDirection = getStringDirection(dirs.map(function (dir) { return dir[1]; })[result.horizontal.index]);\r\n    return {\r\n        vertical: __assign(__assign({}, result.vertical), { direction: verticalDirection }),\r\n        horizontal: __assign(__assign({}, result.horizontal), { direction: horizontalDirection }),\r\n    };\r\n}\r\nfunction checkSnapBoundPriority(a, b) {\r\n    var aDist = abs(a.offset);\r\n    var bDist = abs(b.offset);\r\n    if (a.isBound && b.isBound) {\r\n        return bDist - aDist;\r\n    }\r\n    else if (a.isBound) {\r\n        return -1;\r\n    }\r\n    else if (b.isBound) {\r\n        return 1;\r\n    }\r\n    else if (a.isSnap && b.isSnap) {\r\n        return bDist - aDist;\r\n    }\r\n    else if (a.isSnap) {\r\n        return -1;\r\n    }\r\n    else if (b.isSnap) {\r\n        return 1;\r\n    }\r\n    else if (aDist < TINY_NUM) {\r\n        return 1;\r\n    }\r\n    else if (bDist < TINY_NUM) {\r\n        return -1;\r\n    }\r\n    return aDist - bDist;\r\n}\r\nfunction getNearOffsetInfo(offsets, index) {\r\n    return offsets.slice().sort(function (a, b) {\r\n        var aSign = a.sign[index];\r\n        var bSign = b.sign[index];\r\n        var aOffset = a.offset[index];\r\n        var bOffset = b.offset[index];\r\n        // -1 The positions of a and b do not change.\r\n        // 1 The positions of a and b are reversed.\r\n        if (!aSign) {\r\n            return 1;\r\n        }\r\n        else if (!bSign) {\r\n            return -1;\r\n        }\r\n        return checkSnapBoundPriority({ isBound: a.isBound, isSnap: a.isSnap, offset: aOffset }, { isBound: b.isBound, isSnap: b.isSnap, offset: bOffset });\r\n    })[0];\r\n}\r\nfunction getCheckSnapDirections(direction, fixedDirection, keepRatio) {\r\n    var directions = [];\r\n    // const fixedDirection = [-direction[0], -direction[1]];\r\n    if (keepRatio) {\r\n        if (abs(fixedDirection[0]) !== 1 || abs(fixedDirection[1]) !== 1) {\r\n            directions.push([fixedDirection, [-1, -1]], [fixedDirection, [-1, 1]], [fixedDirection, [1, -1]], [fixedDirection, [1, 1]]);\r\n        }\r\n        else {\r\n            directions.push([fixedDirection, [direction[0], -direction[1]]], [fixedDirection, [-direction[0], direction[1]]]);\r\n        }\r\n        directions.push([fixedDirection, direction]);\r\n    }\r\n    else {\r\n        if ((direction[0] && direction[1]) || (!direction[0] && !direction[1])) {\r\n            var endDirection_1 = direction[0] ? direction : [1, 1];\r\n            [1, -1].forEach(function (signX) {\r\n                [1, -1].forEach(function (signY) {\r\n                    var nextDirection = [signX * endDirection_1[0], signY * endDirection_1[1]];\r\n                    if (fixedDirection[0] === nextDirection[0]\r\n                        && fixedDirection[1] === nextDirection[1]) {\r\n                        return;\r\n                    }\r\n                    directions.push([fixedDirection, nextDirection]);\r\n                });\r\n            });\r\n        }\r\n        else if (direction[0]) {\r\n            var signs = abs(fixedDirection[0]) === 1 ? [1] : [1, -1];\r\n            signs.forEach(function (sign) {\r\n                directions.push([\r\n                    [fixedDirection[0], -1],\r\n                    [sign * direction[0], -1],\r\n                ], [\r\n                    [fixedDirection[0], 0],\r\n                    [sign * direction[0], 0],\r\n                ], [\r\n                    [fixedDirection[0], 1],\r\n                    [sign * direction[0], 1],\r\n                ]);\r\n            });\r\n        }\r\n        else if (direction[1]) {\r\n            var signs = abs(fixedDirection[1]) === 1 ? [1] : [1, -1];\r\n            signs.forEach(function (sign) {\r\n                directions.push([\r\n                    [-1, fixedDirection[1]],\r\n                    [-1, sign * direction[1]],\r\n                ], [\r\n                    [0, fixedDirection[1]],\r\n                    [0, sign * direction[1]],\r\n                ], [\r\n                    [1, fixedDirection[1]],\r\n                    [1, sign * direction[1]],\r\n                ]);\r\n            });\r\n        }\r\n    }\r\n    return directions;\r\n}\n\nfunction isStartLine(dot, line) {\r\n    // l    o     => true\r\n    // o    l    => false\r\n    var cx = average([line[0][0], line[1][0]]);\r\n    var cy = average([line[0][1], line[1][1]]);\r\n    return {\r\n        vertical: cx <= dot[0],\r\n        horizontal: cy <= dot[1],\r\n    };\r\n}\r\nfunction hitTestLine(dot, _a) {\r\n    var _b = __read(_a, 2), pos1 = _b[0], pos2 = _b[1];\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (abs(dx) < TINY_NUM) {\r\n        dx = 0;\r\n    }\r\n    if (abs(dy) < TINY_NUM) {\r\n        dy = 0;\r\n    }\r\n    var test1;\r\n    var test2;\r\n    if (!dx) {\r\n        test1 = pos1[0];\r\n        test2 = dot[0];\r\n    }\r\n    else if (!dy) {\r\n        test1 = pos1[1];\r\n        test2 = dot[1];\r\n    }\r\n    else {\r\n        var a = dy / dx;\r\n        // y = a * (x - pos1) + pos1\r\n        test1 = a * (dot[0] - pos1[0]) + pos1[1];\r\n        test2 = dot[1];\r\n    }\r\n    return test1 - test2;\r\n}\r\nfunction isSameStartLine(dots, line, centerSign, error) {\r\n    if (error === void 0) { error = TINY_NUM; }\r\n    return dots.every(function (dot) {\r\n        var value = hitTestLine(dot, line);\r\n        var sign = value <= 0;\r\n        return sign === centerSign || abs(value) <= error;\r\n    });\r\n}\r\nfunction checkInnerBoundDot(pos, start, end, isStart, threshold) {\r\n    if (threshold === void 0) { threshold = 0; }\r\n    if ((isStart && start - threshold <= pos)\r\n        || (!isStart && pos <= end + threshold)) {\r\n        // false 402 565 602 => 37 ([0, 37])\r\n        // true 400 524.9712603540036 600 => 124 ([124, 0])\r\n        // true 400 410 600 => 10 ([10, 0])\r\n        return {\r\n            isBound: true,\r\n            offset: isStart ? start - pos : end - pos,\r\n        };\r\n    }\r\n    return {\r\n        isBound: false,\r\n        offset: 0,\r\n    };\r\n}\r\nfunction checkInnerBound(moveable, _a) {\r\n    var line = _a.line, centerSign = _a.centerSign, verticalSign = _a.verticalSign, horizontalSign = _a.horizontalSign, lineConstants = _a.lineConstants;\r\n    var bounds = moveable.props.innerBounds;\r\n    if (!bounds) {\r\n        return {\r\n            isAllBound: false,\r\n            isBound: false,\r\n            isVerticalBound: false,\r\n            isHorizontalBound: false,\r\n            offset: [0, 0],\r\n        };\r\n    }\r\n    var left = bounds.left, top = bounds.top, width = bounds.width, height = bounds.height;\r\n    var leftLine = [[left, top], [left, top + height]];\r\n    var topLine = [[left, top], [left + width, top]];\r\n    var rightLine = [[left + width, top], [left + width, top + height]];\r\n    var bottomLine = [[left, top + height], [left + width, top + height]];\r\n    if (isSameStartLine([\r\n        [left, top],\r\n        [left + width, top],\r\n        [left, top + height],\r\n        [left + width, top + height],\r\n    ], line, centerSign)) {\r\n        return {\r\n            isAllBound: false,\r\n            isBound: false,\r\n            isVerticalBound: false,\r\n            isHorizontalBound: false,\r\n            offset: [0, 0],\r\n        };\r\n    }\r\n    // test vertical\r\n    var topBoundInfo = checkLineBoundCollision(line, lineConstants, topLine, verticalSign);\r\n    var bottomBoundInfo = checkLineBoundCollision(line, lineConstants, bottomLine, verticalSign);\r\n    // test horizontal\r\n    var leftBoundInfo = checkLineBoundCollision(line, lineConstants, leftLine, horizontalSign);\r\n    var rightBoundInfo = checkLineBoundCollision(line, lineConstants, rightLine, horizontalSign);\r\n    var isAllVerticalBound = topBoundInfo.isBound && bottomBoundInfo.isBound;\r\n    var isVerticalBound = topBoundInfo.isBound || bottomBoundInfo.isBound;\r\n    var isAllHorizontalBound = leftBoundInfo.isBound && rightBoundInfo.isBound;\r\n    var isHorizontalBound = leftBoundInfo.isBound || rightBoundInfo.isBound;\r\n    var verticalOffset = maxOffset(topBoundInfo.offset, bottomBoundInfo.offset);\r\n    var horizontalOffset = maxOffset(leftBoundInfo.offset, rightBoundInfo.offset);\r\n    var offset = [0, 0];\r\n    var isBound = false;\r\n    var isAllBound = false;\r\n    if (abs(horizontalOffset) < abs(verticalOffset)) {\r\n        offset = [verticalOffset, 0];\r\n        isBound = isVerticalBound;\r\n        isAllBound = isAllVerticalBound;\r\n    }\r\n    else {\r\n        offset = [0, horizontalOffset];\r\n        isBound = isHorizontalBound;\r\n        isAllBound = isAllHorizontalBound;\r\n    }\r\n    return {\r\n        isAllBound: isAllBound,\r\n        isVerticalBound: isVerticalBound,\r\n        isHorizontalBound: isHorizontalBound,\r\n        isBound: isBound,\r\n        offset: offset,\r\n    };\r\n}\r\nfunction checkLineBoundCollision(line, _a, boundLine, isStart, threshold, isRender) {\r\n    var _b = __read(_a, 2), a = _b[0], b = _b[1];\r\n    var dot1 = line[0];\r\n    // const dot2 = line[1];\r\n    var boundDot1 = boundLine[0];\r\n    var boundDot2 = boundLine[1];\r\n    // const dy1 = getTinyDist(dot2[1] - dot1[1]);\r\n    // const dx1 = getTinyDist(dot2[0] - dot1[0]);\r\n    var dy2 = getTinyDist(boundDot2[1] - boundDot1[1]);\r\n    var dx2 = getTinyDist(boundDot2[0] - boundDot1[0]);\r\n    var hasDx = b;\r\n    var hasDy = a;\r\n    var slope = -a / b;\r\n    // lineConstants\r\n    // ax + by + c = 0\r\n    // dx2 or dy2 is zero\r\n    if (!dx2) {\r\n        // vertical\r\n        // by + c = 0\r\n        if (isRender && !hasDy) {\r\n            // 90deg\r\n            return {\r\n                isBound: false,\r\n                offset: 0,\r\n            };\r\n        }\r\n        else if (hasDx) {\r\n            // ax + by + c = 0\r\n            // const y = dy1 ? dy1 / dx1 * (boundDot1[0] - dot1[0]) + dot1[1] : dot1[1];\r\n            var y = slope * (boundDot1[0] - dot1[0]) + dot1[1];\r\n            // boundDot1[1] <= y  <= boundDot2[1]\r\n            return checkInnerBoundDot(y, boundDot1[1], boundDot2[1], isStart, threshold);\r\n        }\r\n        else {\r\n            // ax + c = 0\r\n            var offset = boundDot1[0] - dot1[0];\r\n            var isBound = abs(offset) <= (threshold || 0);\r\n            return {\r\n                isBound: isBound,\r\n                offset: isBound ? offset : 0,\r\n            };\r\n        }\r\n    }\r\n    else if (!dy2) {\r\n        // horizontal\r\n        if (isRender && !hasDx) {\r\n            // 90deg\r\n            return {\r\n                isBound: false,\r\n                offset: 0,\r\n            };\r\n        }\r\n        else if (hasDy) {\r\n            // y = a * (x - x1) + y1\r\n            // x = (y - y1) / a + x1\r\n            // const a = dy1 / dx1;\r\n            // const x = dx1 ? (boundDot1[1] - dot1[1]) / a + dot1[0] : dot1[0];\r\n            var x = (boundDot1[1] - dot1[1]) / slope + dot1[0];\r\n            // boundDot1[0] <= x && x <= boundDot2[0]\r\n            return checkInnerBoundDot(x, boundDot1[0], boundDot2[0], isStart, threshold);\r\n        }\r\n        else {\r\n            var offset = boundDot1[1] - dot1[1];\r\n            var isBound = abs(offset) <= (threshold || 0);\r\n            return {\r\n                isBound: isBound,\r\n                offset: isBound ? offset : 0,\r\n            };\r\n        }\r\n    }\r\n    return {\r\n        isBound: false,\r\n        offset: 0,\r\n    };\r\n}\r\nfunction getInnerBoundInfo(moveable, lineInfos, datas) {\r\n    return lineInfos.map(function (info) {\r\n        var _a = checkInnerBound(moveable, info), isBound = _a.isBound, offset = _a.offset, isVerticalBound = _a.isVerticalBound, isHorizontalBound = _a.isHorizontalBound;\r\n        var multiple = info.multiple;\r\n        var sizeOffset = getDragDist({\r\n            datas: datas,\r\n            distX: offset[0],\r\n            distY: offset[1],\r\n        }).map(function (size, i) { return size * (multiple[i] ? 2 / multiple[i] : 0); });\r\n        return {\r\n            sign: multiple,\r\n            isBound: isBound,\r\n            isVerticalBound: isVerticalBound,\r\n            isHorizontalBound: isHorizontalBound,\r\n            isSnap: false,\r\n            offset: sizeOffset,\r\n        };\r\n    });\r\n}\r\nfunction getInnerBoundDragInfo(moveable, poses, datas) {\r\n    var _a;\r\n    var lines = getCheckInnerBoundLineInfos(moveable, poses, [0, 0], false).map(function (info) {\r\n        return __assign(__assign({}, info), { multiple: info.multiple.map(function (dir) { return abs(dir) * 2; }) });\r\n    });\r\n    var innerBoundInfo = getInnerBoundInfo(moveable, lines, datas);\r\n    var widthOffsetInfo = getNearOffsetInfo(innerBoundInfo, 0);\r\n    var heightOffsetInfo = getNearOffsetInfo(innerBoundInfo, 1);\r\n    var verticalOffset = 0;\r\n    var horizontalOffset = 0;\r\n    var isVerticalBound = widthOffsetInfo.isVerticalBound || heightOffsetInfo.isVerticalBound;\r\n    var isHorizontalBound = widthOffsetInfo.isHorizontalBound || heightOffsetInfo.isHorizontalBound;\r\n    if (isVerticalBound || isHorizontalBound) {\r\n        _a = __read(getInverseDragDist({\r\n            datas: datas,\r\n            distX: -widthOffsetInfo.offset[0],\r\n            distY: -heightOffsetInfo.offset[1],\r\n        }), 2), verticalOffset = _a[0], horizontalOffset = _a[1];\r\n    }\r\n    return {\r\n        vertical: {\r\n            isBound: isVerticalBound,\r\n            offset: verticalOffset,\r\n        },\r\n        horizontal: {\r\n            isBound: isHorizontalBound,\r\n            offset: horizontalOffset,\r\n        },\r\n    };\r\n}\r\nfunction getCheckSnapLineDirections(direction, keepRatio) {\r\n    var lineDirections = [];\r\n    var x = direction[0];\r\n    var y = direction[1];\r\n    if (x && y) {\r\n        lineDirections.push([[0, y * 2], direction, [-x, y]], [[x * 2, 0], direction, [x, -y]]);\r\n    }\r\n    else if (x) {\r\n        // vertcal\r\n        lineDirections.push([[x * 2, 0], [x, 1], [x, -1]]);\r\n        if (keepRatio) {\r\n            lineDirections.push([[0, -1], [x, -1], [-x, -1]], [[0, 1], [x, 1], [-x, 1]]);\r\n        }\r\n    }\r\n    else if (y) {\r\n        // horizontal\r\n        lineDirections.push([[0, y * 2], [1, y], [-1, y]]);\r\n        if (keepRatio) {\r\n            lineDirections.push([[-1, 0], [-1, y], [-1, -y]], [[1, 0], [1, y], [1, -y]]);\r\n        }\r\n    }\r\n    else {\r\n        // [0, 0] to all direction\r\n        lineDirections.push([[-1, 0], [-1, -1], [-1, 1]], [[1, 0], [1, -1], [1, 1]], [[0, -1], [-1, -1], [1, -1]], [[0, 1], [-1, 1], [1, 1]]);\r\n    }\r\n    return lineDirections;\r\n}\r\nfunction getCheckInnerBoundLineInfos(moveable, poses, direction, keepRatio) {\r\n    var _a = moveable.state, allMatrix = _a.allMatrix, is3d = _a.is3d;\r\n    var virtualPoses = calculatePoses(allMatrix, 100, 100, is3d ? 4 : 3);\r\n    var center = getPosByDirection(virtualPoses, [0, 0]);\r\n    return getCheckSnapLineDirections(direction, keepRatio).map(function (_a) {\r\n        var _b = __read(_a, 3), multiple = _b[0], dir1 = _b[1], dir2 = _b[2];\r\n        var virtualLine = [\r\n            getPosByDirection(virtualPoses, dir1),\r\n            getPosByDirection(virtualPoses, dir2),\r\n        ];\r\n        var lineConstants = solveLineConstants(virtualLine);\r\n        var _c = isStartLine(center, virtualLine), verticalSign = _c.vertical, horizontalSign = _c.horizontal;\r\n        var centerSign = hitTestLine(center, virtualLine) <= 0;\r\n        return {\r\n            multiple: multiple,\r\n            centerSign: centerSign,\r\n            verticalSign: verticalSign,\r\n            horizontalSign: horizontalSign,\r\n            lineConstants: lineConstants,\r\n            line: [\r\n                getPosByDirection(poses, dir1),\r\n                getPosByDirection(poses, dir2),\r\n            ],\r\n        };\r\n    });\r\n}\r\nfunction isBoundRotate(relativePoses, boundDots, center, rad) {\r\n    var nextPoses = rad ? relativePoses.map(function (pos) { return rotate(pos, rad); }) : relativePoses;\r\n    return [\r\n        [nextPoses[0], nextPoses[1]],\r\n        [nextPoses[1], nextPoses[3]],\r\n        [nextPoses[3], nextPoses[2]],\r\n        [nextPoses[2], nextPoses[0]],\r\n    ].some(function (line) {\r\n        var centerSign = hitTestLine(center, line) <= 0;\r\n        return !isSameStartLine(boundDots, line, centerSign);\r\n    });\r\n}\r\nfunction getDistPointLine(_a) {\r\n    // x = 0, y = 0\r\n    // d = (ax + by + c) / root(a2 + b2)\r\n    var _b = __read(_a, 2), pos1 = _b[0], pos2 = _b[1];\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (!dx) {\r\n        return abs(pos1[0]);\r\n    }\r\n    if (!dy) {\r\n        return abs(pos1[1]);\r\n    }\r\n    // y - y1 = a(x - x1)\r\n    // 0 = ax -y + -a * x1 + y1\r\n    var a = dy / dx;\r\n    return abs((-a * pos1[0] + pos1[1]) / Math.sqrt(Math.pow(a, 2) + 1));\r\n}\r\nfunction solveReverseLine(_a) {\r\n    var _b = __read(_a, 2), pos1 = _b[0], pos2 = _b[1];\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (!dx) {\r\n        return [pos1[0], 0];\r\n    }\r\n    if (!dy) {\r\n        return [0, pos1[1]];\r\n    }\r\n    var a = dy / dx;\r\n    // y - y1 = a (x  - x1)\r\n    // y = ax - a * x1 + y1\r\n    var b = -a * pos1[0] + pos1[1];\r\n    // y = ax + b = -1/a x\r\n    // x = -b / (a + 1 / a)\r\n    // y = b / (1 + 1 / a^2)\r\n    return [\r\n        -b / (a + 1 / a),\r\n        b / ((a * a) + 1),\r\n    ];\r\n}\r\nfunction checkRotateInnerBounds(moveable, prevPoses, nextPoses, origin, rotation) {\r\n    var bounds = moveable.props.innerBounds;\r\n    var rad = rotation * Math.PI / 180;\r\n    if (!bounds) {\r\n        return [];\r\n    }\r\n    var left = bounds.left, top = bounds.top, width = bounds.width, height = bounds.height;\r\n    var relativeLeft = left - origin[0];\r\n    var relativeRight = left + width - origin[0];\r\n    var relativeTop = top - origin[1];\r\n    var relativeBottom = top + height - origin[1];\r\n    var dots = [\r\n        [relativeLeft, relativeTop],\r\n        [relativeRight, relativeTop],\r\n        [relativeLeft, relativeBottom],\r\n        [relativeRight, relativeBottom],\r\n    ];\r\n    var center = getPosByDirection(nextPoses, [0, 0]);\r\n    if (!isBoundRotate(nextPoses, dots, center, 0)) {\r\n        return [];\r\n    }\r\n    var result = [];\r\n    var dotInfos = dots.map(function (dot) { return [\r\n        getDistSize(dot),\r\n        getRad([0, 0], dot),\r\n    ]; });\r\n    [\r\n        [nextPoses[0], nextPoses[1]],\r\n        [nextPoses[1], nextPoses[3]],\r\n        [nextPoses[3], nextPoses[2]],\r\n        [nextPoses[2], nextPoses[0]],\r\n    ].forEach(function (line) {\r\n        var lineRad = getRad([0, 0], solveReverseLine(line));\r\n        var lineDist = getDistPointLine(line);\r\n        result.push.apply(result, __spreadArray([], __read(dotInfos\r\n            .filter(function (_a) {\r\n            var _b = __read(_a, 1), dotDist = _b[0];\r\n            return dotDist && lineDist <= dotDist;\r\n        })\r\n            .map(function (_a) {\r\n            var _b = __read(_a, 2), dotDist = _b[0], dotRad = _b[1];\r\n            var distRad = Math.acos(dotDist ? lineDist / dotDist : 0);\r\n            var nextRad1 = dotRad + distRad;\r\n            var nextRad2 = dotRad - distRad;\r\n            return [\r\n                rad + nextRad1 - lineRad,\r\n                rad + nextRad2 - lineRad,\r\n            ];\r\n        })\r\n            .reduce(function (prev, cur) {\r\n            prev.push.apply(prev, __spreadArray([], __read(cur), false));\r\n            return prev;\r\n        }, [])\r\n            .filter(function (nextRad) { return !isBoundRotate(prevPoses, dots, center, nextRad); })\r\n            .map(function (nextRad) { return throttle(nextRad * 180 / Math.PI, TINY_NUM); })), false));\r\n    });\r\n    return result;\r\n}\r\nfunction checkInnerBoundPoses(moveable) {\r\n    var innerBounds = moveable.props.innerBounds;\r\n    var boundMap = getInitialBounds();\r\n    if (!innerBounds) {\r\n        return {\r\n            boundMap: boundMap,\r\n            vertical: [],\r\n            horizontal: [],\r\n        };\r\n    }\r\n    var _a = moveable.getRect(), pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4;\r\n    var poses = [pos1, pos2, pos3, pos4];\r\n    var center = getPosByDirection(poses, [0, 0]);\r\n    var left = innerBounds.left, top = innerBounds.top, width = innerBounds.width, height = innerBounds.height;\r\n    var leftLine = [[left, top], [left, top + height]];\r\n    var topLine = [[left, top], [left + width, top]];\r\n    var rightLine = [[left + width, top], [left + width, top + height]];\r\n    var bottomLine = [[left, top + height], [left + width, top + height]];\r\n    var lineInfos = getCheckInnerBoundLineInfos(moveable, poses, [0, 0], false);\r\n    var horizontalPoses = [];\r\n    var verticalPoses = [];\r\n    lineInfos.forEach(function (lineInfo) {\r\n        var line = lineInfo.line, lineConstants = lineInfo.lineConstants;\r\n        var _a = isStartLine(center, line), isHorizontalStart = _a.horizontal, isVerticalStart = _a.vertical;\r\n        // test vertical\r\n        var topBoundInfo = checkLineBoundCollision(line, lineConstants, topLine, isVerticalStart, 1, true);\r\n        var bottomBoundInfo = checkLineBoundCollision(line, lineConstants, bottomLine, isVerticalStart, 1, true);\r\n        // test horizontal\r\n        var leftBoundInfo = checkLineBoundCollision(line, lineConstants, leftLine, isHorizontalStart, 1, true);\r\n        var rightBoundInfo = checkLineBoundCollision(line, lineConstants, rightLine, isHorizontalStart, 1, true);\r\n        if (topBoundInfo.isBound && !boundMap.top) {\r\n            horizontalPoses.push(top);\r\n            boundMap.top = true;\r\n        }\r\n        if (bottomBoundInfo.isBound && !boundMap.bottom) {\r\n            horizontalPoses.push(top + height);\r\n            boundMap.bottom = true;\r\n        }\r\n        if (leftBoundInfo.isBound && !boundMap.left) {\r\n            verticalPoses.push(left);\r\n            boundMap.left = true;\r\n        }\r\n        if (rightBoundInfo.isBound && !boundMap.right) {\r\n            verticalPoses.push(left + width);\r\n            boundMap.right = true;\r\n        }\r\n    });\r\n    return {\r\n        boundMap: boundMap,\r\n        horizontal: horizontalPoses,\r\n        vertical: verticalPoses,\r\n    };\r\n}\n\nfunction solveEquation(pos1, pos2, snapOffset, isVertical) {\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (abs(dx) < TINY_NUM$1) {\r\n        dx = 0;\r\n    }\r\n    if (abs(dy) < TINY_NUM$1) {\r\n        dy = 0;\r\n    }\r\n    if (!dx) {\r\n        // y = 0 * x + b\r\n        // only horizontal\r\n        if (!isVertical) {\r\n            return [0, snapOffset];\r\n        }\r\n        return [0, 0];\r\n    }\r\n    if (!dy) {\r\n        // only vertical\r\n        if (isVertical) {\r\n            return [snapOffset, 0];\r\n        }\r\n        return [0, 0];\r\n    }\r\n    // y = ax + b\r\n    var a = dy / dx;\r\n    var b = pos1[1] - a * pos1[0];\r\n    if (isVertical) {\r\n        // y = a * x + b\r\n        var y = a * (pos2[0] + snapOffset) + b;\r\n        return [snapOffset, y - pos2[1]];\r\n    }\r\n    else {\r\n        // x = (y - b) / a\r\n        var x = (pos2[1] + snapOffset - b) / a;\r\n        return [x - pos2[0], snapOffset];\r\n    }\r\n}\r\nfunction solveNextOffset(pos1, pos2, offset, isVertical, datas) {\r\n    var sizeOffset = solveEquation(pos1, pos2, offset, isVertical);\r\n    if (!sizeOffset) {\r\n        return {\r\n            isOutside: false,\r\n            offset: [0, 0],\r\n        };\r\n    }\r\n    var size = getDist$1(pos1, pos2);\r\n    var dist1 = getDist$1(sizeOffset, pos1);\r\n    var dist2 = getDist$1(sizeOffset, pos2);\r\n    var isOutside = dist1 > size || dist2 > size;\r\n    var _a = __read(getDragDist({\r\n        datas: datas,\r\n        distX: sizeOffset[0],\r\n        distY: sizeOffset[1],\r\n    }), 2), widthOffset = _a[0], heightOffset = _a[1];\r\n    return {\r\n        offset: [widthOffset, heightOffset],\r\n        isOutside: isOutside,\r\n    };\r\n}\r\nfunction getSnapBound(boundInfo, snapInfo) {\r\n    if (boundInfo.isBound) {\r\n        return boundInfo.offset;\r\n    }\r\n    else if (snapInfo.isSnap) {\r\n        return getNearestSnapGuidelineInfo(snapInfo).offset;\r\n    }\r\n    return 0;\r\n}\r\nfunction checkThrottleDragRotate(throttleDragRotate, _a, _b, _c, _d) {\r\n    var _e = __read(_a, 2), distX = _e[0], distY = _e[1];\r\n    var _f = __read(_b, 2), isVerticalBound = _f[0], isHorizontalBound = _f[1];\r\n    var _g = __read(_c, 2), isVerticalSnap = _g[0], isHorizontalSnap = _g[1];\r\n    var _h = __read(_d, 2), verticalOffset = _h[0], horizontalOffset = _h[1];\r\n    var offsetX = -verticalOffset;\r\n    var offsetY = -horizontalOffset;\r\n    if (throttleDragRotate && distX && distY) {\r\n        offsetX = 0;\r\n        offsetY = 0;\r\n        var adjustPoses = [];\r\n        if (isVerticalBound && isHorizontalBound) {\r\n            adjustPoses.push([0, horizontalOffset], [verticalOffset, 0]);\r\n        }\r\n        else if (isVerticalBound) {\r\n            adjustPoses.push([verticalOffset, 0]);\r\n        }\r\n        else if (isHorizontalBound) {\r\n            adjustPoses.push([0, horizontalOffset]);\r\n        }\r\n        else if (isVerticalSnap && isHorizontalSnap) {\r\n            adjustPoses.push([0, horizontalOffset], [verticalOffset, 0]);\r\n        }\r\n        else if (isVerticalSnap) {\r\n            adjustPoses.push([verticalOffset, 0]);\r\n        }\r\n        else if (isHorizontalSnap) {\r\n            adjustPoses.push([0, horizontalOffset]);\r\n        }\r\n        if (adjustPoses.length) {\r\n            adjustPoses.sort(function (a, b) {\r\n                return (getDistSize(minus([distX, distY], a)) -\r\n                    getDistSize(minus([distX, distY], b)));\r\n            });\r\n            var adjustPos = adjustPoses[0];\r\n            if (adjustPos[0] && abs(distX) > TINY_NUM$1) {\r\n                offsetX = -adjustPos[0];\r\n                offsetY =\r\n                    (distY * abs(distX + offsetX)) / abs(distX) -\r\n                        distY;\r\n            }\r\n            else if (adjustPos[1] && abs(distY) > TINY_NUM$1) {\r\n                var prevDistY = distY;\r\n                offsetY = -adjustPos[1];\r\n                offsetX =\r\n                    (distX * abs(distY + offsetY)) / abs(prevDistY) -\r\n                        distX;\r\n            }\r\n            if (throttleDragRotate && isHorizontalBound && isVerticalBound) {\r\n                if (abs(offsetX) > TINY_NUM$1 &&\r\n                    abs(offsetX) < abs(verticalOffset)) {\r\n                    var scale = abs(verticalOffset) / abs(offsetX);\r\n                    offsetX *= scale;\r\n                    offsetY *= scale;\r\n                }\r\n                else if (abs(offsetY) > TINY_NUM$1 &&\r\n                    abs(offsetY) < abs(horizontalOffset)) {\r\n                    var scale = abs(horizontalOffset) / abs(offsetY);\r\n                    offsetX *= scale;\r\n                    offsetY *= scale;\r\n                }\r\n                else {\r\n                    offsetX = maxOffset(-verticalOffset, offsetX);\r\n                    offsetY = maxOffset(-horizontalOffset, offsetY);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        offsetX = distX || isVerticalBound ? -verticalOffset : 0;\r\n        offsetY = distY || isHorizontalBound ? -horizontalOffset : 0;\r\n    }\r\n    return [offsetX, offsetY];\r\n}\r\nfunction checkSnapBoundsDrag(moveable, distX, distY, throttleDragRotate, ignoreSnap, datas) {\r\n    if (!hasGuidelines(moveable, \"draggable\")) {\r\n        return [\r\n            {\r\n                isSnap: false,\r\n                isBound: false,\r\n                offset: 0,\r\n            },\r\n            {\r\n                isSnap: false,\r\n                isBound: false,\r\n                offset: 0,\r\n            },\r\n        ];\r\n    }\r\n    var poses = getAbsolutePoses(datas.absolutePoses, [distX, distY]);\r\n    var _a = getRect(poses), left = _a.left, right = _a.right, top = _a.top, bottom = _a.bottom;\r\n    var boundPoses = {\r\n        horizontal: poses.map(function (pos) { return pos[1]; }),\r\n        vertical: poses.map(function (pos) { return pos[0]; }),\r\n    };\r\n    var snapDirections = getSnapDirections(moveable.props.snapDirections);\r\n    var snapPoses = splitSnapDirectionPoses(snapDirections, {\r\n        left: left,\r\n        right: right,\r\n        top: top,\r\n        bottom: bottom,\r\n        center: (left + right) / 2,\r\n        middle: (top + bottom) / 2,\r\n    });\r\n    var _b = checkMoveableSnapBounds(moveable, ignoreSnap, snapPoses, boundPoses), verticalSnapBoundInfo = _b.vertical, horizontalSnapBoundInfo = _b.horizontal;\r\n    var _c = getInnerBoundDragInfo(moveable, poses, datas), verticalInnerBoundInfo = _c.vertical, horizontalInnerBoundInfo = _c.horizontal;\r\n    var isVerticalSnap = verticalSnapBoundInfo.isSnap;\r\n    var isHorizontalSnap = horizontalSnapBoundInfo.isSnap;\r\n    var isVerticalBound = verticalSnapBoundInfo.isBound || verticalInnerBoundInfo.isBound;\r\n    var isHorizontalBound = horizontalSnapBoundInfo.isBound || horizontalInnerBoundInfo.isBound;\r\n    var verticalOffset = maxOffset(verticalSnapBoundInfo.offset, verticalInnerBoundInfo.offset);\r\n    var horizontalOffset = maxOffset(horizontalSnapBoundInfo.offset, horizontalInnerBoundInfo.offset);\r\n    var _d = __read(checkThrottleDragRotate(throttleDragRotate, [distX, distY], [isVerticalBound, isHorizontalBound], [isVerticalSnap, isHorizontalSnap], [verticalOffset, horizontalOffset]), 2), offsetX = _d[0], offsetY = _d[1];\r\n    return [\r\n        {\r\n            isBound: isVerticalBound,\r\n            isSnap: isVerticalSnap,\r\n            offset: offsetX,\r\n        },\r\n        {\r\n            isBound: isHorizontalBound,\r\n            isSnap: isHorizontalSnap,\r\n            offset: offsetY,\r\n        },\r\n    ];\r\n}\r\nfunction checkMoveableSnapBounds(moveable, ignoreSnap, poses, boundPoses) {\r\n    if (boundPoses === void 0) { boundPoses = poses; }\r\n    var _a = checkBoundPoses(getBounds(moveable), boundPoses.vertical, boundPoses.horizontal), horizontalBoundInfos = _a.horizontal, verticalBoundInfos = _a.vertical;\r\n    var _b = ignoreSnap ? {\r\n        horizontal: { isSnap: false, index: -1 },\r\n        vertical: { isSnap: false, index: -1 },\r\n    } : checkMoveableSnapPoses(moveable, poses.vertical, poses.horizontal, undefined, undefined, undefined, undefined), horizontalSnapInfo = _b.horizontal, verticalSnapInfo = _b.vertical;\r\n    var horizontalOffset = getSnapBound(horizontalBoundInfos[0], horizontalSnapInfo);\r\n    var verticalOffset = getSnapBound(verticalBoundInfos[0], verticalSnapInfo);\r\n    var horizontalDist = abs(horizontalOffset);\r\n    var verticalDist = abs(verticalOffset);\r\n    return {\r\n        horizontal: {\r\n            isBound: horizontalBoundInfos[0].isBound,\r\n            isSnap: horizontalSnapInfo.isSnap,\r\n            snapIndex: horizontalSnapInfo.index,\r\n            offset: horizontalOffset,\r\n            dist: horizontalDist,\r\n            bounds: horizontalBoundInfos,\r\n            snap: horizontalSnapInfo,\r\n        },\r\n        vertical: {\r\n            isBound: verticalBoundInfos[0].isBound,\r\n            isSnap: verticalSnapInfo.isSnap,\r\n            snapIndex: verticalSnapInfo.index,\r\n            offset: verticalOffset,\r\n            dist: verticalDist,\r\n            bounds: verticalBoundInfos,\r\n            snap: verticalSnapInfo,\r\n        },\r\n    };\r\n}\r\nfunction checkSnapBounds(guideines, bounds, posesX, posesY, snapHorizontalThreshold, snapVerticalThreshold, multiples) {\r\n    if (multiples === void 0) { multiples = [1, 1]; }\r\n    var _a = checkBoundPoses(bounds, posesX, posesY), horizontalBoundInfos = _a.horizontal, verticalBoundInfos = _a.vertical;\r\n    // options.isRequest ? {\r\n    //     horizontal: { isSnap: false, index: -1 } as SnapInfo,\r\n    //     vertical: { isSnap: false, index: -1 } as SnapInfo,\r\n    // } :\r\n    var _b = checkSnapPoses(guideines, posesX, posesY, [], [], snapHorizontalThreshold, snapVerticalThreshold, multiples), horizontalSnapInfo = _b.horizontal, verticalSnapInfo = _b.vertical;\r\n    var horizontalOffset = getSnapBound(horizontalBoundInfos[0], horizontalSnapInfo);\r\n    var verticalOffset = getSnapBound(verticalBoundInfos[0], verticalSnapInfo);\r\n    var horizontalDist = abs(horizontalOffset);\r\n    var verticalDist = abs(verticalOffset);\r\n    return {\r\n        horizontal: {\r\n            isBound: horizontalBoundInfos[0].isBound,\r\n            isSnap: horizontalSnapInfo.isSnap,\r\n            snapIndex: horizontalSnapInfo.index,\r\n            offset: horizontalOffset,\r\n            dist: horizontalDist,\r\n            bounds: horizontalBoundInfos,\r\n            snap: horizontalSnapInfo,\r\n        },\r\n        vertical: {\r\n            isBound: verticalBoundInfos[0].isBound,\r\n            isSnap: verticalSnapInfo.isSnap,\r\n            snapIndex: verticalSnapInfo.index,\r\n            offset: verticalOffset,\r\n            dist: verticalDist,\r\n            bounds: verticalBoundInfos,\r\n            snap: verticalSnapInfo,\r\n        },\r\n    };\r\n}\r\nfunction checkSnapRightLine(startPos, endPos, snapBoundInfo, keepRatio) {\r\n    var rad = (getRad(startPos, endPos) / Math.PI) * 180;\r\n    var _a = snapBoundInfo.vertical, isVerticalBound = _a.isBound, isVerticalSnap = _a.isSnap, verticalDist = _a.dist, _b = snapBoundInfo.horizontal, isHorizontalBound = _b.isBound, isHorizontalSnap = _b.isSnap, horizontalDist = _b.dist;\r\n    var rad180 = rad % 180;\r\n    var isHorizontalLine = rad180 < 3 || rad180 > 177;\r\n    var isVerticalLine = rad180 > 87 && rad180 < 93;\r\n    if (horizontalDist < verticalDist) {\r\n        if (isVerticalBound ||\r\n            (isVerticalSnap &&\r\n                !isVerticalLine &&\r\n                (!keepRatio || !isHorizontalLine))) {\r\n            return \"vertical\";\r\n        }\r\n    }\r\n    if (isHorizontalBound ||\r\n        (isHorizontalSnap &&\r\n            !isHorizontalLine &&\r\n            (!keepRatio || !isVerticalLine))) {\r\n        return \"horizontal\";\r\n    }\r\n    return \"\";\r\n}\r\nfunction getSnapBoundInfo(moveable, poses, directions, keepRatio, isRequest, datas) {\r\n    return directions.map(function (_a) {\r\n        var _b = __read(_a, 2), startDirection = _b[0], endDirection = _b[1];\r\n        var otherStartPos = getPosByDirection(poses, startDirection);\r\n        var otherEndPos = getPosByDirection(poses, endDirection);\r\n        var snapBoundInfo = keepRatio\r\n            ? checkSnapBoundsKeepRatio(moveable, otherStartPos, otherEndPos, isRequest)\r\n            : checkMoveableSnapBounds(moveable, isRequest, {\r\n                vertical: [otherEndPos[0]],\r\n                horizontal: [otherEndPos[1]],\r\n            });\r\n        var _c = snapBoundInfo.horizontal, \r\n        // dist: otherHorizontalDist,\r\n        otherHorizontalOffset = _c.offset, isOtherHorizontalBound = _c.isBound, isOtherHorizontalSnap = _c.isSnap, _d = snapBoundInfo.vertical, \r\n        // dist: otherVerticalDist,\r\n        otherVerticalOffset = _d.offset, isOtherVerticalBound = _d.isBound, isOtherVerticalSnap = _d.isSnap;\r\n        var multiple = minus(endDirection, startDirection);\r\n        if (!otherVerticalOffset && !otherHorizontalOffset) {\r\n            return {\r\n                isBound: isOtherVerticalBound || isOtherHorizontalBound,\r\n                isSnap: isOtherVerticalSnap || isOtherHorizontalSnap,\r\n                sign: multiple,\r\n                offset: [0, 0],\r\n            };\r\n        }\r\n        var snapLine = checkSnapRightLine(otherStartPos, otherEndPos, snapBoundInfo, keepRatio);\r\n        if (!snapLine) {\r\n            return {\r\n                sign: multiple,\r\n                isBound: false,\r\n                isSnap: false,\r\n                offset: [0, 0],\r\n            };\r\n        }\r\n        var isVertical = snapLine === \"vertical\";\r\n        var sizeOffset = [0, 0];\r\n        if (!keepRatio\r\n            && abs(endDirection[0]) === 1\r\n            && abs(endDirection[1]) === 1\r\n            && startDirection[0] !== endDirection[0]\r\n            && startDirection[1] !== endDirection[1]) {\r\n            sizeOffset = getDragDist({\r\n                datas: datas,\r\n                distX: -otherVerticalOffset,\r\n                distY: -otherHorizontalOffset,\r\n            });\r\n        }\r\n        else {\r\n            sizeOffset = solveNextOffset(otherStartPos, otherEndPos, -(isVertical ? otherVerticalOffset : otherHorizontalOffset), isVertical, datas).offset;\r\n        }\r\n        sizeOffset = sizeOffset.map(function (size, i) { return size * (multiple[i] ? 2 / multiple[i] : 0); });\r\n        return {\r\n            sign: multiple,\r\n            isBound: isVertical ? isOtherVerticalBound : isOtherHorizontalBound,\r\n            isSnap: isVertical ? isOtherVerticalSnap : isOtherHorizontalSnap,\r\n            offset: sizeOffset,\r\n        };\r\n    });\r\n}\r\nfunction getSnapBoundOffset(boundInfo, snapInfo) {\r\n    if (boundInfo.isBound) {\r\n        return boundInfo.offset;\r\n    }\r\n    else if (snapInfo.isSnap) {\r\n        return snapInfo.offset;\r\n    }\r\n    return 0;\r\n}\r\nfunction checkSnapBoundsKeepRatio(moveable, startPos, endPos, isRequest) {\r\n    var _a = checkBoundKeepRatio(moveable, startPos, endPos), horizontalBoundInfo = _a.horizontal, verticalBoundInfo = _a.vertical;\r\n    var _b = isRequest ? {\r\n        horizontal: { isSnap: false },\r\n        vertical: { isSnap: false },\r\n    } : checkSnapKeepRatio(moveable, startPos, endPos), horizontalSnapInfo = _b.horizontal, verticalSnapInfo = _b.vertical;\r\n    var horizontalOffset = getSnapBoundOffset(horizontalBoundInfo, horizontalSnapInfo);\r\n    var verticalOffset = getSnapBoundOffset(verticalBoundInfo, verticalSnapInfo);\r\n    var horizontalDist = abs(horizontalOffset);\r\n    var verticalDist = abs(verticalOffset);\r\n    return {\r\n        horizontal: {\r\n            isBound: horizontalBoundInfo.isBound,\r\n            isSnap: horizontalSnapInfo.isSnap,\r\n            offset: horizontalOffset,\r\n            dist: horizontalDist,\r\n        },\r\n        vertical: {\r\n            isBound: verticalBoundInfo.isBound,\r\n            isSnap: verticalSnapInfo.isSnap,\r\n            offset: verticalOffset,\r\n            dist: verticalDist,\r\n        },\r\n    };\r\n}\r\nfunction checkMaxBounds(moveable, poses, direction, fixedPosition, datas) {\r\n    var fixedDirection = [-direction[0], -direction[1]];\r\n    var _a = moveable.state, width = _a.width, height = _a.height;\r\n    var bounds = moveable.props.bounds;\r\n    var maxWidth = Infinity;\r\n    var maxHeight = Infinity;\r\n    if (bounds) {\r\n        var directions = [\r\n            [direction[0], -direction[1]],\r\n            [-direction[0], direction[1]],\r\n        ];\r\n        var _b = bounds.left, left_1 = _b === void 0 ? -Infinity : _b, _c = bounds.top, top_1 = _c === void 0 ? -Infinity : _c, _d = bounds.right, right_1 = _d === void 0 ? Infinity : _d, _e = bounds.bottom, bottom_1 = _e === void 0 ? Infinity : _e;\r\n        directions.forEach(function (otherDirection) {\r\n            var isCheckVertical = otherDirection[0] !== fixedDirection[0];\r\n            var isCheckHorizontal = otherDirection[1] !== fixedDirection[1];\r\n            var otherPos = getPosByDirection(poses, otherDirection);\r\n            var deg = (getRad(fixedPosition, otherPos) * 360) / Math.PI;\r\n            if (isCheckHorizontal) {\r\n                var nextOtherPos = otherPos.slice();\r\n                if (abs(deg - 360) < 2 || abs(deg - 180) < 2) {\r\n                    nextOtherPos[1] = fixedPosition[1];\r\n                }\r\n                var _a = solveNextOffset(fixedPosition, nextOtherPos, (fixedPosition[1] < otherPos[1] ? bottom_1 : top_1) -\r\n                    otherPos[1], false, datas), _b = __read(_a.offset, 2), heightOffset = _b[1], isHeightOutside = _a.isOutside;\r\n                if (!isNaN(heightOffset)) {\r\n                    maxHeight = height + (isHeightOutside ? 1 : -1) * abs(heightOffset);\r\n                }\r\n            }\r\n            if (isCheckVertical) {\r\n                var nextOtherPos = otherPos.slice();\r\n                if (abs(deg - 90) < 2 || abs(deg - 270) < 2) {\r\n                    nextOtherPos[0] = fixedPosition[0];\r\n                }\r\n                var _c = solveNextOffset(fixedPosition, nextOtherPos, (fixedPosition[0] < otherPos[0] ? right_1 : left_1) - otherPos[0], true, datas), _d = __read(_c.offset, 1), widthOffset = _d[0], isWidthOutside = _c.isOutside;\r\n                if (!isNaN(widthOffset)) {\r\n                    maxWidth = width + (isWidthOutside ? 1 : -1) * abs(widthOffset);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return {\r\n        maxWidth: maxWidth,\r\n        maxHeight: maxHeight,\r\n    };\r\n}\n\n/**\r\n * @namespace Draggable\r\n * @memberof Moveable\r\n * @description Draggable refers to the ability to drag and move targets.\r\n */\r\nvar Draggable = {\r\n    name: \"draggable\",\r\n    props: [\r\n        \"draggable\",\r\n        \"throttleDrag\",\r\n        \"throttleDragRotate\",\r\n        \"hideThrottleDragRotateLine\",\r\n        \"startDragRotate\",\r\n        \"edgeDraggable\",\r\n    ],\r\n    events: [\r\n        \"dragStart\",\r\n        \"drag\",\r\n        \"dragEnd\",\r\n        \"dragGroupStart\",\r\n        \"dragGroup\",\r\n        \"dragGroupEnd\",\r\n    ],\r\n    requestStyle: function () {\r\n        return [\"left\", \"top\", \"right\", \"bottom\"];\r\n    },\r\n    requestChildStyle: function () {\r\n        return [\"left\", \"top\", \"right\", \"bottom\"];\r\n    },\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, hideThrottleDragRotateLine = _a.hideThrottleDragRotateLine, throttleDragRotate = _a.throttleDragRotate, zoom = _a.zoom;\r\n        var _b = moveable.getState(), dragInfo = _b.dragInfo, beforeOrigin = _b.beforeOrigin;\r\n        if (hideThrottleDragRotateLine || !throttleDragRotate || !dragInfo) {\r\n            return [];\r\n        }\r\n        var dist = dragInfo.dist;\r\n        if (!dist[0] && !dist[1]) {\r\n            return [];\r\n        }\r\n        var width = getDistSize(dist);\r\n        var rad = getRad(dist, [0, 0]);\r\n        return [React.createElement(\"div\", { className: prefix(\"line\", \"horizontal\", \"dragline\", \"dashed\"), key: \"dragRotateGuideline\", style: {\r\n                    width: \"\".concat(width, \"px\"),\r\n                    transform: \"translate(\".concat(beforeOrigin[0], \"px, \").concat(beforeOrigin[1], \"px) rotate(\").concat(rad, \"rad) scaleY(\").concat(zoom, \")\"),\r\n                } })];\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        var datas = e.datas, parentEvent = e.parentEvent, parentGesto = e.parentGesto;\r\n        var state = moveable.state;\r\n        var gestos = state.gestos, style = state.style;\r\n        if (gestos.draggable) {\r\n            return false;\r\n        }\r\n        gestos.draggable = parentGesto || moveable.targetGesto;\r\n        datas.datas = {};\r\n        datas.left = parseFloat(style.left || \"\") || 0;\r\n        datas.top = parseFloat(style.top || \"\") || 0;\r\n        datas.bottom = parseFloat(style.bottom || \"\") || 0;\r\n        datas.right = parseFloat(style.right || \"\") || 0;\r\n        datas.startValue = [0, 0];\r\n        setDragStart(moveable, e);\r\n        setDefaultTransformIndex(moveable, e, \"translate\");\r\n        startCheckSnapDrag(moveable, datas);\r\n        datas.prevDist = [0, 0];\r\n        datas.prevBeforeDist = [0, 0];\r\n        datas.isDrag = false;\r\n        datas.deltaOffset = [0, 0];\r\n        var params = fillParams(moveable, e, __assign({ set: function (translate) {\r\n                datas.startValue = translate;\r\n            } }, fillTransformStartEvent(moveable, e)));\r\n        var result = parentEvent || triggerEvent(moveable, \"onDragStart\", params);\r\n        if (result !== false) {\r\n            datas.isDrag = true;\r\n            moveable.state.dragInfo = {\r\n                startRect: moveable.getRect(),\r\n                dist: [0, 0],\r\n            };\r\n        }\r\n        else {\r\n            gestos.draggable = null;\r\n            datas.isPinch = false;\r\n        }\r\n        return datas.isDrag ? params : false;\r\n    },\r\n    drag: function (moveable, e) {\r\n        if (!e) {\r\n            return;\r\n        }\r\n        resolveTransformEvent(moveable, e, \"translate\");\r\n        var datas = e.datas, parentEvent = e.parentEvent, parentFlag = e.parentFlag, isPinch = e.isPinch, deltaOffset = e.deltaOffset, useSnap = e.useSnap, isRequest = e.isRequest, isGroup = e.isGroup, parentThrottleDrag = e.parentThrottleDrag;\r\n        var distX = e.distX, distY = e.distY;\r\n        var isDrag = datas.isDrag, prevDist = datas.prevDist, prevBeforeDist = datas.prevBeforeDist, startValue = datas.startValue;\r\n        if (!isDrag) {\r\n            return;\r\n        }\r\n        if (deltaOffset) {\r\n            distX += deltaOffset[0];\r\n            distY += deltaOffset[1];\r\n        }\r\n        var props = moveable.props;\r\n        var parentMoveable = props.parentMoveable;\r\n        var throttleDrag = isGroup ? 0 : (props.throttleDrag || parentThrottleDrag || 0);\r\n        var throttleDragRotate = parentEvent ? 0 : (props.throttleDragRotate || 0);\r\n        var dragRotateRad = 0;\r\n        var isVerticalSnap = false;\r\n        var isVerticalBound = false;\r\n        var isHorizontalSnap = false;\r\n        var isHorizontalBound = false;\r\n        if (!parentEvent && throttleDragRotate > 0 && (distX || distY)) {\r\n            var startDragRotate = props.startDragRotate || 0;\r\n            var deg = throttle(startDragRotate + getRad([0, 0], [distX, distY]) * 180 / Math.PI, throttleDragRotate)\r\n                - startDragRotate;\r\n            var ry = distY * Math.abs(Math.cos((deg - 90) / 180 * Math.PI));\r\n            var rx = distX * Math.abs(Math.cos(deg / 180 * Math.PI));\r\n            var r = getDistSize([rx, ry]);\r\n            dragRotateRad = deg * Math.PI / 180;\r\n            distX = r * Math.cos(dragRotateRad);\r\n            distY = r * Math.sin(dragRotateRad);\r\n        }\r\n        if (!isPinch && !parentEvent && !parentFlag) {\r\n            var _a = __read(checkSnapBoundsDrag(moveable, distX, distY, throttleDragRotate, (!useSnap && isRequest) || deltaOffset, datas), 2), verticalInfo = _a[0], horizontalInfo = _a[1];\r\n            isVerticalSnap = verticalInfo.isSnap;\r\n            isVerticalBound = verticalInfo.isBound;\r\n            isHorizontalSnap = horizontalInfo.isSnap;\r\n            isHorizontalBound = horizontalInfo.isBound;\r\n            var verticalOffset = verticalInfo.offset;\r\n            var horizontalOffset = horizontalInfo.offset;\r\n            distX += verticalOffset;\r\n            distY += horizontalOffset;\r\n        }\r\n        var beforeTranslate = plus(getBeforeDragDist({ datas: datas, distX: distX, distY: distY }), startValue);\r\n        var translate = plus(getTransformDist({ datas: datas, distX: distX, distY: distY }), startValue);\r\n        throttleArray(translate, TINY_NUM);\r\n        throttleArray(beforeTranslate, TINY_NUM);\r\n        if (!throttleDragRotate) {\r\n            if (!isVerticalSnap && !isVerticalBound) {\r\n                translate[0] = throttle(translate[0], throttleDrag);\r\n                beforeTranslate[0] = throttle(beforeTranslate[0], throttleDrag);\r\n            }\r\n            if (!isHorizontalSnap && !isHorizontalBound) {\r\n                translate[1] = throttle(translate[1], throttleDrag);\r\n                beforeTranslate[1] = throttle(beforeTranslate[1], throttleDrag);\r\n            }\r\n        }\r\n        var beforeDist = minus(beforeTranslate, startValue);\r\n        var dist = minus(translate, startValue);\r\n        var delta = minus(dist, prevDist);\r\n        var beforeDelta = minus(beforeDist, prevBeforeDist);\r\n        datas.prevDist = dist;\r\n        datas.prevBeforeDist = beforeDist;\r\n        datas.passDelta = delta; //distX - (datas.passDistX || 0);\r\n        // datas.passDeltaY = distY - (datas.passDistY || 0);\r\n        datas.passDist = dist; //distX;\r\n        // datas.passDistY = distY;\r\n        var left = datas.left + beforeDist[0];\r\n        var top = datas.top + beforeDist[1];\r\n        var right = datas.right - beforeDist[0];\r\n        var bottom = datas.bottom - beforeDist[1];\r\n        var nextTransform = convertTransformFormat(datas, \"translate(\".concat(translate[0], \"px, \").concat(translate[1], \"px)\"), \"translate(\".concat(dist[0], \"px, \").concat(dist[1], \"px)\"));\r\n        fillOriginalTransform(e, nextTransform);\r\n        moveable.state.dragInfo.dist = parentEvent ? [0, 0] : dist;\r\n        if (!parentEvent && !parentMoveable && delta.every(function (num) { return !num; }) && beforeDelta.some(function (num) { return !num; })) {\r\n            return;\r\n        }\r\n        var _b = moveable.state, width = _b.width, height = _b.height;\r\n        var params = fillParams(moveable, e, __assign({ transform: nextTransform, dist: dist, delta: delta, translate: translate, beforeDist: beforeDist, beforeDelta: beforeDelta, beforeTranslate: beforeTranslate, left: left, top: top, right: right, bottom: bottom, width: width, height: height, isPinch: isPinch }, fillCSSObject({\r\n            transform: nextTransform,\r\n        }, e)));\r\n        !parentEvent && triggerEvent(moveable, \"onDrag\", params);\r\n        return params;\r\n    },\r\n    dragAfter: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var deltaOffset = datas.deltaOffset;\r\n        if (deltaOffset[0] || deltaOffset[1]) {\r\n            datas.deltaOffset = [0, 0];\r\n            return this.drag(moveable, __assign(__assign({}, e), { deltaOffset: deltaOffset }));\r\n        }\r\n        return false;\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        var parentEvent = e.parentEvent, datas = e.datas;\r\n        moveable.state.dragInfo = null;\r\n        if (!datas.isDrag) {\r\n            return;\r\n        }\r\n        datas.isDrag = false;\r\n        var param = fillEndParams(moveable, e, {});\r\n        !parentEvent && triggerEvent(moveable, \"onDragEnd\", param);\r\n        return param;\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        var _a, _b;\r\n        var datas = e.datas, clientX = e.clientX, clientY = e.clientY;\r\n        var params = this.dragStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        var _c = triggerChildGesto(moveable, this, \"dragStart\", [\r\n            clientX || 0,\r\n            clientY || 0,\r\n        ], e, false, \"draggable\"), childEvents = _c.childEvents, eventParams = _c.eventParams;\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: eventParams });\r\n        var result = triggerEvent(moveable, \"onDragGroupStart\", nextParams);\r\n        datas.isDrag = result !== false;\r\n        // find data.startValue and based on first child moveable\r\n        var startValue = (_b = (_a = childEvents[0]) === null || _a === void 0 ? void 0 : _a.datas.startValue) !== null && _b !== void 0 ? _b : [0, 0];\r\n        datas.throttleOffset = [startValue[0] % 1, startValue[1] % 1];\r\n        return datas.isDrag ? params : false;\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isDrag) {\r\n            return;\r\n        }\r\n        var params = this.drag(moveable, __assign(__assign({}, e), { parentThrottleDrag: moveable.props.throttleDrag }));\r\n        var passDelta = e.datas.passDelta;\r\n        var eventParams = triggerChildGesto(moveable, this, \"drag\", passDelta, e, false, \"draggable\").eventParams;\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: eventParams }, params);\r\n        triggerEvent(moveable, \"onDragGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isDrag) {\r\n            return;\r\n        }\r\n        this.dragEnd(moveable, e);\r\n        var eventParams = triggerChildGesto(moveable, this, \"dragEnd\", [0, 0], e, false, \"draggable\").eventParams;\r\n        triggerEvent(moveable, \"onDragGroupEnd\", fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: eventParams,\r\n        }));\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Draggable#request\r\n     * @param {object} [e] - the draggable's request parameter\r\n     * @param {number} [e.x] - x position\r\n     * @param {number} [e.y] - y position\r\n     * @param {number} [e.deltaX] - X number to move\r\n     * @param {number} [e.deltaY] - Y number to move\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * // Use Relative Value\r\n     * moveable.request(\"draggable\", { deltaX: 10, deltaY: 10 }, true);\r\n     * // Use Absolute Value\r\n     * moveable.request(\"draggable\", { x: 200, y: 100 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"draggable\");\r\n     *\r\n     * // request\r\n     * // Use Relative Value\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * // Use Absolute Value\r\n     * moveable.request(\"draggable\", { x: 200, y: 100 });\r\n     * moveable.request(\"draggable\", { x: 220, y: 100 });\r\n     * moveable.request(\"draggable\", { x: 240, y: 100 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var rect = moveable.getRect();\r\n        var distX = 0;\r\n        var distY = 0;\r\n        var useSnap = false;\r\n        return {\r\n            isControl: false,\r\n            requestStart: function (e) {\r\n                useSnap = e.useSnap;\r\n                return { datas: datas, useSnap: useSnap };\r\n            },\r\n            request: function (e) {\r\n                if (\"x\" in e) {\r\n                    distX = e.x - rect.left;\r\n                }\r\n                else if (\"deltaX\" in e) {\r\n                    distX += e.deltaX;\r\n                }\r\n                if (\"y\" in e) {\r\n                    distY = e.y - rect.top;\r\n                }\r\n                else if (\"deltaY\" in e) {\r\n                    distY += e.deltaY;\r\n                }\r\n                return { datas: datas, distX: distX, distY: distY, useSnap: useSnap };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true, useSnap: useSnap };\r\n            },\r\n        };\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.gestos.draggable = null;\r\n        moveable.state.dragInfo = null;\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be dragged. (default: false)\r\n * @name Moveable.Draggable#draggable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.draggable = true;\r\n */\r\n/**\r\n * throttle of x, y when drag.\r\n * @name Moveable.Draggable#throttleDrag\r\n * @default 0\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.throttleDrag = 1;\r\n */\r\n/**\r\n* throttle of angle of x, y when drag.\r\n* @name Moveable.Draggable#throttleDragRotate\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body);\r\n*\r\n* moveable.throttleDragRotate = 45;\r\n*/\r\n/**\r\n* start angle of throttleDragRotate of x, y when drag.\r\n* @name Moveable.Draggable#startDragRotate\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body);\r\n*\r\n* // 45, 135, 225, 315\r\n* moveable.throttleDragRotate = 90;\r\n* moveable.startDragRotate = 45;\r\n*/\r\n/**\r\n * When the drag starts, the dragStart event is called.\r\n * @memberof Moveable.Draggable\r\n * @event dragStart\r\n * @param {Moveable.Draggable.OnDragStart} - Parameters for the dragStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { draggable: true });\r\n * moveable.on(\"dragStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When dragging, the drag event is called.\r\n * @memberof Moveable.Draggable\r\n * @event drag\r\n * @param {Moveable.Draggable.OnDrag} - Parameters for the drag event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { draggable: true });\r\n * moveable.on(\"drag\", ({ target, transform }) => {\r\n *     target.style.transform = transform;\r\n * });\r\n */\r\n/**\r\n * When the drag finishes, the dragEnd event is called.\r\n * @memberof Moveable.Draggable\r\n * @event dragEnd\r\n * @param {Moveable.Draggable.OnDragEnd} - Parameters for the dragEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { draggable: true });\r\n * moveable.on(\"dragEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n* When the group drag starts, the `dragGroupStart` event is called.\r\n* @memberof Moveable.Draggable\r\n* @event dragGroupStart\r\n* @param {Moveable.Draggable.OnDragGroupStart} - Parameters for the `dragGroupStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     draggable: true\r\n* });\r\n* moveable.on(\"dragGroupStart\", ({ targets }) => {\r\n*     console.log(\"onDragGroupStart\", targets);\r\n* });\r\n*/\r\n/**\r\n* When the group drag, the `dragGroup` event is called.\r\n* @memberof Moveable.Draggable\r\n* @event dragGroup\r\n* @param {Moveable.Draggable.OnDragGroup} - Parameters for the `dragGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     draggable: true\r\n* });\r\n* moveable.on(\"dragGroup\", ({ targets, events }) => {\r\n*     console.log(\"onDragGroup\", targets);\r\n*     events.forEach(ev => {\r\n*          // drag event\r\n*          console.log(\"onDrag left, top\", ev.left, ev.top);\r\n*          // ev.target!.style.left = `${ev.left}px`;\r\n*          // ev.target!.style.top = `${ev.top}px`;\r\n*          console.log(\"onDrag translate\", ev.dist);\r\n*          ev.target!.style.transform = ev.transform;)\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group drag finishes, the `dragGroupEnd` event is called.\r\n * @memberof Moveable.Draggable\r\n * @event dragGroupEnd\r\n * @param {Moveable.Draggable.OnDragGroupEnd} - Parameters for the `dragGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     draggable: true\r\n * });\r\n * moveable.on(\"dragGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onDragGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nfunction getFixedDirectionInfo(startPositions, fixedDirection) {\r\n    var fixedPosition = getPosByDirection(startPositions, fixedDirection);\r\n    var fixedOffset = [0, 0];\r\n    return {\r\n        fixedPosition: fixedPosition,\r\n        fixedDirection: fixedDirection,\r\n        fixedOffset: fixedOffset,\r\n    };\r\n}\r\nfunction getOffsetFixedDirectionInfo(state, fixedDirection) {\r\n    // for start\r\n    var allMatrix = state.allMatrix, is3d = state.is3d, width = state.width, height = state.height;\r\n    var n = is3d ? 4 : 3;\r\n    var nextFixedOffset = [\r\n        width / 2 * (1 + fixedDirection[0]),\r\n        height / 2 * (1 + fixedDirection[1]),\r\n    ];\r\n    var fixedPosition = calculatePosition(allMatrix, nextFixedOffset, n);\r\n    var fixedOffset = [0, 0];\r\n    return {\r\n        fixedPosition: fixedPosition,\r\n        fixedDirection: fixedDirection,\r\n        fixedOffset: fixedOffset,\r\n    };\r\n}\r\nfunction getOffsetFixedPositionInfo(state, offsetFixedPosition) {\r\n    // for start\r\n    var allMatrix = state.allMatrix, is3d = state.is3d, width = state.width, height = state.height;\r\n    var n = is3d ? 4 : 3;\r\n    var fixedDirection = getDirectionByPos(offsetFixedPosition, width, height);\r\n    var nextFixedPosition = calculatePosition(allMatrix, offsetFixedPosition, n);\r\n    var fixedOffset = [\r\n        width ? 0 : offsetFixedPosition[0],\r\n        height ? 0 : offsetFixedPosition[1],\r\n    ];\r\n    return {\r\n        fixedPosition: nextFixedPosition,\r\n        fixedDirection: fixedDirection,\r\n        fixedOffset: fixedOffset,\r\n    };\r\n}\n\n/**\r\n * @namespace Resizable\r\n * @memberof Moveable\r\n * @description Resizable indicates whether the target's width and height can be increased or decreased.\r\n */\r\nvar directionCondition$2 = getDirectionCondition(\"resizable\");\r\nvar Resizable = {\r\n    name: \"resizable\",\r\n    ableGroup: \"size\",\r\n    canPinch: true,\r\n    props: [\r\n        \"resizable\",\r\n        \"throttleResize\",\r\n        \"renderDirections\",\r\n        \"displayAroundControls\",\r\n        \"keepRatio\",\r\n        \"resizeFormat\",\r\n        \"keepRatioFinally\",\r\n        \"edge\",\r\n        \"checkResizableError\",\r\n    ],\r\n    events: [\r\n        \"resizeStart\",\r\n        \"beforeResize\",\r\n        \"resize\",\r\n        \"resizeEnd\",\r\n        \"resizeGroupStart\",\r\n        \"beforeResizeGroup\",\r\n        \"resizeGroup\",\r\n        \"resizeGroupEnd\",\r\n    ],\r\n    render: getRenderDirections(\"resizable\"),\r\n    dragControlCondition: directionCondition$2,\r\n    viewClassName: getDirectionViewClassName(\"resizable\"),\r\n    dragControlStart: function (moveable, e) {\r\n        var _a;\r\n        var inputEvent = e.inputEvent, isPinch = e.isPinch, isGroup = e.isGroup, parentDirection = e.parentDirection, parentGesto = e.parentGesto, datas = e.datas, parentFixedDirection = e.parentFixedDirection, parentEvent = e.parentEvent;\r\n        var direction = getTotalDirection(parentDirection, isPinch, inputEvent, datas);\r\n        var state = moveable.state;\r\n        var target = state.target, width = state.width, height = state.height, gestos = state.gestos;\r\n        if (!direction || !target) {\r\n            return false;\r\n        }\r\n        if (gestos.resizable) {\r\n            return false;\r\n        }\r\n        gestos.resizable = parentGesto || moveable.controlGesto;\r\n        !isPinch && setDragStart(moveable, e);\r\n        datas.datas = {};\r\n        datas.direction = direction;\r\n        datas.startOffsetWidth = width;\r\n        datas.startOffsetHeight = height;\r\n        datas.prevWidth = 0;\r\n        datas.prevHeight = 0;\r\n        datas.minSize = [0, 0];\r\n        datas.startWidth = state.inlineCSSWidth || state.cssWidth;\r\n        datas.startHeight = state.inlineCSSHeight || state.cssHeight;\r\n        datas.maxSize = [Infinity, Infinity];\r\n        if (!isGroup) {\r\n            datas.minSize = [\r\n                state.minOffsetWidth,\r\n                state.minOffsetHeight,\r\n            ];\r\n            datas.maxSize = [\r\n                state.maxOffsetWidth,\r\n                state.maxOffsetHeight,\r\n            ];\r\n        }\r\n        var transformOrigin = moveable.props.transformOrigin || \"% %\";\r\n        datas.transformOrigin = transformOrigin && isString(transformOrigin)\r\n            ? transformOrigin.split(\" \")\r\n            : transformOrigin;\r\n        datas.startOffsetMatrix = state.offsetMatrix;\r\n        datas.startTransformOrigin = state.transformOrigin;\r\n        datas.isWidth = (_a = e === null || e === void 0 ? void 0 : e.parentIsWidth) !== null && _a !== void 0 ? _a : ((!direction[0] && !direction[1]) || direction[0] || !direction[1]);\r\n        function setRatio(ratio) {\r\n            datas.ratio = ratio && isFinite(ratio) ? ratio : 0;\r\n        }\r\n        datas.startPositions = getAbsolutePosesByState(moveable.state);\r\n        function setFixedDirection(fixedDirection) {\r\n            var result = getFixedDirectionInfo(datas.startPositions, fixedDirection);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            datas.fixedOffset = result.fixedOffset;\r\n        }\r\n        function setFixedPosition(fixedPosition) {\r\n            var result = getOffsetFixedPositionInfo(moveable.state, fixedPosition);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            datas.fixedOffset = result.fixedOffset;\r\n        }\r\n        function setMin(minSize) {\r\n            datas.minSize = [\r\n                convertUnitSize(\"\".concat(minSize[0]), 0) || 0,\r\n                convertUnitSize(\"\".concat(minSize[1]), 0) || 0,\r\n            ];\r\n        }\r\n        function setMax(maxSize) {\r\n            var nextMaxSize = [\r\n                maxSize[0] || Infinity,\r\n                maxSize[1] || Infinity,\r\n            ];\r\n            if (!isNumber(nextMaxSize[0]) || isFinite(nextMaxSize[0])) {\r\n                nextMaxSize[0] = convertUnitSize(\"\".concat(nextMaxSize[0]), 0) || Infinity;\r\n            }\r\n            if (!isNumber(nextMaxSize[1]) || isFinite(nextMaxSize[1])) {\r\n                nextMaxSize[1] = convertUnitSize(\"\".concat(nextMaxSize[1]), 0) || Infinity;\r\n            }\r\n            datas.maxSize = nextMaxSize;\r\n        }\r\n        setRatio(width / height);\r\n        setFixedDirection(parentFixedDirection || [-direction[0], -direction[1]]);\r\n        datas.setFixedDirection = setFixedDirection;\r\n        datas.setFixedPosition = setFixedPosition;\r\n        datas.setMin = setMin;\r\n        datas.setMax = setMax;\r\n        var params = fillParams(moveable, e, {\r\n            direction: direction,\r\n            startRatio: datas.ratio,\r\n            set: function (_a) {\r\n                var _b = __read(_a, 2), startWidth = _b[0], startHeight = _b[1];\r\n                datas.startWidth = startWidth;\r\n                datas.startHeight = startHeight;\r\n            },\r\n            setMin: setMin,\r\n            setMax: setMax,\r\n            setRatio: setRatio,\r\n            setFixedDirection: setFixedDirection,\r\n            setFixedPosition: setFixedPosition,\r\n            setOrigin: function (origin) {\r\n                datas.transformOrigin = origin;\r\n            },\r\n            dragStart: Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e)),\r\n        });\r\n        var result = parentEvent || triggerEvent(moveable, \"onResizeStart\", params);\r\n        datas.startFixedDirection = datas.fixedDirection;\r\n        datas.startFixedPosition = datas.fixedPosition;\r\n        if (result !== false) {\r\n            datas.isResize = true;\r\n            moveable.state.snapRenderInfo = {\r\n                request: e.isRequest,\r\n                direction: direction,\r\n            };\r\n        }\r\n        return datas.isResize ? params : false;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var _a;\r\n        var datas = e.datas, parentFlag = e.parentFlag, isPinch = e.isPinch, parentKeepRatio = e.parentKeepRatio, dragClient = e.dragClient, parentDist = e.parentDist, useSnap = e.useSnap, isRequest = e.isRequest, isGroup = e.isGroup, parentEvent = e.parentEvent, resolveMatrix = e.resolveMatrix;\r\n        var isResize = datas.isResize, transformOrigin = datas.transformOrigin, startWidth = datas.startWidth, startHeight = datas.startHeight, prevWidth = datas.prevWidth, prevHeight = datas.prevHeight, minSize = datas.minSize, maxSize = datas.maxSize, ratio = datas.ratio, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, isWidth = datas.isWidth;\r\n        if (!isResize) {\r\n            return;\r\n        }\r\n        if (resolveMatrix) {\r\n            var is3d = moveable.state.is3d;\r\n            var startOffsetMatrix = datas.startOffsetMatrix, startTransformOrigin = datas.startTransformOrigin;\r\n            var n = is3d ? 4 : 3;\r\n            var targetMatrix = parseMat(getNextTransforms(e));\r\n            var targetN = Math.sqrt(targetMatrix.length);\r\n            if (n !== targetN) {\r\n                targetMatrix = convertDimension(targetMatrix, targetN, n);\r\n            }\r\n            var nextAllMatrix = getNextMatrix(startOffsetMatrix, targetMatrix, startTransformOrigin, n);\r\n            var poses = calculatePoses(nextAllMatrix, startOffsetWidth, startOffsetHeight, n);\r\n            datas.startPositions = poses;\r\n            datas.nextTargetMatrix = targetMatrix;\r\n            datas.nextAllMatrix = nextAllMatrix;\r\n        }\r\n        var props = getProps(moveable.props, \"resizable\");\r\n        var resizeFormat = props.resizeFormat, _b = props.throttleResize, throttleResize = _b === void 0 ? parentFlag ? 0 : 1 : _b, parentMoveable = props.parentMoveable, keepRatioFinally = props.keepRatioFinally;\r\n        var direction = datas.direction;\r\n        var sizeDirection = direction;\r\n        var distWidth = 0;\r\n        var distHeight = 0;\r\n        if (!direction[0] && !direction[1]) {\r\n            sizeDirection = [1, 1];\r\n        }\r\n        var keepRatio = (ratio && (parentKeepRatio != null ? parentKeepRatio : props.keepRatio)) || false;\r\n        function getNextBoundingSize() {\r\n            var fixedDirection = datas.fixedDirection;\r\n            var nextSize = getOffsetSizeDist(sizeDirection, keepRatio, datas, e);\r\n            distWidth = nextSize.distWidth;\r\n            distHeight = nextSize.distHeight;\r\n            var nextWidth = (sizeDirection[0] - fixedDirection[0]) || keepRatio\r\n                ? Math.max(startOffsetWidth + distWidth, TINY_NUM) : startOffsetWidth;\r\n            var nextHeight = (sizeDirection[1] - fixedDirection[1]) || keepRatio\r\n                ? Math.max(startOffsetHeight + distHeight, TINY_NUM) : startOffsetHeight;\r\n            if (keepRatio && startOffsetWidth && startOffsetHeight) {\r\n                // startOffsetWidth : startOffsetHeight = nextWidth : nextHeight\r\n                if (isWidth) {\r\n                    nextHeight = nextWidth / ratio;\r\n                }\r\n                else {\r\n                    nextWidth = nextHeight * ratio;\r\n                }\r\n            }\r\n            return [nextWidth, nextHeight];\r\n        }\r\n        var _c = __read(getNextBoundingSize(), 2), boundingWidth = _c[0], boundingHeight = _c[1];\r\n        if (!parentEvent) {\r\n            datas.setFixedDirection(datas.fixedDirection);\r\n            triggerEvent(moveable, \"onBeforeResize\", fillParams(moveable, e, {\r\n                startFixedDirection: datas.startFixedDirection,\r\n                startFixedPosition: datas.startFixedPosition,\r\n                setFixedDirection: function (nextFixedDirection) {\r\n                    var _a;\r\n                    datas.setFixedDirection(nextFixedDirection);\r\n                    _a = __read(getNextBoundingSize(), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n                    return [boundingWidth, boundingHeight];\r\n                },\r\n                setFixedPosition: function (nextFixedPosition) {\r\n                    var _a;\r\n                    datas.setFixedPosition(nextFixedPosition);\r\n                    _a = __read(getNextBoundingSize(), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n                    return [boundingWidth, boundingHeight];\r\n                },\r\n                boundingWidth: boundingWidth,\r\n                boundingHeight: boundingHeight,\r\n                setSize: function (size) {\r\n                    var _a;\r\n                    _a = __read(size, 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n                },\r\n            }, true));\r\n        }\r\n        var fixedPosition = dragClient;\r\n        if (!dragClient) {\r\n            if (!parentFlag && isPinch) {\r\n                fixedPosition = getAbsolutePosition(moveable, [0, 0]);\r\n            }\r\n            else {\r\n                fixedPosition = datas.fixedPosition;\r\n            }\r\n        }\r\n        var snapDist = [0, 0];\r\n        if (!isPinch) {\r\n            snapDist = checkSnapResize(moveable, boundingWidth, boundingHeight, direction, fixedPosition, !useSnap && isRequest, datas);\r\n        }\r\n        if (parentDist) {\r\n            !parentDist[0] && (snapDist[0] = 0);\r\n            !parentDist[1] && (snapDist[1] = 0);\r\n        }\r\n        function computeSize() {\r\n            var _a;\r\n            if (resizeFormat) {\r\n                _a = __read(resizeFormat([boundingWidth, boundingHeight]), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n            }\r\n            boundingWidth = throttle(boundingWidth, throttleResize);\r\n            boundingHeight = throttle(boundingHeight, throttleResize);\r\n        }\r\n        if (keepRatio) {\r\n            if (sizeDirection[0] && sizeDirection[1] && snapDist[0] && snapDist[1]) {\r\n                if (abs(snapDist[0]) > abs(snapDist[1])) {\r\n                    snapDist[1] = 0;\r\n                }\r\n                else {\r\n                    snapDist[0] = 0;\r\n                }\r\n            }\r\n            var isNoSnap = !snapDist[0] && !snapDist[1];\r\n            if (isNoSnap) {\r\n                // pre-compute before maintaining the ratio\r\n                computeSize();\r\n            }\r\n            if ((sizeDirection[0] && !sizeDirection[1])\r\n                || (snapDist[0] && !snapDist[1])\r\n                || (isNoSnap && isWidth)) {\r\n                boundingWidth += snapDist[0];\r\n                boundingHeight = boundingWidth / ratio;\r\n            }\r\n            else if ((!sizeDirection[0] && sizeDirection[1])\r\n                || (!snapDist[0] && snapDist[1])\r\n                || (isNoSnap && !isWidth)) {\r\n                boundingHeight += snapDist[1];\r\n                boundingWidth = boundingHeight * ratio;\r\n            }\r\n        }\r\n        else {\r\n            boundingWidth += snapDist[0];\r\n            boundingHeight += snapDist[1];\r\n            boundingWidth = Math.max(0, boundingWidth);\r\n            boundingHeight = Math.max(0, boundingHeight);\r\n        }\r\n        _a = __read(calculateBoundSize([boundingWidth, boundingHeight], minSize, maxSize, keepRatio ? ratio : false), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n        computeSize();\r\n        if (keepRatio && (isGroup || keepRatioFinally)) {\r\n            if (isWidth) {\r\n                boundingHeight = boundingWidth / ratio;\r\n            }\r\n            else {\r\n                boundingWidth = boundingHeight * ratio;\r\n            }\r\n        }\r\n        distWidth = boundingWidth - startOffsetWidth;\r\n        distHeight = boundingHeight - startOffsetHeight;\r\n        var delta = [distWidth - prevWidth, distHeight - prevHeight];\r\n        datas.prevWidth = distWidth;\r\n        datas.prevHeight = distHeight;\r\n        var inverseDelta = getResizeDist(moveable, boundingWidth, boundingHeight, fixedPosition, transformOrigin, datas);\r\n        if (!parentMoveable && delta.every(function (num) { return !num; }) && inverseDelta.every(function (num) { return !num; })) {\r\n            return;\r\n        }\r\n        var drag = Draggable.drag(moveable, setCustomDrag(e, moveable.state, inverseDelta, !!isPinch, false, \"draggable\"));\r\n        var transform = drag.transform;\r\n        var nextWidth = startWidth + distWidth;\r\n        var nextHeight = startHeight + distHeight;\r\n        var params = fillParams(moveable, e, __assign({ width: nextWidth, height: nextHeight, offsetWidth: Math.round(boundingWidth), offsetHeight: Math.round(boundingHeight), startRatio: ratio, boundingWidth: boundingWidth, boundingHeight: boundingHeight, direction: direction, dist: [distWidth, distHeight], delta: delta, isPinch: !!isPinch, drag: drag }, fillAfterTransform({\r\n            style: {\r\n                width: \"\".concat(nextWidth, \"px\"),\r\n                height: \"\".concat(nextHeight, \"px\"),\r\n            },\r\n            transform: transform,\r\n        }, drag, e)));\r\n        !parentEvent && triggerEvent(moveable, \"onResize\", params);\r\n        return params;\r\n    },\r\n    dragControlAfter: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var isResize = datas.isResize, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, prevWidth = datas.prevWidth, prevHeight = datas.prevHeight;\r\n        if (!isResize || moveable.props.checkResizableError === false) {\r\n            return;\r\n        }\r\n        var _a = moveable.state, width = _a.width, height = _a.height;\r\n        var errorWidth = width - (startOffsetWidth + prevWidth);\r\n        var errorHeight = height - (startOffsetHeight + prevHeight);\r\n        var isErrorWidth = abs(errorWidth) > 3;\r\n        var isErrorHeight = abs(errorHeight) > 3;\r\n        if (isErrorWidth) {\r\n            datas.startWidth += errorWidth;\r\n            datas.startOffsetWidth += errorWidth;\r\n            datas.prevWidth += errorWidth;\r\n        }\r\n        if (isErrorHeight) {\r\n            datas.startHeight += errorHeight;\r\n            datas.startOffsetHeight += errorHeight;\r\n            datas.prevHeight += errorHeight;\r\n        }\r\n        if (isErrorWidth || isErrorHeight) {\r\n            return this.dragControl(moveable, e);\r\n        }\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas, parentEvent = e.parentEvent;\r\n        if (!datas.isResize) {\r\n            return;\r\n        }\r\n        datas.isResize = false;\r\n        var params = fillEndParams(moveable, e, {});\r\n        !parentEvent && triggerEvent(moveable, \"onResizeEnd\", params);\r\n        return params;\r\n    },\r\n    dragGroupControlCondition: directionCondition$2,\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var params = this.dragControlStart(moveable, __assign(__assign({}, e), { isGroup: true }));\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        var originalEvents = fillChildEvents(moveable, \"resizable\", e);\r\n        var parentStartOffsetWidth = datas.startOffsetWidth, parentStartOffsetHeight = datas.startOffsetHeight;\r\n        function updateGroupMin() {\r\n            var originalMinSize = datas.minSize;\r\n            originalEvents.forEach(function (ev) {\r\n                var _a = ev.datas, childMinSize = _a.minSize, childStartOffsetWidth = _a.startOffsetWidth, childStartOffsetHeight = _a.startOffsetHeight;\r\n                var parentMinWidth = parentStartOffsetWidth\r\n                    * (childStartOffsetWidth ? childMinSize[0] / childStartOffsetWidth : 0);\r\n                var parentMinHeight = parentStartOffsetHeight\r\n                    * (childStartOffsetHeight ? childMinSize[1] / childStartOffsetHeight : 0);\r\n                originalMinSize[0] = Math.max(originalMinSize[0], parentMinWidth);\r\n                originalMinSize[1] = Math.max(originalMinSize[1], parentMinHeight);\r\n            });\r\n        }\r\n        function updateGroupMax() {\r\n            var originalMaxSize = datas.maxSize;\r\n            originalEvents.forEach(function (ev) {\r\n                var _a = ev.datas, childMaxSize = _a.maxSize, childStartOffsetWidth = _a.startOffsetWidth, childStartOffsetHeight = _a.startOffsetHeight;\r\n                var parentMaxWidth = parentStartOffsetWidth\r\n                    * (childStartOffsetWidth ? childMaxSize[0] / childStartOffsetWidth : 0);\r\n                var parentMaxHeight = parentStartOffsetHeight\r\n                    * (childStartOffsetHeight ? childMaxSize[1] / childStartOffsetHeight : 0);\r\n                originalMaxSize[0] = Math.min(originalMaxSize[0], parentMaxWidth);\r\n                originalMaxSize[1] = Math.min(originalMaxSize[1], parentMaxHeight);\r\n            });\r\n        }\r\n        var events = triggerChildAbles(moveable, this, \"dragControlStart\", e, function (child, ev) {\r\n            return startChildDist(moveable, child, datas, ev);\r\n        });\r\n        updateGroupMin();\r\n        updateGroupMax();\r\n        var setFixedDirection = function (fixedDirection) {\r\n            params.setFixedDirection(fixedDirection);\r\n            events.forEach(function (ev, i) {\r\n                ev.setFixedDirection(fixedDirection);\r\n                startChildDist(moveable, ev.moveable, datas, originalEvents[i]);\r\n            });\r\n        };\r\n        datas.setFixedDirection = setFixedDirection;\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: events.map(function (ev) {\r\n                return __assign(__assign({}, ev), { setMin: function (minSize) {\r\n                        ev.setMin(minSize);\r\n                        updateGroupMin();\r\n                    }, setMax: function (maxSize) {\r\n                        ev.setMax(maxSize);\r\n                        updateGroupMax();\r\n                    } });\r\n            }), setFixedDirection: setFixedDirection, setMin: function (minSize) {\r\n                params.setMin(minSize);\r\n                updateGroupMin();\r\n            }, setMax: function (maxSize) {\r\n                params.setMax(maxSize);\r\n                updateGroupMax();\r\n            } });\r\n        var result = triggerEvent(moveable, \"onResizeGroupStart\", nextParams);\r\n        datas.isResize = result !== false;\r\n        return datas.isResize ? params : false;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isResize) {\r\n            return;\r\n        }\r\n        var props = getProps(moveable.props, \"resizable\");\r\n        catchEvent(moveable, \"onBeforeResize\", function (parentEvent) {\r\n            triggerEvent(moveable, \"onBeforeResizeGroup\", fillParams(moveable, e, __assign(__assign({}, parentEvent), { targets: props.targets }), true));\r\n        });\r\n        var params = this.dragControl(moveable, __assign(__assign({}, e), { isGroup: true }));\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var boundingWidth = params.boundingWidth, boundingHeight = params.boundingHeight, dist = params.dist;\r\n        var keepRatio = props.keepRatio;\r\n        var parentScale = [\r\n            boundingWidth / (boundingWidth - dist[0]),\r\n            boundingHeight / (boundingHeight - dist[1]),\r\n        ];\r\n        var fixedPosition = datas.fixedPosition;\r\n        var events = triggerChildAbles(moveable, this, \"dragControl\", e, function (_, ev) {\r\n            var _a = __read(calculate(createRotateMatrix(moveable.rotation / 180 * Math.PI, 3), [\r\n                ev.datas.originalX * parentScale[0],\r\n                ev.datas.originalY * parentScale[1],\r\n                1,\r\n            ], 3), 2), clientX = _a[0], clientY = _a[1];\r\n            return __assign(__assign({}, ev), { parentDist: null, parentScale: parentScale, dragClient: plus(fixedPosition, [clientX, clientY]), parentKeepRatio: keepRatio });\r\n        });\r\n        var nextParams = __assign({ targets: props.targets, events: events }, params);\r\n        triggerEvent(moveable, \"onResizeGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isResize) {\r\n            return;\r\n        }\r\n        this.dragControlEnd(moveable, e);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlEnd\", e);\r\n        var nextParams = fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: events,\r\n        });\r\n        triggerEvent(moveable, \"onResizeGroupEnd\", nextParams);\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Resizable#request\r\n     * @param {Moveable.Resizable.ResizableRequestParam} e - the Resizable's request parameter\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * // Use Relative Value\r\n     * moveable.request(\"resizable\", { deltaWidth: 10, deltaHeight: 10 }, true);\r\n     *\r\n     * // Use Absolute Value\r\n     * moveable.request(\"resizable\", { offsetWidth: 100, offsetHeight: 100 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"resizable\");\r\n     *\r\n     * // request\r\n     * // Use Relative Value\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     *\r\n     * // Use Absolute Value\r\n     * moveable.request(\"resizable\", { offsetWidth: 100, offsetHeight: 100 });\r\n     * moveable.request(\"resizable\", { offsetWidth: 110, offsetHeight: 100 });\r\n     * moveable.request(\"resizable\", { offsetWidth: 120, offsetHeight: 100 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var distWidth = 0;\r\n        var distHeight = 0;\r\n        var useSnap = false;\r\n        var rect = moveable.getRect();\r\n        return {\r\n            isControl: true,\r\n            requestStart: function (e) {\r\n                var _a;\r\n                useSnap = e.useSnap;\r\n                return {\r\n                    datas: datas,\r\n                    parentDirection: e.direction || [1, 1],\r\n                    parentIsWidth: (_a = e === null || e === void 0 ? void 0 : e.horizontal) !== null && _a !== void 0 ? _a : true,\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            request: function (e) {\r\n                if (\"offsetWidth\" in e) {\r\n                    distWidth = e.offsetWidth - rect.offsetWidth;\r\n                }\r\n                else if (\"deltaWidth\" in e) {\r\n                    distWidth += e.deltaWidth;\r\n                }\r\n                if (\"offsetHeight\" in e) {\r\n                    distHeight = e.offsetHeight - rect.offsetHeight;\r\n                }\r\n                else if (\"deltaHeight\" in e) {\r\n                    distHeight += e.deltaHeight;\r\n                }\r\n                return {\r\n                    datas: datas,\r\n                    parentDist: [distWidth, distHeight],\r\n                    parentKeepRatio: e.keepRatio,\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true, useSnap: useSnap };\r\n            },\r\n        };\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.gestos.resizable = null;\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be resized.\r\n * @name Moveable.Resizable#resizable\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     resizable: false,\r\n * });\r\n *\r\n * moveable.resizable = true;\r\n */\r\n/**\r\n * throttle of width, height when resize. If throttleResize is set to less than 1, the target may shake.\r\n * @name Moveable.Resizable#throttleResize\r\n * @default 1\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n *   throttleResize: 1,\r\n * });\r\n *\r\n * moveable.throttleResize = 0;\r\n */\r\n/**\r\n * When resize or scale, keeps a ratio of the width, height.\r\n * @name Moveable.Resizable#keepRatio\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n * });\r\n *\r\n * moveable.keepRatio = true;\r\n */\r\n/**\r\n * Set directions to show the control box.\r\n * @name Moveable.Resizable#renderDirections\r\n * @default [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"]\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n *   renderDirections: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"],\r\n * });\r\n *\r\n * moveable.renderDirections = [\"nw\", \"ne\", \"sw\", \"se\"];\r\n */\r\n/**\r\n * Function to convert size for resize\r\n * @name Moveable.Resizable#resizeFormat\r\n * @default oneself\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n *   resizeFormat: v => v,\r\n * });\r\n *\r\n * moveable.resizeFormat = (size: number[]) => ([Math.trunc(size[0]), Math.trunc(size[1])];\r\n */\r\n/**\r\n * When the resize starts, the resizeStart event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resizeStart\r\n * @param {Moveable.Resizable.OnResizeStart} - Parameters for the resizeStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"resizeStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When resizing, `beforeResize` is called before `resize` occurs. In `beforeResize`, you can get and set the pre-value before resizing.\r\n * @memberof Moveable.Resizable\r\n * @event beforeResize\r\n * @param {Moveable.Resizable.OnBeforeResize} - Parameters for the `beforeResize` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"beforeResize\", ({ setFixedDirection }) => {\r\n *     if (shiftKey) {\r\n *        setFixedDirection([0, 0]);\r\n *     }\r\n * });\r\n * moveable.on(\"resize\", ({ target, width, height, drag }) => {\r\n *     target.style.width = `${width}px`;\r\n *     target.style.height = `${height}px`;\r\n *     target.style.transform = drag.transform;\r\n * });\r\n */\r\n/**\r\n * When resizing, the resize event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resize\r\n * @param {Moveable.Resizable.OnResize} - Parameters for the resize event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"resize\", ({ target, width, height }) => {\r\n *     target.style.width = `${e.width}px`;\r\n *     target.style.height = `${e.height}px`;\r\n * });\r\n */\r\n/**\r\n * When the resize finishes, the resizeEnd event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resizeEnd\r\n * @param {Moveable.Resizable.OnResizeEnd} - Parameters for the resizeEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"resizeEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n* When the group resize starts, the `resizeGroupStart` event is called.\r\n* @memberof Moveable.Resizable\r\n* @event resizeGroupStart\r\n* @param {Moveable.Resizable.OnResizeGroupStart} - Parameters for the `resizeGroupStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     resizable: true\r\n* });\r\n* moveable.on(\"resizeGroupStart\", ({ targets }) => {\r\n*     console.log(\"onResizeGroupStart\", targets);\r\n* });\r\n*/\r\n/**\r\n* When the group resize, the `resizeGroup` event is called.\r\n* @memberof Moveable.Resizable\r\n* @event resizeGroup\r\n* @param {Moveable.Resizable.onResizeGroup} - Parameters for the `resizeGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     resizable: true\r\n* });\r\n* moveable.on(\"resizeGroup\", ({ targets, events }) => {\r\n*     console.log(\"onResizeGroup\", targets);\r\n*     events.forEach(ev => {\r\n*         const offset = [\r\n*             direction[0] < 0 ? -ev.delta[0] : 0,\r\n*             direction[1] < 0 ? -ev.delta[1] : 0,\r\n*         ];\r\n*         // ev.drag is a drag event that occurs when the group resize.\r\n*         const left = offset[0] + ev.drag.beforeDist[0];\r\n*         const top = offset[1] + ev.drag.beforeDist[1];\r\n*         const width = ev.width;\r\n*         const top = ev.top;\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group resize finishes, the `resizeGroupEnd` event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resizeGroupEnd\r\n * @param {Moveable.Resizable.OnResizeGroupEnd} - Parameters for the `resizeGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     resizable: true\r\n * });\r\n * moveable.on(\"resizeGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onResizeGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\n/**\r\n * @namespace Rotatable\r\n * @memberof Moveable\r\n * @description Rotatable indicates whether the target can be rotated.\r\n */\r\nfunction setRotateStartInfo(moveable, datas, clientX, clientY, rect) {\r\n    var groupable = moveable.props.groupable;\r\n    var state = moveable.state;\r\n    var n = state.is3d ? 4 : 3;\r\n    var origin = datas.origin;\r\n    var nextOrigin = calculatePosition(moveable.state.rootMatrix, \r\n    // TO-DO #710\r\n    minus([origin[0], origin[1]], groupable ? [0, 0] : [state.left, state.top]), n);\r\n    var startAbsoluteOrigin = plus([rect.left, rect.top], nextOrigin);\r\n    datas.startAbsoluteOrigin = startAbsoluteOrigin;\r\n    datas.prevDeg = getRad(startAbsoluteOrigin, [clientX, clientY]) / Math.PI * 180;\r\n    datas.defaultDeg = datas.prevDeg;\r\n    datas.prevSnapDeg = 0;\r\n    datas.loop = 0;\r\n    datas.startDist = getDist$1(startAbsoluteOrigin, [clientX, clientY]);\r\n}\r\nfunction getAbsoluteDist(deg, direction, datas) {\r\n    var defaultDeg = datas.defaultDeg, prevDeg = datas.prevDeg;\r\n    var normalizedPrevDeg = prevDeg % 360;\r\n    var loop = Math.floor(prevDeg / 360);\r\n    if (normalizedPrevDeg < 0) {\r\n        normalizedPrevDeg += 360;\r\n    }\r\n    if (normalizedPrevDeg > deg && normalizedPrevDeg > 270 && deg < 90) {\r\n        // 360 => 0\r\n        ++loop;\r\n    }\r\n    else if (normalizedPrevDeg < deg && normalizedPrevDeg < 90 && deg > 270) {\r\n        // 0 => 360\r\n        --loop;\r\n    }\r\n    var dist = direction * (loop * 360 + deg - defaultDeg);\r\n    datas.prevDeg = defaultDeg + dist;\r\n    return dist;\r\n}\r\nfunction getAbsoluteDistByClient(clientX, clientY, direction, datas) {\r\n    return getAbsoluteDist(getRad(datas.startAbsoluteOrigin, [clientX, clientY]) / Math.PI * 180, direction, datas);\r\n}\r\nfunction getRotateInfo(moveable, moveableRect, datas, dist, startValue, checkSnap) {\r\n    var _a = moveable.props.throttleRotate, throttleRotate = _a === void 0 ? 0 : _a;\r\n    var prevSnapDeg = datas.prevSnapDeg;\r\n    var snapRotation = 0;\r\n    var isSnap = false;\r\n    if (checkSnap) {\r\n        var result = checkSnapRotate(moveable, moveableRect, dist, startValue + dist);\r\n        isSnap = result.isSnap;\r\n        snapRotation = startValue + result.dist;\r\n    }\r\n    if (!isSnap) {\r\n        snapRotation = throttle(startValue + dist, throttleRotate);\r\n    }\r\n    var snapDeg = snapRotation - startValue;\r\n    datas.prevSnapDeg = snapDeg;\r\n    return [snapDeg - prevSnapDeg, snapDeg, snapRotation];\r\n}\r\nfunction getRotationPositions(rotationPosition, _a, direction) {\r\n    var _b = __read(_a, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n    if (rotationPosition === \"none\") {\r\n        return [];\r\n    }\r\n    if (isArray(rotationPosition)) {\r\n        return rotationPosition.map(function (child) { return getRotationPositions(child, [pos1, pos2, pos3, pos4], direction)[0]; });\r\n    }\r\n    var _c = __read((rotationPosition || \"top\").split(\"-\"), 2), dir1 = _c[0], dir2 = _c[1];\r\n    var radPoses = [pos1, pos2];\r\n    if (dir1 === \"left\") {\r\n        radPoses = [pos3, pos1];\r\n    }\r\n    else if (dir1 === \"right\") {\r\n        radPoses = [pos2, pos4];\r\n    }\r\n    else if (dir1 === \"bottom\") {\r\n        radPoses = [pos4, pos3];\r\n    }\r\n    var pos = [\r\n        (radPoses[0][0] + radPoses[1][0]) / 2,\r\n        (radPoses[0][1] + radPoses[1][1]) / 2,\r\n    ];\r\n    var rad = getRotationRad(radPoses, direction);\r\n    if (dir2) {\r\n        var isStart = dir2 === \"top\" || dir2 === \"left\";\r\n        var isReverse = dir1 === \"bottom\" || dir1 === \"left\";\r\n        pos = radPoses[(isStart && !isReverse) || (!isStart && isReverse) ? 0 : 1];\r\n    }\r\n    return [[pos, rad]];\r\n}\r\nfunction dragControlCondition(moveable, e) {\r\n    if (e.isRequest) {\r\n        return e.requestAble === \"rotatable\";\r\n    }\r\n    var target = e.inputEvent.target;\r\n    if (hasClass(target, prefix(\"rotation-control\"))\r\n        || (moveable.props.rotateAroundControls && hasClass(target, prefix(\"around-control\")))\r\n        || (hasClass(target, prefix(\"control\")) && hasClass(target, prefix(\"rotatable\")))) {\r\n        return true;\r\n    }\r\n    var rotationTarget = moveable.props.rotationTarget;\r\n    if (rotationTarget) {\r\n        return getRefTargets(rotationTarget, true).some(function (element) {\r\n            if (!element) {\r\n                return false;\r\n            }\r\n            return target === element || target.contains(element);\r\n        });\r\n    }\r\n    return false;\r\n}\r\nvar css = \".rotation {\\nposition: absolute;\\nheight: 40px;\\nwidth: 1px;\\ntransform-origin: 50% 100%;\\nheight: calc(40px * var(--zoom));\\ntop: auto;\\nleft: 0;\\nbottom: 100%;\\nwill-change: transform;\\n}\\n.rotation .rotation-line {\\ndisplay: block;\\nwidth: 100%;\\nheight: 100%;\\ntransform-origin: 50% 50%;\\n}\\n.rotation .rotation-control {\\nborder-color: #4af;\\nborder-color: var(--moveable-color);\\nbackground:#fff;\\ncursor: alias;\\n}\\n:global .view-rotation-dragging, .rotatable.direction.control {\\ncursor: alias;\\n}\\n.rotatable.direction.control.move {\\ncursor: move;\\n}\\n\";\r\nvar Rotatable = {\r\n    name: \"rotatable\",\r\n    canPinch: true,\r\n    props: [\r\n        \"rotatable\",\r\n        \"rotationPosition\",\r\n        \"throttleRotate\",\r\n        \"renderDirections\",\r\n        \"rotationTarget\",\r\n        \"rotateAroundControls\",\r\n        \"edge\",\r\n        \"resolveAblesWithRotatable\",\r\n        \"displayAroundControls\",\r\n    ],\r\n    events: [\r\n        \"rotateStart\",\r\n        \"beforeRotate\",\r\n        \"rotate\",\r\n        \"rotateEnd\",\r\n        \"rotateGroupStart\",\r\n        \"beforeRotateGroup\",\r\n        \"rotateGroup\",\r\n        \"rotateGroupEnd\",\r\n    ],\r\n    css: [css],\r\n    viewClassName: function (moveable) {\r\n        if (!moveable.isDragging(\"rotatable\")) {\r\n            return \"\";\r\n        }\r\n        return prefix(\"view-rotation-dragging\");\r\n    },\r\n    render: function (moveable, React) {\r\n        var _a = getProps(moveable.props, \"rotatable\"), rotatable = _a.rotatable, rotationPosition = _a.rotationPosition, zoom = _a.zoom, renderDirections = _a.renderDirections, rotateAroundControls = _a.rotateAroundControls, resolveAblesWithRotatable = _a.resolveAblesWithRotatable;\r\n        var _b = moveable.getState(), renderPoses = _b.renderPoses, direction = _b.direction;\r\n        if (!rotatable) {\r\n            return null;\r\n        }\r\n        var positions = getRotationPositions(rotationPosition, renderPoses, direction);\r\n        var jsxs = [];\r\n        positions.forEach(function (_a, i) {\r\n            var _b = __read(_a, 2), pos = _b[0], rad = _b[1];\r\n            jsxs.push(React.createElement(\"div\", { key: \"rotation\".concat(i), className: prefix(\"rotation\"), style: {\r\n                    // tslint:disable-next-line: max-line-length\r\n                    transform: \"translate(-50%) translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) rotate(\").concat(rad, \"rad)\"),\r\n                } },\r\n                React.createElement(\"div\", { className: prefix(\"line rotation-line\"), style: {\r\n                        transform: \"scaleX(\".concat(zoom, \")\"),\r\n                    } }),\r\n                React.createElement(\"div\", { className: prefix(\"control rotation-control\"), style: {\r\n                        transform: \"translate(0.5px) scale(\".concat(zoom, \")\"),\r\n                    } })));\r\n        });\r\n        if (renderDirections) {\r\n            var ables = getKeys(resolveAblesWithRotatable || {});\r\n            var resolveMap_1 = {};\r\n            ables.forEach(function (name) {\r\n                resolveAblesWithRotatable[name].forEach(function (direction) {\r\n                    resolveMap_1[direction] = name;\r\n                });\r\n            });\r\n            var directionControlInfos = [];\r\n            if (isArray(renderDirections)) {\r\n                directionControlInfos = renderDirections.map(function (dir) {\r\n                    var able = resolveMap_1[dir];\r\n                    return {\r\n                        data: able ? { resolve: able } : {},\r\n                        classNames: able ? [\"move\"] : [],\r\n                        dir: dir,\r\n                    };\r\n                });\r\n            }\r\n            jsxs.push.apply(jsxs, __spreadArray([], __read(renderDirectionControlsByInfos(moveable, \"rotatable\", directionControlInfos, React)), false));\r\n        }\r\n        if (rotateAroundControls) {\r\n            jsxs.push.apply(jsxs, __spreadArray([], __read(renderAroundControls(moveable, React)), false));\r\n        }\r\n        return jsxs;\r\n    },\r\n    dragControlCondition: dragControlCondition,\r\n    dragControlStart: function (moveable, e) {\r\n        var _a;\r\n        var _b;\r\n        var datas = e.datas, clientX = e.clientX, clientY = e.clientY, parentRotate = e.parentRotate, parentFlag = e.parentFlag, isPinch = e.isPinch, isRequest = e.isRequest;\r\n        var state = moveable.state;\r\n        var target = state.target, left = state.left, top = state.top, direction = state.direction, beforeDirection = state.beforeDirection, targetTransform = state.targetTransform, moveableClientRect = state.moveableClientRect, offsetMatrix = state.offsetMatrix, targetMatrix = state.targetMatrix, allMatrix = state.allMatrix, width = state.width, height = state.height;\r\n        if (!isRequest && !target) {\r\n            return false;\r\n        }\r\n        var rect = moveable.getRect();\r\n        datas.rect = rect;\r\n        datas.transform = targetTransform;\r\n        datas.left = left;\r\n        datas.top = top;\r\n        var setFixedPosition = function (fixedPosition) {\r\n            var result = getOffsetFixedPositionInfo(moveable.state, fixedPosition);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedOffset = result.fixedOffset;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            if (resizeStart) {\r\n                resizeStart.setFixedPosition(fixedPosition);\r\n            }\r\n        };\r\n        var setFixedDirection = function (fixedDirection) {\r\n            var result = getOffsetFixedDirectionInfo(moveable.state, fixedDirection);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedOffset = result.fixedOffset;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            if (resizeStart) {\r\n                resizeStart.setFixedDirection(fixedDirection);\r\n            }\r\n        };\r\n        var startClientX = clientX;\r\n        var startClientY = clientY;\r\n        if (isRequest || isPinch || parentFlag) {\r\n            var externalRotate = parentRotate || 0;\r\n            datas.beforeInfo = {\r\n                origin: rect.beforeOrigin,\r\n                prevDeg: externalRotate,\r\n                defaultDeg: externalRotate,\r\n                prevSnapDeg: 0,\r\n                startDist: 0,\r\n            };\r\n            datas.afterInfo = __assign(__assign({}, datas.beforeInfo), { origin: rect.origin });\r\n            datas.absoluteInfo = __assign(__assign({}, datas.beforeInfo), { origin: rect.origin, startValue: externalRotate });\r\n        }\r\n        else {\r\n            var inputTarget = (_b = e.inputEvent) === null || _b === void 0 ? void 0 : _b.target;\r\n            if (inputTarget) {\r\n                var regionDirection = inputTarget.getAttribute(\"data-direction\") || \"\";\r\n                var controlDirection = DIRECTION_REGION_TO_DIRECTION[regionDirection];\r\n                if (controlDirection) {\r\n                    datas.isControl = true;\r\n                    datas.isAroundControl = hasClass(inputTarget, prefix(\"around-control\"));\r\n                    datas.controlDirection = controlDirection;\r\n                    var resolve = inputTarget.getAttribute(\"data-resolve\");\r\n                    if (resolve) {\r\n                        datas.resolveAble = resolve;\r\n                    }\r\n                    var clientPoses = calculateMoveableClientPositions(state.rootMatrix, state.renderPoses, moveableClientRect);\r\n                    _a = __read(getPosByDirection(clientPoses, controlDirection), 2), startClientX = _a[0], startClientY = _a[1];\r\n                }\r\n            }\r\n            datas.beforeInfo = { origin: rect.beforeOrigin };\r\n            datas.afterInfo = { origin: rect.origin };\r\n            datas.absoluteInfo = {\r\n                origin: rect.origin,\r\n                startValue: rect.rotation,\r\n            };\r\n            var originalFixedPosition_1 = setFixedPosition;\r\n            setFixedPosition = function (fixedPosition) {\r\n                var n = state.is3d ? 4 : 3;\r\n                var _a = __read(plus(getOrigin(targetMatrix, n), fixedPosition), 2), originX = _a[0], originY = _a[1];\r\n                var fixedBeforeOrigin = calculate(offsetMatrix, convertPositionMatrix([originX, originY], n));\r\n                var fixedAfterOrigin = calculate(allMatrix, convertPositionMatrix([fixedPosition[0], fixedPosition[1]], n));\r\n                originalFixedPosition_1(fixedPosition);\r\n                var posDelta = state.posDelta;\r\n                datas.beforeInfo.origin = minus(fixedBeforeOrigin, posDelta);\r\n                datas.afterInfo.origin = minus(fixedAfterOrigin, posDelta);\r\n                datas.absoluteInfo.origin = minus(fixedAfterOrigin, posDelta);\r\n                setRotateStartInfo(moveable, datas.beforeInfo, startClientX, startClientY, moveableClientRect);\r\n                setRotateStartInfo(moveable, datas.afterInfo, startClientX, startClientY, moveableClientRect);\r\n                setRotateStartInfo(moveable, datas.absoluteInfo, startClientX, startClientY, moveableClientRect);\r\n            };\r\n            setFixedDirection = function (fixedDirection) {\r\n                var fixedPosition = getPosByDirection([\r\n                    [0, 0],\r\n                    [width, 0],\r\n                    [0, height],\r\n                    [width, height],\r\n                ], fixedDirection);\r\n                setFixedPosition(fixedPosition);\r\n            };\r\n        }\r\n        datas.startClientX = startClientX;\r\n        datas.startClientY = startClientY;\r\n        datas.direction = direction;\r\n        datas.beforeDirection = beforeDirection;\r\n        datas.startValue = 0;\r\n        datas.datas = {};\r\n        setDefaultTransformIndex(moveable, e, \"rotate\");\r\n        var dragStart = false;\r\n        var resizeStart = false;\r\n        if (datas.isControl && datas.resolveAble) {\r\n            var resolveAble = datas.resolveAble;\r\n            if (resolveAble === \"resizable\") {\r\n                resizeStart = Resizable.dragControlStart(moveable, __assign(__assign({}, (new CustomGesto(\"resizable\").dragStart([0, 0], e))), { parentPosition: datas.controlPosition, parentFixedPosition: datas.fixedPosition }));\r\n            }\r\n        }\r\n        if (!resizeStart) {\r\n            dragStart = Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e));\r\n        }\r\n        setFixedPosition(getTotalOrigin(moveable));\r\n        var params = fillParams(moveable, e, __assign(__assign({ set: function (rotatation) {\r\n                datas.startValue = rotatation * Math.PI / 180;\r\n            }, setFixedDirection: setFixedDirection, setFixedPosition: setFixedPosition }, fillTransformStartEvent(moveable, e)), { dragStart: dragStart, resizeStart: resizeStart }));\r\n        var result = triggerEvent(moveable, \"onRotateStart\", params);\r\n        datas.isRotate = result !== false;\r\n        state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n        };\r\n        return datas.isRotate ? params : false;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var _a, _b, _c;\r\n        var datas = e.datas, clientDistX = e.clientDistX, clientDistY = e.clientDistY, parentRotate = e.parentRotate, parentFlag = e.parentFlag, isPinch = e.isPinch, groupDelta = e.groupDelta, resolveMatrix = e.resolveMatrix;\r\n        var beforeDirection = datas.beforeDirection, beforeInfo = datas.beforeInfo, afterInfo = datas.afterInfo, absoluteInfo = datas.absoluteInfo, isRotate = datas.isRotate, startValue = datas.startValue, rect = datas.rect, startClientX = datas.startClientX, startClientY = datas.startClientY;\r\n        if (!isRotate) {\r\n            return;\r\n        }\r\n        resolveTransformEvent(moveable, e, \"rotate\");\r\n        var targetDirection = getTransformDirection(e);\r\n        var direction = beforeDirection * targetDirection;\r\n        var parentMoveable = moveable.props.parentMoveable;\r\n        var beforeDelta = 0;\r\n        var beforeDist;\r\n        var beforeRotation;\r\n        var delta = 0;\r\n        var dist;\r\n        var rotation;\r\n        var absoluteDelta = 0;\r\n        var absoluteDist;\r\n        var absoluteRotation;\r\n        var startRotation = 180 / Math.PI * startValue;\r\n        var absoluteStartRotation = absoluteInfo.startValue;\r\n        var isSnap = false;\r\n        var nextClientX = startClientX + clientDistX;\r\n        var nextClientY = startClientY + clientDistY;\r\n        if (!parentFlag && \"parentDist\" in e) {\r\n            var parentDist = e.parentDist;\r\n            beforeDist = parentDist;\r\n            dist = parentDist;\r\n            absoluteDist = parentDist;\r\n        }\r\n        else if (isPinch || parentFlag) {\r\n            beforeDist = getAbsoluteDist(parentRotate, beforeDirection, beforeInfo);\r\n            dist = getAbsoluteDist(parentRotate, direction, afterInfo);\r\n            absoluteDist = getAbsoluteDist(parentRotate, direction, absoluteInfo);\r\n        }\r\n        else {\r\n            beforeDist = getAbsoluteDistByClient(nextClientX, nextClientY, beforeDirection, beforeInfo);\r\n            dist = getAbsoluteDistByClient(nextClientX, nextClientY, direction, afterInfo);\r\n            absoluteDist = getAbsoluteDistByClient(nextClientX, nextClientY, direction, absoluteInfo);\r\n            isSnap = true;\r\n        }\r\n        beforeRotation = startRotation + beforeDist;\r\n        rotation = startRotation + dist;\r\n        absoluteRotation = absoluteStartRotation + absoluteDist;\r\n        triggerEvent(moveable, \"onBeforeRotate\", fillParams(moveable, e, {\r\n            beforeRotation: beforeRotation,\r\n            rotation: rotation,\r\n            absoluteRotation: absoluteRotation,\r\n            setRotation: function (nextRotation) {\r\n                dist = nextRotation - startRotation;\r\n                beforeDist = dist;\r\n                absoluteDist = dist;\r\n            },\r\n        }, true));\r\n        _a = __read(getRotateInfo(moveable, rect, beforeInfo, beforeDist, startRotation, isSnap), 3), beforeDelta = _a[0], beforeDist = _a[1], beforeRotation = _a[2];\r\n        _b = __read(getRotateInfo(moveable, rect, afterInfo, dist, startRotation, isSnap), 3), delta = _b[0], dist = _b[1], rotation = _b[2];\r\n        _c = __read(getRotateInfo(moveable, rect, absoluteInfo, absoluteDist, absoluteStartRotation, isSnap), 3), absoluteDelta = _c[0], absoluteDist = _c[1], absoluteRotation = _c[2];\r\n        if (!absoluteDelta && !delta && !beforeDelta && !parentMoveable && !resolveMatrix) {\r\n            return;\r\n        }\r\n        var nextTransform = convertTransformFormat(datas, \"rotate(\".concat(rotation, \"deg)\"), \"rotate(\".concat(dist, \"deg)\"));\r\n        if (resolveMatrix) {\r\n            datas.fixedPosition = getTranslateFixedPosition(moveable, datas.targetAllTransform, datas.fixedDirection, datas.fixedOffset, datas);\r\n        }\r\n        var inverseDist = getRotateDist(moveable, dist, datas);\r\n        var inverseDelta = minus(plus(groupDelta || [0, 0], inverseDist), datas.prevInverseDist || [0, 0]);\r\n        datas.prevInverseDist = inverseDist;\r\n        datas.requestValue = null;\r\n        var dragEvent = fillTransformEvent(moveable, nextTransform, inverseDelta, isPinch, e);\r\n        var transformEvent = dragEvent;\r\n        var parentDistance = getDist$1([nextClientX, nextClientY], absoluteInfo.startAbsoluteOrigin) - absoluteInfo.startDist;\r\n        var resize = undefined;\r\n        if (datas.resolveAble === \"resizable\") {\r\n            var resizeEvent = Resizable.dragControl(moveable, __assign(__assign({}, setCustomDrag(e, moveable.state, [e.deltaX, e.deltaY], !!isPinch, false, \"resizable\")), { resolveMatrix: true, parentDistance: parentDistance }));\r\n            if (resizeEvent) {\r\n                resize = resizeEvent;\r\n                transformEvent = fillAfterTransform(transformEvent, resizeEvent, e);\r\n            }\r\n        }\r\n        var params = fillParams(moveable, e, __assign(__assign({ delta: delta, dist: dist, rotate: rotation, rotation: rotation, beforeDist: beforeDist, beforeDelta: beforeDelta, beforeRotate: beforeRotation, beforeRotation: beforeRotation, absoluteDist: absoluteDist, absoluteDelta: absoluteDelta, absoluteRotate: absoluteRotation, absoluteRotation: absoluteRotation, isPinch: !!isPinch, resize: resize }, dragEvent), transformEvent));\r\n        triggerEvent(moveable, \"onRotate\", params);\r\n        return params;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isRotate) {\r\n            return;\r\n        }\r\n        datas.isRotate = false;\r\n        var params = fillEndParams(moveable, e, {});\r\n        triggerEvent(moveable, \"onRotateEnd\", params);\r\n        return params;\r\n    },\r\n    dragGroupControlCondition: dragControlCondition,\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var _a = moveable.state, parentLeft = _a.left, parentTop = _a.top, parentBeforeOrigin = _a.beforeOrigin;\r\n        var params = this.dragControlStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        params.set(datas.beforeDirection * moveable.rotation);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlStart\", e, function (child, ev) {\r\n            var _a = child.state, left = _a.left, top = _a.top, beforeOrigin = _a.beforeOrigin;\r\n            var childClient = plus(minus([left, top], [parentLeft, parentTop]), minus(beforeOrigin, parentBeforeOrigin));\r\n            ev.datas.startGroupClient = childClient;\r\n            ev.datas.groupClient = childClient;\r\n            return __assign(__assign({}, ev), { parentRotate: 0 });\r\n        });\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: events });\r\n        var result = triggerEvent(moveable, \"onRotateGroupStart\", nextParams);\r\n        datas.isRotate = result !== false;\r\n        return datas.isRotate ? params : false;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isRotate) {\r\n            return;\r\n        }\r\n        catchEvent(moveable, \"onBeforeRotate\", function (parentEvent) {\r\n            triggerEvent(moveable, \"onBeforeRotateGroup\", fillParams(moveable, e, __assign(__assign({}, parentEvent), { targets: moveable.props.targets }), true));\r\n        });\r\n        var params = this.dragControl(moveable, e);\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var direction = datas.beforeDirection;\r\n        var parentRotate = params.beforeDist;\r\n        var rad = parentRotate / 180 * Math.PI;\r\n        var events = triggerChildAbles(moveable, this, \"dragControl\", e, function (_, ev) {\r\n            var startGroupClient = ev.datas.startGroupClient;\r\n            var _a = __read(ev.datas.groupClient, 2), prevClientX = _a[0], prevClientY = _a[1];\r\n            var _b = __read(rotate(startGroupClient, rad * direction), 2), clientX = _b[0], clientY = _b[1];\r\n            var delta = [clientX - prevClientX, clientY - prevClientY];\r\n            ev.datas.groupClient = [clientX, clientY];\r\n            return __assign(__assign({}, ev), { parentRotate: parentRotate, groupDelta: delta });\r\n        });\r\n        moveable.rotation = direction * params.beforeRotation;\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events, set: function (rotation) {\r\n                moveable.rotation = rotation;\r\n            }, setGroupRotation: function (rotation) {\r\n                moveable.rotation = rotation;\r\n            } }, params);\r\n        triggerEvent(moveable, \"onRotateGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isRotate) {\r\n            return;\r\n        }\r\n        this.dragControlEnd(moveable, e);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlEnd\", e);\r\n        var nextParams = fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: events,\r\n        });\r\n        triggerEvent(moveable, \"onRotateGroupEnd\", nextParams);\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Rotatable#request\r\n     * @param {object} [e] - the Resizable's request parameter\r\n     * @param {number} [e.deltaRotate=0] -  delta number of rotation\r\n     * @param {number} [e.rotate=0] - absolute number of moveable's rotation\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * moveable.request(\"rotatable\", { deltaRotate: 10 }, true);\r\n     *\r\n     * * moveable.request(\"rotatable\", { rotate: 10 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"rotatable\");\r\n     *\r\n     * // request\r\n     * requester.request({ deltaRotate: 10 });\r\n     * requester.request({ deltaRotate: 10 });\r\n     * requester.request({ deltaRotate: 10 });\r\n     *\r\n     * requester.request({ rotate: 10 });\r\n     * requester.request({ rotate: 20 });\r\n     * requester.request({ rotate: 30 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var distRotate = 0;\r\n        var startRotation = moveable.getRotation();\r\n        return {\r\n            isControl: true,\r\n            requestStart: function () {\r\n                return { datas: datas };\r\n            },\r\n            request: function (e) {\r\n                if (\"deltaRotate\" in e) {\r\n                    distRotate += e.deltaRotate;\r\n                }\r\n                else if (\"rotate\" in e) {\r\n                    distRotate = e.rotate - startRotation;\r\n                }\r\n                return { datas: datas, parentDist: distRotate };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true };\r\n            },\r\n        };\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be rotated. (default: false)\r\n * @name Moveable.Rotatable#rotatable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.rotatable = true;\r\n */\r\n/**\r\n * You can specify the position of the rotation. (default: \"top\")\r\n * @name Moveable.Rotatable#rotationPosition\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   rotationPosition: \"top\",\r\n * });\r\n *\r\n * moveable.rotationPosition = \"bottom\"\r\n */\r\n/**\r\n * throttle of angle(degree) when rotate.\r\n * @name Moveable.Rotatable#throttleRotate\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.throttleRotate = 1;\r\n */\r\n/**\r\n * When the rotate starts, the rotateStart event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateStart\r\n * @param {Moveable.Rotatable.OnRotateStart} - Parameters for the rotateStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { rotatable: true });\r\n * moveable.on(\"rotateStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n* When rotating, the rotate event is called.\r\n* @memberof Moveable.Rotatable\r\n* @event rotate\r\n* @param {Moveable.Rotatable.OnRotate} - Parameters for the rotate event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, { rotatable: true });\r\n* moveable.on(\"rotate\", ({ target, transform, dist }) => {\r\n*     target.style.transform = transform;\r\n* });\r\n*/\r\n/**\r\n * When the rotate finishes, the rotateEnd event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateEnd\r\n * @param {Moveable.Rotatable.OnRotateEnd} - Parameters for the rotateEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { rotatable: true });\r\n * moveable.on(\"rotateEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n * When the group rotate starts, the `rotateGroupStart` event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateGroupStart\r\n * @param {Moveable.Rotatable.OnRotateGroupStart} - Parameters for the `rotateGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     rotatable: true\r\n * });\r\n * moveable.on(\"rotateGroupStart\", ({ targets }) => {\r\n *     console.log(\"onRotateGroupStart\", targets);\r\n * });\r\n */\r\n/**\r\n* When the group rotate, the `rotateGroup` event is called.\r\n* @memberof Moveable.Rotatable\r\n* @event rotateGroup\r\n* @param {Moveable.Rotatable.OnRotateGroup} - Parameters for the `rotateGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     rotatable: true\r\n* });\r\n* moveable.on(\"rotateGroup\", ({ targets, events }) => {\r\n*     console.log(\"onRotateGroup\", targets);\r\n*     events.forEach(ev => {\r\n*         const target = ev.target;\r\n*         // ev.drag is a drag event that occurs when the group rotate.\r\n*         const left = ev.drag.beforeDist[0];\r\n*         const top = ev.drag.beforeDist[1];\r\n*         const deg = ev.beforeDist;\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group rotate finishes, the `rotateGroupEnd` event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateGroupEnd\r\n * @param {Moveable.Rotatable.OnRotateGroupEnd} - Parameters for the `rotateGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     rotatable: true\r\n * });\r\n * moveable.on(\"rotateGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onRotateGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nfunction renderGuideline(info, React) {\r\n    var _a;\r\n    var direction = info.direction, classNames = info.classNames, size = info.size, pos = info.pos, zoom = info.zoom, key = info.key;\r\n    var isHorizontal = direction === \"horizontal\";\r\n    var scaleType = isHorizontal ? \"Y\" : \"X\";\r\n    // const scaleType2 = isHorizontal ? \"Y\" : \"X\";\r\n    return React.createElement(\"div\", {\r\n        key: key,\r\n        className: classNames.join(\" \"),\r\n        style: (_a = {},\r\n            _a[isHorizontal ? \"width\" : \"height\"] = \"\".concat(size),\r\n            _a.transform = \"translate(\".concat(pos[0], \", \").concat(pos[1], \") translate\").concat(scaleType, \"(-50%) scale\").concat(scaleType, \"(\").concat(zoom, \")\"),\r\n            _a),\r\n    });\r\n}\r\nfunction renderInnerGuideline(info, React) {\r\n    return renderGuideline(__assign(__assign({}, info), { classNames: __spreadArray([\r\n            prefix(\"line\", \"guideline\", info.direction)\r\n        ], __read(info.classNames), false).filter(function (className) { return className; }), size: info.size || \"\".concat(info.sizeValue, \"px\"), pos: info.pos || info.posValue.map(function (v) { return \"\".concat(throttle(v, 0.1), \"px\"); }) }), React);\r\n}\r\nfunction renderSnapPoses(moveable, direction, snapPoses, minPos, targetPos, size, index, React) {\r\n    var zoom = moveable.props.zoom;\r\n    return snapPoses.map(function (_a, i) {\r\n        var type = _a.type, pos = _a.pos;\r\n        var renderPos = [0, 0];\r\n        renderPos[index] = minPos;\r\n        renderPos[index ? 0 : 1] = -targetPos + pos;\r\n        return renderInnerGuideline({\r\n            key: \"\".concat(direction, \"TargetGuideline\").concat(i),\r\n            classNames: [prefix(\"target\", \"bold\", type)],\r\n            posValue: renderPos,\r\n            sizeValue: size,\r\n            zoom: zoom,\r\n            direction: direction,\r\n        }, React);\r\n    });\r\n}\r\nfunction renderGuidelines(moveable, type, guidelines, targetPos, targetRect, React) {\r\n    var _a = moveable.props, zoom = _a.zoom, isDisplayInnerSnapDigit = _a.isDisplayInnerSnapDigit;\r\n    var mainNames = type === \"horizontal\" ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n    var targetStart = targetRect[mainNames.start];\r\n    var targetEnd = targetRect[mainNames.end];\r\n    return guidelines.filter(function (_a) {\r\n        var hide = _a.hide, elementRect = _a.elementRect;\r\n        if (hide) {\r\n            return false;\r\n        }\r\n        if (isDisplayInnerSnapDigit && elementRect) {\r\n            // inner\r\n            var rect = elementRect.rect;\r\n            if (rect[mainNames.start] <= targetStart && targetEnd <= rect[mainNames.end]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }).map(function (guideline, i) {\r\n        var pos = guideline.pos, size = guideline.size, element = guideline.element, className = guideline.className;\r\n        var renderPos = [\r\n            -targetPos[0] + pos[0],\r\n            -targetPos[1] + pos[1],\r\n        ];\r\n        return renderInnerGuideline({\r\n            key: \"\".concat(type, \"-default-guideline-\").concat(i),\r\n            classNames: element ? [prefix(\"bold\"), className] : [prefix(\"normal\"), className],\r\n            direction: type,\r\n            posValue: renderPos,\r\n            sizeValue: size,\r\n            zoom: zoom,\r\n        }, React);\r\n    });\r\n}\r\nfunction renderDigitLine(moveable, type, lineType, index, gap, renderPos, className, React) {\r\n    var _a;\r\n    var _b = moveable.props, _c = _b.snapDigit, snapDigit = _c === void 0 ? 0 : _c, _d = _b.isDisplaySnapDigit, isDisplaySnapDigit = _d === void 0 ? true : _d, _e = _b.snapDistFormat, snapDistFormat = _e === void 0 ? function (v, type) {\r\n        // Type can be used render different values.\r\n        if (type === 'vertical') {\r\n            return v;\r\n        }\r\n        return v;\r\n    } : _e, zoom = _b.zoom;\r\n    var scaleType = type === \"horizontal\" ? \"X\" : \"Y\";\r\n    var sizeName = type === \"vertical\" ? \"height\" : \"width\";\r\n    var absGap = Math.abs(gap);\r\n    var snapSize = isDisplaySnapDigit\r\n        ? parseFloat(absGap.toFixed(snapDigit))\r\n        : 0;\r\n    return React.createElement(\"div\", { key: \"\".concat(type, \"-\").concat(lineType, \"-guideline-\").concat(index), className: prefix(\"guideline-group\", type), style: (_a = {\r\n                left: \"\".concat(renderPos[0], \"px\"),\r\n                top: \"\".concat(renderPos[1], \"px\")\r\n            },\r\n            _a[sizeName] = \"\".concat(absGap, \"px\"),\r\n            _a) },\r\n        renderInnerGuideline({\r\n            direction: type,\r\n            classNames: [prefix(lineType), className],\r\n            size: \"100%\",\r\n            posValue: [0, 0],\r\n            sizeValue: absGap,\r\n            zoom: zoom,\r\n        }, React),\r\n        React.createElement(\"div\", { className: prefix(\"size-value\", \"gap\"), style: {\r\n                transform: \"translate\".concat(scaleType, \"(-50%) scale(\").concat(zoom, \")\"),\r\n            } }, snapSize > 0 ? snapDistFormat(snapSize, type) : \"\"));\r\n}\r\nfunction groupByElementGuidelines(type, guidelines, targetRect, isDisplayInnerSnapDigit) {\r\n    var index = type === \"vertical\" ? 0 : 1;\r\n    var otherIndex = type === \"vertical\" ? 1 : 0;\r\n    var names = index ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n    var targetStart = targetRect[names.start];\r\n    var targetEnd = targetRect[names.end];\r\n    return groupBy(guidelines, function (guideline) {\r\n        return guideline.pos[index];\r\n    }).map(function (nextGuidelines) {\r\n        var start = [];\r\n        var end = [];\r\n        var inner = [];\r\n        nextGuidelines.forEach(function (guideline) {\r\n            var _a, _b;\r\n            var element = guideline.element;\r\n            var rect = guideline.elementRect.rect;\r\n            if (rect[names.end] < targetStart) {\r\n                start.push(guideline);\r\n            }\r\n            else if (targetEnd < rect[names.start]) {\r\n                end.push(guideline);\r\n            }\r\n            else if (rect[names.start] <= targetStart && targetEnd <= rect[names.end] && isDisplayInnerSnapDigit) {\r\n                var pos = guideline.pos;\r\n                var elementRect1 = { element: element, rect: __assign(__assign({}, rect), (_a = {}, _a[names.end] = rect[names.start], _a)) };\r\n                var elementRect2 = { element: element, rect: __assign(__assign({}, rect), (_b = {}, _b[names.start] = rect[names.end], _b)) };\r\n                var nextPos1 = [0, 0];\r\n                var nextPos2 = [0, 0];\r\n                nextPos1[index] = pos[index];\r\n                nextPos1[otherIndex] = pos[otherIndex];\r\n                nextPos2[index] = pos[index];\r\n                nextPos2[otherIndex] = pos[otherIndex] + guideline.size;\r\n                start.push({\r\n                    type: type,\r\n                    pos: nextPos1,\r\n                    size: 0,\r\n                    elementRect: elementRect1,\r\n                    direction: \"\",\r\n                    elementDirection: \"end\",\r\n                });\r\n                end.push({\r\n                    type: type,\r\n                    pos: nextPos2,\r\n                    size: 0,\r\n                    elementRect: elementRect2,\r\n                    direction: \"\",\r\n                    elementDirection: \"start\",\r\n                });\r\n                // inner.push(guideline);\r\n            }\r\n        });\r\n        start.sort(function (a, b) {\r\n            return b.pos[otherIndex] - a.pos[otherIndex];\r\n        });\r\n        end.sort(function (a, b) {\r\n            return a.pos[otherIndex] - b.pos[otherIndex];\r\n        });\r\n        return {\r\n            total: nextGuidelines,\r\n            start: start,\r\n            end: end,\r\n            inner: inner,\r\n        };\r\n    });\r\n}\r\nfunction renderDashedGuidelines(moveable, guidelines, targetPos, targetRect, React) {\r\n    var isDisplayInnerSnapDigit = moveable.props.isDisplayInnerSnapDigit;\r\n    var rendered = [];\r\n    [\"vertical\", \"horizontal\"].forEach(function (type) {\r\n        var nextGuidelines = guidelines.filter(function (guideline) { return guideline.type === type; });\r\n        var index = type === \"vertical\" ? 1 : 0;\r\n        var otherIndex = index ? 0 : 1;\r\n        var groups = groupByElementGuidelines(type, nextGuidelines, targetRect, isDisplayInnerSnapDigit);\r\n        var mainNames = index ? HORIZONTAL_NAMES_MAP : VERTICAL_NAMES_MAP;\r\n        var sideNames = index ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n        var targetStart = targetRect[mainNames.start];\r\n        var targetEnd = targetRect[mainNames.end];\r\n        groups.forEach(function (_a) {\r\n            var total = _a.total, start = _a.start, end = _a.end, inner = _a.inner;\r\n            var sidePos = targetPos[otherIndex] + total[0].pos[otherIndex] - targetRect[sideNames.start];\r\n            var prevRect = targetRect;\r\n            start.forEach(function (guideline) {\r\n                var nextRect = guideline.elementRect.rect;\r\n                var size = prevRect[mainNames.start] - nextRect[mainNames.end];\r\n                if (size > 0) {\r\n                    var renderPos = [0, 0];\r\n                    renderPos[index] = targetPos[index] + prevRect[mainNames.start] - targetStart - size;\r\n                    renderPos[otherIndex] = sidePos;\r\n                    rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size, renderPos, guideline.className, React));\r\n                }\r\n                prevRect = nextRect;\r\n            });\r\n            prevRect = targetRect;\r\n            end.forEach(function (guideline) {\r\n                var nextRect = guideline.elementRect.rect;\r\n                var size = nextRect[mainNames.start] - prevRect[mainNames.end];\r\n                if (size > 0) {\r\n                    var renderPos = [0, 0];\r\n                    renderPos[index] = targetPos[index] + prevRect[mainNames.end] - targetStart;\r\n                    renderPos[otherIndex] = sidePos;\r\n                    rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size, renderPos, guideline.className, React));\r\n                }\r\n                prevRect = nextRect;\r\n            });\r\n            inner.forEach(function (guideline) {\r\n                var nextRect = guideline.elementRect.rect;\r\n                var size1 = targetStart - nextRect[mainNames.start];\r\n                var size2 = nextRect[mainNames.end] - targetEnd;\r\n                var renderPos1 = [0, 0];\r\n                var renderPos2 = [0, 0];\r\n                renderPos1[index] = targetPos[index] - size1;\r\n                renderPos1[otherIndex] = sidePos;\r\n                renderPos2[index] = targetPos[index] + targetEnd - targetStart;\r\n                renderPos2[otherIndex] = sidePos;\r\n                rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size1, renderPos1, guideline.className, React));\r\n                rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size2, renderPos2, guideline.className, React));\r\n            });\r\n        });\r\n    });\r\n    return rendered;\r\n}\r\nfunction renderGapGuidelines(moveable, guidelines, targetPos, targetRect, React) {\r\n    var rendered = [];\r\n    [\"horizontal\", \"vertical\"].forEach(function (type) {\r\n        var nextGuidelines = guidelines.filter(function (guideline) { return guideline.type === type; }).slice(0, 1);\r\n        var index = type === \"vertical\" ? 0 : 1;\r\n        var otherIndex = index ? 0 : 1;\r\n        var mainNames = index ? HORIZONTAL_NAMES_MAP : VERTICAL_NAMES_MAP;\r\n        var sideNames = index ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n        var targetStart = targetRect[mainNames.start];\r\n        var targetEnd = targetRect[mainNames.end];\r\n        var targetSideStart = targetRect[sideNames.start];\r\n        var targetSideEnd = targetRect[sideNames.end];\r\n        nextGuidelines.forEach(function (_a) {\r\n            var gap = _a.gap, gapRects = _a.gapRects;\r\n            var sideStartPos = Math.max.apply(Math, __spreadArray([targetSideStart], __read(gapRects.map(function (_a) {\r\n                var rect = _a.rect;\r\n                return rect[sideNames.start];\r\n            })), false));\r\n            var sideEndPos = Math.min.apply(Math, __spreadArray([targetSideEnd], __read(gapRects.map(function (_a) {\r\n                var rect = _a.rect;\r\n                return rect[sideNames.end];\r\n            })), false));\r\n            var sideCenterPos = (sideStartPos + sideEndPos) / 2;\r\n            if (sideStartPos === sideEndPos || sideCenterPos === (targetSideStart + targetSideEnd) / 2) {\r\n                return;\r\n            }\r\n            gapRects.forEach(function (_a) {\r\n                var rect = _a.rect, className = _a.className;\r\n                var renderPos = [targetPos[0], targetPos[1]];\r\n                if (rect[mainNames.end] < targetStart) {\r\n                    renderPos[index] += rect[mainNames.end] - targetStart;\r\n                }\r\n                else if (targetEnd < rect[mainNames.start]) {\r\n                    renderPos[index] += rect[mainNames.start] - targetStart - gap;\r\n                }\r\n                else {\r\n                    return;\r\n                }\r\n                renderPos[otherIndex] += sideCenterPos - targetSideStart;\r\n                rendered.push(renderDigitLine(moveable, index ? \"vertical\" : \"horizontal\", \"gap\", rendered.length, gap, renderPos, className, React));\r\n            });\r\n        });\r\n    });\r\n    return rendered;\r\n}\n\nfunction getTotalGuidelines(moveable) {\r\n    var _a, _b;\r\n    var state = moveable.state;\r\n    var containerClientRect = state.containerClientRect, hasFixed = state.hasFixed;\r\n    var overflow = containerClientRect.overflow, containerHeight = containerClientRect.scrollHeight, containerWidth = containerClientRect.scrollWidth, containerClientHeight = containerClientRect.clientHeight, containerClientWidth = containerClientRect.clientWidth, clientLeft = containerClientRect.clientLeft, clientTop = containerClientRect.clientTop;\r\n    var _c = moveable.props, _d = _c.snapGap, snapGap = _d === void 0 ? true : _d, verticalGuidelines = _c.verticalGuidelines, horizontalGuidelines = _c.horizontalGuidelines, _e = _c.snapThreshold, snapThreshold = _e === void 0 ? 5 : _e, _f = _c.maxSnapElementGuidelineDistance, maxSnapElementGuidelineDistance = _f === void 0 ? Infinity : _f, isDisplayGridGuidelines = _c.isDisplayGridGuidelines;\r\n    var _g = getRect(getAbsolutePosesByState(moveable.state)), top = _g.top, left = _g.left, bottom = _g.bottom, right = _g.right;\r\n    var targetRect = { top: top, left: left, bottom: bottom, right: right, center: (left + right) / 2, middle: (top + bottom) / 2 };\r\n    var elementGuidelines = getElementGuidelines(moveable);\r\n    var totalGuidelines = __spreadArray([], __read(elementGuidelines), false);\r\n    var snapThresholdMultiples = ((_b = (_a = state.snapThresholdInfo) === null || _a === void 0 ? void 0 : _a.multiples) !== null && _b !== void 0 ? _b : [1, 1]).map(function (n) { return n * snapThreshold; });\r\n    if (snapGap) {\r\n        totalGuidelines.push.apply(totalGuidelines, __spreadArray([], __read(getGapGuidelines(moveable, targetRect, snapThresholdMultiples)), false));\r\n    }\r\n    var snapOffset = __assign({}, (state.snapOffset || {\r\n        left: 0,\r\n        top: 0,\r\n        bottom: 0,\r\n        right: 0,\r\n    }));\r\n    totalGuidelines.push.apply(totalGuidelines, __spreadArray([], __read(getGridGuidelines(moveable, overflow ? containerWidth : containerClientWidth, overflow ? containerHeight : containerClientHeight, clientLeft, clientTop, snapOffset, isDisplayGridGuidelines)), false));\r\n    if (hasFixed) {\r\n        var left_1 = containerClientRect.left, top_1 = containerClientRect.top;\r\n        snapOffset.left += left_1;\r\n        snapOffset.top += top_1;\r\n        snapOffset.right += left_1;\r\n        snapOffset.bottom += top_1;\r\n    }\r\n    totalGuidelines.push.apply(totalGuidelines, __spreadArray([], __read(getDefaultGuidelines(horizontalGuidelines || false, verticalGuidelines || false, overflow ? containerWidth : containerClientWidth, overflow ? containerHeight : containerClientHeight, clientLeft, clientTop, snapOffset)), false));\r\n    totalGuidelines = totalGuidelines.filter(function (_a) {\r\n        var element = _a.element, elementRect = _a.elementRect, type = _a.type;\r\n        if (!element || !elementRect) {\r\n            return true;\r\n        }\r\n        var rect = elementRect.rect;\r\n        return checkBetweenRects(targetRect, rect, type, maxSnapElementGuidelineDistance);\r\n    });\r\n    return totalGuidelines;\r\n}\r\nfunction getGapGuidelines(moveable, targetRect, snapThresholds) {\r\n    var _a = moveable.props, _b = _a.maxSnapElementGuidelineDistance, maxSnapElementGuidelineDistance = _b === void 0 ? Infinity : _b, _c = _a.maxSnapElementGapDistance, maxSnapElementGapDistance = _c === void 0 ? Infinity : _c;\r\n    var elementRects = moveable.state.elementRects;\r\n    var gapGuidelines = [];\r\n    [\r\n        [\"vertical\", VERTICAL_NAMES_MAP, HORIZONTAL_NAMES_MAP],\r\n        [\"horizontal\", HORIZONTAL_NAMES_MAP, VERTICAL_NAMES_MAP],\r\n    ].forEach(function (_a) {\r\n        var _b = __read(_a, 3), type = _b[0], mainNames = _b[1], sideNames = _b[2];\r\n        var targetStart = targetRect[mainNames.start];\r\n        var targetEnd = targetRect[mainNames.end];\r\n        var targetCenter = targetRect[mainNames.center];\r\n        var targetStart2 = targetRect[sideNames.start];\r\n        var targetEnd2 = targetRect[sideNames.end];\r\n        // element : moveable\r\n        var snapThresholdMap = {\r\n            left: snapThresholds[0],\r\n            top: snapThresholds[1],\r\n        };\r\n        function getDist(elementRect) {\r\n            var rect = elementRect.rect;\r\n            var snapThreshold = snapThresholdMap[mainNames.start];\r\n            if (rect[mainNames.end] < targetStart + snapThreshold) {\r\n                return targetStart - rect[mainNames.end];\r\n            }\r\n            else if (targetEnd - snapThreshold < rect[mainNames.start]) {\r\n                return rect[mainNames.start] - targetEnd;\r\n            }\r\n            else {\r\n                return -1;\r\n            }\r\n        }\r\n        var nextElementRects = elementRects.filter(function (elementRect) {\r\n            var rect = elementRect.rect;\r\n            if (rect[sideNames.start] > targetEnd2 || rect[sideNames.end] < targetStart2) {\r\n                return false;\r\n            }\r\n            return getDist(elementRect) > 0;\r\n        }).sort(function (a, b) {\r\n            return getDist(a) - getDist(b);\r\n        });\r\n        var groups = [];\r\n        nextElementRects.forEach(function (snapRect1) {\r\n            nextElementRects.forEach(function (snapRect2) {\r\n                if (snapRect1 === snapRect2) {\r\n                    return;\r\n                }\r\n                var rect1 = snapRect1.rect;\r\n                var rect2 = snapRect2.rect;\r\n                var rect1Start = rect1[sideNames.start];\r\n                var rect1End = rect1[sideNames.end];\r\n                var rect2Start = rect2[sideNames.start];\r\n                var rect2End = rect2[sideNames.end];\r\n                if (rect1Start > rect2End || rect2Start > rect1End) {\r\n                    return;\r\n                }\r\n                groups.push([snapRect1, snapRect2]);\r\n            });\r\n        });\r\n        groups.forEach(function (_a) {\r\n            var _b = __read(_a, 2), snapRect1 = _b[0], snapRect2 = _b[1];\r\n            var rect1 = snapRect1.rect;\r\n            var rect2 = snapRect2.rect;\r\n            var rect1Start = rect1[mainNames.start];\r\n            var rect1End = rect1[mainNames.end];\r\n            var rect2Start = rect2[mainNames.start];\r\n            var rect2End = rect2[mainNames.end];\r\n            var snapThreshold = snapThresholdMap[mainNames.start];\r\n            var gap = 0;\r\n            var pos = 0;\r\n            var isStart = false;\r\n            var isCenter = false;\r\n            var isEnd = false;\r\n            if (rect1End <= targetStart && targetEnd <= rect2Start) {\r\n                // (l)element1(r) : (l)target(r) : (l)element2(r)\r\n                isCenter = true;\r\n                gap = ((rect2Start - rect1End) - (targetEnd - targetStart)) / 2;\r\n                pos = rect1End + gap + (targetEnd - targetStart) / 2;\r\n                if (abs(pos - targetCenter) > snapThreshold) {\r\n                    return;\r\n                }\r\n            }\r\n            else if (rect1End < rect2Start && rect2End < targetStart + snapThreshold) {\r\n                // (l)element1(r) : (l)element2(r) : (l)target\r\n                isStart = true;\r\n                gap = rect2Start - rect1End;\r\n                pos = rect2End + gap;\r\n                if (abs(pos - targetStart) > snapThreshold) {\r\n                    return;\r\n                }\r\n            }\r\n            else if (rect1End < rect2Start && targetEnd - snapThreshold < rect1Start) {\r\n                // target(r) : (l)element1(r) : (l)element2(r)\r\n                isEnd = true;\r\n                gap = rect2Start - rect1End;\r\n                pos = rect1Start - gap;\r\n                if (abs(pos - targetEnd) > snapThreshold) {\r\n                    return;\r\n                }\r\n            }\r\n            else {\r\n                return;\r\n            }\r\n            if (!gap) {\r\n                return;\r\n            }\r\n            if (!checkBetweenRects(targetRect, rect2, type, maxSnapElementGuidelineDistance)) {\r\n                return;\r\n            }\r\n            if (gap > maxSnapElementGapDistance) {\r\n                return;\r\n            }\r\n            gapGuidelines.push({\r\n                type: type,\r\n                pos: type === \"vertical\" ? [pos, 0] : [0, pos],\r\n                element: snapRect2.element,\r\n                size: 0,\r\n                className: snapRect2.className,\r\n                isStart: isStart,\r\n                isCenter: isCenter,\r\n                isEnd: isEnd,\r\n                gap: gap,\r\n                hide: true,\r\n                gapRects: [snapRect1, snapRect2],\r\n                direction: \"\",\r\n                elementDirection: \"\",\r\n            });\r\n        });\r\n    });\r\n    return gapGuidelines;\r\n}\r\nfunction startGridGroupGuidelines(moveable, clientLeft, clientTop, snapOffset) {\r\n    var _a, _b;\r\n    var props = moveable.props;\r\n    var state = moveable.state;\r\n    var snapGridAll = props.snapGridAll;\r\n    var _c = props.snapGridWidth, snapGridWidth = _c === void 0 ? 0 : _c, _d = props.snapGridHeight, snapGridHeight = _d === void 0 ? 0 : _d;\r\n    var snapRenderInfo = state.snapRenderInfo;\r\n    var hasDirection = snapRenderInfo && (((_a = snapRenderInfo.direction) === null || _a === void 0 ? void 0 : _a[0]) || ((_b = snapRenderInfo.direction) === null || _b === void 0 ? void 0 : _b[1]));\r\n    var moveables = moveable.moveables;\r\n    // snap group's all child to grid.\r\n    if (snapGridAll\r\n        && moveables\r\n        && hasDirection\r\n        && (snapGridWidth || snapGridHeight)) {\r\n        if (state.snapThresholdInfo) {\r\n            return;\r\n        }\r\n        state.snapThresholdInfo = {\r\n            multiples: [1, 1],\r\n            offset: [0, 0],\r\n        };\r\n        var rect_1 = moveable.getRect();\r\n        var children_1 = rect_1.children;\r\n        var direction = snapRenderInfo.direction;\r\n        if (children_1) {\r\n            var result = direction.map(function (dir, i) {\r\n                var _a = i === 0 ? {\r\n                    snapSize: snapGridWidth,\r\n                    posName: \"left\",\r\n                    sizeName: \"width\",\r\n                    clientOffset: snapOffset.left - clientLeft,\r\n                } : {\r\n                    snapSize: snapGridHeight,\r\n                    posName: \"top\",\r\n                    sizeName: \"height\",\r\n                    clientOffset: snapOffset.top - clientTop,\r\n                }, snapSize = _a.snapSize, posName = _a.posName, sizeName = _a.sizeName, clientOffset = _a.clientOffset;\r\n                if (!snapSize) {\r\n                    return {\r\n                        dir: dir,\r\n                        multiple: 1,\r\n                        snapSize: snapSize,\r\n                        snapOffset: 0,\r\n                    };\r\n                }\r\n                var rectSize = rect_1[sizeName];\r\n                var rectPos = rect_1[posName];\r\n                //     ?\r\n                var childSizes = flat$1(children_1.map(function (child) {\r\n                    return [\r\n                        (child[posName] - rectPos),\r\n                        (child[sizeName]),\r\n                        (rectSize - child[sizeName] - child[posName] + rectPos),\r\n                    ];\r\n                })).filter(function (v) { return v; }).sort(function (a, b) {\r\n                    return a - b;\r\n                });\r\n                var firstChildSize = childSizes[0];\r\n                var childSnapSizes = childSizes.map(function (size) { return throttle(size / firstChildSize, 0.1) * snapSize; });\r\n                var n = 1;\r\n                var rectRatio = throttle(rectSize / firstChildSize, 0.1);\r\n                for (n = 1; n <= 10; ++n) {\r\n                    if (childSnapSizes.every(function (childSize) {\r\n                        return childSize * n % 1 === 0;\r\n                    })) {\r\n                        break;\r\n                    }\r\n                }\r\n                // dir 1 (fixed -1)\r\n                // dir 0 (fixed 0)\r\n                // dir -1 (fixed 1)\r\n                var ratio = (-dir + 1) / 2;\r\n                var offsetPos = dot(rectPos - clientOffset, rectPos - clientOffset + rectSize, ratio, 1 - ratio);\r\n                return {\r\n                    multiple: rectRatio * n,\r\n                    dir: dir,\r\n                    snapSize: snapSize,\r\n                    snapOffset: Math.round(offsetPos / snapSize),\r\n                };\r\n            });\r\n            var multiples = result.map(function (r) { return r.multiple || 1; });\r\n            state.snapThresholdInfo.multiples = multiples;\r\n            state.snapThresholdInfo.offset = result.map(function (r) { return r.snapOffset; });\r\n            result.forEach(function (r, i) {\r\n                if (r.snapSize) ;\r\n            });\r\n        }\r\n    }\r\n    else {\r\n        state.snapThresholdInfo = null;\r\n    }\r\n}\r\nfunction getGridGuidelines(moveable, containerWidth, containerHeight, clientLeft, clientTop, snapOffset, isDisplayGridGuidelines) {\r\n    if (clientLeft === void 0) { clientLeft = 0; }\r\n    if (clientTop === void 0) { clientTop = 0; }\r\n    var props = moveable.props;\r\n    var state = moveable.state;\r\n    var _a = props.snapGridWidth, snapGridWidth = _a === void 0 ? 0 : _a, _b = props.snapGridHeight, snapGridHeight = _b === void 0 ? 0 : _b;\r\n    var guidelines = [];\r\n    var snapOffsetLeft = snapOffset.left, snapOffsetTop = snapOffset.top;\r\n    var startOffset = [0, 0];\r\n    startGridGroupGuidelines(moveable, clientLeft, clientTop, snapOffset);\r\n    var snapThresholdInfo = state.snapThresholdInfo;\r\n    var defaultSnapGridWidth = snapGridWidth;\r\n    var defaultSnapGridHeight = snapGridHeight;\r\n    if (snapThresholdInfo) {\r\n        snapGridWidth *= snapThresholdInfo.multiples[0] || 1;\r\n        snapGridHeight *= snapThresholdInfo.multiples[1] || 1;\r\n        startOffset = snapThresholdInfo.offset;\r\n    }\r\n    if (snapGridHeight) {\r\n        var pushGuideline = function (pos) {\r\n            guidelines.push({\r\n                type: \"horizontal\",\r\n                pos: [\r\n                    snapOffsetLeft,\r\n                    throttle(startOffset[1] * defaultSnapGridHeight + pos - clientTop + snapOffsetTop, 0.1),\r\n                ],\r\n                className: prefix(\"grid-guideline\"),\r\n                size: containerWidth,\r\n                hide: !isDisplayGridGuidelines,\r\n                direction: \"\",\r\n                grid: true,\r\n            });\r\n        };\r\n        for (var pos = 0; pos <= containerHeight * 2; pos += snapGridHeight) {\r\n            pushGuideline(pos);\r\n        }\r\n        for (var pos = -snapGridHeight; pos >= -containerHeight; pos -= snapGridHeight) {\r\n            pushGuideline(pos);\r\n        }\r\n    }\r\n    if (snapGridWidth) {\r\n        var pushGuideline = function (pos) {\r\n            guidelines.push({\r\n                type: \"vertical\",\r\n                pos: [\r\n                    throttle(startOffset[0] * defaultSnapGridWidth + pos - clientLeft + snapOffsetLeft, 0.1),\r\n                    snapOffsetTop,\r\n                ],\r\n                className: prefix(\"grid-guideline\"),\r\n                size: containerHeight,\r\n                hide: !isDisplayGridGuidelines,\r\n                direction: \"\",\r\n                grid: true,\r\n            });\r\n        };\r\n        for (var pos = 0; pos <= containerWidth * 2; pos += snapGridWidth) {\r\n            pushGuideline(pos);\r\n        }\r\n        for (var pos = -snapGridWidth; pos >= -containerWidth; pos -= snapGridWidth) {\r\n            pushGuideline(pos);\r\n        }\r\n    }\r\n    return guidelines;\r\n}\r\nfunction checkBetweenRects(rect1, rect2, type, distance) {\r\n    if (type === \"horizontal\") {\r\n        return abs(rect1.right - rect2.left) <= distance\r\n            || abs(rect1.left - rect2.right) <= distance\r\n            || rect1.left <= rect2.right && rect2.left <= rect1.right;\r\n    }\r\n    else if (type === \"vertical\") {\r\n        return abs(rect1.bottom - rect2.top) <= distance\r\n            || abs(rect1.top - rect2.bottom) <= distance\r\n            || rect1.top <= rect2.bottom && rect2.top <= rect1.bottom;\r\n    }\r\n    return true;\r\n}\r\nfunction getElementGuidelines(moveable) {\r\n    var state = moveable.state;\r\n    var _a = moveable.props.elementGuidelines, elementGuidelines = _a === void 0 ? [] : _a;\r\n    if (!elementGuidelines.length) {\r\n        state.elementRects = [];\r\n        return [];\r\n    }\r\n    var prevValues = (state.elementRects || []).filter(function (snapRect) { return !snapRect.refresh; });\r\n    var nextElementGuidelines = elementGuidelines.map(function (el) {\r\n        if (isObject(el) && \"element\" in el) {\r\n            return __assign(__assign({}, el), { element: getRefTarget(el.element, true) });\r\n        }\r\n        return {\r\n            element: getRefTarget(el, true),\r\n        };\r\n    }).filter(function (value) {\r\n        return value.element;\r\n    });\r\n    var _b = diff(prevValues.map(function (v) { return v.element; }), nextElementGuidelines.map(function (v) { return v.element; })), maintained = _b.maintained, added = _b.added;\r\n    var nextValues = [];\r\n    maintained.forEach(function (_a) {\r\n        var _b = __read(_a, 2), prevIndex = _b[0], nextIndex = _b[1];\r\n        nextValues[nextIndex] = prevValues[prevIndex];\r\n    });\r\n    getSnapElementRects(moveable, added.map(function (index) { return nextElementGuidelines[index]; })).map(function (rect, i) {\r\n        nextValues[added[i]] = rect;\r\n    });\r\n    state.elementRects = nextValues;\r\n    var elementSnapDirections = getSnapDirections(moveable.props.elementSnapDirections);\r\n    var nextGuidelines = [];\r\n    nextValues.forEach(function (snapRect) {\r\n        var element = snapRect.element, _a = snapRect.top, topValue = _a === void 0 ? elementSnapDirections.top : _a, _b = snapRect.left, leftValue = _b === void 0 ? elementSnapDirections.left : _b, _c = snapRect.right, rightValue = _c === void 0 ? elementSnapDirections.right : _c, _d = snapRect.bottom, bottomValue = _d === void 0 ? elementSnapDirections.bottom : _d, _e = snapRect.center, centerValue = _e === void 0 ? elementSnapDirections.center : _e, _f = snapRect.middle, middleValue = _f === void 0 ? elementSnapDirections.middle : _f, className = snapRect.className, rect = snapRect.rect;\r\n        var _g = splitSnapDirectionPoses({\r\n            top: topValue,\r\n            right: rightValue,\r\n            left: leftValue,\r\n            bottom: bottomValue,\r\n            center: centerValue,\r\n            middle: middleValue,\r\n        }, rect), horizontal = _g.horizontal, vertical = _g.vertical, horizontalNames = _g.horizontalNames, verticalNames = _g.verticalNames;\r\n        var rectTop = rect.top;\r\n        var rectLeft = rect.left;\r\n        var width = rect.right - rectLeft;\r\n        var height = rect.bottom - rectTop;\r\n        var sizes = [width, height];\r\n        vertical.forEach(function (pos, i) {\r\n            nextGuidelines.push({\r\n                type: \"vertical\",\r\n                element: element,\r\n                pos: [\r\n                    throttle(pos, 0.1),\r\n                    rectTop,\r\n                ], size: height,\r\n                sizes: sizes,\r\n                className: className,\r\n                elementRect: snapRect,\r\n                elementDirection: SNAP_SKIP_NAMES_MAP[verticalNames[i]] || verticalNames[i],\r\n                direction: \"\",\r\n            });\r\n        });\r\n        horizontal.forEach(function (pos, i) {\r\n            nextGuidelines.push({\r\n                type: \"horizontal\",\r\n                element: element,\r\n                pos: [\r\n                    rectLeft,\r\n                    throttle(pos, 0.1),\r\n                ],\r\n                size: width,\r\n                sizes: sizes,\r\n                className: className,\r\n                elementRect: snapRect,\r\n                elementDirection: SNAP_SKIP_NAMES_MAP[horizontalNames[i]] || horizontalNames[i],\r\n                direction: \"\",\r\n            });\r\n        });\r\n    });\r\n    return nextGuidelines;\r\n}\r\nfunction getObjectGuidelines(guidelines, containerSize) {\r\n    return guidelines ? guidelines.map(function (info) {\r\n        var posGuideline = isObject(info) ? info : { pos: info };\r\n        var pos = posGuideline.pos;\r\n        if (isNumber(pos)) {\r\n            return posGuideline;\r\n        }\r\n        else {\r\n            return __assign(__assign({}, posGuideline), { pos: convertUnitSize(pos, containerSize) });\r\n        }\r\n    }) : [];\r\n}\r\nfunction getDefaultGuidelines(horizontalGuidelines, verticalGuidelines, width, height, clientLeft, clientTop, snapOffset) {\r\n    if (clientLeft === void 0) { clientLeft = 0; }\r\n    if (clientTop === void 0) { clientTop = 0; }\r\n    if (snapOffset === void 0) { snapOffset = { left: 0, top: 0, right: 0, bottom: 0 }; }\r\n    var guidelines = [];\r\n    var snapOffsetLeft = snapOffset.left, snapOffsetTop = snapOffset.top, snapOffsetBottom = snapOffset.bottom, snapOffsetRight = snapOffset.right;\r\n    var snapWidth = width + snapOffsetRight - snapOffsetLeft;\r\n    var snapHeight = height + snapOffsetBottom - snapOffsetTop;\r\n    getObjectGuidelines(horizontalGuidelines, snapHeight).forEach(function (posInfo) {\r\n        guidelines.push({\r\n            type: \"horizontal\",\r\n            pos: [\r\n                snapOffsetLeft,\r\n                throttle(posInfo.pos - clientTop + snapOffsetTop, 0.1),\r\n            ],\r\n            size: snapWidth,\r\n            className: posInfo.className,\r\n            direction: \"\",\r\n        });\r\n    });\r\n    getObjectGuidelines(verticalGuidelines, snapWidth).forEach(function (posInfo) {\r\n        guidelines.push({\r\n            type: \"vertical\",\r\n            pos: [\r\n                throttle(posInfo.pos - clientLeft + snapOffsetLeft, 0.1),\r\n                snapOffsetTop,\r\n            ],\r\n            size: snapHeight,\r\n            className: posInfo.className,\r\n            direction: \"\",\r\n        });\r\n    });\r\n    return guidelines;\r\n}\r\nfunction getSnapElementRects(moveable, values) {\r\n    if (!values.length) {\r\n        return [];\r\n    }\r\n    var groupable = moveable.props.groupable;\r\n    var state = moveable.state;\r\n    var containerClientRect = state.containerClientRect, \r\n    // targetClientRect: {\r\n    //     top: clientTop,\r\n    //     left: clientLeft,\r\n    // },\r\n    rootMatrix = state.rootMatrix, is3d = state.is3d, offsetDelta = state.offsetDelta;\r\n    var n = is3d ? 4 : 3;\r\n    var _a = __read(calculateContainerPos(rootMatrix, containerClientRect, n), 2), containerLeft = _a[0], containerTop = _a[1];\r\n    // const poses = getAbsolutePosesByState(state);\r\n    // const {\r\n    //     minX: targetLeft,\r\n    //     minY: targetTop,\r\n    // } = getMinMaxs(poses);\r\n    // const [distLeft, distTop] = minus([targetLeft, targetTop], calculateInversePosition(rootMatrix, [\r\n    //     clientLeft - containerLeft,\r\n    //     clientTop - containerTop,\r\n    // ], n)).map(pos => roundSign(pos));\r\n    var offsetLeft = groupable ? 0 : offsetDelta[0];\r\n    var offsetTop = groupable ? 0 : offsetDelta[1];\r\n    return values.map(function (value) {\r\n        var rect = value.element.getBoundingClientRect();\r\n        var left = rect.left - containerLeft - offsetLeft;\r\n        var top = rect.top - containerTop - offsetTop;\r\n        var bottom = top + rect.height;\r\n        var right = left + rect.width;\r\n        var _a = __read(calculateInversePosition(rootMatrix, [left, top], n), 2), elementLeft = _a[0], elementTop = _a[1];\r\n        var _b = __read(calculateInversePosition(rootMatrix, [right, bottom], n), 2), elementRight = _b[0], elementBottom = _b[1];\r\n        return __assign(__assign({}, value), { rect: {\r\n                left: elementLeft,\r\n                right: elementRight,\r\n                top: elementTop,\r\n                bottom: elementBottom,\r\n                center: (elementLeft + elementRight) / 2,\r\n                middle: (elementTop + elementBottom) / 2,\r\n            } });\r\n    });\r\n}\n\nfunction checkSnapInfo(moveable) {\r\n    var state = moveable.state;\r\n    var container = state.container;\r\n    var snapContainer = moveable.props.snapContainer || container;\r\n    if (state.snapContainer === snapContainer && state.guidelines && state.guidelines.length) {\r\n        return false;\r\n    }\r\n    var containerClientRect = state.containerClientRect;\r\n    var snapOffset = {\r\n        left: 0,\r\n        top: 0,\r\n        bottom: 0,\r\n        right: 0,\r\n    };\r\n    if (container !== snapContainer) {\r\n        var snapContainerTarget = getRefTarget(snapContainer, true);\r\n        if (snapContainerTarget) {\r\n            var snapContainerRect = getClientRect(snapContainerTarget);\r\n            var offset1 = getDragDistByState(state, [\r\n                snapContainerRect.left - containerClientRect.left,\r\n                snapContainerRect.top - containerClientRect.top,\r\n            ]);\r\n            var offset2 = getDragDistByState(state, [\r\n                snapContainerRect.right - containerClientRect.right,\r\n                snapContainerRect.bottom - containerClientRect.bottom,\r\n            ]);\r\n            snapOffset.left = throttle(offset1[0], 0.00001);\r\n            snapOffset.top = throttle(offset1[1], 0.00001);\r\n            snapOffset.right = throttle(offset2[0], 0.00001);\r\n            snapOffset.bottom = throttle(offset2[1], 0.00001);\r\n        }\r\n    }\r\n    state.snapContainer = snapContainer;\r\n    state.snapOffset = snapOffset;\r\n    state.guidelines = getTotalGuidelines(moveable);\r\n    state.enableSnap = true;\r\n    return true;\r\n}\r\nfunction getNextFixedPoses(matrix, width, height, fixedDirection, fixedPos, is3d) {\r\n    var nextPoses = calculatePoses(matrix, width, height, is3d ? 4 : 3);\r\n    var nextFixedPos = getPosByDirection(nextPoses, fixedDirection);\r\n    return getAbsolutePoses(nextPoses, minus(fixedPos, nextFixedPos));\r\n}\r\nfunction normalized(value) {\r\n    return value ? value / abs(value) : 0;\r\n}\r\nfunction getSizeOffsetInfo(moveable, poses, direction, keepRatio, isRequest, datas) {\r\n    var fixedDirection = datas.fixedDirection;\r\n    var directions = getCheckSnapDirections(direction, fixedDirection, keepRatio);\r\n    var innerBoundLineInfos = getCheckInnerBoundLineInfos(moveable, poses, direction, keepRatio);\r\n    var offsets = __spreadArray(__spreadArray([], __read(getSnapBoundInfo(moveable, poses, directions, keepRatio, isRequest, datas)), false), __read(getInnerBoundInfo(moveable, innerBoundLineInfos, datas)), false);\r\n    var widthOffsetInfo = getNearOffsetInfo(offsets, 0);\r\n    var heightOffsetInfo = getNearOffsetInfo(offsets, 1);\r\n    return {\r\n        width: {\r\n            isBound: widthOffsetInfo.isBound,\r\n            offset: widthOffsetInfo.offset[0],\r\n        },\r\n        height: {\r\n            isBound: heightOffsetInfo.isBound,\r\n            offset: heightOffsetInfo.offset[1],\r\n        },\r\n    };\r\n}\r\nfunction recheckSizeByTwoDirection(moveable, poses, width, height, maxWidth, maxHeight, direction, isRequest, datas) {\r\n    var snapPos = getPosByDirection(poses, direction);\r\n    var _a = checkMoveableSnapBounds(moveable, isRequest, {\r\n        vertical: [snapPos[0]],\r\n        horizontal: [snapPos[1]],\r\n    }), horizontalOffset = _a.horizontal.offset, verticalOffset = _a.vertical.offset;\r\n    if (throttle(verticalOffset, FLOAT_POINT_NUM) || throttle(horizontalOffset, FLOAT_POINT_NUM)) {\r\n        var _b = __read(getDragDist({\r\n            datas: datas,\r\n            distX: -verticalOffset,\r\n            distY: -horizontalOffset,\r\n        }), 2), nextWidthOffset = _b[0], nextHeightOffset = _b[1];\r\n        var nextWidth = Math.min(maxWidth || Infinity, width + direction[0] * nextWidthOffset);\r\n        var nextHeight = Math.min(maxHeight || Infinity, height + direction[1] * nextHeightOffset);\r\n        return [nextWidth - width, nextHeight - height];\r\n    }\r\n    return [0, 0];\r\n}\r\nfunction checkSizeDist(moveable, getNextPoses, width, height, direction, fixedPosition, isRequest, datas) {\r\n    var poses = getAbsolutePosesByState(moveable.state);\r\n    var keepRatio = moveable.props.keepRatio;\r\n    var widthOffset = 0;\r\n    var heightOffset = 0;\r\n    for (var i = 0; i < 2; ++i) {\r\n        var nextPoses = getNextPoses(widthOffset, heightOffset);\r\n        var _a = getSizeOffsetInfo(moveable, nextPoses, direction, keepRatio, isRequest, datas), widthOffsetInfo = _a.width, heightOffsetInfo = _a.height;\r\n        var isWidthBound = widthOffsetInfo.isBound;\r\n        var isHeightBound = heightOffsetInfo.isBound;\r\n        var nextWidthOffset = widthOffsetInfo.offset;\r\n        var nextHeightOffset = heightOffsetInfo.offset;\r\n        if (i === 1) {\r\n            if (!isWidthBound) {\r\n                nextWidthOffset = 0;\r\n            }\r\n            if (!isHeightBound) {\r\n                nextHeightOffset = 0;\r\n            }\r\n        }\r\n        if (i === 0 && isRequest && !isWidthBound && !isHeightBound) {\r\n            return [0, 0];\r\n        }\r\n        if (keepRatio) {\r\n            var widthDist = abs(nextWidthOffset) * (width ? 1 / width : 1);\r\n            var heightDist = abs(nextHeightOffset) * (height ? 1 / height : 1);\r\n            var isGetWidthOffset = isWidthBound && isHeightBound\r\n                ? widthDist < heightDist\r\n                : isHeightBound ||\r\n                    (!isWidthBound && widthDist < heightDist);\r\n            if (isGetWidthOffset) {\r\n                // width : height = ? : heightOffset\r\n                nextWidthOffset = (width * nextHeightOffset) / height;\r\n            }\r\n            else {\r\n                // width : height = widthOffset : ?\r\n                nextHeightOffset = (height * nextWidthOffset) / width;\r\n            }\r\n        }\r\n        widthOffset += nextWidthOffset;\r\n        heightOffset += nextHeightOffset;\r\n    }\r\n    if (!keepRatio && direction[0] && direction[1]) {\r\n        var _b = checkMaxBounds(moveable, poses, direction, fixedPosition, datas), maxWidth = _b.maxWidth, maxHeight = _b.maxHeight;\r\n        var _c = __read(recheckSizeByTwoDirection(moveable, getNextPoses(widthOffset, heightOffset).map(function (pos) { return pos.map(function (p) { return throttle(p, FLOAT_POINT_NUM); }); }), width + widthOffset, height + heightOffset, maxWidth, maxHeight, direction, isRequest, datas), 2), nextWidthOffset = _c[0], nextHeightOffset = _c[1];\r\n        widthOffset += nextWidthOffset;\r\n        heightOffset += nextHeightOffset;\r\n    }\r\n    return [widthOffset, heightOffset];\r\n}\r\nfunction absDegree(deg) {\r\n    if (deg < 0) {\r\n        deg = deg % 360 + 360;\r\n    }\r\n    deg %= 360;\r\n    return deg;\r\n}\r\nfunction bumpDegree(baseDeg, snapDeg) {\r\n    // baseDeg -80\r\n    // snapDeg 270\r\n    // return -90\r\n    snapDeg = absDegree(snapDeg);\r\n    var count = Math.floor(baseDeg / 360);\r\n    var deg1 = count * 360 + 360 - snapDeg;\r\n    var deg2 = count * 360 + snapDeg;\r\n    return abs(baseDeg - deg1) < abs(baseDeg - deg2) ? deg1 : deg2;\r\n}\r\nfunction getMinDegreeDistance(deg1, deg2) {\r\n    deg1 = absDegree(deg1);\r\n    deg2 = absDegree(deg2);\r\n    var deg3 = absDegree(deg1 - deg2);\r\n    return Math.min(deg3, 360 - deg3);\r\n}\r\nfunction checkSnapRotate(moveable, rect, dist, rotation) {\r\n    var _a;\r\n    var props = moveable.props;\r\n    var snapRotationThreshold = (_a = props[NAME_snapRotationThreshold]) !== null && _a !== void 0 ? _a : 5;\r\n    var snapRotationDegrees = props[NAME_snapRotationDegrees];\r\n    if (hasGuidelines(moveable, \"rotatable\")) {\r\n        var pos1 = rect.pos1, pos2 = rect.pos2, pos3 = rect.pos3, pos4 = rect.pos4, origin2_1 = rect.origin;\r\n        var rad_1 = (dist * Math.PI) / 180;\r\n        var prevPoses = [pos1, pos2, pos3, pos4].map(function (pos) { return minus(pos, origin2_1); });\r\n        var nextPoses = prevPoses.map(function (pos) { return rotate(pos, rad_1); });\r\n        // console.log(moveable.state.left, moveable.state.top, moveable.state.origin);\r\n        // console.log(pos1, pos2, pos3, pos4, origin, rad, prevPoses, nextPoses);\r\n        var result = __spreadArray(__spreadArray([], __read(checkRotateBounds(moveable, prevPoses, nextPoses, origin2_1, dist)), false), __read(checkRotateInnerBounds(moveable, prevPoses, nextPoses, origin2_1, dist)), false);\r\n        result.sort(function (a, b) { return abs(a - dist) - abs(b - dist); });\r\n        var isSnap = result.length > 0;\r\n        if (isSnap) {\r\n            return {\r\n                isSnap: isSnap,\r\n                dist: isSnap ? result[0] : dist,\r\n            };\r\n        }\r\n    }\r\n    if ((snapRotationDegrees === null || snapRotationDegrees === void 0 ? void 0 : snapRotationDegrees.length) && snapRotationThreshold) {\r\n        var sorted = snapRotationDegrees.slice().sort(function (a, b) {\r\n            return getMinDegreeDistance(a, rotation) - getMinDegreeDistance(b, rotation);\r\n        });\r\n        var firstDegree = sorted[0];\r\n        if (getMinDegreeDistance(firstDegree, rotation) <= snapRotationThreshold) {\r\n            return {\r\n                isSnap: true,\r\n                dist: dist + bumpDegree(rotation, firstDegree) - rotation,\r\n            };\r\n        }\r\n    }\r\n    return {\r\n        isSnap: false,\r\n        dist: dist,\r\n    };\r\n}\r\nfunction checkSnapResize(moveable, width, height, direction, fixedPosition, isRequest, datas) {\r\n    if (!hasGuidelines(moveable, \"resizable\")) {\r\n        return [0, 0];\r\n    }\r\n    var fixedDirection = datas.fixedDirection, nextAllMatrix = datas.nextAllMatrix;\r\n    var _a = moveable.state, allMatrix = _a.allMatrix, is3d = _a.is3d;\r\n    return checkSizeDist(moveable, function (widthOffset, heightOffset) {\r\n        return getNextFixedPoses(nextAllMatrix || allMatrix, width + widthOffset, height + heightOffset, fixedDirection, fixedPosition, is3d);\r\n    }, width, height, direction, fixedPosition, isRequest, datas);\r\n}\r\nfunction checkSnapScale(moveable, scale, direction, isRequest, datas) {\r\n    if (!hasGuidelines(moveable, \"scalable\")) {\r\n        return [0, 0];\r\n    }\r\n    var startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, fixedPosition = datas.fixedPosition, fixedDirection = datas.fixedDirection, is3d = datas.is3d;\r\n    var sizeDist = checkSizeDist(moveable, function (widthOffset, heightOffset) {\r\n        return getNextFixedPoses(scaleMatrix(datas, plus(scale, [widthOffset / startOffsetWidth, heightOffset / startOffsetHeight])), startOffsetWidth, startOffsetHeight, fixedDirection, fixedPosition, is3d);\r\n    }, startOffsetWidth, startOffsetHeight, direction, fixedPosition, isRequest, datas);\r\n    return [sizeDist[0] / startOffsetWidth, sizeDist[1] / startOffsetHeight];\r\n}\r\nfunction startCheckSnapDrag(moveable, datas) {\r\n    datas.absolutePoses = getAbsolutePosesByState(moveable.state);\r\n}\r\nfunction getSnapGuidelines(posInfos) {\r\n    var guidelines = [];\r\n    posInfos.forEach(function (posInfo) {\r\n        posInfo.guidelineInfos.forEach(function (_a) {\r\n            var guideline = _a.guideline;\r\n            if (find(guidelines, function (info) { return info.guideline === guideline; })) {\r\n                return;\r\n            }\r\n            guideline.direction = \"\";\r\n            guidelines.push({ guideline: guideline, posInfo: posInfo });\r\n        });\r\n    });\r\n    return guidelines.map(function (_a) {\r\n        var guideline = _a.guideline, posInfo = _a.posInfo;\r\n        return __assign(__assign({}, guideline), { direction: posInfo.direction });\r\n    });\r\n}\r\nfunction addBoundGuidelines(moveable, verticalPoses, horizontalPoses, verticalSnapPoses, horizontalSnapPoses, externalBounds) {\r\n    var _a = checkBoundPoses(getBounds(moveable, externalBounds), verticalPoses, horizontalPoses), verticalBoundInfos = _a.vertical, horizontalBoundInfos = _a.horizontal;\r\n    var boundMap = getInitialBounds();\r\n    verticalBoundInfos.forEach(function (info) {\r\n        if (info.isBound) {\r\n            if (info.direction === \"start\") {\r\n                boundMap.left = true;\r\n            }\r\n            if (info.direction === \"end\") {\r\n                boundMap.right = true;\r\n            }\r\n            verticalSnapPoses.push({\r\n                type: \"bounds\",\r\n                pos: info.pos,\r\n            });\r\n        }\r\n    });\r\n    horizontalBoundInfos.forEach(function (info) {\r\n        if (info.isBound) {\r\n            if (info.direction === \"start\") {\r\n                boundMap.top = true;\r\n            }\r\n            if (info.direction === \"end\") {\r\n                boundMap.bottom = true;\r\n            }\r\n            horizontalSnapPoses.push({\r\n                type: \"bounds\",\r\n                pos: info.pos,\r\n            });\r\n        }\r\n    });\r\n    var _b = checkInnerBoundPoses(moveable), innerBoundMap = _b.boundMap, verticalInnerBoundPoses = _b.vertical, horizontalInnerBoundPoses = _b.horizontal;\r\n    verticalInnerBoundPoses.forEach(function (innerPos) {\r\n        if (findIndex(verticalSnapPoses, function (_a) {\r\n            var type = _a.type, pos = _a.pos;\r\n            return type === \"bounds\" && pos === innerPos;\r\n        }) >= 0) {\r\n            return;\r\n        }\r\n        verticalSnapPoses.push({\r\n            type: \"bounds\",\r\n            pos: innerPos,\r\n        });\r\n    });\r\n    horizontalInnerBoundPoses.forEach(function (innerPos) {\r\n        if (findIndex(horizontalSnapPoses, function (_a) {\r\n            var type = _a.type, pos = _a.pos;\r\n            return type === \"bounds\" && pos === innerPos;\r\n        }) >= 0) {\r\n            return;\r\n        }\r\n        horizontalSnapPoses.push({\r\n            type: \"bounds\",\r\n            pos: innerPos,\r\n        });\r\n    });\r\n    return {\r\n        boundMap: boundMap,\r\n        innerBoundMap: innerBoundMap,\r\n    };\r\n}\r\nvar directionCondition$1 = getDirectionCondition(\"\", [\"resizable\", \"scalable\"]);\r\n/**\r\n * @namespace Moveable.Snappable\r\n * @description Whether or not target can be snapped to the guideline. (default: false)\r\n * @sort 2\r\n */\r\nvar Snappable = {\r\n    name: \"snappable\",\r\n    dragRelation: \"strong\",\r\n    props: [\r\n        \"snappable\",\r\n        \"snapContainer\",\r\n        \"snapDirections\",\r\n        \"elementSnapDirections\",\r\n        \"snapGap\",\r\n        \"snapGridWidth\",\r\n        \"snapGridHeight\",\r\n        \"isDisplaySnapDigit\",\r\n        \"isDisplayInnerSnapDigit\",\r\n        \"isDisplayGridGuidelines\",\r\n        \"snapDigit\",\r\n        \"snapThreshold\",\r\n        \"snapRenderThreshold\",\r\n        \"snapGridAll\",\r\n        NAME_snapRotationThreshold,\r\n        NAME_snapRotationDegrees,\r\n        NAME_snapHorizontalThreshold,\r\n        NAME_snapVerticalThreshold,\r\n        \"horizontalGuidelines\",\r\n        \"verticalGuidelines\",\r\n        \"elementGuidelines\",\r\n        \"bounds\",\r\n        \"innerBounds\",\r\n        \"snapDistFormat\",\r\n        \"maxSnapElementGuidelineDistance\",\r\n        \"maxSnapElementGapDistance\",\r\n    ],\r\n    events: [\"snap\", \"bound\"],\r\n    css: [\r\n        \":host {\\n--bounds-color: #d66;\\n}\\n.guideline {\\npointer-events: none;\\nz-index: 2;\\n}\\n.guideline.bounds {\\nbackground: #d66;\\nbackground: var(--bounds-color);\\n}\\n.guideline-group {\\nposition: absolute;\\ntop: 0;\\nleft: 0;\\n}\\n.guideline-group .size-value {\\nposition: absolute;\\ncolor: #f55;\\nfont-size: 12px;\\nfont-size: calc(12px * var(--zoom));\\nfont-weight: bold;\\n}\\n.guideline-group.horizontal .size-value {\\ntransform-origin: 50% 100%;\\ntransform: translateX(-50%);\\nleft: 50%;\\nbottom: 5px;\\nbottom: calc(2px + 3px * var(--zoom));\\n}\\n.guideline-group.vertical .size-value {\\ntransform-origin: 0% 50%;\\ntop: 50%;\\ntransform: translateY(-50%);\\nleft: 5px;\\nleft: calc(2px + 3px * var(--zoom));\\n}\\n.guideline.gap {\\nbackground: #f55;\\n}\\n.size-value.gap {\\ncolor: #f55;\\n}\\n\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var state = moveable.state;\r\n        var targetTop = state.top, targetLeft = state.left, pos1 = state.pos1, pos2 = state.pos2, pos3 = state.pos3, pos4 = state.pos4, snapRenderInfo = state.snapRenderInfo;\r\n        var _a = moveable.props.snapRenderThreshold, snapRenderThreshold = _a === void 0 ? 1 : _a;\r\n        if (!snapRenderInfo || !snapRenderInfo.render || !hasGuidelines(moveable, \"\")) {\r\n            // reset store\r\n            watchValue(moveable, \"boundMap\", getInitialBounds(), function (v) { return JSON.stringify(v); });\r\n            watchValue(moveable, \"innerBoundMap\", getInitialBounds(), function (v) { return JSON.stringify(v); });\r\n            return [];\r\n        }\r\n        state.guidelines = getTotalGuidelines(moveable);\r\n        var minLeft = Math.min(pos1[0], pos2[0], pos3[0], pos4[0]);\r\n        var minTop = Math.min(pos1[1], pos2[1], pos3[1], pos4[1]);\r\n        var externalPoses = snapRenderInfo.externalPoses || [];\r\n        var poses = getAbsolutePosesByState(moveable.state);\r\n        var verticalSnapPoses = [];\r\n        var horizontalSnapPoses = [];\r\n        var verticalGuidelines = [];\r\n        var horizontalGuidelines = [];\r\n        var snapInfos = [];\r\n        var _b = getRect(poses), width = _b.width, height = _b.height, top = _b.top, left = _b.left, bottom = _b.bottom, right = _b.right;\r\n        var targetRect = { left: left, right: right, top: top, bottom: bottom, center: (left + right) / 2, middle: (top + bottom) / 2 };\r\n        var hasExternalPoses = externalPoses.length > 0;\r\n        var externalRect = hasExternalPoses\r\n            ? getRect(externalPoses)\r\n            : {};\r\n        if (!snapRenderInfo.request) {\r\n            if (snapRenderInfo.direction) {\r\n                snapInfos.push(getSnapInfosByDirection(moveable, poses, snapRenderInfo.direction, snapRenderThreshold, snapRenderThreshold));\r\n            }\r\n            if (snapRenderInfo.snap) {\r\n                var rect = getRect(poses);\r\n                if (snapRenderInfo.center) {\r\n                    rect.middle = (rect.top + rect.bottom) / 2;\r\n                    rect.center = (rect.left + rect.right) / 2;\r\n                }\r\n                snapInfos.push(checkSnaps(moveable, rect, snapRenderThreshold, snapRenderThreshold));\r\n            }\r\n            if (hasExternalPoses) {\r\n                if (snapRenderInfo.center) {\r\n                    externalRect.middle =\r\n                        (externalRect.top + externalRect.bottom) / 2;\r\n                    externalRect.center =\r\n                        (externalRect.left + externalRect.right) / 2;\r\n                }\r\n                snapInfos.push(checkSnaps(moveable, externalRect, snapRenderThreshold, snapRenderThreshold));\r\n            }\r\n            snapInfos.forEach(function (snapInfo) {\r\n                var verticalPosInfos = snapInfo.vertical.posInfos, horizontalPosInfos = snapInfo.horizontal.posInfos;\r\n                verticalSnapPoses.push.apply(verticalSnapPoses, __spreadArray([], __read(verticalPosInfos.filter(function (_a) {\r\n                    var guidelineInfos = _a.guidelineInfos;\r\n                    return guidelineInfos.some(function (_a) {\r\n                        var guideline = _a.guideline;\r\n                        return !guideline.hide;\r\n                    });\r\n                }).map(function (posInfo) { return ({\r\n                    type: \"snap\",\r\n                    pos: posInfo.pos,\r\n                }); })), false));\r\n                horizontalSnapPoses.push.apply(horizontalSnapPoses, __spreadArray([], __read(horizontalPosInfos.filter(function (_a) {\r\n                    var guidelineInfos = _a.guidelineInfos;\r\n                    return guidelineInfos.some(function (_a) {\r\n                        var guideline = _a.guideline;\r\n                        return !guideline.hide;\r\n                    });\r\n                }).map(function (posInfo) { return ({\r\n                    type: \"snap\",\r\n                    pos: posInfo.pos,\r\n                }); })), false));\r\n                verticalGuidelines.push.apply(verticalGuidelines, __spreadArray([], __read(getSnapGuidelines(verticalPosInfos)), false));\r\n                horizontalGuidelines.push.apply(horizontalGuidelines, __spreadArray([], __read(getSnapGuidelines(horizontalPosInfos)), false));\r\n            });\r\n        }\r\n        var _c = addBoundGuidelines(moveable, [left, right], [top, bottom], verticalSnapPoses, horizontalSnapPoses), boundMap = _c.boundMap, innerBoundMap = _c.innerBoundMap;\r\n        if (hasExternalPoses) {\r\n            addBoundGuidelines(moveable, [externalRect.left, externalRect.right], [externalRect.top, externalRect.bottom], verticalSnapPoses, horizontalSnapPoses, snapRenderInfo.externalBounds);\r\n        }\r\n        var allGuidelines = __spreadArray(__spreadArray([], __read(verticalGuidelines), false), __read(horizontalGuidelines), false);\r\n        var elementGuidelines = allGuidelines.filter(function (guideline) { return guideline.element && !guideline.gapRects; });\r\n        var gapGuidelines = allGuidelines.filter(function (guideline) { return guideline.gapRects; }).sort(function (a, b) {\r\n            return a.gap - b.gap;\r\n        });\r\n        triggerEvent(moveable, \"onSnap\", {\r\n            guidelines: allGuidelines.filter(function (_a) {\r\n                var element = _a.element;\r\n                return !element;\r\n            }),\r\n            elements: elementGuidelines,\r\n            gaps: gapGuidelines,\r\n        }, true);\r\n        var nextBoundMap = watchValue(moveable, \"boundMap\", boundMap, function (v) { return JSON.stringify(v); }, getInitialBounds());\r\n        var nextInnerBoundMap = watchValue(moveable, \"innerBoundMap\", innerBoundMap, function (v) { return JSON.stringify(v); }, getInitialBounds());\r\n        if (boundMap === nextBoundMap || innerBoundMap === nextInnerBoundMap) {\r\n            triggerEvent(moveable, \"onBound\", {\r\n                bounds: boundMap,\r\n                innerBounds: innerBoundMap,\r\n            }, true);\r\n        }\r\n        // verticalSnapPoses.\r\n        return __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], __read(renderDashedGuidelines(moveable, elementGuidelines, [minLeft, minTop], targetRect, React)), false), __read(renderGapGuidelines(moveable, gapGuidelines, [minLeft, minTop], targetRect, React)), false), __read(renderGuidelines(moveable, \"horizontal\", horizontalGuidelines, [targetLeft, targetTop], targetRect, React)), false), __read(renderGuidelines(moveable, \"vertical\", verticalGuidelines, [targetLeft, targetTop], targetRect, React)), false), __read(renderSnapPoses(moveable, \"horizontal\", horizontalSnapPoses, minLeft, targetTop, width, 0, React)), false), __read(renderSnapPoses(moveable, \"vertical\", verticalSnapPoses, minTop, targetLeft, height, 1, React)), false);\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        moveable.state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n            snap: true,\r\n            center: true,\r\n        };\r\n        checkSnapInfo(moveable);\r\n    },\r\n    drag: function (moveable) {\r\n        var state = moveable.state;\r\n        if (!checkSnapInfo(moveable)) {\r\n            state.guidelines = getTotalGuidelines(moveable);\r\n        }\r\n        if (state.snapRenderInfo) {\r\n            state.snapRenderInfo.render = true;\r\n        }\r\n    },\r\n    pinchStart: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        if (directionCondition$1(moveable, e) || dragControlCondition(moveable, e)) {\r\n            return true;\r\n        }\r\n        if (!e.isRequest && e.inputEvent) {\r\n            return hasClass(e.inputEvent.target, prefix(\"snap-control\"));\r\n        }\r\n    },\r\n    dragControlStart: function (moveable) {\r\n        moveable.state.snapRenderInfo = null;\r\n        checkSnapInfo(moveable);\r\n    },\r\n    dragControl: function (moveable) {\r\n        this.drag(moveable);\r\n    },\r\n    dragControlEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        this.dragStart(moveable, e);\r\n    },\r\n    dragGroup: function (moveable) {\r\n        this.drag(moveable);\r\n    },\r\n    dragGroupEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragGroupControlStart: function (moveable) {\r\n        moveable.state.snapRenderInfo = null;\r\n        checkSnapInfo(moveable);\r\n    },\r\n    dragGroupControl: function (moveable) {\r\n        this.drag(moveable);\r\n    },\r\n    dragGroupControlEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    unset: function (moveable) {\r\n        var state = moveable.state;\r\n        state.enableSnap = false;\r\n        state.guidelines = [];\r\n        state.snapRenderInfo = null;\r\n        state.elementRects = [];\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be snapped to the guideline. (default: false)\r\n * @name Moveable.Snappable#snappable\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snappable = true;\r\n */\r\n/**\r\n *  A snap container that is the basis for snap, bounds, and innerBounds. (default: null = container)\r\n * @name Moveable.Snappable#snapContainer\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.querySelector(\".container\"));\r\n *\r\n * moveable.snapContainer = document.body;\r\n */\r\n/**\r\n * You can specify the directions to snap to the target. (default: { left: true, top: true, right: true, bottom: true })\r\n * @name Moveable.Snappable#snapDirections\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   snappable: true,\r\n *   snapDirections: true,\r\n * });\r\n * // snap center\r\n * moveable.snapDirections = { left: true, top: true, right: true, bottom: true, center: true, middle: true };\r\n */\r\n/**\r\n * You can specify the snap directions of elements. (default: { left: true, ftrue, right: true, bottom: true })\r\n * @name Moveable.Snappable#elementSnapDirections\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   snappable: true,\r\n *   elementSnapDirections: true,\r\n * });\r\n * // snap center\r\n * moveable.elementSnapDirections = { left: true, top: true, right: true, bottom: true, center: true, middle: true };\r\n */\r\n/**\r\n * When you drag, make the gap snap in the element guidelines. (default: true)\r\n * @name Moveable.Snappable#snapGap\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   snappable: true,\r\n *   snapElement: true,\r\n *   snapGap: true,\r\n * });\r\n *\r\n * moveable.snapGap = false;\r\n */\r\n/**\r\n * Distance value that can snap to guidelines. (default: 5)\r\n * @name Moveable.Snappable#snapThreshold\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapThreshold = 5;\r\n */\r\n/**\r\n * Add guidelines in the horizontal direction. (default: [])\r\n * @name Moveable.Snappable#horizontalGuidelines\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.horizontalGuidelines = [100, 200, 500];\r\n */\r\n/**\r\n * Add guidelines in the vertical direction. (default: [])\r\n * @name Moveable.Snappable#verticalGuidelines\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.verticalGuidelines = [100, 200, 500];\r\n */\r\n/**\r\n * Add guidelines for the element. (default: [])\r\n * @name Moveable.Snappable#elementGuidelines\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.elementGuidelines = [\r\n *   document.querySelector(\".element\"),\r\n * ];\r\n */\r\n/**\r\n * You can set up boundaries.\r\n * @name Moveable.Snappable#bounds\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @default null\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.bounds = { left: 0, right: 1000, top: 0, bottom: 1000};\r\n */\r\n/**\r\n * You can set up inner boundaries.\r\n * @name Moveable.Snappable#innerBounds\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @default null\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.innerBounds = { left: 500, top: 500, width: 100, height: 100};\r\n */\r\n/**\r\n * snap distance digits (default: 0)\r\n * @name Moveable.Snappable#snapDigit\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapDigit = 0\r\n */\r\n/**\r\n * If width size is greater than 0, you can vertical snap to the grid. (default: 0)\r\n * @name Moveable.Snappable#snapGridWidth\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapGridWidth = 5;\r\n */\r\n/**\r\n * If height size is greater than 0, you can horizontal snap to the grid. (default: 0)\r\n * @name Moveable.Snappable#snapGridHeight\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapGridHeight = 5;\r\n */\r\n/**\r\n * Whether to show snap distance (default: true)\r\n * @name Moveable.Snappable#isDisplaySnapDigit\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.isDisplaySnapDigit = true;\r\n */\r\n/**\r\n * Whether to show element inner snap distance (default: false)\r\n * @name Moveable.Snappable#isDisplayInnerSnapDigit\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.isDisplayInnerSnapDigit = true;\r\n */\r\n/**\r\n * You can set the text format of the distance shown in the guidelines. (default: self)\r\n * @name Moveable.Snappable#snapDistFormat\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  snappable: true,\r\n *  snapDistFormat: (v, type) => v,\r\n * });\r\n * moveable.snapDistFormat = (v, type) => `${v}px`;\r\n */\r\n/**\r\n * When you drag or dragControl, the `snap` event is called.\r\n * @memberof Moveable.Snappable\r\n * @event snap\r\n * @param {Moveable.Snappable.OnSnap} - Parameters for the `snap` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     snappable: true\r\n * });\r\n * moveable.on(\"snap\", e => {\r\n *     console.log(\"onSnap\", e);\r\n * });\r\n */\n\nfunction multiply2(pos1, pos2) {\r\n    return [\r\n        pos1[0] * pos2[0],\r\n        pos1[1] * pos2[1],\r\n    ];\r\n}\r\nfunction prefix() {\r\n    var classNames = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        classNames[_i] = arguments[_i];\r\n    }\r\n    return prefixNames.apply(void 0, __spreadArray([PREFIX], __read(classNames), false));\r\n}\r\nfunction defaultSync(fn) {\r\n    fn();\r\n}\r\nfunction getTransformMatrix(transform) {\r\n    if (!transform || transform === \"none\") {\r\n        return [1, 0, 0, 1, 0, 0];\r\n    }\r\n    if (isObject(transform)) {\r\n        return transform;\r\n    }\r\n    return parseMat(transform);\r\n}\r\nfunction getAbsoluteMatrix(matrix, n, origin) {\r\n    return multiplies(n, createOriginMatrix(origin, n), matrix, createOriginMatrix(origin.map(function (a) { return -a; }), n));\r\n}\r\nfunction measureSVGSize(el, unit, isHorizontal) {\r\n    if (unit === \"%\") {\r\n        var viewBox = getSVGViewBox(el.ownerSVGElement);\r\n        return viewBox[isHorizontal ? \"width\" : \"height\"] / 100;\r\n    }\r\n    return 1;\r\n}\r\nfunction getBeforeTransformOrigin(el) {\r\n    var relativeOrigin = getTransformOrigin(getComputedStyle(el, \":before\"));\r\n    return relativeOrigin.map(function (o, i) {\r\n        var _a = splitUnit(o), value = _a.value, unit = _a.unit;\r\n        return value * measureSVGSize(el, unit, i === 0);\r\n    });\r\n}\r\nfunction getTransformOriginArray(transformOrigin) {\r\n    return transformOrigin ? transformOrigin.split(\" \") : [\"0\", \"0\"];\r\n}\r\nfunction getTransformOrigin(style) {\r\n    return getTransformOriginArray(style.transformOrigin);\r\n}\r\nfunction getElementTransform(target) {\r\n    var getStyle = getCachedStyle(target);\r\n    var computedTransform = getStyle(\"transform\");\r\n    if (computedTransform && computedTransform !== \"none\") {\r\n        return computedTransform;\r\n    }\r\n    if (\"transform\" in target) {\r\n        var list = target.transform;\r\n        var baseVal = list.baseVal;\r\n        if (!baseVal) {\r\n            return \"\";\r\n        }\r\n        var length_1 = baseVal.length;\r\n        if (!length_1) {\r\n            return \"\";\r\n        }\r\n        var matrixes = [];\r\n        var _loop_1 = function (i) {\r\n            var matrix = baseVal[i].matrix;\r\n            matrixes.push(\"matrix(\".concat([\"a\", \"b\", \"c\", \"d\", \"e\", \"f\"].map(function (chr) { return matrix[chr]; }).join(\", \"), \")\"));\r\n        };\r\n        for (var i = 0; i < length_1; ++i) {\r\n            _loop_1(i);\r\n        }\r\n        return matrixes.join(\" \");\r\n    }\r\n    return \"\";\r\n}\r\nfunction getOffsetInfo(el, lastParent, isParent, checkZoom, getTargetStyle) {\r\n    var _a, _b;\r\n    var documentElement = getDocumentElement(el) || getDocumentBody(el);\r\n    var hasSlot = false;\r\n    var target;\r\n    var parentSlotElement;\r\n    if (!el || isParent) {\r\n        target = el;\r\n    }\r\n    else {\r\n        var assignedSlotParentElement = (_a = el === null || el === void 0 ? void 0 : el.assignedSlot) === null || _a === void 0 ? void 0 : _a.parentElement;\r\n        var parentElement = el.parentElement;\r\n        if (assignedSlotParentElement) {\r\n            hasSlot = true;\r\n            parentSlotElement = parentElement;\r\n            target = assignedSlotParentElement;\r\n        }\r\n        else {\r\n            target = parentElement;\r\n        }\r\n    }\r\n    var isCustomElement = false;\r\n    var isEnd = el === lastParent || target === lastParent;\r\n    var position = \"relative\";\r\n    var offsetZoom = 1;\r\n    var targetZoom = parseFloat(getTargetStyle === null || getTargetStyle === void 0 ? void 0 : getTargetStyle(\"zoom\")) || 1;\r\n    var targetPosition = getTargetStyle === null || getTargetStyle === void 0 ? void 0 : getTargetStyle(\"position\");\r\n    while (target && target !== documentElement) {\r\n        if (lastParent === target) {\r\n            isEnd = true;\r\n        }\r\n        var getStyle = getCachedStyle(target);\r\n        var tagName = target.tagName.toLowerCase();\r\n        var transform = getElementTransform(target);\r\n        var willChange = getStyle(\"willChange\");\r\n        var zoom = parseFloat(getStyle(\"zoom\")) || 1;\r\n        position = getStyle(\"position\");\r\n        if (checkZoom && zoom !== 1) {\r\n            offsetZoom = zoom;\r\n            break;\r\n        }\r\n        if (\r\n        // offsetParent is the parentElement if the target's zoom is not 1 and not absolute.\r\n        !isParent && checkZoom && targetZoom !== 1 && targetPosition && targetPosition !== \"absolute\"\r\n            || tagName === \"svg\"\r\n            || tagName === \"foreignobject\"\r\n            || position !== \"static\"\r\n            || (transform && transform !== \"none\")\r\n            || willChange === \"transform\") {\r\n            break;\r\n        }\r\n        var slotParentNode = (_b = el === null || el === void 0 ? void 0 : el.assignedSlot) === null || _b === void 0 ? void 0 : _b.parentNode;\r\n        var targetParentNode = target.parentNode;\r\n        if (slotParentNode) {\r\n            hasSlot = true;\r\n            parentSlotElement = targetParentNode;\r\n        }\r\n        var parentNode = targetParentNode;\r\n        if (parentNode && parentNode.nodeType === 11) {\r\n            // Shadow Root\r\n            target = parentNode.host;\r\n            isCustomElement = true;\r\n            position = getCachedStyle(target)(\"position\");\r\n            break;\r\n        }\r\n        target = parentNode;\r\n        position = \"relative\";\r\n    }\r\n    return {\r\n        offsetZoom: offsetZoom,\r\n        hasSlot: hasSlot,\r\n        parentSlotElement: parentSlotElement,\r\n        isCustomElement: isCustomElement,\r\n        isStatic: position === \"static\",\r\n        isEnd: isEnd || !target || target === documentElement,\r\n        offsetParent: target || documentElement,\r\n    };\r\n}\r\nfunction getOffsetPosInfo(el, target) {\r\n    var _a;\r\n    var tagName = el.tagName.toLowerCase();\r\n    var offsetLeft = el.offsetLeft;\r\n    var offsetTop = el.offsetTop;\r\n    var getStyle = getCachedStyle(el);\r\n    // svg\r\n    var isSVG = isUndefined(offsetLeft);\r\n    var hasOffset = !isSVG;\r\n    var origin;\r\n    var targetOrigin;\r\n    // inner svg element\r\n    if (!hasOffset && (tagName !== \"svg\" || el.ownerSVGElement)) {\r\n        origin = IS_WEBKIT605\r\n            ? getBeforeTransformOrigin(el)\r\n            : getTransformOriginArray(getStyle(\"transformOrigin\")).map(function (pos) { return parseFloat(pos); });\r\n        targetOrigin = origin.slice();\r\n        hasOffset = true;\r\n        if (tagName === \"svg\") {\r\n            offsetLeft = 0;\r\n            offsetTop = 0;\r\n        }\r\n        else {\r\n            _a = __read(getSVGGraphicsOffset(el, origin, el === target && target.tagName.toLowerCase() === \"g\"), 4), offsetLeft = _a[0], offsetTop = _a[1], origin[0] = _a[2], origin[1] = _a[3];\r\n        }\r\n    }\r\n    else {\r\n        origin = getTransformOriginArray(getStyle(\"transformOrigin\")).map(function (pos) { return parseFloat(pos); });\r\n        targetOrigin = origin.slice();\r\n        // console.log(getStyle(\"transformOrigin\"), targetOrigin);\r\n    }\r\n    return {\r\n        tagName: tagName,\r\n        isSVG: isSVG,\r\n        hasOffset: hasOffset,\r\n        offset: [offsetLeft || 0, offsetTop || 0],\r\n        origin: origin,\r\n        targetOrigin: targetOrigin,\r\n    };\r\n}\r\nfunction getBodyOffset(el, isSVG) {\r\n    var getStyle = getCachedStyle(el);\r\n    var getBodyStyle = getCachedStyle(getDocumentBody(el));\r\n    var bodyPosition = getBodyStyle(\"position\");\r\n    if (!isSVG && (!bodyPosition || bodyPosition === \"static\")) {\r\n        return [0, 0];\r\n    }\r\n    var marginLeft = parseInt(getBodyStyle(\"marginLeft\"), 10);\r\n    var marginTop = parseInt(getBodyStyle(\"marginTop\"), 10);\r\n    if (getStyle(\"position\") === \"absolute\") {\r\n        if (getStyle(\"top\") !== \"auto\" || getStyle(\"bottom\") !== \"auto\") {\r\n            marginTop = 0;\r\n        }\r\n        if (getStyle(\"left\") !== \"auto\" || getStyle(\"right\") !== \"auto\") {\r\n            marginLeft = 0;\r\n        }\r\n    }\r\n    return [marginLeft, marginTop];\r\n}\r\nfunction convert3DMatrixes(matrixes) {\r\n    matrixes.forEach(function (info) {\r\n        var matrix = info.matrix;\r\n        if (matrix) {\r\n            info.matrix = convertDimension(matrix, 3, 4);\r\n        }\r\n    });\r\n}\r\nfunction getPositionFixedInfo(el) {\r\n    var fixedContainer = el.parentElement;\r\n    var hasTransform = false;\r\n    var body = getDocumentBody(el);\r\n    while (fixedContainer) {\r\n        var transform = getComputedStyle(fixedContainer).transform;\r\n        if (transform && transform !== \"none\") {\r\n            hasTransform = true;\r\n            break;\r\n        }\r\n        if (fixedContainer === body) {\r\n            break;\r\n        }\r\n        fixedContainer = fixedContainer.parentElement;\r\n    }\r\n    return {\r\n        fixedContainer: fixedContainer || body,\r\n        hasTransform: hasTransform,\r\n    };\r\n}\r\nfunction makeMatrixCSS(matrix, is3d) {\r\n    if (is3d === void 0) { is3d = matrix.length > 9; }\r\n    return \"\".concat(is3d ? \"matrix3d\" : \"matrix\", \"(\").concat(convertMatrixtoCSS(matrix, !is3d).join(\",\"), \")\");\r\n}\r\nfunction getSVGViewBox(el) {\r\n    var clientWidth = el.clientWidth;\r\n    var clientHeight = el.clientHeight;\r\n    if (!el) {\r\n        return { x: 0, y: 0, width: 0, height: 0, clientWidth: clientWidth, clientHeight: clientHeight };\r\n    }\r\n    var viewBox = el.viewBox;\r\n    var baseVal = (viewBox && viewBox.baseVal) || { x: 0, y: 0, width: 0, height: 0 };\r\n    return {\r\n        x: baseVal.x,\r\n        y: baseVal.y,\r\n        width: baseVal.width || clientWidth,\r\n        height: baseVal.height || clientHeight,\r\n        clientWidth: clientWidth,\r\n        clientHeight: clientHeight,\r\n    };\r\n}\r\nfunction getSVGMatrix(el, n) {\r\n    var _a;\r\n    var _b = getSVGViewBox(el), viewBoxWidth = _b.width, viewBoxHeight = _b.height, clientWidth = _b.clientWidth, clientHeight = _b.clientHeight;\r\n    var scaleX = clientWidth / viewBoxWidth;\r\n    var scaleY = clientHeight / viewBoxHeight;\r\n    var preserveAspectRatio = el.preserveAspectRatio.baseVal;\r\n    // https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/preserveAspectRatio\r\n    var align = preserveAspectRatio.align;\r\n    // 1 : meet 2: slice\r\n    var meetOrSlice = preserveAspectRatio.meetOrSlice;\r\n    var svgOrigin = [0, 0];\r\n    var scale = [scaleX, scaleY];\r\n    var translate = [0, 0];\r\n    if (align !== 1) {\r\n        var xAlign = (align - 2) % 3;\r\n        var yAlign = Math.floor((align - 2) / 3);\r\n        svgOrigin[0] = viewBoxWidth * xAlign / 2;\r\n        svgOrigin[1] = viewBoxHeight * yAlign / 2;\r\n        var scaleDimension = meetOrSlice === 2 ? Math.max(scaleY, scaleX) : Math.min(scaleX, scaleY);\r\n        scale[0] = scaleDimension;\r\n        scale[1] = scaleDimension;\r\n        translate[0] = (clientWidth - viewBoxWidth) / 2 * xAlign;\r\n        translate[1] = (clientHeight - viewBoxHeight) / 2 * yAlign;\r\n    }\r\n    var scaleMatrix = createScaleMatrix(scale, n);\r\n    _a = __read(translate, 2), scaleMatrix[n * (n - 1)] = _a[0], scaleMatrix[n * (n - 1) + 1] = _a[1];\r\n    return getAbsoluteMatrix(scaleMatrix, n, svgOrigin);\r\n}\r\nfunction getSVGGraphicsOffset(el, origin, isGTarget) {\r\n    var tagName = el.tagName.toLowerCase();\r\n    if (!el.getBBox || !isGTarget && tagName === \"g\") {\r\n        return [0, 0, 0, 0];\r\n    }\r\n    var getStyle = getCachedStyle(el);\r\n    var isFillBox = getStyle(\"transform-box\") === \"fill-box\";\r\n    var bbox = el.getBBox();\r\n    var viewBox = getSVGViewBox(el.ownerSVGElement);\r\n    var x = bbox.x;\r\n    var y = bbox.y;\r\n    // x, y 0  \r\n    if (tagName === \"foreignobject\" && (!x && !y)) {\r\n        x = parseFloat(el.getAttribute(\"x\")) || 0;\r\n        y = parseFloat(el.getAttribute(\"y\")) || 0;\r\n    }\r\n    var left = x - viewBox.x;\r\n    var top = y - viewBox.y;\r\n    var originX = isFillBox ? origin[0] : origin[0] - left;\r\n    var originY = isFillBox ? origin[1] : origin[1] - top;\r\n    // if (isFillBox) {\r\n    //     const bbox = (el as SVGGraphicsElement).getBBox();\r\n    //     const x = parseFloat(getStyle(\"x\")) || bbox.x;\r\n    //     const y = parseFloat(getStyle(\"y\")) || bbox.y;\r\n    //     const xScale = bbox.x / x;\r\n    //     const yScale = bbox.y / y;\r\n    //     console.log(x, y);\r\n    //     originX *= xScale;\r\n    //     originY *= yScale;\r\n    // }\r\n    return [left, top, originX, originY];\r\n}\r\nfunction calculatePosition(matrix, pos, n) {\r\n    return calculate(matrix, convertPositionMatrix(pos, n), n);\r\n}\r\nfunction calculatePoses(matrix, width, height, n) {\r\n    return [[0, 0], [width, 0], [0, height], [width, height]].map(function (pos) { return calculatePosition(matrix, pos, n); });\r\n}\r\nfunction getRect(poses) {\r\n    var posesX = poses.map(function (pos) { return pos[0]; });\r\n    var posesY = poses.map(function (pos) { return pos[1]; });\r\n    var left = Math.min.apply(Math, __spreadArray([], __read(posesX), false));\r\n    var top = Math.min.apply(Math, __spreadArray([], __read(posesY), false));\r\n    var right = Math.max.apply(Math, __spreadArray([], __read(posesX), false));\r\n    var bottom = Math.max.apply(Math, __spreadArray([], __read(posesY), false));\r\n    var rectWidth = right - left;\r\n    var rectHeight = bottom - top;\r\n    return {\r\n        left: left,\r\n        top: top,\r\n        right: right,\r\n        bottom: bottom,\r\n        width: rectWidth,\r\n        height: rectHeight,\r\n    };\r\n}\r\nfunction calculateRect(matrix, width, height, n) {\r\n    var poses = calculatePoses(matrix, width, height, n);\r\n    return getRect(poses);\r\n}\r\nfunction getSVGOffset(offsetInfo, targetInfo, container, n, beforeMatrix) {\r\n    var _a;\r\n    var target = offsetInfo.target;\r\n    var origin = offsetInfo.origin;\r\n    var targetMatrix = targetInfo.matrix;\r\n    var _b = getSize(target), width = _b.offsetWidth, height = _b.offsetHeight;\r\n    var containerClientRect = container.getBoundingClientRect();\r\n    var margin = [0, 0];\r\n    if (container === getDocumentBody(container)) {\r\n        margin = getBodyOffset(target, true);\r\n    }\r\n    var rect = target.getBoundingClientRect();\r\n    var rectLeft = rect.left - containerClientRect.left + container.scrollLeft\r\n        - (container.clientLeft || 0) + margin[0];\r\n    var rectTop = rect.top - containerClientRect.top + container.scrollTop\r\n        - (container.clientTop || 0) + margin[1];\r\n    var rectWidth = rect.width;\r\n    var rectHeight = rect.height;\r\n    var mat = multiplies(n, beforeMatrix, targetMatrix);\r\n    var _c = calculateRect(mat, width, height, n), prevLeft = _c.left, prevTop = _c.top, prevWidth = _c.width, prevHeight = _c.height;\r\n    var posOrigin = calculatePosition(mat, origin, n);\r\n    var prevOrigin = minus(posOrigin, [prevLeft, prevTop]);\r\n    var rectOrigin = [\r\n        rectLeft + prevOrigin[0] * rectWidth / prevWidth,\r\n        rectTop + prevOrigin[1] * rectHeight / prevHeight,\r\n    ];\r\n    var offset = [0, 0];\r\n    var count = 0;\r\n    while (++count < 10) {\r\n        var inverseBeforeMatrix = invert(beforeMatrix, n);\r\n        _a = __read(minus(calculatePosition(inverseBeforeMatrix, rectOrigin, n), calculatePosition(inverseBeforeMatrix, posOrigin, n)), 2), offset[0] = _a[0], offset[1] = _a[1];\r\n        var mat2 = multiplies(n, beforeMatrix, createOriginMatrix(offset, n), targetMatrix);\r\n        var _d = calculateRect(mat2, width, height, n), nextLeft = _d.left, nextTop = _d.top;\r\n        var distLeft = nextLeft - rectLeft;\r\n        var distTop = nextTop - rectTop;\r\n        if (abs(distLeft) < 2 && abs(distTop) < 2) {\r\n            break;\r\n        }\r\n        rectOrigin[0] -= distLeft;\r\n        rectOrigin[1] -= distTop;\r\n    }\r\n    return offset.map(function (p) { return Math.round(p); });\r\n}\r\nfunction calculateMoveableClientPositions(rootMatrix, poses, rootClientRect) {\r\n    var is3d = rootMatrix.length === 16;\r\n    var n = is3d ? 4 : 3;\r\n    var rootPoses = poses.map(function (pos) { return calculatePosition(rootMatrix, pos, n); });\r\n    var left = rootClientRect.left, top = rootClientRect.top;\r\n    return rootPoses.map(function (pos) {\r\n        return [pos[0] + left, pos[1] + top];\r\n    });\r\n}\r\nfunction getDistSize(vec) {\r\n    return Math.sqrt(vec[0] * vec[0] + vec[1] * vec[1]);\r\n}\r\nfunction getDiagonalSize(pos1, pos2) {\r\n    return getDistSize([\r\n        pos2[0] - pos1[0],\r\n        pos2[1] - pos1[1],\r\n    ]);\r\n}\r\nfunction getLineStyle(pos1, pos2, zoom, rad) {\r\n    if (zoom === void 0) { zoom = 1; }\r\n    if (rad === void 0) { rad = getRad(pos1, pos2); }\r\n    var width = getDiagonalSize(pos1, pos2);\r\n    return {\r\n        transform: \"translateY(-50%) translate(\".concat(pos1[0], \"px, \").concat(pos1[1], \"px) rotate(\").concat(rad, \"rad) scaleY(\").concat(zoom, \")\"),\r\n        width: \"\".concat(width, \"px\"),\r\n    };\r\n}\r\nfunction getControlTransform(rotation, zoom) {\r\n    var poses = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        poses[_i - 2] = arguments[_i];\r\n    }\r\n    var length = poses.length;\r\n    var x = poses.reduce(function (prev, pos) { return prev + pos[0]; }, 0) / length;\r\n    var y = poses.reduce(function (prev, pos) { return prev + pos[1]; }, 0) / length;\r\n    return {\r\n        transform: \"translateZ(0px) translate(\".concat(x, \"px, \").concat(y, \"px) rotate(\").concat(rotation, \"rad) scale(\").concat(zoom, \")\"),\r\n    };\r\n}\r\nfunction getProps(props, ableName) {\r\n    var self = props[ableName];\r\n    if (isObject(self)) {\r\n        return __assign(__assign({}, props), self);\r\n    }\r\n    return props;\r\n}\r\nfunction getSize(target) {\r\n    var hasOffset = target && !isUndefined(target.offsetWidth);\r\n    var offsetWidth = 0;\r\n    var offsetHeight = 0;\r\n    var clientWidth = 0;\r\n    var clientHeight = 0;\r\n    var cssWidth = 0;\r\n    var cssHeight = 0;\r\n    var contentWidth = 0;\r\n    var contentHeight = 0;\r\n    var minWidth = 0;\r\n    var minHeight = 0;\r\n    var minOffsetWidth = 0;\r\n    var minOffsetHeight = 0;\r\n    var maxWidth = Infinity;\r\n    var maxHeight = Infinity;\r\n    var maxOffsetWidth = Infinity;\r\n    var maxOffsetHeight = Infinity;\r\n    var inlineCSSWidth = 0;\r\n    var inlineCSSHeight = 0;\r\n    var svg = false;\r\n    if (target) {\r\n        if (!hasOffset && target.ownerSVGElement) {\r\n            // check svg elements\r\n            var bbox = target.getBBox();\r\n            svg = true;\r\n            offsetWidth = bbox.width;\r\n            offsetHeight = bbox.height;\r\n            cssWidth = offsetWidth;\r\n            cssHeight = offsetHeight;\r\n            contentWidth = offsetWidth;\r\n            contentHeight = offsetHeight;\r\n            clientWidth = offsetWidth;\r\n            clientHeight = offsetHeight;\r\n        }\r\n        else {\r\n            // check html elements\r\n            var getStyle = getCachedStyle(target);\r\n            var targetStyle = target.style;\r\n            var boxSizing = getStyle(\"boxSizing\") === \"border-box\";\r\n            var borderLeft = parseFloat(getStyle(\"borderLeftWidth\")) || 0;\r\n            var borderRight = parseFloat(getStyle(\"borderRightWidth\")) || 0;\r\n            var borderTop = parseFloat(getStyle(\"borderTopWidth\")) || 0;\r\n            var borderBottom = parseFloat(getStyle(\"borderBottomWidth\")) || 0;\r\n            var paddingLeft = parseFloat(getStyle(\"paddingLeft\")) || 0;\r\n            var paddingRight = parseFloat(getStyle(\"paddingRight\")) || 0;\r\n            var paddingTop = parseFloat(getStyle(\"paddingTop\")) || 0;\r\n            var paddingBottom = parseFloat(getStyle(\"paddingBottom\")) || 0;\r\n            var horizontalPadding = paddingLeft + paddingRight;\r\n            var verticalPadding = paddingTop + paddingBottom;\r\n            var horizontalBorder = borderLeft + borderRight;\r\n            var verticalBorder = borderTop + borderBottom;\r\n            var horizontalOffset = horizontalPadding + horizontalBorder;\r\n            var verticalOffset = verticalPadding + verticalBorder;\r\n            var position = getStyle(\"position\");\r\n            var containerWidth = 0;\r\n            var containerHeight = 0;\r\n            // SVGSVGElement, HTMLElement\r\n            if (\"clientLeft\" in target) {\r\n                var parentElement = null;\r\n                if (position === \"absolute\") {\r\n                    var offsetInfo = getOffsetInfo(target, getDocumentBody(target));\r\n                    parentElement = offsetInfo.offsetParent;\r\n                }\r\n                else {\r\n                    parentElement = target.parentElement;\r\n                }\r\n                if (parentElement) {\r\n                    var getParentStyle = getCachedStyle(parentElement);\r\n                    containerWidth = parseFloat(getParentStyle(\"width\"));\r\n                    containerHeight = parseFloat(getParentStyle(\"height\"));\r\n                }\r\n            }\r\n            minWidth = Math.max(horizontalPadding, convertUnitSize(getStyle(\"minWidth\"), containerWidth) || 0);\r\n            minHeight = Math.max(verticalPadding, convertUnitSize(getStyle(\"minHeight\"), containerHeight) || 0);\r\n            maxWidth = convertUnitSize(getStyle(\"maxWidth\"), containerWidth);\r\n            maxHeight = convertUnitSize(getStyle(\"maxHeight\"), containerHeight);\r\n            if (isNaN(maxWidth)) {\r\n                maxWidth = Infinity;\r\n            }\r\n            if (isNaN(maxHeight)) {\r\n                maxHeight = Infinity;\r\n            }\r\n            inlineCSSWidth = convertUnitSize(targetStyle.width, 0) || 0;\r\n            inlineCSSHeight = convertUnitSize(targetStyle.height, 0) || 0;\r\n            cssWidth = parseFloat(getStyle(\"width\")) || 0;\r\n            cssHeight = parseFloat(getStyle(\"height\")) || 0;\r\n            contentWidth = abs(cssWidth - inlineCSSWidth) < 1\r\n                ? between(minWidth, inlineCSSWidth || cssWidth, maxWidth)\r\n                : cssWidth;\r\n            contentHeight = abs(cssHeight - inlineCSSHeight) < 1\r\n                ? between(minHeight, inlineCSSHeight || cssHeight, maxHeight)\r\n                : cssHeight;\r\n            offsetWidth = contentWidth;\r\n            offsetHeight = contentHeight;\r\n            clientWidth = contentWidth;\r\n            clientHeight = contentHeight;\r\n            if (boxSizing) {\r\n                maxOffsetWidth = maxWidth;\r\n                maxOffsetHeight = maxHeight;\r\n                minOffsetWidth = minWidth;\r\n                minOffsetHeight = minHeight;\r\n                contentWidth = offsetWidth - horizontalOffset;\r\n                contentHeight = offsetHeight - verticalOffset;\r\n            }\r\n            else {\r\n                maxOffsetWidth = maxWidth + horizontalOffset;\r\n                maxOffsetHeight = maxHeight + verticalOffset;\r\n                minOffsetWidth = minWidth + horizontalOffset;\r\n                minOffsetHeight = minHeight + verticalOffset;\r\n                offsetWidth = contentWidth + horizontalOffset;\r\n                offsetHeight = contentHeight + verticalOffset;\r\n            }\r\n            clientWidth = contentWidth + horizontalPadding;\r\n            clientHeight = contentHeight + verticalPadding;\r\n        }\r\n    }\r\n    return {\r\n        svg: svg,\r\n        offsetWidth: offsetWidth,\r\n        offsetHeight: offsetHeight,\r\n        clientWidth: clientWidth,\r\n        clientHeight: clientHeight,\r\n        contentWidth: contentWidth,\r\n        contentHeight: contentHeight,\r\n        inlineCSSWidth: inlineCSSWidth,\r\n        inlineCSSHeight: inlineCSSHeight,\r\n        cssWidth: cssWidth,\r\n        cssHeight: cssHeight,\r\n        minWidth: minWidth,\r\n        minHeight: minHeight,\r\n        maxWidth: maxWidth,\r\n        maxHeight: maxHeight,\r\n        minOffsetWidth: minOffsetWidth,\r\n        minOffsetHeight: minOffsetHeight,\r\n        maxOffsetWidth: maxOffsetWidth,\r\n        maxOffsetHeight: maxOffsetHeight,\r\n    };\r\n}\r\nfunction getRotationRad(poses, direction) {\r\n    return getRad(direction > 0 ? poses[0] : poses[1], direction > 0 ? poses[1] : poses[0]);\r\n}\r\nfunction resetClientRect() {\r\n    return {\r\n        left: 0, top: 0,\r\n        width: 0, height: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        clientLeft: 0, clientTop: 0,\r\n        clientWidth: 0, clientHeight: 0,\r\n        scrollWidth: 0, scrollHeight: 0,\r\n    };\r\n}\r\nfunction getExtendsRect(el, rect) {\r\n    var isRoot = el === getDocumentBody(el) || el === getDocumentElement(el);\r\n    var extendsRect = {\r\n        clientLeft: el.clientLeft,\r\n        clientTop: el.clientTop,\r\n        clientWidth: el.clientWidth,\r\n        clientHeight: el.clientHeight,\r\n        scrollWidth: el.scrollWidth,\r\n        scrollHeight: el.scrollHeight,\r\n        overflow: false,\r\n    };\r\n    if (isRoot) {\r\n        extendsRect.clientHeight = Math.max(rect.height, extendsRect.clientHeight);\r\n        extendsRect.scrollHeight = Math.max(rect.height, extendsRect.scrollHeight);\r\n    }\r\n    extendsRect.overflow = getCachedStyle(el)(\"overflow\") !== \"visible\";\r\n    return __assign(__assign({}, rect), extendsRect);\r\n}\r\nfunction getClientRectByPosition(position, base, el, isExtends) {\r\n    var left = position.left, right = position.right, top = position.top, bottom = position.bottom;\r\n    var baseTop = base.top;\r\n    var baseLeft = base.left;\r\n    var rect = {\r\n        left: baseLeft + left,\r\n        top: baseTop + top,\r\n        right: baseLeft + right,\r\n        bottom: baseTop + bottom,\r\n        width: right - left,\r\n        height: bottom - top,\r\n    };\r\n    if (el && isExtends) {\r\n        return getExtendsRect(el, rect);\r\n    }\r\n    return rect;\r\n}\r\nfunction getClientRect(el, isExtends) {\r\n    var left = 0;\r\n    var top = 0;\r\n    var width = 0;\r\n    var height = 0;\r\n    // let isRoot = false;\r\n    if (el) {\r\n        var clientRect = el.getBoundingClientRect();\r\n        left = clientRect.left;\r\n        top = clientRect.top;\r\n        width = clientRect.width;\r\n        height = clientRect.height;\r\n    }\r\n    var rect = {\r\n        left: left,\r\n        top: top,\r\n        width: width,\r\n        height: height,\r\n        right: left + width,\r\n        bottom: top + height,\r\n    };\r\n    if (el && isExtends) {\r\n        return getExtendsRect(el, rect);\r\n    }\r\n    return rect;\r\n}\r\nfunction getTotalOrigin(moveable) {\r\n    var _a = moveable.props, groupable = _a.groupable, svgOrigin = _a.svgOrigin;\r\n    var _b = moveable.getState(), offsetWidth = _b.offsetWidth, offsetHeight = _b.offsetHeight, svg = _b.svg, transformOrigin = _b.transformOrigin;\r\n    if (!groupable && svg && svgOrigin) {\r\n        return convertTransformOriginArray(svgOrigin, offsetWidth, offsetHeight);\r\n    }\r\n    return transformOrigin;\r\n}\r\nfunction getTotalDirection(parentDirection, isPinch, inputEvent, datas) {\r\n    var direction;\r\n    if (parentDirection) {\r\n        direction = parentDirection;\r\n    }\r\n    else if (isPinch) {\r\n        direction = [0, 0];\r\n    }\r\n    else {\r\n        var target = inputEvent.target;\r\n        direction = getDirection(target, datas);\r\n    }\r\n    return direction;\r\n}\r\nfunction getDirection(target, datas) {\r\n    if (!target) {\r\n        return;\r\n    }\r\n    var deg = target.getAttribute(\"data-rotation\") || \"\";\r\n    var direciton = target.getAttribute(\"data-direction\");\r\n    datas.deg = deg;\r\n    if (!direciton) {\r\n        return;\r\n    }\r\n    var dir = [0, 0];\r\n    (direciton.indexOf(\"w\") > -1) && (dir[0] = -1);\r\n    (direciton.indexOf(\"e\") > -1) && (dir[0] = 1);\r\n    (direciton.indexOf(\"n\") > -1) && (dir[1] = -1);\r\n    (direciton.indexOf(\"s\") > -1) && (dir[1] = 1);\r\n    return dir;\r\n}\r\nfunction getAbsolutePoses(poses, dist) {\r\n    return [\r\n        plus(dist, poses[0]),\r\n        plus(dist, poses[1]),\r\n        plus(dist, poses[2]),\r\n        plus(dist, poses[3]),\r\n    ];\r\n}\r\nfunction getAbsolutePosesByState(_a) {\r\n    var left = _a.left, top = _a.top, pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4;\r\n    return getAbsolutePoses([pos1, pos2, pos3, pos4], [left, top]);\r\n}\r\nfunction unsetAbles(self, isControl) {\r\n    self[isControl ? \"controlAbles\" : \"targetAbles\"].forEach(function (able) {\r\n        able.unset && able.unset(self);\r\n    });\r\n}\r\nfunction unsetGesto(self, isControl) {\r\n    var gestoName = isControl ? \"controlGesto\" : \"targetGesto\";\r\n    var gesto = self[gestoName];\r\n    if ((gesto === null || gesto === void 0 ? void 0 : gesto.isIdle()) === false) {\r\n        unsetAbles(self, isControl);\r\n    }\r\n    gesto === null || gesto === void 0 ? void 0 : gesto.unset();\r\n    self[gestoName] = null;\r\n}\r\nfunction fillCSSObject(style, resolvedEvent) {\r\n    if (resolvedEvent) {\r\n        var originalDatas = getBeforeRenderableDatas(resolvedEvent);\r\n        originalDatas.nextStyle = __assign(__assign({}, originalDatas.nextStyle), style);\r\n    }\r\n    return {\r\n        style: style,\r\n        cssText: getKeys(style).map(function (name) { return \"\".concat(decamelize(name, \"-\"), \": \").concat(style[name], \";\"); }).join(\"\"),\r\n    };\r\n}\r\nfunction fillAfterTransform(prevEvent, nextEvent, resolvedEvent) {\r\n    var afterTransform = nextEvent.afterTransform || nextEvent.transform;\r\n    return __assign(__assign({}, fillCSSObject(__assign(__assign(__assign({}, prevEvent.style), nextEvent.style), { transform: afterTransform }), resolvedEvent)), { afterTransform: afterTransform, transform: prevEvent.transform });\r\n}\r\nfunction fillParams(moveable, e, params, isBeforeEvent) {\r\n    var datas = e.datas;\r\n    if (!datas.datas) {\r\n        datas.datas = {};\r\n    }\r\n    var nextParams = __assign(__assign({}, params), { target: moveable.state.target, clientX: e.clientX, clientY: e.clientY, inputEvent: e.inputEvent, currentTarget: moveable, moveable: moveable, datas: datas.datas, isRequest: e.isRequest, isRequestChild: e.isRequestChild, isFirstDrag: !!e.isFirstDrag, isTrusted: e.isTrusted !== false, stopAble: function () {\r\n            datas.isEventStart = false;\r\n        }, stopDrag: function () {\r\n            var _a;\r\n            (_a = e.stop) === null || _a === void 0 ? void 0 : _a.call(e);\r\n        } });\r\n    if (!datas.isStartEvent) {\r\n        datas.isStartEvent = true;\r\n    }\r\n    else if (!isBeforeEvent) {\r\n        datas.lastEvent = nextParams;\r\n    }\r\n    return nextParams;\r\n}\r\nfunction fillEndParams(moveable, e, params) {\r\n    var datas = e.datas;\r\n    var isDrag = \"isDrag\" in params ? params.isDrag : e.isDrag;\r\n    if (!datas.datas) {\r\n        datas.datas = {};\r\n    }\r\n    return __assign(__assign({ isDrag: isDrag }, params), { moveable: moveable, target: moveable.state.target, clientX: e.clientX, clientY: e.clientY, inputEvent: e.inputEvent, currentTarget: moveable, lastEvent: datas.lastEvent, isDouble: e.isDouble, datas: datas.datas, isFirstDrag: !!e.isFirstDrag });\r\n}\r\nfunction catchEvent(moveable, name, callback) {\r\n    moveable._emitter.on(name, callback);\r\n}\r\nfunction triggerEvent(moveable, name, params, isManager, isRequest) {\r\n    return moveable.triggerEvent(name, params, isManager, isRequest);\r\n}\r\nfunction getComputedStyle(el, pseudoElt) {\r\n    return getWindow(el).getComputedStyle(el, pseudoElt);\r\n}\r\nfunction filterAbles(ables, methods, triggerAblesSimultaneously) {\r\n    var enabledAbles = {};\r\n    var ableGroups = {};\r\n    return ables.filter(function (able) {\r\n        var name = able.name;\r\n        if (enabledAbles[name] || !methods.some(function (method) { return able[method]; })) {\r\n            return false;\r\n        }\r\n        if (!triggerAblesSimultaneously && able.ableGroup) {\r\n            if (ableGroups[able.ableGroup]) {\r\n                return false;\r\n            }\r\n            ableGroups[able.ableGroup] = true;\r\n        }\r\n        enabledAbles[name] = true;\r\n        return true;\r\n    });\r\n}\r\nfunction equals(a1, a2) {\r\n    return a1 === a2 || (a1 == null && a2 == null);\r\n}\r\nfunction selectValue() {\r\n    var values = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        values[_i] = arguments[_i];\r\n    }\r\n    var length = values.length - 1;\r\n    for (var i = 0; i < length; ++i) {\r\n        var value = values[i];\r\n        if (!isUndefined(value)) {\r\n            return value;\r\n        }\r\n    }\r\n    return values[length];\r\n}\r\nfunction groupBy(arr, func) {\r\n    var groups = [];\r\n    var groupKeys = [];\r\n    arr.forEach(function (el, index) {\r\n        var groupKey = func(el, index, arr);\r\n        var keyIndex = groupKeys.indexOf(groupKey);\r\n        var group = groups[keyIndex] || [];\r\n        if (keyIndex === -1) {\r\n            groupKeys.push(groupKey);\r\n            groups.push(group);\r\n        }\r\n        group.push(el);\r\n    });\r\n    return groups;\r\n}\r\nfunction groupByMap(arr, func) {\r\n    var groups = [];\r\n    var groupKeys = {};\r\n    arr.forEach(function (el, index) {\r\n        var groupKey = func(el, index, arr);\r\n        var group = groupKeys[groupKey];\r\n        if (!group) {\r\n            group = [];\r\n            groupKeys[groupKey] = group;\r\n            groups.push(group);\r\n        }\r\n        group.push(el);\r\n    });\r\n    return groups;\r\n}\r\nfunction flat(arr) {\r\n    return arr.reduce(function (prev, cur) {\r\n        return prev.concat(cur);\r\n    }, []);\r\n}\r\nfunction maxOffset() {\r\n    var args = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        args[_i] = arguments[_i];\r\n    }\r\n    args.sort(function (a, b) { return abs(b) - abs(a); });\r\n    return args[0];\r\n}\r\nfunction calculateInversePosition(matrix, pos, n) {\r\n    return calculate(invert(matrix, n), convertPositionMatrix(pos, n), n);\r\n}\r\nfunction convertDragDist(state, e) {\r\n    var _a;\r\n    var is3d = state.is3d, rootMatrix = state.rootMatrix;\r\n    var n = is3d ? 4 : 3;\r\n    _a = __read(calculateInversePosition(rootMatrix, [e.distX, e.distY], n), 2), e.distX = _a[0], e.distY = _a[1];\r\n    return e;\r\n}\r\nfunction calculatePadding(matrix, pos, added, n) {\r\n    if (!added[0] && !added[1]) {\r\n        return pos;\r\n    }\r\n    var xAdded = calculatePosition(matrix, [normalized(added[0] || 1), 0], n);\r\n    var yAdded = calculatePosition(matrix, [0, normalized(added[1] || 1)], n);\r\n    var nextAdded = calculatePosition(matrix, [\r\n        added[0] / getDistSize(xAdded),\r\n        added[1] / getDistSize(yAdded),\r\n    ], n);\r\n    return plus(pos, nextAdded);\r\n}\r\nfunction convertCSSSize(value, size, isRelative) {\r\n    return isRelative ? \"\".concat(value / size * 100, \"%\") : \"\".concat(value, \"px\");\r\n}\r\nfunction getTinyDist(v) {\r\n    return abs(v) <= TINY_NUM ? 0 : v;\r\n}\r\nfunction getDirectionViewClassName(ableName) {\r\n    return function (moveable) {\r\n        if (!moveable.isDragging(ableName)) {\r\n            return \"\";\r\n        }\r\n        var data = getGestoData(moveable, ableName);\r\n        var deg = data.deg;\r\n        if (!deg) {\r\n            return \"\";\r\n        }\r\n        return prefix(\"view-control-rotation\".concat(deg));\r\n    };\r\n}\r\nfunction getDirectionCondition(ableName, checkAbles) {\r\n    if (checkAbles === void 0) { checkAbles = [ableName]; }\r\n    return function (moveable, e) {\r\n        if (e.isRequest) {\r\n            if (checkAbles.some(function (name) { return e.requestAble === name; })) {\r\n                return e.parentDirection;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n        var target = e.inputEvent.target;\r\n        return hasClass(target, prefix(\"direction\")) && (!ableName || hasClass(target, prefix(ableName)));\r\n    };\r\n}\r\nfunction convertTransformInfo(transforms, state, index) {\r\n    var _a;\r\n    var matrixInfos = parse(transforms, {\r\n        \"x%\": function (v) { return v / 100 * state.offsetWidth; },\r\n        \"y%\": function (v) { return v / 100 * state.offsetHeight; },\r\n    });\r\n    var beforeFunctionTexts = transforms.slice(0, index < 0 ? undefined : index);\r\n    var beforeFunctionTexts2 = transforms.slice(0, index < 0 ? undefined : index + 1);\r\n    var targetFunctionText = transforms[index] || \"\";\r\n    var afterFunctionTexts = index < 0 ? [] : transforms.slice(index);\r\n    var afterFunctionTexts2 = index < 0 ? [] : transforms.slice(index + 1);\r\n    var beforeFunctions = matrixInfos.slice(0, index < 0 ? undefined : index);\r\n    var beforeFunctions2 = matrixInfos.slice(0, index < 0 ? undefined : index + 1);\r\n    var targetFunction = (_a = matrixInfos[index]) !== null && _a !== void 0 ? _a : parse([\"\"])[0];\r\n    var afterFunctions = index < 0 ? [] : matrixInfos.slice(index);\r\n    var afterFunctions2 = index < 0 ? [] : matrixInfos.slice(index + 1);\r\n    var targetFunctions = targetFunction ? [targetFunction] : [];\r\n    var beforeFunctionMatrix = toMat(beforeFunctions);\r\n    var beforeFunctionMatrix2 = toMat(beforeFunctions2);\r\n    var afterFunctionMatrix = toMat(afterFunctions);\r\n    var afterFunctionMatrix2 = toMat(afterFunctions2);\r\n    var allFunctionMatrix = multiply(beforeFunctionMatrix, afterFunctionMatrix, 4);\r\n    return {\r\n        transforms: transforms,\r\n        beforeFunctionMatrix: beforeFunctionMatrix,\r\n        beforeFunctionMatrix2: beforeFunctionMatrix2,\r\n        targetFunctionMatrix: toMat(targetFunctions),\r\n        afterFunctionMatrix: afterFunctionMatrix,\r\n        afterFunctionMatrix2: afterFunctionMatrix2,\r\n        allFunctionMatrix: allFunctionMatrix,\r\n        beforeFunctions: beforeFunctions,\r\n        beforeFunctions2: beforeFunctions2,\r\n        targetFunction: targetFunctions[0],\r\n        afterFunctions: afterFunctions,\r\n        afterFunctions2: afterFunctions2,\r\n        beforeFunctionTexts: beforeFunctionTexts,\r\n        beforeFunctionTexts2: beforeFunctionTexts2,\r\n        targetFunctionText: targetFunctionText,\r\n        afterFunctionTexts: afterFunctionTexts,\r\n        afterFunctionTexts2: afterFunctionTexts2,\r\n    };\r\n}\r\nfunction isArrayFormat(arr) {\r\n    if (!arr || !isObject(arr)) {\r\n        return false;\r\n    }\r\n    if (isNode(arr)) {\r\n        return false;\r\n    }\r\n    return isArray(arr) || \"length\" in arr;\r\n}\r\nfunction getRefTarget(target, isSelector) {\r\n    if (!target) {\r\n        return null;\r\n    }\r\n    if (isNode(target)) {\r\n        return target;\r\n    }\r\n    if (isString(target)) {\r\n        if (isSelector) {\r\n            return document.querySelector(target);\r\n        }\r\n        return target;\r\n    }\r\n    if (isFunction(target)) {\r\n        return target();\r\n    }\r\n    if (isWindow(target)) {\r\n        return target;\r\n    }\r\n    if (\"current\" in target) {\r\n        return target.current;\r\n    }\r\n    return target;\r\n}\r\nfunction getRefTargets(targets, isSelector) {\r\n    if (!targets) {\r\n        return [];\r\n    }\r\n    var userTargets = isArrayFormat(targets) ? [].slice.call(targets) : [targets];\r\n    return userTargets.reduce(function (prev, target) {\r\n        if (isString(target) && isSelector) {\r\n            return __spreadArray(__spreadArray([], __read(prev), false), __read([].slice.call(document.querySelectorAll(target))), false);\r\n        }\r\n        if (isArray(target)) {\r\n            prev.push(getRefTargets(target, isSelector));\r\n        }\r\n        else {\r\n            prev.push(getRefTarget(target, isSelector));\r\n        }\r\n        return prev;\r\n    }, []);\r\n}\r\nfunction getAbsoluteRotation(pos1, pos2, direction) {\r\n    var deg = getRad(pos1, pos2) / Math.PI * 180;\r\n    deg = direction >= 0 ? deg : 180 - deg;\r\n    deg = deg >= 0 ? deg : 360 + deg;\r\n    return deg;\r\n}\r\nfunction getDragDistByState(state, dist) {\r\n    var rootMatrix = state.rootMatrix, is3d = state.is3d;\r\n    var n = is3d ? 4 : 3;\r\n    var inverseMatrix = invert(rootMatrix, n);\r\n    if (!is3d) {\r\n        inverseMatrix = convertDimension(inverseMatrix, 3, 4);\r\n    }\r\n    inverseMatrix[12] = 0;\r\n    inverseMatrix[13] = 0;\r\n    inverseMatrix[14] = 0;\r\n    return calculateMatrixDist(inverseMatrix, dist);\r\n}\r\nfunction getSizeDistByDist(startSize, dist, ratio, direction, keepRatio) {\r\n    var _a = __read(startSize, 2), startOffsetWidth = _a[0], startOffsetHeight = _a[1];\r\n    var distWidth = 0;\r\n    var distHeight = 0;\r\n    if (keepRatio && startOffsetWidth && startOffsetHeight) {\r\n        var rad = getRad([0, 0], dist);\r\n        var standardRad = getRad([0, 0], direction);\r\n        var size = getDistSize(dist);\r\n        var signSize = Math.cos(rad - standardRad) * size;\r\n        if (!direction[0]) {\r\n            // top, bottom\r\n            distHeight = signSize;\r\n            distWidth = distHeight * ratio;\r\n        }\r\n        else if (!direction[1]) {\r\n            // left, right\r\n            distWidth = signSize;\r\n            distHeight = distWidth / ratio;\r\n        }\r\n        else {\r\n            // two-way\r\n            var startWidthSize = direction[0] * startOffsetWidth;\r\n            var startHeightSize = direction[1] * startOffsetHeight;\r\n            var secondRad = Math.atan2(startWidthSize + dist[0], startHeightSize + dist[1]);\r\n            var firstRad = Math.atan2(startWidthSize, startHeightSize);\r\n            if (secondRad < 0) {\r\n                secondRad += Math.PI * 2;\r\n            }\r\n            if (firstRad < 0) {\r\n                firstRad += Math.PI * 2;\r\n            }\r\n            var rad_1 = 0;\r\n            if (abs(secondRad - firstRad) < Math.PI / 2 || abs(secondRad - firstRad) > Math.PI / 2 * 3) {\r\n                rad_1 = secondRad - firstRad;\r\n            }\r\n            else {\r\n                firstRad += Math.PI;\r\n                rad_1 = secondRad - firstRad;\r\n            }\r\n            if (rad_1 > Math.PI * 2) {\r\n                rad_1 -= Math.PI * 2;\r\n            }\r\n            else if (rad_1 > Math.PI) {\r\n                rad_1 = 2 * Math.PI - rad_1;\r\n            }\r\n            else if (rad_1 < -Math.PI) {\r\n                rad_1 = -2 * Math.PI - rad_1;\r\n            }\r\n            //       180\r\n            // -1, -1,  // 1, -1\r\n            // 270            90\r\n            // -1, 1    // 1, 1\r\n            //       0\r\n            var distSize = getDistSize([startWidthSize + dist[0], startHeightSize + dist[1]]) * Math.cos(rad_1);\r\n            distWidth = distSize * Math.sin(firstRad) - startWidthSize;\r\n            distHeight = distSize * Math.cos(firstRad) - startHeightSize;\r\n            if (direction[0] < 0) {\r\n                distWidth *= -1;\r\n            }\r\n            if (direction[1] < 0) {\r\n                distHeight *= -1;\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        distWidth = direction[0] * dist[0];\r\n        distHeight = direction[1] * dist[1];\r\n    }\r\n    return [distWidth, distHeight];\r\n}\r\nfunction getOffsetSizeDist(sizeDirection, keepRatio, datas, e) {\r\n    var _a;\r\n    var ratio = datas.ratio, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight;\r\n    var distWidth = 0;\r\n    var distHeight = 0;\r\n    var distX = e.distX, distY = e.distY, pinchScale = e.pinchScale, parentDistance = e.parentDistance, parentDist = e.parentDist, parentScale = e.parentScale;\r\n    var startFixedDirection = datas.fixedDirection;\r\n    var directionsDists = [0, 1].map(function (index) {\r\n        return abs(sizeDirection[index] - startFixedDirection[index]);\r\n    });\r\n    var directionRatios = [0, 1].map(function (index) {\r\n        var dist = directionsDists[index];\r\n        if (dist !== 0) {\r\n            dist = 2 / dist;\r\n        }\r\n        return dist;\r\n    });\r\n    if (parentDist) {\r\n        distWidth = parentDist[0];\r\n        distHeight = parentDist[1];\r\n        if (keepRatio) {\r\n            if (!distWidth) {\r\n                distWidth = distHeight * ratio;\r\n            }\r\n            else if (!distHeight) {\r\n                distHeight = distWidth / ratio;\r\n            }\r\n        }\r\n    }\r\n    else if (isNumber(pinchScale)) {\r\n        distWidth = (pinchScale - 1) * startOffsetWidth;\r\n        distHeight = (pinchScale - 1) * startOffsetHeight;\r\n    }\r\n    else if (parentScale) {\r\n        distWidth = (parentScale[0] - 1) * startOffsetWidth;\r\n        distHeight = (parentScale[1] - 1) * startOffsetHeight;\r\n    }\r\n    else if (parentDistance) {\r\n        var scaleX = startOffsetWidth * directionsDists[0];\r\n        var scaleY = startOffsetHeight * directionsDists[1];\r\n        var ratioDistance = getDistSize([scaleX, scaleY]);\r\n        distWidth = parentDistance / ratioDistance * scaleX * directionRatios[0];\r\n        distHeight = parentDistance / ratioDistance * scaleY * directionRatios[1];\r\n    }\r\n    else {\r\n        var dist_1 = getDragDist({ datas: datas, distX: distX, distY: distY });\r\n        dist_1 = directionRatios.map(function (ratio, i) {\r\n            return dist_1[i] * ratio;\r\n        });\r\n        _a = __read(getSizeDistByDist([startOffsetWidth, startOffsetHeight], dist_1, ratio, sizeDirection, keepRatio), 2), distWidth = _a[0], distHeight = _a[1];\r\n    }\r\n    return {\r\n        // direction,\r\n        // sizeDirection,\r\n        distWidth: distWidth,\r\n        distHeight: distHeight,\r\n    };\r\n}\r\nfunction convertTransformUnit(origin, xy) {\r\n    if (xy) {\r\n        if (origin === \"left\") {\r\n            return { x: \"0%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"top\") {\r\n            return { x: \"50%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"center\") {\r\n            return { x: \"50%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"right\") {\r\n            return { x: \"100%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"bottom\") {\r\n            return { x: \"50%\", y: \"100%\" };\r\n        }\r\n        var _a = __read(origin.split(\" \"), 2), left = _a[0], right = _a[1];\r\n        var leftOrigin = convertTransformUnit(left || \"\");\r\n        var rightOrigin = convertTransformUnit(right || \"\");\r\n        var originObject = __assign(__assign({}, leftOrigin), rightOrigin);\r\n        var nextOriginObject = {\r\n            x: \"50%\",\r\n            y: \"50%\",\r\n        };\r\n        if (originObject.x) {\r\n            nextOriginObject.x = originObject.x;\r\n        }\r\n        if (originObject.y) {\r\n            nextOriginObject.y = originObject.y;\r\n        }\r\n        if (originObject.value) {\r\n            if (originObject.x && !originObject.y) {\r\n                nextOriginObject.y = originObject.value;\r\n            }\r\n            if (!originObject.x && originObject.y) {\r\n                nextOriginObject.x = originObject.value;\r\n            }\r\n        }\r\n        return nextOriginObject;\r\n    }\r\n    if (origin === \"left\") {\r\n        return { x: \"0%\" };\r\n    }\r\n    if (origin === \"right\") {\r\n        return { x: \"100%\" };\r\n    }\r\n    if (origin === \"top\") {\r\n        return { y: \"0%\" };\r\n    }\r\n    if (origin === \"bottom\") {\r\n        return { y: \"100%\" };\r\n    }\r\n    if (!origin) {\r\n        return {};\r\n    }\r\n    if (origin === \"center\") {\r\n        return { value: \"50%\" };\r\n    }\r\n    return { value: origin };\r\n}\r\nfunction convertTransformOriginArray(transformOrigin, width, height) {\r\n    var _a = convertTransformUnit(transformOrigin, true), x = _a.x, y = _a.y;\r\n    return [\r\n        convertUnitSize(x, width) || 0,\r\n        convertUnitSize(y, height) || 0,\r\n    ];\r\n}\r\nfunction rotatePosesInfo(poses, origin, rad) {\r\n    var prevPoses = poses.map(function (pos) { return minus(pos, origin); });\r\n    var nextPoses = prevPoses.map(function (pos) { return rotate(pos, rad); });\r\n    return {\r\n        prev: prevPoses,\r\n        next: nextPoses,\r\n        result: nextPoses.map(function (pos) { return plus(pos, origin); }),\r\n    };\r\n}\r\nfunction isDeepArrayEquals(arr1, arr2) {\r\n    return arr1.length === arr2.length && arr1.every(function (value1, i) {\r\n        var value2 = arr2[i];\r\n        var isArray1 = isArray(value1);\r\n        var isArray2 = isArray(value2);\r\n        if (isArray1 && isArray2) {\r\n            return isDeepArrayEquals(value1, value2);\r\n        }\r\n        else if (!isArray1 && !isArray2) {\r\n            return value1 === value2;\r\n        }\r\n        return false;\r\n    });\r\n}\r\nfunction watchValue(moveable, property, nextValue, valueKey, defaultValue) {\r\n    var store = moveable._store;\r\n    var prevValue = store[property];\r\n    if (!(property in store)) {\r\n        if (defaultValue != null) {\r\n            store[property] = defaultValue;\r\n            prevValue = defaultValue;\r\n        }\r\n        else {\r\n            store[property] = nextValue;\r\n            return nextValue;\r\n        }\r\n    }\r\n    if (prevValue === nextValue || valueKey(prevValue) === valueKey(nextValue)) {\r\n        return prevValue;\r\n    }\r\n    store[property] = nextValue;\r\n    return nextValue;\r\n}\r\nfunction sign(value) {\r\n    return value >= 0 ? 1 : -1;\r\n}\r\nfunction abs(value) {\r\n    return Math.abs(value);\r\n}\r\nfunction countEach(count, callback) {\r\n    return counter(count).map(function (index) { return callback(index); });\r\n}\r\nfunction getPaddingBox(padding) {\r\n    if (isNumber(padding)) {\r\n        return {\r\n            top: padding,\r\n            left: padding,\r\n            right: padding,\r\n            bottom: padding,\r\n        };\r\n    }\r\n    return {\r\n        left: padding.left || 0,\r\n        top: padding.top || 0,\r\n        right: padding.right || 0,\r\n        bottom: padding.bottom || 0,\r\n    };\r\n}\n\n/**\r\n * @namespace Moveable.Pinchable\r\n * @description Whether or not target can be pinched with draggable, resizable, scalable, rotatable (default: false)\r\n */\r\nvar Pinchable = makeAble(\"pinchable\", {\r\n    props: [\r\n        \"pinchable\",\r\n    ],\r\n    events: [\r\n        \"pinchStart\",\r\n        \"pinch\",\r\n        \"pinchEnd\",\r\n        \"pinchGroupStart\",\r\n        \"pinchGroup\",\r\n        \"pinchGroupEnd\",\r\n    ],\r\n    dragStart: function () {\r\n        return true;\r\n    },\r\n    pinchStart: function (moveable, e) {\r\n        var datas = e.datas, targets = e.targets, angle = e.angle, originalDatas = e.originalDatas;\r\n        var _a = moveable.props, pinchable = _a.pinchable, ables = _a.ables;\r\n        if (!pinchable) {\r\n            return false;\r\n        }\r\n        var eventName = \"onPinch\".concat(targets ? \"Group\" : \"\", \"Start\");\r\n        var controlEventName = \"drag\".concat(targets ? \"Group\" : \"\", \"ControlStart\");\r\n        var pinchAbles = (pinchable === true ? moveable.controlAbles : ables.filter(function (able) {\r\n            return pinchable.indexOf(able.name) > -1;\r\n        })).filter(function (able) { return able.canPinch && able[controlEventName]; });\r\n        var params = fillParams(moveable, e, {});\r\n        if (targets) {\r\n            params.targets = targets;\r\n        }\r\n        var result = triggerEvent(moveable, eventName, params);\r\n        datas.isPinch = result !== false;\r\n        datas.ables = pinchAbles;\r\n        var isPinch = datas.isPinch;\r\n        if (!isPinch) {\r\n            return false;\r\n        }\r\n        pinchAbles.forEach(function (able) {\r\n            originalDatas[able.name] = originalDatas[able.name] || {};\r\n            if (!able[controlEventName]) {\r\n                return;\r\n            }\r\n            var ableEvent = __assign(__assign({}, e), { datas: originalDatas[able.name], parentRotate: angle, isPinch: true });\r\n            able[controlEventName](moveable, ableEvent);\r\n        });\r\n        moveable.state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n            direction: [0, 0],\r\n        };\r\n        return isPinch;\r\n    },\r\n    pinch: function (moveable, e) {\r\n        var datas = e.datas, pinchScale = e.scale, distance = e.distance, originalDatas = e.originalDatas, inputEvent = e.inputEvent, targets = e.targets, angle = e.angle;\r\n        if (!datas.isPinch) {\r\n            return;\r\n        }\r\n        var parentDistance = distance * (1 - 1 / pinchScale);\r\n        var params = fillParams(moveable, e, {});\r\n        if (targets) {\r\n            params.targets = targets;\r\n        }\r\n        var eventName = \"onPinch\".concat(targets ? \"Group\" : \"\");\r\n        triggerEvent(moveable, eventName, params);\r\n        var ables = datas.ables;\r\n        var controlEventName = \"drag\".concat(targets ? \"Group\" : \"\", \"Control\");\r\n        ables.forEach(function (able) {\r\n            if (!able[controlEventName]) {\r\n                return;\r\n            }\r\n            able[controlEventName](moveable, __assign(__assign({}, e), { datas: originalDatas[able.name], inputEvent: inputEvent, resolveMatrix: true, pinchScale: pinchScale, parentDistance: parentDistance, parentRotate: angle, isPinch: true }));\r\n        });\r\n        return params;\r\n    },\r\n    pinchEnd: function (moveable, e) {\r\n        var datas = e.datas, isPinch = e.isPinch, inputEvent = e.inputEvent, targets = e.targets, originalDatas = e.originalDatas;\r\n        if (!datas.isPinch) {\r\n            return;\r\n        }\r\n        var eventName = \"onPinch\".concat(targets ? \"Group\" : \"\", \"End\");\r\n        var params = fillEndParams(moveable, e, { isDrag: isPinch });\r\n        if (targets) {\r\n            params.targets = targets;\r\n        }\r\n        triggerEvent(moveable, eventName, params);\r\n        var ables = datas.ables;\r\n        var controlEventName = \"drag\".concat(targets ? \"Group\" : \"\", \"ControlEnd\");\r\n        ables.forEach(function (able) {\r\n            if (!able[controlEventName]) {\r\n                return;\r\n            }\r\n            able[controlEventName](moveable, __assign(__assign({}, e), { isDrag: isPinch, datas: originalDatas[able.name], inputEvent: inputEvent, isPinch: true }));\r\n        });\r\n        return isPinch;\r\n    },\r\n    pinchGroupStart: function (moveable, e) {\r\n        return this.pinchStart(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    pinchGroup: function (moveable, e) {\r\n        return this.pinch(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    pinchGroupEnd: function (moveable, e) {\r\n        return this.pinchEnd(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n});\r\n/**\r\n * Whether or not target can be pinched with draggable, resizable, scalable, rotatable (default: false)\r\n * @name Moveable.Pinchable#pinchable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.pinchable = true;\r\n */\r\n/**\r\n * When the pinch starts, the pinchStart event is called with part of scaleStart, rotateStart, resizeStart\r\n * @memberof Moveable.Pinchable\r\n * @event pinchStart\r\n * @param {Moveable.Pinchable.OnPinchStart} - Parameters for the pinchStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     rotatable: true,\r\n *     scalable: true,\r\n *     pinchable: true, // [\"rotatable\", \"scalable\"]\r\n * });\r\n * moveable.on(\"pinchStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"rotateStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"scaleStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When pinching, the pinch event is called with part of scale, rotate, resize\r\n * @memberof Moveable.Pinchable\r\n * @event pinch\r\n * @param {Moveable.Pinchable.OnPinch} - Parameters for the pinch event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     rotatable: true,\r\n *     scalable: true,\r\n *     pinchable: true, // [\"rotatable\", \"scalable\"]\r\n * });\r\n * moveable.on(\"pinch\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"rotate\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"scale\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When the pinch finishes, the pinchEnd event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchEnd\r\n * @param {Moveable.Pinchable.OnPinchEnd} - Parameters for the pinchEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     rotatable: true,\r\n *     scalable: true,\r\n *     pinchable: true, // [\"rotatable\", \"scalable\"]\r\n * });\r\n * moveable.on(\"pinchEnd\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"rotateEnd\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"scaleEnd\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When the group pinch starts, the `pinchGroupStart` event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchGroupStart\r\n * @param {Moveable.Pinchable.OnPinchGroupStart} - Parameters for the `pinchGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     pinchable: true\r\n * });\r\n * moveable.on(\"pinchGroupStart\", ({ targets }) => {\r\n *     console.log(\"onPinchGroupStart\", targets);\r\n * });\r\n */\r\n/**\r\n * When the group pinch, the `pinchGroup` event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchGroup\r\n * @param {Moveable.Pinchable.OnPinchGroup} - Parameters for the `pinchGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     pinchable: true\r\n * });\r\n * moveable.on(\"pinchGroup\", ({ targets, events }) => {\r\n *     console.log(\"onPinchGroup\", targets);\r\n * });\r\n */\r\n/**\r\n * When the group pinch finishes, the `pinchGroupEnd` event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchGroupEnd\r\n * @param {Moveable.Pinchable.OnPinchGroupEnd} - Parameters for the `pinchGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     pinchable: true\r\n * });\r\n * moveable.on(\"pinchGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onPinchGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nvar directionCondition = getDirectionCondition(\"scalable\");\r\n/**\r\n * @namespace Scalable\r\n * @memberof Moveable\r\n * @description Scalable indicates whether the target's x and y can be scale of transform.\r\n */\r\nvar Scalable = {\r\n    name: \"scalable\",\r\n    ableGroup: \"size\",\r\n    canPinch: true,\r\n    props: [\r\n        \"scalable\",\r\n        \"throttleScale\",\r\n        \"renderDirections\",\r\n        \"keepRatio\",\r\n        \"edge\",\r\n        \"displayAroundControls\",\r\n    ],\r\n    events: [\r\n        \"scaleStart\",\r\n        \"beforeScale\",\r\n        \"scale\",\r\n        \"scaleEnd\",\r\n        \"scaleGroupStart\",\r\n        \"beforeScaleGroup\",\r\n        \"scaleGroup\",\r\n        \"scaleGroupEnd\",\r\n    ],\r\n    render: getRenderDirections(\"scalable\"),\r\n    dragControlCondition: directionCondition,\r\n    viewClassName: getDirectionViewClassName(\"scalable\"),\r\n    dragControlStart: function (moveable, e) {\r\n        var datas = e.datas, isPinch = e.isPinch, inputEvent = e.inputEvent, parentDirection = e.parentDirection;\r\n        var direction = getTotalDirection(parentDirection, isPinch, inputEvent, datas);\r\n        var _a = moveable.state, width = _a.width, height = _a.height, targetTransform = _a.targetTransform, target = _a.target, pos1 = _a.pos1, pos2 = _a.pos2, pos4 = _a.pos4;\r\n        if (!direction || !target) {\r\n            return false;\r\n        }\r\n        if (!isPinch) {\r\n            setDragStart(moveable, e);\r\n        }\r\n        datas.datas = {};\r\n        datas.transform = targetTransform;\r\n        datas.prevDist = [1, 1];\r\n        datas.direction = direction;\r\n        datas.startOffsetWidth = width;\r\n        datas.startOffsetHeight = height;\r\n        datas.startValue = [1, 1];\r\n        // const scaleWidth = getDist(pos1, pos2);\r\n        // const scaleHeight = getDist(pos2, pos4);\r\n        var isWidth = (!direction[0] && !direction[1]) || direction[0] || !direction[1];\r\n        // datas.scaleWidth = scaleWidth;\r\n        // datas.scaleHeight = scaleHeight;\r\n        // datas.scaleXRatio = scaleWidth / width;\r\n        // datas.scaleYRatio = scaleHeight / height;\r\n        setDefaultTransformIndex(moveable, e, \"scale\");\r\n        datas.isWidth = isWidth;\r\n        function setRatio(ratio) {\r\n            datas.ratio = ratio && isFinite(ratio) ? ratio : 0;\r\n        }\r\n        datas.startPositions = getAbsolutePosesByState(moveable.state);\r\n        function setFixedDirection(fixedDirection) {\r\n            var result = getFixedDirectionInfo(datas.startPositions, fixedDirection);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            datas.fixedOffset = result.fixedOffset;\r\n        }\r\n        datas.setFixedDirection = setFixedDirection;\r\n        setRatio(getDist$1(pos1, pos2) / getDist$1(pos2, pos4));\r\n        setFixedDirection([-direction[0], -direction[1]]);\r\n        var setMinScaleSize = function (min) {\r\n            datas.minScaleSize = min;\r\n        };\r\n        var setMaxScaleSize = function (max) {\r\n            datas.maxScaleSize = max;\r\n        };\r\n        // const setMinScale = (min: number[]) => {\r\n        // };\r\n        // const setMaxScale = (max: number[]) => {\r\n        // };\r\n        setMinScaleSize([-Infinity, -Infinity]);\r\n        setMaxScaleSize([Infinity, Infinity]);\r\n        var params = fillParams(moveable, e, __assign(__assign({ direction: direction, set: function (scale) {\r\n                datas.startValue = scale;\r\n            }, setRatio: setRatio, setFixedDirection: setFixedDirection, setMinScaleSize: setMinScaleSize, setMaxScaleSize: setMaxScaleSize }, fillTransformStartEvent(moveable, e)), { dragStart: Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e)) }));\r\n        var result = triggerEvent(moveable, \"onScaleStart\", params);\r\n        datas.startFixedDirection = datas.fixedDirection;\r\n        if (result !== false) {\r\n            datas.isScale = true;\r\n            moveable.state.snapRenderInfo = {\r\n                request: e.isRequest,\r\n                direction: direction,\r\n            };\r\n        }\r\n        return datas.isScale ? params : false;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        resolveTransformEvent(moveable, e, \"scale\");\r\n        var datas = e.datas, parentKeepRatio = e.parentKeepRatio, parentFlag = e.parentFlag, isPinch = e.isPinch, dragClient = e.dragClient, isRequest = e.isRequest, useSnap = e.useSnap, resolveMatrix = e.resolveMatrix;\r\n        var prevDist = datas.prevDist, direction = datas.direction, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, isScale = datas.isScale, startValue = datas.startValue, isWidth = datas.isWidth, ratio = datas.ratio;\r\n        if (!isScale) {\r\n            return false;\r\n        }\r\n        var props = moveable.props;\r\n        var throttleScale = props.throttleScale, parentMoveable = props.parentMoveable;\r\n        var sizeDirection = direction;\r\n        if (!direction[0] && !direction[1]) {\r\n            sizeDirection = [1, 1];\r\n        }\r\n        var keepRatio = (ratio && (parentKeepRatio != null ? parentKeepRatio : props.keepRatio)) || false;\r\n        var state = moveable.state;\r\n        var tempScaleValue = [\r\n            startValue[0],\r\n            startValue[1],\r\n        ];\r\n        function getNextScale() {\r\n            var _a = getOffsetSizeDist(sizeDirection, keepRatio, datas, e), distWidth = _a.distWidth, distHeight = _a.distHeight;\r\n            var distX = startOffsetWidth ? (startOffsetWidth + distWidth) / startOffsetWidth : 1;\r\n            var distY = startOffsetHeight ? (startOffsetHeight + distHeight) / startOffsetHeight : 1;\r\n            if (!startValue[0]) {\r\n                tempScaleValue[0] = distWidth / startOffsetWidth;\r\n            }\r\n            if (!startValue[1]) {\r\n                tempScaleValue[1] = distHeight / startOffsetHeight;\r\n            }\r\n            var scaleX = (sizeDirection[0] || keepRatio ? distX : 1) * tempScaleValue[0];\r\n            var scaleY = (sizeDirection[1] || keepRatio ? distY : 1) * tempScaleValue[1];\r\n            if (scaleX === 0) {\r\n                scaleX = sign(prevDist[0]) * MIN_SCALE;\r\n            }\r\n            if (scaleY === 0) {\r\n                scaleY = sign(prevDist[1]) * MIN_SCALE;\r\n            }\r\n            return [scaleX, scaleY];\r\n        }\r\n        var scale = getNextScale();\r\n        if (!isPinch && moveable.props.groupable) {\r\n            var snapRenderInfo = state.snapRenderInfo || {};\r\n            var stateDirection = snapRenderInfo.direction;\r\n            if (isArray(stateDirection) && (stateDirection[0] || stateDirection[1])) {\r\n                state.snapRenderInfo = { direction: direction, request: e.isRequest };\r\n            }\r\n        }\r\n        triggerEvent(moveable, \"onBeforeScale\", fillParams(moveable, e, {\r\n            scale: scale,\r\n            setFixedDirection: function (nextFixedDirection) {\r\n                datas.setFixedDirection(nextFixedDirection);\r\n                scale = getNextScale();\r\n                return scale;\r\n            },\r\n            startFixedDirection: datas.startFixedDirection,\r\n            setScale: function (nextScale) {\r\n                scale = nextScale;\r\n            },\r\n        }, true));\r\n        var dist = [\r\n            scale[0] / tempScaleValue[0],\r\n            scale[1] / tempScaleValue[1],\r\n        ];\r\n        var fixedPosition = dragClient;\r\n        var snapDist = [0, 0];\r\n        var distSign = sign(dist[0] * dist[1]);\r\n        var isSelfPinch = !dragClient && !parentFlag && isPinch;\r\n        if (isSelfPinch || resolveMatrix) {\r\n            fixedPosition = getTranslateFixedPosition(moveable, datas.targetAllTransform, [0, 0], [0, 0], datas);\r\n        }\r\n        else if (!dragClient) {\r\n            fixedPosition = datas.fixedPosition;\r\n        }\r\n        if (!isPinch) {\r\n            snapDist = checkSnapScale(moveable, dist, direction, !useSnap && isRequest, datas);\r\n        }\r\n        if (keepRatio) {\r\n            if (sizeDirection[0] && sizeDirection[1] && snapDist[0] && snapDist[1]) {\r\n                if (Math.abs(snapDist[0] * startOffsetWidth) > Math.abs(snapDist[1] * startOffsetHeight)) {\r\n                    snapDist[1] = 0;\r\n                }\r\n                else {\r\n                    snapDist[0] = 0;\r\n                }\r\n            }\r\n            var isNoSnap = !snapDist[0] && !snapDist[1];\r\n            if (isNoSnap) {\r\n                // throttle scale value (not absolute scale size)\r\n                if (isWidth) {\r\n                    dist[0] = throttle(dist[0] * tempScaleValue[0], throttleScale) / tempScaleValue[0];\r\n                }\r\n                else {\r\n                    dist[1] = throttle(dist[1] * tempScaleValue[1], throttleScale) / tempScaleValue[1];\r\n                }\r\n            }\r\n            if ((sizeDirection[0] && !sizeDirection[1])\r\n                || (snapDist[0] && !snapDist[1])\r\n                || (isNoSnap && isWidth)) {\r\n                dist[0] += snapDist[0];\r\n                var snapHeight = startOffsetWidth * dist[0] * tempScaleValue[0] / ratio;\r\n                dist[1] = sign(distSign * dist[0]) * abs(snapHeight / startOffsetHeight / tempScaleValue[1]);\r\n            }\r\n            else if ((!sizeDirection[0] && sizeDirection[1])\r\n                || (!snapDist[0] && snapDist[1])\r\n                || (isNoSnap && !isWidth)) {\r\n                dist[1] += snapDist[1];\r\n                var snapWidth = startOffsetHeight * dist[1] * tempScaleValue[1] * ratio;\r\n                dist[0] = sign(distSign * dist[1]) * abs(snapWidth / startOffsetWidth / tempScaleValue[0]);\r\n            }\r\n        }\r\n        else {\r\n            dist[0] += snapDist[0];\r\n            dist[1] += snapDist[1];\r\n            if (!snapDist[0]) {\r\n                dist[0] = throttle(dist[0] * tempScaleValue[0], throttleScale) / tempScaleValue[0];\r\n            }\r\n            if (!snapDist[1]) {\r\n                dist[1] = throttle(dist[1] * tempScaleValue[1], throttleScale) / tempScaleValue[1];\r\n            }\r\n        }\r\n        if (dist[0] === 0) {\r\n            dist[0] = sign(prevDist[0]) * MIN_SCALE;\r\n        }\r\n        if (dist[1] === 0) {\r\n            dist[1] = sign(prevDist[1]) * MIN_SCALE;\r\n        }\r\n        scale = multiply2(dist, [tempScaleValue[0], tempScaleValue[1]]);\r\n        var startOffsetSize = [\r\n            startOffsetWidth,\r\n            startOffsetHeight,\r\n        ];\r\n        var scaleSize = [\r\n            startOffsetWidth * scale[0],\r\n            startOffsetHeight * scale[1],\r\n        ];\r\n        scaleSize = calculateBoundSize(scaleSize, datas.minScaleSize, datas.maxScaleSize, keepRatio ? ratio : false);\r\n        // if (keepRatio && (isGroup || keepRatioFinally)) {\r\n        //     if (isWidth) {\r\n        //         boundingHeight = boundingWidth / ratio;\r\n        //     } else {\r\n        //         boundingWidth = boundingHeight * ratio;\r\n        //     }\r\n        // }\r\n        scale = countEach(2, function (i) {\r\n            return startOffsetSize[i] ? scaleSize[i] / startOffsetSize[i] : scaleSize[i];\r\n        });\r\n        dist = countEach(2, function (i) {\r\n            return scale[i] / tempScaleValue[i];\r\n        });\r\n        var delta = countEach(2, function (i) { return prevDist[i] ? dist[i] / prevDist[i] : dist[i]; });\r\n        var distText = \"scale(\".concat(dist.join(\", \"), \")\");\r\n        var scaleText = \"scale(\".concat(scale.join(\", \"), \")\");\r\n        var nextTransform = convertTransformFormat(datas, scaleText, distText);\r\n        var isZeroScale = !startValue[0] || !startValue[1];\r\n        var inverseDist = getScaleDist(moveable, isZeroScale ? scaleText : distText, datas.fixedDirection, fixedPosition, datas.fixedOffset, datas, isZeroScale);\r\n        var inverseDelta = isSelfPinch ? inverseDist : minus(inverseDist, datas.prevInverseDist || [0, 0]);\r\n        datas.prevDist = dist;\r\n        datas.prevInverseDist = inverseDist;\r\n        if (scale[0] === prevDist[0] && scale[1] === prevDist[1]\r\n            && inverseDelta.every(function (num) { return !num; })\r\n            && !parentMoveable\r\n            && !isSelfPinch) {\r\n            return false;\r\n        }\r\n        var params = fillParams(moveable, e, __assign({ offsetWidth: startOffsetWidth, offsetHeight: startOffsetHeight, direction: direction, scale: scale, dist: dist, delta: delta, isPinch: !!isPinch }, fillTransformEvent(moveable, nextTransform, inverseDelta, isPinch, e)));\r\n        triggerEvent(moveable, \"onScale\", params);\r\n        return params;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isScale) {\r\n            return false;\r\n        }\r\n        datas.isScale = false;\r\n        var scaleEndParam = fillEndParams(moveable, e, {});\r\n        triggerEvent(moveable, \"onScaleEnd\", scaleEndParam);\r\n        return scaleEndParam;\r\n    },\r\n    dragGroupControlCondition: directionCondition,\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var params = this.dragControlStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        var originalEvents = fillChildEvents(moveable, \"resizable\", e);\r\n        datas.moveableScale = moveable.scale;\r\n        var events = triggerChildAbles(moveable, this, \"dragControlStart\", e, function (child, ev) {\r\n            return startChildDist(moveable, child, datas, ev);\r\n        });\r\n        var setFixedDirection = function (fixedDirection) {\r\n            params.setFixedDirection(fixedDirection);\r\n            events.forEach(function (ev, i) {\r\n                ev.setFixedDirection(fixedDirection);\r\n                startChildDist(moveable, ev.moveable, datas, originalEvents[i]);\r\n            });\r\n        };\r\n        datas.setFixedDirection = setFixedDirection;\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: events, setFixedDirection: setFixedDirection });\r\n        var result = triggerEvent(moveable, \"onScaleGroupStart\", nextParams);\r\n        datas.isScale = result !== false;\r\n        return datas.isScale ? nextParams : false;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isScale) {\r\n            return;\r\n        }\r\n        catchEvent(moveable, \"onBeforeScale\", function (parentEvent) {\r\n            triggerEvent(moveable, \"onBeforeScaleGroup\", fillParams(moveable, e, __assign(__assign({}, parentEvent), { targets: moveable.props.targets }), true));\r\n        });\r\n        var params = this.dragControl(moveable, e);\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var dist = params.dist;\r\n        var moveableScale = datas.moveableScale;\r\n        moveable.scale = [\r\n            dist[0] * moveableScale[0],\r\n            dist[1] * moveableScale[1],\r\n        ];\r\n        var keepRatio = moveable.props.keepRatio;\r\n        var fixedPosition = datas.fixedPosition;\r\n        var events = triggerChildAbles(moveable, this, \"dragControl\", e, function (_, ev) {\r\n            var _a = __read(calculate(createRotateMatrix(moveable.rotation / 180 * Math.PI, 3), [\r\n                ev.datas.originalX * dist[0],\r\n                ev.datas.originalY * dist[1],\r\n                1,\r\n            ], 3), 2), clientX = _a[0], clientY = _a[1];\r\n            return __assign(__assign({}, ev), { parentDist: null, parentScale: dist, parentKeepRatio: keepRatio, \r\n                // recalculate child fixed position for parent group's dragging.\r\n                dragClient: plus(fixedPosition, [clientX, clientY]) });\r\n        });\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events }, params);\r\n        triggerEvent(moveable, \"onScaleGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isScale) {\r\n            return;\r\n        }\r\n        this.dragControlEnd(moveable, e);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlEnd\", e);\r\n        var nextParams = fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: events,\r\n        });\r\n        triggerEvent(moveable, \"onScaleGroupEnd\", nextParams);\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Scalable#request\r\n     * @param {Moveable.Scalable.ScalableRequestParam} e - the Scalable's request parameter\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * moveable.request(\"scalable\", { deltaWidth: 10, deltaHeight: 10 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"scalable\");\r\n     *\r\n     * // request\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function () {\r\n        var datas = {};\r\n        var distWidth = 0;\r\n        var distHeight = 0;\r\n        var useSnap = false;\r\n        return {\r\n            isControl: true,\r\n            requestStart: function (e) {\r\n                useSnap = e.useSnap;\r\n                return {\r\n                    datas: datas,\r\n                    parentDirection: e.direction || [1, 1],\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            request: function (e) {\r\n                distWidth += e.deltaWidth;\r\n                distHeight += e.deltaHeight;\r\n                return {\r\n                    datas: datas,\r\n                    parentDist: [distWidth, distHeight],\r\n                    parentKeepRatio: e.keepRatio,\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true, useSnap: useSnap };\r\n            },\r\n        };\r\n    },\r\n};\r\n/**\r\n * Whether or not target can scaled.\r\n *\r\n * @name Moveable.Scalable#scalable\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.scalable = true;\r\n */\r\n/**\r\n * throttle of scaleX, scaleY when scale.\r\n * @name Moveable.Scalable#throttleScale\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.throttleScale = 0.1;\r\n */\r\n/**\r\n * Set directions to show the control box. (default: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"])\r\n * @name Moveable.Scalable#renderDirections\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     scalable: true,\r\n *   renderDirections: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"],\r\n * });\r\n *\r\n * moveable.renderDirections = [\"nw\", \"ne\", \"sw\", \"se\"];\r\n */\r\n/**\r\n * When resize or scale, keeps a ratio of the width, height. (default: false)\r\n * @name Moveable.Scalable#keepRatio\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     scalable: true,\r\n * });\r\n *\r\n * moveable.keepRatio = true;\r\n */\r\n/**\r\n * When the scale starts, the scaleStart event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scaleStart\r\n * @param {Moveable.Scalable.OnScaleStart} - Parameters for the scaleStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"scaleStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When scaling, `beforeScale` is called before `scale` occurs. In `beforeScale`, you can get and set the pre-value before scaling.\r\n * @memberof Moveable.Scalable\r\n * @event beforeScale\r\n * @param {Moveable.Scalable.OnBeforeScale} - Parameters for the `beforeScale` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"beforeScale\", ({ setFixedDirection }) => {\r\n *     if (shiftKey) {\r\n *        setFixedDirection([0, 0]);\r\n *     }\r\n * });\r\n * moveable.on(\"scale\", ({ target, transform, dist }) => {\r\n *     target.style.transform = transform;\r\n * });\r\n */\r\n/**\r\n * When scaling, the `scale` event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scale\r\n * @param {Moveable.Scalable.OnScale} - Parameters for the `scale` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"scale\", ({ target, transform, dist }) => {\r\n *     target.style.transform = transform;\r\n * });\r\n */\r\n/**\r\n * When the scale finishes, the `scaleEnd` event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scaleEnd\r\n * @param {Moveable.Scalable.OnScaleEnd} - Parameters for the `scaleEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"scaleEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n* When the group scale starts, the `scaleGroupStart` event is called.\r\n* @memberof Moveable.Scalable\r\n* @event scaleGroupStart\r\n* @param {Moveable.Scalable.OnScaleGroupStart} - Parameters for the `scaleGroupStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     scalable: true\r\n* });\r\n* moveable.on(\"scaleGroupStart\", ({ targets }) => {\r\n*     console.log(\"onScaleGroupStart\", targets);\r\n* });\r\n*/\r\n/**\r\n* When the group scale, the `scaleGroup` event is called.\r\n* @memberof Moveable.Scalable\r\n* @event scaleGroup\r\n* @param {Moveable.Scalable.OnScaleGroup} - Parameters for the `scaleGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     scalable: true\r\n* });\r\n* moveable.on(\"scaleGroup\", ({ targets, events }) => {\r\n*     console.log(\"onScaleGroup\", targets);\r\n*     events.forEach(ev => {\r\n*         const target = ev.target;\r\n*         // ev.drag is a drag event that occurs when the group scale.\r\n*         const left = ev.drag.beforeDist[0];\r\n*         const top = ev.drag.beforeDist[1];\r\n*         const scaleX = ev.scale[0];\r\n*         const scaleY = ev.scale[1];\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group scale finishes, the `scaleGroupEnd` event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scaleGroupEnd\r\n * @param {Moveable.Scalable.OnScaleGroupEnd} - Parameters for the `scaleGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     scalable: true\r\n * });\r\n * moveable.on(\"scaleGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onScaleGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nfunction getMiddleLinePos(pos1, pos2) {\r\n    return pos1.map(function (pos, i) { return dot(pos, pos2[i], 1, 2); });\r\n}\r\nfunction getTriangleRad(pos1, pos2, pos3) {\r\n    // pos1 Rad\r\n    var rad1 = getRad(pos1, pos2);\r\n    var rad2 = getRad(pos1, pos3);\r\n    var rad = rad2 - rad1;\r\n    return rad >= 0 ? rad : rad + 2 * Math.PI;\r\n}\r\nfunction isValidPos(poses1, poses2) {\r\n    var rad1 = getTriangleRad(poses1[0], poses1[1], poses1[2]);\r\n    var rad2 = getTriangleRad(poses2[0], poses2[1], poses2[2]);\r\n    var pi = Math.PI;\r\n    if ((rad1 >= pi && rad2 <= pi) || (rad1 <= pi && rad2 >= pi)) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * @namespace Moveable.Warpable\r\n * @description Warpable indicates whether the target can be warped(distorted, bented).\r\n */\r\nvar Warpable = {\r\n    name: \"warpable\",\r\n    ableGroup: \"size\",\r\n    props: [\r\n        \"warpable\",\r\n        \"renderDirections\",\r\n        \"edge\",\r\n        \"displayAroundControls\",\r\n    ],\r\n    events: [\r\n        \"warpStart\",\r\n        \"warp\",\r\n        \"warpEnd\",\r\n    ],\r\n    viewClassName: getDirectionViewClassName(\"warpable\"),\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, resizable = _a.resizable, scalable = _a.scalable, warpable = _a.warpable, zoom = _a.zoom;\r\n        if (resizable || scalable || !warpable) {\r\n            return [];\r\n        }\r\n        var _b = moveable.state, pos1 = _b.pos1, pos2 = _b.pos2, pos3 = _b.pos3, pos4 = _b.pos4;\r\n        var linePosFrom1 = getMiddleLinePos(pos1, pos2);\r\n        var linePosFrom2 = getMiddleLinePos(pos2, pos1);\r\n        var linePosFrom3 = getMiddleLinePos(pos1, pos3);\r\n        var linePosFrom4 = getMiddleLinePos(pos3, pos1);\r\n        var linePosTo1 = getMiddleLinePos(pos3, pos4);\r\n        var linePosTo2 = getMiddleLinePos(pos4, pos3);\r\n        var linePosTo3 = getMiddleLinePos(pos2, pos4);\r\n        var linePosTo4 = getMiddleLinePos(pos4, pos2);\r\n        return __spreadArray([\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine1\", style: getLineStyle(linePosFrom1, linePosTo1, zoom) }),\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine2\", style: getLineStyle(linePosFrom2, linePosTo2, zoom) }),\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine3\", style: getLineStyle(linePosFrom3, linePosTo3, zoom) }),\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine4\", style: getLineStyle(linePosFrom4, linePosTo4, zoom) })\r\n        ], __read(renderAllDirections(moveable, \"warpable\", React)), false);\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        if (e.isRequest) {\r\n            return false;\r\n        }\r\n        var target = e.inputEvent.target;\r\n        return hasClass(target, prefix(\"direction\")) && hasClass(target, prefix(\"warpable\"));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var datas = e.datas, inputEvent = e.inputEvent;\r\n        var target = moveable.props.target;\r\n        var inputTarget = inputEvent.target;\r\n        var direction = getDirection(inputTarget, datas);\r\n        if (!direction || !target) {\r\n            return false;\r\n        }\r\n        var state = moveable.state;\r\n        var transformOrigin = state.transformOrigin, is3d = state.is3d, targetTransform = state.targetTransform, targetMatrix = state.targetMatrix, width = state.width, height = state.height, left = state.left, top = state.top;\r\n        datas.datas = {};\r\n        datas.targetTransform = targetTransform;\r\n        datas.warpTargetMatrix = is3d ? targetMatrix : convertDimension(targetMatrix, 3, 4);\r\n        datas.targetInverseMatrix = ignoreDimension(invert(datas.warpTargetMatrix, 4), 3, 4);\r\n        datas.direction = direction;\r\n        datas.left = left;\r\n        datas.top = top;\r\n        datas.poses = [\r\n            [0, 0],\r\n            [width, 0],\r\n            [0, height],\r\n            [width, height],\r\n        ].map(function (p) { return minus(p, transformOrigin); });\r\n        datas.nextPoses = datas.poses.map(function (_a) {\r\n            var _b = __read(_a, 2), x = _b[0], y = _b[1];\r\n            return calculate(datas.warpTargetMatrix, [x, y, 0, 1], 4);\r\n        });\r\n        datas.startValue = createIdentityMatrix(4);\r\n        datas.prevMatrix = createIdentityMatrix(4);\r\n        datas.absolutePoses = getAbsolutePosesByState(state);\r\n        datas.posIndexes = getPosIndexesByDirection(direction);\r\n        setDragStart(moveable, e);\r\n        setDefaultTransformIndex(moveable, e, \"matrix3d\");\r\n        state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n            direction: direction,\r\n        };\r\n        var params = fillParams(moveable, e, __assign({ set: function (matrix) {\r\n                datas.startValue = matrix;\r\n            } }, fillTransformStartEvent(moveable, e)));\r\n        var result = triggerEvent(moveable, \"onWarpStart\", params);\r\n        if (result !== false) {\r\n            datas.isWarp = true;\r\n        }\r\n        return datas.isWarp;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var datas = e.datas, isRequest = e.isRequest;\r\n        var distX = e.distX, distY = e.distY;\r\n        var targetInverseMatrix = datas.targetInverseMatrix, prevMatrix = datas.prevMatrix, isWarp = datas.isWarp, startValue = datas.startValue, poses = datas.poses, posIndexes = datas.posIndexes, absolutePoses = datas.absolutePoses;\r\n        if (!isWarp) {\r\n            return false;\r\n        }\r\n        resolveTransformEvent(moveable, e, \"matrix3d\");\r\n        if (hasGuidelines(moveable, \"warpable\")) {\r\n            var selectedPoses = posIndexes.map(function (index) { return absolutePoses[index]; });\r\n            if (selectedPoses.length > 1) {\r\n                selectedPoses.push([\r\n                    (selectedPoses[0][0] + selectedPoses[1][0]) / 2,\r\n                    (selectedPoses[0][1] + selectedPoses[1][1]) / 2,\r\n                ]);\r\n            }\r\n            var _a = checkMoveableSnapBounds(moveable, isRequest, {\r\n                horizontal: selectedPoses.map(function (pos) { return pos[1] + distY; }),\r\n                vertical: selectedPoses.map(function (pos) { return pos[0] + distX; }),\r\n            }), horizontalSnapInfo = _a.horizontal, verticalSnapInfo = _a.vertical;\r\n            distY -= horizontalSnapInfo.offset;\r\n            distX -= verticalSnapInfo.offset;\r\n        }\r\n        var dist = getDragDist({ datas: datas, distX: distX, distY: distY }, true);\r\n        var nextPoses = datas.nextPoses.slice();\r\n        posIndexes.forEach(function (index) {\r\n            nextPoses[index] = plus(nextPoses[index], dist);\r\n        });\r\n        if (!NEARBY_POS.every(function (nearByPoses) { return isValidPos(nearByPoses.map(function (i) { return poses[i]; }), nearByPoses.map(function (i) { return nextPoses[i]; })); })) {\r\n            return false;\r\n        }\r\n        var h = createWarpMatrix(poses[0], poses[2], poses[1], poses[3], nextPoses[0], nextPoses[2], nextPoses[1], nextPoses[3]);\r\n        if (!h.length) {\r\n            return false;\r\n        }\r\n        // B * A * M\r\n        var afterMatrix = multiply(targetInverseMatrix, h, 4);\r\n        // B * M * A\r\n        var matrix = getTransfromMatrix(datas, afterMatrix, true);\r\n        var delta = multiply(invert(prevMatrix, 4), matrix, 4);\r\n        datas.prevMatrix = matrix;\r\n        var totalMatrix = multiply(startValue, matrix, 4);\r\n        var nextTransform = convertTransformFormat(datas, \"matrix3d(\".concat(totalMatrix.join(\", \"), \")\"), \"matrix3d(\".concat(matrix.join(\", \"), \")\"));\r\n        fillOriginalTransform(e, nextTransform);\r\n        triggerEvent(moveable, \"onWarp\", fillParams(moveable, e, __assign({ delta: delta, matrix: totalMatrix, dist: matrix, multiply: multiply, transform: nextTransform }, fillCSSObject({\r\n            transform: nextTransform,\r\n        }, e))));\r\n        return true;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas, isDrag = e.isDrag;\r\n        if (!datas.isWarp) {\r\n            return false;\r\n        }\r\n        datas.isWarp = false;\r\n        triggerEvent(moveable, \"onWarpEnd\", fillEndParams(moveable, e, {}));\r\n        return isDrag;\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be warped. (default: false)\r\n * @name Moveable.Warpable#warpable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.warpable = true;\r\n */\r\n/**\r\n* Set directions to show the control box. (default: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"])\r\n* @name Moveable.Warpable#renderDirections\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     warpable: true,\r\n*     renderDirections: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"],\r\n* });\r\n*\r\n* moveable.renderDirections = [\"nw\", \"ne\", \"sw\", \"se\"];\r\n*/\r\n/**\r\n* When the warp starts, the warpStart event is called.\r\n* @memberof Moveable.Warpable\r\n* @event warpStart\r\n* @param {Moveable.Warpable.OnWarpStart} - Parameters for the warpStart event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, { warpable: true });\r\n* moveable.on(\"warpStart\", ({ target }) => {\r\n*     console.log(target);\r\n* });\r\n*/\r\n/**\r\n * When warping, the warp event is called.\r\n * @memberof Moveable.Warpable\r\n * @event warp\r\n * @param {Moveable.Warpable.OnWarp} - Parameters for the warp event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n * let matrix = [\r\n *  1, 0, 0, 0,\r\n *  0, 1, 0, 0,\r\n *  0, 0, 1, 0,\r\n *  0, 0, 0, 1,\r\n * ];\r\n * const moveable = new Moveable(document.body, { warpable: true });\r\n * moveable.on(\"warp\", ({ target, transform, delta, multiply }) => {\r\n *    // target.style.transform = transform;\r\n *    matrix = multiply(matrix, delta);\r\n *    target.style.transform = `matrix3d(${matrix.join(\",\")})`;\r\n * });\r\n */\r\n/**\r\n * When the warp finishes, the warpEnd event is called.\r\n * @memberof Moveable.Warpable\r\n * @event warpEnd\r\n * @param {Moveable.Warpable.OnWarpEnd} - Parameters for the warpEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { warpable: true });\r\n * moveable.on(\"warpEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\n\nvar AREA_PIECES = /*#__PURE__*/ prefix(\"area-pieces\");\r\nvar AREA_PIECE = /*#__PURE__*/ prefix(\"area-piece\");\r\nvar AVOID = /*#__PURE__*/ prefix(\"avoid\");\r\nvar VIEW_DRAGGING = prefix(\"view-dragging\");\n\nfunction restoreStyle(moveable) {\r\n    var el = moveable.areaElement;\r\n    if (!el) {\r\n        return;\r\n    }\r\n    var _a = moveable.state, width = _a.width, height = _a.height;\r\n    removeClass(el, AVOID);\r\n    el.style.cssText += \"left: 0px; top: 0px; width: \".concat(width, \"px; height: \").concat(height, \"px\");\r\n}\r\nfunction renderPieces(React) {\r\n    return (React.createElement(\"div\", { key: \"area_pieces\", className: AREA_PIECES },\r\n        React.createElement(\"div\", { className: AREA_PIECE }),\r\n        React.createElement(\"div\", { className: AREA_PIECE }),\r\n        React.createElement(\"div\", { className: AREA_PIECE }),\r\n        React.createElement(\"div\", { className: AREA_PIECE })));\r\n}\r\nvar DragArea = {\r\n    name: \"dragArea\",\r\n    props: [\r\n        \"dragArea\",\r\n        \"passDragArea\",\r\n    ],\r\n    events: [\r\n        \"click\",\r\n        \"clickGroup\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, target = _a.target, dragArea = _a.dragArea, groupable = _a.groupable, passDragArea = _a.passDragArea;\r\n        var _b = moveable.getState(), width = _b.width, height = _b.height, renderPoses = _b.renderPoses;\r\n        var className = passDragArea ? prefix(\"area\", \"pass\") : prefix(\"area\");\r\n        if (groupable) {\r\n            return [\r\n                React.createElement(\"div\", { key: \"area\", ref: ref(moveable, \"areaElement\"), className: className }),\r\n                renderPieces(React),\r\n            ];\r\n        }\r\n        if (!target || !dragArea) {\r\n            return [];\r\n        }\r\n        var h = createWarpMatrix([0, 0], [width, 0], [0, height], [width, height], renderPoses[0], renderPoses[1], renderPoses[2], renderPoses[3]);\r\n        var transform = h.length ? makeMatrixCSS(h, true) : \"none\";\r\n        return [\r\n            React.createElement(\"div\", { key: \"area\", ref: ref(moveable, \"areaElement\"), className: className, style: {\r\n                    top: \"0px\",\r\n                    left: \"0px\",\r\n                    width: \"\".concat(width, \"px\"),\r\n                    height: \"\".concat(height, \"px\"),\r\n                    transformOrigin: \"0 0\",\r\n                    transform: transform,\r\n                } }),\r\n            renderPieces(React),\r\n        ];\r\n    },\r\n    dragStart: function (moveable, _a) {\r\n        var datas = _a.datas, clientX = _a.clientX, clientY = _a.clientY, inputEvent = _a.inputEvent;\r\n        if (!inputEvent) {\r\n            return false;\r\n        }\r\n        datas.isDragArea = false;\r\n        var areaElement = moveable.areaElement;\r\n        var state = moveable.state;\r\n        var moveableClientRect = state.moveableClientRect, renderPoses = state.renderPoses, rootMatrix = state.rootMatrix, is3d = state.is3d;\r\n        var left = moveableClientRect.left, top = moveableClientRect.top;\r\n        var _b = getRect(renderPoses), relativeLeft = _b.left, relativeTop = _b.top, width = _b.width, height = _b.height;\r\n        var n = is3d ? 4 : 3;\r\n        var _c = __read(calculateInversePosition(rootMatrix, [clientX - left, clientY - top], n), 2), posX = _c[0], posY = _c[1];\r\n        posX -= relativeLeft;\r\n        posY -= relativeTop;\r\n        var rects = [\r\n            { left: relativeLeft, top: relativeTop, width: width, height: posY - 10 },\r\n            { left: relativeLeft, top: relativeTop, width: posX - 10, height: height },\r\n            { left: relativeLeft, top: relativeTop + posY + 10, width: width, height: height - posY - 10 },\r\n            { left: relativeLeft + posX + 10, top: relativeTop, width: width - posX - 10, height: height },\r\n        ];\r\n        var children = [].slice.call(areaElement.nextElementSibling.children);\r\n        rects.forEach(function (rect, i) {\r\n            children[i].style.cssText\r\n                = \"left: \".concat(rect.left, \"px;top: \").concat(rect.top, \"px; width: \").concat(rect.width, \"px; height: \").concat(rect.height, \"px;\");\r\n        });\r\n        addClass(areaElement, AVOID);\r\n        state.disableNativeEvent = true;\r\n        return;\r\n    },\r\n    drag: function (moveable, _a) {\r\n        var datas = _a.datas, inputEvent = _a.inputEvent;\r\n        this.enableNativeEvent(moveable);\r\n        if (!inputEvent) {\r\n            return false;\r\n        }\r\n        if (!datas.isDragArea) {\r\n            datas.isDragArea = true;\r\n            restoreStyle(moveable);\r\n        }\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        this.enableNativeEvent(moveable);\r\n        var inputEvent = e.inputEvent, datas = e.datas;\r\n        if (!inputEvent) {\r\n            return false;\r\n        }\r\n        if (!datas.isDragArea) {\r\n            restoreStyle(moveable);\r\n        }\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        return this.dragStart(moveable, e);\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    unset: function (moveable) {\r\n        restoreStyle(moveable);\r\n        moveable.state.disableNativeEvent = false;\r\n    },\r\n    enableNativeEvent: function (moveable) {\r\n        var state = moveable.state;\r\n        if (state.disableNativeEvent) {\r\n            requestAnimationFrame(function () {\r\n                state.disableNativeEvent = false;\r\n            });\r\n        }\r\n    },\r\n};\r\n/**\r\n * Add an event to the moveable area instead of the target for stopPropagation. (default: false, true in group)\r\n * @name Moveable#dragArea\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  dragArea: false,\r\n * });\r\n */\r\n/**\r\n * Set `pointerEvents: none;` css to pass events in dragArea. (default: false)\r\n * @name Moveable#passDragArea\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  dragArea: false,\r\n * });\r\n */\n\nvar Origin = makeAble(\"origin\", {\r\n    props: [\"origin\", \"svgOrigin\"],\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, zoom = _a.zoom, svgOrigin = _a.svgOrigin, groupable = _a.groupable;\r\n        var _b = moveable.getState(), beforeOrigin = _b.beforeOrigin, rotation = _b.rotation, svg = _b.svg, allMatrix = _b.allMatrix, is3d = _b.is3d, left = _b.left, top = _b.top, offsetWidth = _b.offsetWidth, offsetHeight = _b.offsetHeight;\r\n        var originStyle;\r\n        if (!groupable && svg && svgOrigin) {\r\n            var _c = __read(convertTransformOriginArray(svgOrigin, offsetWidth, offsetHeight), 2), originX = _c[0], originY = _c[1];\r\n            var n = is3d ? 4 : 3;\r\n            var result = calculatePosition(allMatrix, [originX, originY], n);\r\n            originStyle = getControlTransform(rotation, zoom, minus(result, [left, top]));\r\n        }\r\n        else {\r\n            originStyle = getControlTransform(rotation, zoom, beforeOrigin);\r\n        }\r\n        return [\r\n            React.createElement(\"div\", { className: prefix(\"control\", \"origin\"), style: originStyle, key: \"beforeOrigin\" }),\r\n        ];\r\n    },\r\n});\r\n/**\r\n * Whether or not the origin controlbox will be visible or not (default: true)\r\n * @name Moveable#origin\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.origin = true;\r\n */\n\nfunction getDefaultScrollPosition(e) {\r\n    var scrollContainer = e.scrollContainer;\r\n    return [\r\n        scrollContainer.scrollLeft,\r\n        scrollContainer.scrollTop,\r\n    ];\r\n}\r\n/**\r\n * @namespace Moveable.Scrollable\r\n * @description Whether or not target can be scrolled to the scroll container (default: false)\r\n */\r\nvar Scrollable = {\r\n    name: \"scrollable\",\r\n    canPinch: true,\r\n    props: [\r\n        \"scrollable\",\r\n        \"scrollContainer\",\r\n        \"scrollThreshold\",\r\n        \"scrollThrottleTime\",\r\n        \"getScrollPosition\",\r\n        \"scrollOptions\",\r\n    ],\r\n    events: [\r\n        \"scroll\",\r\n        \"scrollGroup\",\r\n    ],\r\n    dragRelation: \"strong\",\r\n    dragStart: function (moveable, e) {\r\n        var props = moveable.props;\r\n        var _a = props.scrollContainer, scrollContainer = _a === void 0 ? moveable.getContainer() : _a, scrollOptions = props.scrollOptions;\r\n        var dragScroll = new DragScroll();\r\n        var scrollContainerElement = getRefTarget(scrollContainer, true);\r\n        e.datas.dragScroll = dragScroll;\r\n        moveable.state.dragScroll = dragScroll;\r\n        var gestoName = e.isControl ? \"controlGesto\" : \"targetGesto\";\r\n        var targets = e.targets;\r\n        dragScroll.on(\"scroll\", function (_a) {\r\n            var container = _a.container, direction = _a.direction;\r\n            var params = fillParams(moveable, e, {\r\n                scrollContainer: container,\r\n                direction: direction,\r\n            });\r\n            var eventName = targets ? \"onScrollGroup\" : \"onScroll\";\r\n            if (targets) {\r\n                params.targets = targets;\r\n            }\r\n            triggerEvent(moveable, eventName, params);\r\n        }).on(\"move\", function (_a) {\r\n            var offsetX = _a.offsetX, offsetY = _a.offsetY, inputEvent = _a.inputEvent;\r\n            moveable[gestoName].scrollBy(offsetX, offsetY, inputEvent.inputEvent, false);\r\n        }).on(\"scrollDrag\", function (_a) {\r\n            var next = _a.next;\r\n            next(moveable[gestoName].getCurrentEvent());\r\n        });\r\n        dragScroll.dragStart(e, __assign({ container: scrollContainerElement }, scrollOptions));\r\n    },\r\n    checkScroll: function (moveable, e) {\r\n        var dragScroll = e.datas.dragScroll;\r\n        if (!dragScroll) {\r\n            return;\r\n        }\r\n        var _a = moveable.props, _b = _a.scrollContainer, scrollContainer = _b === void 0 ? moveable.getContainer() : _b, _c = _a.scrollThreshold, scrollThreshold = _c === void 0 ? 0 : _c, _d = _a.scrollThrottleTime, scrollThrottleTime = _d === void 0 ? 0 : _d, _e = _a.getScrollPosition, getScrollPosition = _e === void 0 ? getDefaultScrollPosition : _e, scrollOptions = _a.scrollOptions;\r\n        dragScroll.drag(e, __assign({ container: scrollContainer, threshold: scrollThreshold, throttleTime: scrollThrottleTime, getScrollPosition: function (ev) {\r\n                return getScrollPosition({ scrollContainer: ev.container, direction: ev.direction });\r\n            } }, scrollOptions));\r\n        return true;\r\n    },\r\n    drag: function (moveable, e) {\r\n        return this.checkScroll(moveable, e);\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        e.datas.dragScroll.dragEnd();\r\n        e.datas.dragScroll = null;\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, __assign(__assign({}, e), { isControl: true }));\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        return this.dragStart(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        return this.drag(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, __assign(__assign({}, e), { targets: moveable.props.targets, isControl: true }));\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        return this.drag(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroupControEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    unset: function (moveable) {\r\n        var _a;\r\n        var state = moveable.state;\r\n        (_a = state.dragScroll) === null || _a === void 0 ? void 0 : _a.dragEnd();\r\n        state.dragScroll = null;\r\n    },\r\n};\r\n/**\r\n * When the drag cursor leaves the scrollContainer, the `scroll` event occur to scroll.\r\n * @memberof Moveable.Scrollable\r\n * @event scroll\r\n * @param {Moveable.Scrollable.OnScroll} - Parameters for the `scroll` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"scroll\", ({ scrollContainer, direction }) => {\r\n *   scrollContainer.scrollLeft += direction[0] * 10;\r\n *   scrollContainer.scrollTop += direction[1] * 10;\r\n * });\r\n */\r\n/**\r\n * When the drag cursor leaves the scrollContainer, the `scrollGroup` event occur to scroll in group.\r\n * @memberof Moveable.Scrollable\r\n * @event scrollGroup\r\n * @param {Moveable.Scrollable.OnScrollGroup} - Parameters for the `scrollGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"scroll\", ({ scrollContainer, direction }) => {\r\n *   scrollContainer.scrollLeft += direction[0] * 10;\r\n *   scrollContainer.scrollTop += direction[1] * 10;\r\n * });\r\n */\n\nvar Default = {\r\n    name: \"\",\r\n    props: [\r\n        \"target\",\r\n        \"dragTargetSelf\",\r\n        \"dragTarget\",\r\n        \"dragContainer\",\r\n        \"container\",\r\n        \"warpSelf\",\r\n        \"rootContainer\",\r\n        \"useResizeObserver\",\r\n        \"useMutationObserver\",\r\n        \"zoom\",\r\n        \"dragFocusedInput\",\r\n        \"transformOrigin\",\r\n        \"ables\",\r\n        \"className\",\r\n        \"pinchThreshold\",\r\n        \"pinchOutside\",\r\n        \"triggerAblesSimultaneously\",\r\n        \"checkInput\",\r\n        \"cspNonce\",\r\n        \"translateZ\",\r\n        \"hideDefaultLines\",\r\n        \"props\",\r\n        \"flushSync\",\r\n        \"stopPropagation\",\r\n        \"preventClickEventOnDrag\",\r\n        \"preventClickDefault\",\r\n        \"viewContainer\",\r\n        \"persistData\",\r\n        \"useAccuratePosition\",\r\n        \"firstRenderState\",\r\n        \"linePadding\",\r\n        \"controlPadding\",\r\n        \"preventDefault\",\r\n        \"preventRightClick\",\r\n        \"preventWheelClick\",\r\n        \"requestStyles\",\r\n    ],\r\n    events: [\r\n        \"changeTargets\",\r\n    ],\r\n};\n\nvar Padding = makeAble(\"padding\", {\r\n    props: [\"padding\"],\r\n    render: function (moveable, React) {\r\n        var props = moveable.props;\r\n        if (props.dragArea) {\r\n            return [];\r\n        }\r\n        var _a = getPaddingBox(props.padding || {}), left = _a.left, top = _a.top, right = _a.right, bottom = _a.bottom;\r\n        var _b = moveable.getState(), renderPoses = _b.renderPoses, pos1 = _b.pos1, pos2 = _b.pos2, pos3 = _b.pos3, pos4 = _b.pos4;\r\n        var poses = [pos1, pos2, pos3, pos4];\r\n        var paddingDirections = [];\r\n        if (left > 0) {\r\n            paddingDirections.push([0, 2]);\r\n        }\r\n        if (top > 0) {\r\n            paddingDirections.push([0, 1]);\r\n        }\r\n        if (right > 0) {\r\n            paddingDirections.push([1, 3]);\r\n        }\r\n        if (bottom > 0) {\r\n            paddingDirections.push([2, 3]);\r\n        }\r\n        return paddingDirections.map(function (_a, i) {\r\n            var _b = __read(_a, 2), dir1 = _b[0], dir2 = _b[1];\r\n            var paddingPos1 = poses[dir1];\r\n            var paddingPos2 = poses[dir2];\r\n            var paddingPos3 = renderPoses[dir1];\r\n            var paddingPos4 = renderPoses[dir2];\r\n            var h = createWarpMatrix([0, 0], [100, 0], [0, 100], [100, 100], paddingPos1, paddingPos2, paddingPos3, paddingPos4);\r\n            if (!h.length) {\r\n                return undefined;\r\n            }\r\n            return (React.createElement(\"div\", { key: \"padding\".concat(i), className: prefix(\"padding\"), style: {\r\n                    transform: makeMatrixCSS(h, true),\r\n                } }));\r\n        });\r\n    },\r\n});\r\n/**\r\n * Add padding around the target to increase the drag area.\r\n * @name Moveable#padding\r\n * @default null\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  target: document.querySelector(\".target\"),\r\n *  padding: { left: 0, top: 0, right: 0, bottom: 0 },\r\n * });\r\n * moveable.padding = { left: 10, top: 10, right: 10, bottom: 10 },\r\n * moveable.updateRect();\r\n */\n\nvar RADIUS_DIRECTIONS = [\"nw\", \"ne\", \"se\", \"sw\"];\r\nfunction calculateRatio(values, size) {\r\n    var sumSize = values[0] + values[1];\r\n    var sumRatio = sumSize > size ? size / sumSize : 1;\r\n    values[0] *= sumRatio;\r\n    values[1] = size - values[1] * sumRatio;\r\n    return values;\r\n}\r\nvar HORIZONTAL_RADIUS_ORDER = [1, 2, 5, 6];\r\nvar VERTICAL_RADIUS_ORDER = [0, 3, 4, 7];\r\nvar HORIZONTAL_RADIUS_DIRECTIONS = [1, -1, -1, 1];\r\nvar VERTICAL_RADIUS_DIRECTIONS = [1, 1, -1, -1];\r\nfunction getRadiusStyles(nextPoses, isRelative, width, height, left, top, right, bottom) {\r\n    if (left === void 0) { left = 0; }\r\n    if (top === void 0) { top = 0; }\r\n    if (right === void 0) { right = width; }\r\n    if (bottom === void 0) { bottom = height; }\r\n    var clipStyles = [];\r\n    var isVertical = false;\r\n    var radiusPoses = nextPoses.filter(function (pos) { return !pos.virtual; });\r\n    var raws = radiusPoses.map(function (posInfo) {\r\n        var horizontal = posInfo.horizontal, vertical = posInfo.vertical, pos = posInfo.pos;\r\n        if (vertical && !isVertical) {\r\n            isVertical = true;\r\n            clipStyles.push(\"/\");\r\n        }\r\n        if (isVertical) {\r\n            var rawPos = Math.max(0, vertical === 1 ? pos[1] - top : bottom - pos[1]);\r\n            clipStyles.push(convertCSSSize(rawPos, height, isRelative));\r\n            return rawPos;\r\n        }\r\n        else {\r\n            var rawPos = Math.max(0, horizontal === 1 ? pos[0] - left : right - pos[0]);\r\n            clipStyles.push(convertCSSSize(rawPos, width, isRelative));\r\n            return rawPos;\r\n        }\r\n    });\r\n    return {\r\n        radiusPoses: radiusPoses,\r\n        styles: clipStyles,\r\n        raws: raws,\r\n    };\r\n}\r\nfunction getRadiusRange(controlPoses) {\r\n    // [start, length]\r\n    var horizontalRange = [0, 0];\r\n    var verticalRange = [0, 0];\r\n    var length = controlPoses.length;\r\n    for (var i = 0; i < length; ++i) {\r\n        var clipPose = controlPoses[i];\r\n        if (!clipPose.sub) {\r\n            continue;\r\n        }\r\n        if (clipPose.horizontal) {\r\n            if (horizontalRange[1] === 0) {\r\n                horizontalRange[0] = i;\r\n            }\r\n            horizontalRange[1] = i - horizontalRange[0] + 1;\r\n            verticalRange[0] = i + 1;\r\n        }\r\n        if (clipPose.vertical) {\r\n            if (verticalRange[1] === 0) {\r\n                verticalRange[0] = i;\r\n            }\r\n            verticalRange[1] = i - verticalRange[0] + 1;\r\n        }\r\n    }\r\n    return {\r\n        horizontalRange: horizontalRange,\r\n        verticalRange: verticalRange,\r\n    };\r\n}\r\nfunction getRadiusValues(values, width, height, left, top, minCounts, full) {\r\n    var _a, _b, _c, _d;\r\n    if (minCounts === void 0) { minCounts = [0, 0]; }\r\n    if (full === void 0) { full = false; }\r\n    var splitIndex = values.indexOf(\"/\");\r\n    var splitLength = (splitIndex > -1 ? values.slice(0, splitIndex) : values).length;\r\n    var horizontalValues = values.slice(0, splitLength);\r\n    var verticalValues = values.slice(splitLength + 1);\r\n    var horizontalValuesLength = horizontalValues.length;\r\n    var verticalValuesLength = verticalValues.length;\r\n    var hasVerticalValues = verticalValuesLength > 0;\r\n    var _e = __read(horizontalValues, 4), _f = _e[0], nwValue = _f === void 0 ? \"0px\" : _f, _g = _e[1], neValue = _g === void 0 ? nwValue : _g, _h = _e[2], seValue = _h === void 0 ? nwValue : _h, _j = _e[3], swValue = _j === void 0 ? neValue : _j;\r\n    var _k = __read(verticalValues, 4), _l = _k[0], wnValue = _l === void 0 ? nwValue : _l, _m = _k[1], enValue = _m === void 0 ? hasVerticalValues ? wnValue : neValue : _m, _o = _k[2], esValue = _o === void 0 ? hasVerticalValues ? wnValue : seValue : _o, _p = _k[3], wsValue = _p === void 0 ? hasVerticalValues ? enValue : swValue : _p;\r\n    var horizontalRawPoses = [nwValue, neValue, seValue, swValue].map(function (pos) { return convertUnitSize(pos, width); });\r\n    var verticalRawPoses = [wnValue, enValue, esValue, wsValue].map(function (pos) { return convertUnitSize(pos, height); });\r\n    var horizontalPoses = horizontalRawPoses.slice();\r\n    var verticalPoses = verticalRawPoses.slice();\r\n    _a = __read(calculateRatio([horizontalPoses[0], horizontalPoses[1]], width), 2), horizontalPoses[0] = _a[0], horizontalPoses[1] = _a[1];\r\n    _b = __read(calculateRatio([horizontalPoses[3], horizontalPoses[2]], width), 2), horizontalPoses[3] = _b[0], horizontalPoses[2] = _b[1];\r\n    _c = __read(calculateRatio([verticalPoses[0], verticalPoses[3]], height), 2), verticalPoses[0] = _c[0], verticalPoses[3] = _c[1];\r\n    _d = __read(calculateRatio([verticalPoses[1], verticalPoses[2]], height), 2), verticalPoses[1] = _d[0], verticalPoses[2] = _d[1];\r\n    var nextHorizontalPoses = full\r\n        ? horizontalPoses\r\n        : horizontalPoses.slice(0, Math.max(minCounts[0], horizontalValuesLength));\r\n    var nextVerticalPoses = full\r\n        ? verticalPoses\r\n        : verticalPoses.slice(0, Math.max(minCounts[1], verticalValuesLength));\r\n    return __spreadArray(__spreadArray([], __read(nextHorizontalPoses.map(function (pos, i) {\r\n        var direction = RADIUS_DIRECTIONS[i];\r\n        return {\r\n            virtual: i >= horizontalValuesLength,\r\n            horizontal: HORIZONTAL_RADIUS_DIRECTIONS[i],\r\n            vertical: 0,\r\n            pos: [left + pos, top + (VERTICAL_RADIUS_DIRECTIONS[i] === -1 ? height : 0)],\r\n            sub: true,\r\n            raw: horizontalRawPoses[i],\r\n            direction: direction,\r\n        };\r\n    })), false), __read(nextVerticalPoses.map(function (pos, i) {\r\n        var direction = RADIUS_DIRECTIONS[i];\r\n        return {\r\n            virtual: i >= verticalValuesLength,\r\n            horizontal: 0,\r\n            vertical: VERTICAL_RADIUS_DIRECTIONS[i],\r\n            pos: [left + (HORIZONTAL_RADIUS_DIRECTIONS[i] === -1 ? width : 0), top + pos],\r\n            sub: true,\r\n            raw: verticalRawPoses[i],\r\n            direction: direction,\r\n        };\r\n    })), false);\r\n}\r\nfunction removeRadiusPos(controlPoses, poses, index, startIndex, length) {\r\n    if (length === void 0) { length = poses.length; }\r\n    var _a = getRadiusRange(controlPoses.slice(startIndex)), horizontalRange = _a.horizontalRange, verticalRange = _a.verticalRange;\r\n    var radiuslIndex = index - startIndex;\r\n    var deleteCount = 0;\r\n    if (radiuslIndex === 0) {\r\n        deleteCount = length;\r\n    }\r\n    else if (radiuslIndex > 0 && radiuslIndex < horizontalRange[1]) {\r\n        deleteCount = horizontalRange[1] - radiuslIndex;\r\n    }\r\n    else if (radiuslIndex >= verticalRange[0]) {\r\n        deleteCount = verticalRange[0] + verticalRange[1] - radiuslIndex;\r\n    }\r\n    else {\r\n        return;\r\n    }\r\n    controlPoses.splice(index, deleteCount);\r\n    poses.splice(index, deleteCount);\r\n}\r\nfunction addRadiusPos(controlPoses, poses, startIndex, horizontalIndex, verticalIndex, distX, distY, right, bottom, left, top) {\r\n    if (left === void 0) { left = 0; }\r\n    if (top === void 0) { top = 0; }\r\n    var _a = getRadiusRange(controlPoses.slice(startIndex)), horizontalRange = _a.horizontalRange, verticalRange = _a.verticalRange;\r\n    if (horizontalIndex > -1) {\r\n        var radiusX = HORIZONTAL_RADIUS_DIRECTIONS[horizontalIndex] === 1\r\n            ? distX - left\r\n            : right - distX;\r\n        for (var i = horizontalRange[1]; i <= horizontalIndex; ++i) {\r\n            var y = VERTICAL_RADIUS_DIRECTIONS[i] === 1 ? top : bottom;\r\n            var x = 0;\r\n            if (horizontalIndex === i) {\r\n                x = distX;\r\n            }\r\n            else if (i === 0) {\r\n                x = left + radiusX;\r\n            }\r\n            else if (HORIZONTAL_RADIUS_DIRECTIONS[i] === -1) {\r\n                x = right - (poses[startIndex][0] - left);\r\n            }\r\n            controlPoses.splice(startIndex + i, 0, {\r\n                horizontal: HORIZONTAL_RADIUS_DIRECTIONS[i],\r\n                vertical: 0,\r\n                pos: [x, y],\r\n            });\r\n            poses.splice(startIndex + i, 0, [x, y]);\r\n            if (i === 0) {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    else if (verticalIndex > -1) {\r\n        var radiusY = VERTICAL_RADIUS_DIRECTIONS[verticalIndex] === 1\r\n            ? distY - top\r\n            : bottom - distY;\r\n        if (horizontalRange[1] === 0 && verticalRange[1] === 0) {\r\n            var pos = [\r\n                left + radiusY,\r\n                top,\r\n            ];\r\n            controlPoses.push({\r\n                horizontal: HORIZONTAL_RADIUS_DIRECTIONS[0],\r\n                vertical: 0,\r\n                pos: pos,\r\n            });\r\n            poses.push(pos);\r\n        }\r\n        var startVerticalIndex = verticalRange[0];\r\n        for (var i = verticalRange[1]; i <= verticalIndex; ++i) {\r\n            var x = HORIZONTAL_RADIUS_DIRECTIONS[i] === 1 ? left : right;\r\n            var y = 0;\r\n            if (verticalIndex === i) {\r\n                y = distY;\r\n            }\r\n            else if (i === 0) {\r\n                y = top + radiusY;\r\n            }\r\n            else if (VERTICAL_RADIUS_DIRECTIONS[i] === 1) {\r\n                y = poses[startIndex + startVerticalIndex][1];\r\n            }\r\n            else if (VERTICAL_RADIUS_DIRECTIONS[i] === -1) {\r\n                y = bottom - (poses[startIndex + startVerticalIndex][1] - top);\r\n            }\r\n            controlPoses.push({\r\n                horizontal: 0,\r\n                vertical: VERTICAL_RADIUS_DIRECTIONS[i],\r\n                pos: [x, y],\r\n            });\r\n            poses.push([x, y]);\r\n            if (i === 0) {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction splitRadiusPoses(controlPoses, raws) {\r\n    if (raws === void 0) { raws = controlPoses.map(function (pos) { return pos.raw; }); }\r\n    var horizontals = controlPoses\r\n        .map(function (pos, i) { return pos.horizontal ? raws[i] : null; }).filter(function (pos) { return pos != null; });\r\n    var verticals = controlPoses\r\n        .map(function (pos, i) { return pos.vertical ? raws[i] : null; }).filter(function (pos) { return pos != null; });\r\n    return {\r\n        horizontals: horizontals,\r\n        verticals: verticals,\r\n    };\r\n}\n\nvar CLIP_DIRECTIONS = [\r\n    [0, -1, \"n\"],\r\n    [1, 0, \"e\"],\r\n];\r\nvar CLIP_RECT_DIRECTIONS = [\r\n    [-1, -1, \"nw\"],\r\n    [0, -1, \"n\"],\r\n    [1, -1, \"ne\"],\r\n    [1, 0, \"e\"],\r\n    [1, 1, \"se\"],\r\n    [0, 1, \"s\"],\r\n    [-1, 1, \"sw\"],\r\n    [-1, 0, \"w\"],\r\n];\r\n// 1 2 5 6 0 3 4 7\r\n// 0 1 2 3 4 5 6 7\r\nfunction getClipStyles(moveable, clipPath, poses) {\r\n    var clipRelative = moveable.props.clipRelative;\r\n    var _a = moveable.state, width = _a.width, height = _a.height;\r\n    var _b = clipPath, clipType = _b.type, clipPoses = _b.poses;\r\n    var isRect = clipType === \"rect\";\r\n    var isCircle = clipType === \"circle\";\r\n    if (clipType === \"polygon\") {\r\n        return poses.map(function (pos) { return \"\".concat(convertCSSSize(pos[0], width, clipRelative), \" \").concat(convertCSSSize(pos[1], height, clipRelative)); });\r\n    }\r\n    else if (isRect || clipType === \"inset\") {\r\n        var top_1 = poses[1][1];\r\n        var right = poses[3][0];\r\n        var left = poses[7][0];\r\n        var bottom = poses[5][1];\r\n        if (isRect) {\r\n            return [\r\n                top_1,\r\n                right,\r\n                bottom,\r\n                left,\r\n            ].map(function (pos) { return \"\".concat(pos, \"px\"); });\r\n        }\r\n        var clipStyles = [top_1, width - right, height - bottom, left]\r\n            .map(function (pos, i) { return convertCSSSize(pos, i % 2 ? width : height, clipRelative); });\r\n        if (poses.length > 8) {\r\n            var _c = __read(minus(poses[4], poses[0]), 2), subWidth = _c[0], subHeight = _c[1];\r\n            clipStyles.push.apply(clipStyles, __spreadArray([\"round\"], __read(getRadiusStyles(clipPoses.slice(8).map(function (info, i) {\r\n                return __assign(__assign({}, info), { pos: poses[i] });\r\n            }), clipRelative, subWidth, subHeight, left, top_1, right, bottom).styles), false));\r\n        }\r\n        return clipStyles;\r\n    }\r\n    else if (isCircle || clipType === \"ellipse\") {\r\n        var center = poses[0];\r\n        var ry = convertCSSSize(abs(poses[1][1] - center[1]), isCircle ? Math.sqrt((width * width + height * height) / 2) : height, clipRelative);\r\n        var clipStyles = isCircle ? [ry]\r\n            : [convertCSSSize(abs(poses[2][0] - center[0]), width, clipRelative), ry];\r\n        clipStyles.push(\"at\", convertCSSSize(center[0], width, clipRelative), convertCSSSize(center[1], height, clipRelative));\r\n        return clipStyles;\r\n    }\r\n}\r\nfunction getRectPoses(top, right, bottom, left) {\r\n    var xs = [left, (left + right) / 2, right];\r\n    var ys = [top, (top + bottom) / 2, bottom];\r\n    return CLIP_RECT_DIRECTIONS.map(function (_a) {\r\n        var _b = __read(_a, 3), dirx = _b[0], diry = _b[1], dir = _b[2];\r\n        var x = xs[dirx + 1];\r\n        var y = ys[diry + 1];\r\n        return {\r\n            vertical: abs(diry),\r\n            horizontal: abs(dirx),\r\n            direction: dir,\r\n            pos: [x, y],\r\n        };\r\n    });\r\n}\r\nfunction getControlSize(controlPoses) {\r\n    var xRange = [Infinity, -Infinity];\r\n    var yRange = [Infinity, -Infinity];\r\n    controlPoses.forEach(function (_a) {\r\n        var pos = _a.pos;\r\n        xRange[0] = Math.min(xRange[0], pos[0]);\r\n        xRange[1] = Math.max(xRange[1], pos[0]);\r\n        yRange[0] = Math.min(yRange[0], pos[1]);\r\n        yRange[1] = Math.max(yRange[1], pos[1]);\r\n    });\r\n    return [\r\n        abs(xRange[1] - xRange[0]),\r\n        abs(yRange[1] - yRange[0]),\r\n    ];\r\n}\r\nfunction getClipPath(target, width, height, defaultClip, customClip) {\r\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j;\r\n    if (!target) {\r\n        return;\r\n    }\r\n    var clipText = customClip;\r\n    if (!clipText) {\r\n        var getStyle = getCachedStyle(target);\r\n        var clipPath = getStyle(\"clipPath\");\r\n        clipText = clipPath !== \"none\" ? clipPath : getStyle(\"clip\");\r\n    }\r\n    if (!clipText || clipText === \"none\" || clipText === \"auto\") {\r\n        clipText = defaultClip;\r\n        if (!clipText) {\r\n            return;\r\n        }\r\n    }\r\n    var _k = splitBracket(clipText), _l = _k.prefix, clipPrefix = _l === void 0 ? clipText : _l, _m = _k.value, value = _m === void 0 ? \"\" : _m;\r\n    var isCircle = clipPrefix === \"circle\";\r\n    var splitter = \" \";\r\n    if (clipPrefix === \"polygon\") {\r\n        var values = splitComma(value || \"0% 0%, 100% 0%, 100% 100%, 0% 100%\");\r\n        splitter = \",\";\r\n        var poses = values.map(function (pos) {\r\n            var _a = __read(pos.split(\" \"), 2), xPos = _a[0], yPos = _a[1];\r\n            return {\r\n                vertical: 1,\r\n                horizontal: 1,\r\n                pos: [\r\n                    convertUnitSize(xPos, width),\r\n                    convertUnitSize(yPos, height),\r\n                ],\r\n            };\r\n        });\r\n        var minMaxs = getMinMaxs(poses.map(function (pos) { return pos.pos; }));\r\n        return {\r\n            type: clipPrefix,\r\n            clipText: clipText,\r\n            poses: poses,\r\n            splitter: splitter,\r\n            left: minMaxs.minX,\r\n            right: minMaxs.maxX,\r\n            top: minMaxs.minY,\r\n            bottom: minMaxs.maxY,\r\n        };\r\n    }\r\n    else if (isCircle || clipPrefix === \"ellipse\") {\r\n        var xPos = \"\";\r\n        var yPos = \"\";\r\n        var radiusX_1 = 0;\r\n        var radiusY_1 = 0;\r\n        var values = splitSpace(value);\r\n        if (isCircle) {\r\n            var radius = \"\";\r\n            _a = __read(values, 4), _b = _a[0], radius = _b === void 0 ? \"50%\" : _b, _c = _a[2], xPos = _c === void 0 ? \"50%\" : _c, _d = _a[3], yPos = _d === void 0 ? \"50%\" : _d;\r\n            radiusX_1 = convertUnitSize(radius, Math.sqrt((width * width + height * height) / 2));\r\n            radiusY_1 = radiusX_1;\r\n        }\r\n        else {\r\n            var xRadius = \"\";\r\n            var yRadius = \"\";\r\n            _e = __read(values, 5), _f = _e[0], xRadius = _f === void 0 ? \"50%\" : _f, _g = _e[1], yRadius = _g === void 0 ? \"50%\" : _g, _h = _e[3], xPos = _h === void 0 ? \"50%\" : _h, _j = _e[4], yPos = _j === void 0 ? \"50%\" : _j;\r\n            radiusX_1 = convertUnitSize(xRadius, width);\r\n            radiusY_1 = convertUnitSize(yRadius, height);\r\n        }\r\n        var centerPos_1 = [\r\n            convertUnitSize(xPos, width),\r\n            convertUnitSize(yPos, height),\r\n        ];\r\n        var poses = __spreadArray([\r\n            {\r\n                vertical: 1,\r\n                horizontal: 1,\r\n                pos: centerPos_1,\r\n                direction: \"nesw\",\r\n            }\r\n        ], __read(CLIP_DIRECTIONS.slice(0, isCircle ? 1 : 2).map(function (dir) { return ({\r\n            vertical: abs(dir[1]),\r\n            horizontal: dir[0],\r\n            direction: dir[2],\r\n            sub: true,\r\n            pos: [\r\n                centerPos_1[0] + dir[0] * radiusX_1,\r\n                centerPos_1[1] + dir[1] * radiusY_1,\r\n            ],\r\n        }); })), false);\r\n        return {\r\n            type: clipPrefix,\r\n            clipText: clipText,\r\n            radiusX: radiusX_1,\r\n            radiusY: radiusY_1,\r\n            left: centerPos_1[0] - radiusX_1,\r\n            top: centerPos_1[1] - radiusY_1,\r\n            right: centerPos_1[0] + radiusX_1,\r\n            bottom: centerPos_1[1] + radiusY_1,\r\n            poses: poses,\r\n            splitter: splitter,\r\n        };\r\n    }\r\n    else if (clipPrefix === \"inset\") {\r\n        var values = splitSpace(value || \"0 0 0 0\");\r\n        var roundIndex = values.indexOf(\"round\");\r\n        var rectLength = (roundIndex > -1 ? values.slice(0, roundIndex) : values).length;\r\n        var radiusValues = values.slice(rectLength + 1);\r\n        var _o = __read(values.slice(0, rectLength), 4), topValue = _o[0], _p = _o[1], rightValue = _p === void 0 ? topValue : _p, _q = _o[2], bottomValue = _q === void 0 ? topValue : _q, _r = _o[3], leftValue = _r === void 0 ? rightValue : _r;\r\n        var _s = __read([topValue, bottomValue].map(function (pos) { return convertUnitSize(pos, height); }), 2), top_2 = _s[0], bottom = _s[1];\r\n        var _t = __read([leftValue, rightValue].map(function (pos) { return convertUnitSize(pos, width); }), 2), left = _t[0], right = _t[1];\r\n        var nextRight = width - right;\r\n        var nextBottom = height - bottom;\r\n        var radiusPoses = getRadiusValues(radiusValues, nextRight - left, nextBottom - top_2, left, top_2);\r\n        var poses = __spreadArray(__spreadArray([], __read(getRectPoses(top_2, nextRight, nextBottom, left)), false), __read(radiusPoses), false);\r\n        return {\r\n            type: \"inset\",\r\n            clipText: clipText,\r\n            poses: poses,\r\n            top: top_2,\r\n            left: left,\r\n            right: nextRight,\r\n            bottom: nextBottom,\r\n            radius: radiusValues,\r\n            splitter: splitter,\r\n        };\r\n    }\r\n    else if (clipPrefix === \"rect\") {\r\n        // top right bottom left\r\n        var values = splitComma(value || \"0px, \".concat(width, \"px, \").concat(height, \"px, 0px\"));\r\n        splitter = \",\";\r\n        var _u = __read(values.map(function (pos) {\r\n            var posValue = splitUnit(pos).value;\r\n            return posValue;\r\n        }), 4), top_3 = _u[0], right = _u[1], bottom = _u[2], left = _u[3];\r\n        var poses = getRectPoses(top_3, right, bottom, left);\r\n        return {\r\n            type: \"rect\",\r\n            clipText: clipText,\r\n            poses: poses,\r\n            top: top_3,\r\n            right: right,\r\n            bottom: bottom,\r\n            left: left,\r\n            values: values,\r\n            splitter: splitter,\r\n        };\r\n    }\r\n    return;\r\n}\n\nfunction moveControlPos(controlPoses, index, dist, isRect, keepRatio) {\r\n    var _a = controlPoses[index], direction = _a.direction, sub = _a.sub;\r\n    var dists = controlPoses.map(function () { return [0, 0]; });\r\n    var directions = direction ? direction.split(\"\") : [];\r\n    if (isRect && index < 8) {\r\n        var verticalDirections = directions.filter(function (dir) { return dir === \"w\" || dir === \"e\"; });\r\n        var horizontalDirections = directions.filter(function (dir) { return dir === \"n\" || dir === \"s\"; });\r\n        var verticalDirection_1 = verticalDirections[0];\r\n        var horizontalDirection_1 = horizontalDirections[0];\r\n        dists[index] = dist;\r\n        var _b = __read(getControlSize(controlPoses), 2), width = _b[0], height = _b[1];\r\n        var ratio = width && height ? width / height : 0;\r\n        if (ratio && keepRatio) {\r\n            // 0 1 2\r\n            // 7   3\r\n            // 6 5 4\r\n            var fixedIndex = (index + 4) % 8;\r\n            var fixedPosition = controlPoses[fixedIndex].pos;\r\n            var sizeDirection = [0, 0];\r\n            if (direction.indexOf(\"w\") > -1) {\r\n                sizeDirection[0] = -1;\r\n            }\r\n            else if (direction.indexOf(\"e\") > -1) {\r\n                sizeDirection[0] = 1;\r\n            }\r\n            if (direction.indexOf(\"n\") > -1) {\r\n                sizeDirection[1] = -1;\r\n            }\r\n            else if (direction.indexOf(\"s\") > -1) {\r\n                sizeDirection[1] = 1;\r\n            }\r\n            var nextDist = getSizeDistByDist([width, height], dist, ratio, sizeDirection, true);\r\n            var nextWidth = width + nextDist[0];\r\n            var nextHeight = height + nextDist[1];\r\n            var top_1 = fixedPosition[1];\r\n            var bottom = fixedPosition[1];\r\n            var left = fixedPosition[0];\r\n            var right = fixedPosition[0];\r\n            if (sizeDirection[0] === -1) {\r\n                left = right - nextWidth;\r\n            }\r\n            else if (sizeDirection[0] === 1) {\r\n                right = left + nextWidth;\r\n            }\r\n            else {\r\n                left = left - nextWidth / 2;\r\n                right = right + nextWidth / 2;\r\n            }\r\n            if (sizeDirection[1] === -1) {\r\n                top_1 = bottom - nextHeight;\r\n            }\r\n            else if (sizeDirection[1] === 1) {\r\n                bottom = top_1 + nextHeight;\r\n            }\r\n            else {\r\n                top_1 = bottom - nextHeight / 2;\r\n                bottom = top_1 + nextHeight;\r\n            }\r\n            var nextControlPoses_1 = getRectPoses(top_1, right, bottom, left);\r\n            controlPoses.forEach(function (controlPose, i) {\r\n                dists[i][0] = nextControlPoses_1[i].pos[0] - controlPose.pos[0];\r\n                dists[i][1] = nextControlPoses_1[i].pos[1] - controlPose.pos[1];\r\n            });\r\n        }\r\n        else {\r\n            controlPoses.forEach(function (controlPose, i) {\r\n                var controlDir = controlPose.direction;\r\n                if (!controlDir) {\r\n                    return;\r\n                }\r\n                if (controlDir.indexOf(verticalDirection_1) > -1) {\r\n                    dists[i][0] = dist[0];\r\n                }\r\n                if (controlDir.indexOf(horizontalDirection_1) > -1) {\r\n                    dists[i][1] = dist[1];\r\n                }\r\n            });\r\n            if (verticalDirection_1) {\r\n                dists[1][0] = dist[0] / 2;\r\n                dists[5][0] = dist[0] / 2;\r\n            }\r\n            if (horizontalDirection_1) {\r\n                dists[3][1] = dist[1] / 2;\r\n                dists[7][1] = dist[1] / 2;\r\n            }\r\n        }\r\n    }\r\n    else if (direction && !sub) {\r\n        directions.forEach(function (dir) {\r\n            var isVertical = dir === \"n\" || dir === \"s\";\r\n            controlPoses.forEach(function (controlPose, i) {\r\n                var dirDir = controlPose.direction, dirHorizontal = controlPose.horizontal, dirVertical = controlPose.vertical;\r\n                if (!dirDir || dirDir.indexOf(dir) === -1) {\r\n                    return;\r\n                }\r\n                dists[i] = [\r\n                    isVertical || !dirHorizontal ? 0 : dist[0],\r\n                    !isVertical || !dirVertical ? 0 : dist[1],\r\n                ];\r\n            });\r\n        });\r\n    }\r\n    else {\r\n        dists[index] = dist;\r\n    }\r\n    return dists;\r\n}\r\nfunction addClipPath(moveable, e) {\r\n    var _a = __read(calculatePointerDist(moveable, e), 2), distX = _a[0], distY = _a[1];\r\n    var _b = e.datas, clipPath = _b.clipPath, clipIndex = _b.clipIndex;\r\n    var _c = clipPath, clipType = _c.type, clipPoses = _c.poses, splitter = _c.splitter;\r\n    var poses = clipPoses.map(function (pos) { return pos.pos; });\r\n    if (clipType === \"polygon\") {\r\n        poses.splice(clipIndex, 0, [distX, distY]);\r\n    }\r\n    else if (clipType === \"inset\") {\r\n        var horizontalIndex = HORIZONTAL_RADIUS_ORDER.indexOf(clipIndex);\r\n        var verticalIndex = VERTICAL_RADIUS_ORDER.indexOf(clipIndex);\r\n        var length_1 = clipPoses.length;\r\n        addRadiusPos(clipPoses, poses, 8, horizontalIndex, verticalIndex, distX, distY, poses[4][0], poses[4][1], poses[0][0], poses[0][1]);\r\n        if (length_1 === clipPoses.length) {\r\n            return;\r\n        }\r\n    }\r\n    else {\r\n        return;\r\n    }\r\n    var clipStyles = getClipStyles(moveable, clipPath, poses);\r\n    var clipStyle = \"\".concat(clipType, \"(\").concat(clipStyles.join(splitter), \")\");\r\n    triggerEvent(moveable, \"onClip\", fillParams(moveable, e, __assign({ clipEventType: \"added\", clipType: clipType, poses: poses, clipStyles: clipStyles, clipStyle: clipStyle, distX: 0, distY: 0 }, fillCSSObject({\r\n        clipPath: clipStyle,\r\n    }, e))));\r\n}\r\nfunction removeClipPath(moveable, e) {\r\n    var _a = e.datas, clipPath = _a.clipPath, clipIndex = _a.clipIndex;\r\n    var _b = clipPath, clipType = _b.type, clipPoses = _b.poses, splitter = _b.splitter;\r\n    var poses = clipPoses.map(function (pos) { return pos.pos; });\r\n    var length = poses.length;\r\n    if (clipType === \"polygon\") {\r\n        clipPoses.splice(clipIndex, 1);\r\n        poses.splice(clipIndex, 1);\r\n    }\r\n    else if (clipType === \"inset\") {\r\n        if (clipIndex < 8) {\r\n            return;\r\n        }\r\n        removeRadiusPos(clipPoses, poses, clipIndex, 8, length);\r\n        if (length === clipPoses.length) {\r\n            return;\r\n        }\r\n    }\r\n    else {\r\n        return;\r\n    }\r\n    var clipStyles = getClipStyles(moveable, clipPath, poses);\r\n    var clipStyle = \"\".concat(clipType, \"(\").concat(clipStyles.join(splitter), \")\");\r\n    triggerEvent(moveable, \"onClip\", fillParams(moveable, e, __assign({ clipEventType: \"removed\", clipType: clipType, poses: poses, clipStyles: clipStyles, clipStyle: clipStyle, distX: 0, distY: 0 }, fillCSSObject({\r\n        clipPath: clipStyle,\r\n    }, e))));\r\n}\r\n/**\r\n * @namespace Moveable.Clippable\r\n * @description Whether to clip the target.\r\n */\r\nvar Clippable = {\r\n    name: \"clippable\",\r\n    props: [\r\n        \"clippable\",\r\n        \"defaultClipPath\",\r\n        \"customClipPath\",\r\n        \"keepRatio\",\r\n        \"clipRelative\",\r\n        \"clipArea\",\r\n        \"dragWithClip\",\r\n        \"clipTargetBounds\",\r\n        \"clipVerticalGuidelines\",\r\n        \"clipHorizontalGuidelines\",\r\n        \"clipSnapThreshold\",\r\n    ],\r\n    events: [\r\n        \"clipStart\",\r\n        \"clip\",\r\n        \"clipEnd\",\r\n    ],\r\n    css: [\r\n        \".control.clip-control {\\nbackground: #6d6;\\ncursor: pointer;\\n}\\n.control.clip-control.clip-radius {\\nbackground: #d66;\\n}\\n.line.clip-line {\\nbackground: #6e6;\\ncursor: move;\\nz-index: 1;\\n}\\n.clip-area {\\nposition: absolute;\\ntop: 0;\\nleft: 0;\\n}\\n.clip-ellipse {\\nposition: absolute;\\ncursor: move;\\nborder: 1px solid #6d6;\\nborder: var(--zoompx) solid #6d6;\\nborder-radius: 50%;\\ntransform-origin: 0px 0px;\\n}\",\r\n        \":host {\\n--bounds-color: #d66;\\n}\",\r\n        \".guideline {\\npointer-events: none;\\nz-index: 2;\\n}\",\r\n        \".line.guideline.bounds {\\nbackground: #d66;\\nbackground: var(--bounds-color);\\n}\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, customClipPath = _a.customClipPath, defaultClipPath = _a.defaultClipPath, clipArea = _a.clipArea, zoom = _a.zoom, groupable = _a.groupable;\r\n        var _b = moveable.getState(), target = _b.target, width = _b.width, height = _b.height, allMatrix = _b.allMatrix, is3d = _b.is3d, left = _b.left, top = _b.top, pos1 = _b.pos1, pos2 = _b.pos2, pos3 = _b.pos3, pos4 = _b.pos4, clipPathState = _b.clipPathState, snapBoundInfos = _b.snapBoundInfos, rotationRad = _b.rotation;\r\n        if (!target || groupable) {\r\n            return [];\r\n        }\r\n        var clipPath = getClipPath(target, width, height, defaultClipPath || \"inset\", clipPathState || customClipPath);\r\n        if (!clipPath) {\r\n            return [];\r\n        }\r\n        var n = is3d ? 4 : 3;\r\n        var type = clipPath.type;\r\n        var clipPoses = clipPath.poses;\r\n        var poses = clipPoses.map(function (pos) {\r\n            // return [x, y];\r\n            var calculatedPos = calculatePosition(allMatrix, pos.pos, n);\r\n            return [\r\n                calculatedPos[0] - left,\r\n                calculatedPos[1] - top,\r\n            ];\r\n        });\r\n        var controls = [];\r\n        var lines = [];\r\n        var isRect = type === \"rect\";\r\n        var isInset = type === \"inset\";\r\n        var isPolygon = type === \"polygon\";\r\n        if (isRect || isInset || isPolygon) {\r\n            var linePoses_1 = isInset ? poses.slice(0, 8) : poses;\r\n            lines = linePoses_1.map(function (to, i) {\r\n                var from = i === 0 ? linePoses_1[linePoses_1.length - 1] : linePoses_1[i - 1];\r\n                var rad = getRad(from, to);\r\n                var dist = getDiagonalSize(from, to);\r\n                return React.createElement(\"div\", { key: \"clipLine\".concat(i), className: prefix(\"line\", \"clip-line\", \"snap-control\"), \"data-clip-index\": i, style: {\r\n                        width: \"\".concat(dist, \"px\"),\r\n                        transform: \"translate(\".concat(from[0], \"px, \").concat(from[1], \"px) rotate(\").concat(rad, \"rad) scaleY(\").concat(zoom, \")\"),\r\n                    } });\r\n            });\r\n        }\r\n        controls = poses.map(function (pos, i) {\r\n            return React.createElement(\"div\", { key: \"clipControl\".concat(i), className: prefix(\"control\", \"clip-control\", \"snap-control\"), \"data-clip-index\": i, style: {\r\n                    transform: \"translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) rotate(\").concat(rotationRad, \"rad) scale(\").concat(zoom, \")\"),\r\n                } });\r\n        });\r\n        if (isInset) {\r\n            controls.push.apply(controls, __spreadArray([], __read(poses.slice(8).map(function (pos, i) {\r\n                return React.createElement(\"div\", { key: \"clipRadiusControl\".concat(i), className: prefix(\"control\", \"clip-control\", \"clip-radius\", \"snap-control\"), \"data-clip-index\": 8 + i, style: {\r\n                        transform: \"translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) rotate(\").concat(rotationRad, \"rad) scale(\").concat(zoom, \")\"),\r\n                    } });\r\n            })), false));\r\n        }\r\n        if (type === \"circle\" || type === \"ellipse\") {\r\n            var clipLeft = clipPath.left, clipTop = clipPath.top, radiusX = clipPath.radiusX, radiusY = clipPath.radiusY;\r\n            var _c = __read(minus(calculatePosition(allMatrix, [clipLeft, clipTop], n), calculatePosition(allMatrix, [0, 0], n)), 2), distLeft = _c[0], distTop = _c[1];\r\n            var ellipseClipPath = \"none\";\r\n            if (!clipArea) {\r\n                var piece = Math.max(10, radiusX / 5, radiusY / 5);\r\n                var areaPoses = [];\r\n                for (var i = 0; i <= piece; ++i) {\r\n                    var rad = Math.PI * 2 / piece * i;\r\n                    areaPoses.push([\r\n                        radiusX + (radiusX - zoom) * Math.cos(rad),\r\n                        radiusY + (radiusY - zoom) * Math.sin(rad),\r\n                    ]);\r\n                }\r\n                areaPoses.push([radiusX, -2]);\r\n                areaPoses.push([-2, -2]);\r\n                areaPoses.push([-2, radiusY * 2 + 2]);\r\n                areaPoses.push([radiusX * 2 + 2, radiusY * 2 + 2]);\r\n                areaPoses.push([radiusX * 2 + 2, -2]);\r\n                areaPoses.push([radiusX, -2]);\r\n                ellipseClipPath = \"polygon(\".concat(areaPoses.map(function (pos) { return \"\".concat(pos[0], \"px \").concat(pos[1], \"px\"); }).join(\", \"), \")\");\r\n            }\r\n            controls.push(React.createElement(\"div\", { key: \"clipEllipse\", className: prefix(\"clip-ellipse\", \"snap-control\"), style: {\r\n                    width: \"\".concat(radiusX * 2, \"px\"),\r\n                    height: \"\".concat(radiusY * 2, \"px\"),\r\n                    clipPath: ellipseClipPath,\r\n                    transform: \"translate(\".concat(-left + distLeft, \"px, \").concat(-top + distTop, \"px) \").concat(makeMatrixCSS(allMatrix)),\r\n                } }));\r\n        }\r\n        if (clipArea) {\r\n            var _d = getRect(__spreadArray([pos1, pos2, pos3, pos4], __read(poses), false)), allWidth = _d.width, allHeight = _d.height, allLeft_1 = _d.left, allTop_1 = _d.top;\r\n            if (isPolygon || isRect || isInset) {\r\n                var areaPoses = isInset ? poses.slice(0, 8) : poses;\r\n                controls.push(React.createElement(\"div\", { key: \"clipArea\", className: prefix(\"clip-area\", \"snap-control\"), style: {\r\n                        width: \"\".concat(allWidth, \"px\"),\r\n                        height: \"\".concat(allHeight, \"px\"),\r\n                        transform: \"translate(\".concat(allLeft_1, \"px, \").concat(allTop_1, \"px)\"),\r\n                        clipPath: \"polygon(\".concat(areaPoses.map(function (pos) { return \"\".concat(pos[0] - allLeft_1, \"px \").concat(pos[1] - allTop_1, \"px\"); }).join(\", \"), \")\"),\r\n                    } }));\r\n            }\r\n        }\r\n        if (snapBoundInfos) {\r\n            [\"vertical\", \"horizontal\"].forEach(function (directionType) {\r\n                var info = snapBoundInfos[directionType];\r\n                var isHorizontal = directionType === \"horizontal\";\r\n                if (info.isSnap) {\r\n                    lines.push.apply(lines, __spreadArray([], __read(info.snap.posInfos.map(function (_a, i) {\r\n                        var pos = _a.pos;\r\n                        var snapPos1 = minus(calculatePosition(allMatrix, isHorizontal ? [0, pos] : [pos, 0], n), [left, top]);\r\n                        var snapPos2 = minus(calculatePosition(allMatrix, isHorizontal ? [width, pos] : [pos, height], n), [left, top]);\r\n                        return renderLine(React, \"\", snapPos1, snapPos2, zoom, \"clip\".concat(directionType, \"snap\").concat(i), \"guideline\");\r\n                    })), false));\r\n                }\r\n                if (info.isBound) {\r\n                    lines.push.apply(lines, __spreadArray([], __read(info.bounds.map(function (_a, i) {\r\n                        var pos = _a.pos;\r\n                        var snapPos1 = minus(calculatePosition(allMatrix, isHorizontal ? [0, pos] : [pos, 0], n), [left, top]);\r\n                        var snapPos2 = minus(calculatePosition(allMatrix, isHorizontal ? [width, pos] : [pos, height], n), [left, top]);\r\n                        return renderLine(React, \"\", snapPos1, snapPos2, zoom, \"clip\".concat(directionType, \"bounds\").concat(i), \"guideline\", \"bounds\", \"bold\");\r\n                    })), false));\r\n                }\r\n            });\r\n        }\r\n        return __spreadArray(__spreadArray([], __read(controls), false), __read(lines), false);\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        return e.inputEvent && (e.inputEvent.target.getAttribute(\"class\") || \"\").indexOf(\"clip\") > -1;\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        var props = moveable.props;\r\n        var _a = props.dragWithClip, dragWithClip = _a === void 0 ? true : _a;\r\n        if (dragWithClip) {\r\n            return false;\r\n        }\r\n        return this.dragControlStart(moveable, e);\r\n    },\r\n    drag: function (moveable, e) {\r\n        return this.dragControl(moveable, __assign(__assign({}, e), { isDragTarget: true }));\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        return this.dragControlEnd(moveable, e);\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var state = moveable.state;\r\n        var _a = moveable.props, defaultClipPath = _a.defaultClipPath, customClipPath = _a.customClipPath;\r\n        var target = state.target, width = state.width, height = state.height;\r\n        var inputTarget = e.inputEvent ? e.inputEvent.target : null;\r\n        var className = (inputTarget && inputTarget.getAttribute(\"class\")) || \"\";\r\n        var datas = e.datas;\r\n        var clipPath = getClipPath(target, width, height, defaultClipPath || \"inset\", customClipPath);\r\n        if (!clipPath) {\r\n            return false;\r\n        }\r\n        var clipText = clipPath.clipText, type = clipPath.type, poses = clipPath.poses;\r\n        var result = triggerEvent(moveable, \"onClipStart\", fillParams(moveable, e, {\r\n            clipType: type,\r\n            clipStyle: clipText,\r\n            poses: poses.map(function (pos) { return pos.pos; }),\r\n        }));\r\n        if (result === false) {\r\n            datas.isClipStart = false;\r\n            return false;\r\n        }\r\n        datas.isControl = className && className.indexOf(\"clip-control\") > -1;\r\n        datas.isLine = className.indexOf(\"clip-line\") > -1;\r\n        datas.isArea = className.indexOf(\"clip-area\") > -1 || className.indexOf(\"clip-ellipse\") > -1;\r\n        datas.clipIndex = inputTarget ? parseInt(inputTarget.getAttribute(\"data-clip-index\"), 10) : -1;\r\n        datas.clipPath = clipPath;\r\n        datas.isClipStart = true;\r\n        state.clipPathState = clipText;\r\n        setDragStart(moveable, e);\r\n        return true;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var _a, _b, _c;\r\n        var datas = e.datas, originalDatas = e.originalDatas, isDragTarget = e.isDragTarget;\r\n        if (!datas.isClipStart) {\r\n            return false;\r\n        }\r\n        var _d = datas, isControl = _d.isControl, isLine = _d.isLine, isArea = _d.isArea, clipIndex = _d.clipIndex, clipPath = _d.clipPath;\r\n        if (!clipPath) {\r\n            return false;\r\n        }\r\n        var props = getProps(moveable.props, \"clippable\");\r\n        var keepRatio = props.keepRatio;\r\n        var distX = 0;\r\n        var distY = 0;\r\n        var originalDraggable = originalDatas.draggable;\r\n        var originalDist = getDragDist(e);\r\n        if (isDragTarget && originalDraggable) {\r\n            _a = __read(originalDraggable.prevBeforeDist, 2), distX = _a[0], distY = _a[1];\r\n        }\r\n        else {\r\n            _b = __read(originalDist, 2), distX = _b[0], distY = _b[1];\r\n        }\r\n        var firstDist = [distX, distY];\r\n        var state = moveable.state;\r\n        var width = state.width, height = state.height;\r\n        var isDragWithTarget = !isArea && !isControl && !isLine;\r\n        var clipType = clipPath.type, clipPoses = clipPath.poses, splitter = clipPath.splitter;\r\n        var poses = clipPoses.map(function (pos) { return pos.pos; });\r\n        if (isDragWithTarget) {\r\n            distX = -distX;\r\n            distY = -distY;\r\n        }\r\n        var isAll = !isControl || clipPoses[clipIndex].direction === \"nesw\";\r\n        var isRect = clipType === \"inset\" || clipType === \"rect\";\r\n        var dists = clipPoses.map(function () { return [0, 0]; });\r\n        if (isControl && !isAll) {\r\n            var _e = clipPoses[clipIndex], horizontal = _e.horizontal, vertical = _e.vertical;\r\n            var dist = [\r\n                distX * abs(horizontal),\r\n                distY * abs(vertical),\r\n            ];\r\n            dists = moveControlPos(clipPoses, clipIndex, dist, isRect, keepRatio);\r\n        }\r\n        else if (isAll) {\r\n            dists = poses.map(function () { return [distX, distY]; });\r\n        }\r\n        var nextPoses = poses.map(function (pos, i) { return plus(pos, dists[i]); });\r\n        var guidePoses = __spreadArray([], __read(nextPoses), false);\r\n        state.snapBoundInfos = null;\r\n        var isCircle = clipPath.type === \"circle\";\r\n        var isEllipse = clipPath.type === \"ellipse\";\r\n        if (isCircle || isEllipse) {\r\n            var guideRect = getRect(nextPoses);\r\n            var ry = abs(guideRect.bottom - guideRect.top);\r\n            var rx = abs(isEllipse ? guideRect.right - guideRect.left : ry);\r\n            var bottom = nextPoses[0][1] + ry;\r\n            var left = nextPoses[0][0] - rx;\r\n            var right = nextPoses[0][0] + rx;\r\n            // right\r\n            if (isCircle) {\r\n                guidePoses.push([right, guideRect.bottom]);\r\n                dists.push([1, 0]);\r\n            }\r\n            // bottom\r\n            guidePoses.push([guideRect.left, bottom]);\r\n            dists.push([0, 1]);\r\n            // left\r\n            guidePoses.push([left, guideRect.bottom]);\r\n            dists.push([1, 0]);\r\n        }\r\n        var guidelines = getDefaultGuidelines((props.clipHorizontalGuidelines || []).map(function (v) { return convertUnitSize(\"\".concat(v), height); }), (props.clipVerticalGuidelines || []).map(function (v) { return convertUnitSize(\"\".concat(v), width); }), width, height);\r\n        var guideXPoses = [];\r\n        var guideYPoses = [];\r\n        if (isCircle || isEllipse) {\r\n            guideXPoses = [guidePoses[4][0], guidePoses[2][0]];\r\n            guideYPoses = [guidePoses[1][1], guidePoses[3][1]];\r\n        }\r\n        else if (isRect) {\r\n            var rectPoses = [guidePoses[0], guidePoses[2], guidePoses[4], guidePoses[6]];\r\n            var rectDists_1 = [dists[0], dists[2], dists[4], dists[6]];\r\n            guideXPoses = rectPoses.filter(function (_, i) { return rectDists_1[i][0]; }).map(function (pos) { return pos[0]; });\r\n            guideYPoses = rectPoses.filter(function (_, i) { return rectDists_1[i][1]; }).map(function (pos) { return pos[1]; });\r\n        }\r\n        else {\r\n            guideXPoses = guidePoses.filter(function (_, i) { return dists[i][0]; }).map(function (pos) { return pos[0]; });\r\n            guideYPoses = guidePoses.filter(function (_, i) { return dists[i][1]; }).map(function (pos) { return pos[1]; });\r\n        }\r\n        var boundDelta = [0, 0];\r\n        var _f = checkSnapBounds(guidelines, props.clipTargetBounds && { left: 0, top: 0, right: width, bottom: height }, guideXPoses, guideYPoses, 5, 5), horizontalSnapInfo = _f.horizontal, verticalSnapInfo = _f.vertical;\r\n        var snapOffsetY = horizontalSnapInfo.offset;\r\n        var snapOffsetX = verticalSnapInfo.offset;\r\n        if (horizontalSnapInfo.isBound) {\r\n            boundDelta[1] += snapOffsetY;\r\n        }\r\n        if (verticalSnapInfo.isBound) {\r\n            boundDelta[0] += snapOffsetX;\r\n        }\r\n        if ((isEllipse || isCircle) && dists[0][0] === 0 && dists[0][1] === 0) {\r\n            var guideRect = getRect(nextPoses);\r\n            var cy = guideRect.bottom - guideRect.top;\r\n            var cx = isEllipse ? guideRect.right - guideRect.left : cy;\r\n            var distSnapX = verticalSnapInfo.isBound\r\n                ? abs(snapOffsetX)\r\n                : (verticalSnapInfo.snapIndex === 0 ? -snapOffsetX : snapOffsetX);\r\n            var distSnapY = horizontalSnapInfo.isBound\r\n                ? abs(snapOffsetY)\r\n                : (horizontalSnapInfo.snapIndex === 0 ? -snapOffsetY : snapOffsetY);\r\n            cx -= distSnapX;\r\n            cy -= distSnapY;\r\n            if (isCircle) {\r\n                cy = checkSnapBoundPriority(verticalSnapInfo, horizontalSnapInfo) > 0 ? cy : cx;\r\n                cx = cy;\r\n            }\r\n            var center = guidePoses[0];\r\n            guidePoses[1][1] = center[1] - cy;\r\n            guidePoses[2][0] = center[0] + cx;\r\n            guidePoses[3][1] = center[1] + cy;\r\n            guidePoses[4][0] = center[0] - cx;\r\n        }\r\n        else if (isRect && keepRatio && isControl) {\r\n            var _g = __read(getControlSize(clipPoses), 2), width_1 = _g[0], height_1 = _g[1];\r\n            var ratio = width_1 && height_1 ? width_1 / height_1 : 0;\r\n            var clipPose = clipPoses[clipIndex];\r\n            var direction = clipPose.direction || \"\";\r\n            var top_2 = guidePoses[1][1];\r\n            var bottom = guidePoses[5][1];\r\n            var left = guidePoses[7][0];\r\n            var right = guidePoses[3][0];\r\n            if (abs(snapOffsetY) <= abs(snapOffsetX)) {\r\n                snapOffsetY = sign(snapOffsetY) * abs(snapOffsetX) / ratio;\r\n            }\r\n            else {\r\n                snapOffsetX = sign(snapOffsetX) * abs(snapOffsetY) * ratio;\r\n            }\r\n            if (direction.indexOf(\"w\") > -1) {\r\n                left -= snapOffsetX;\r\n            }\r\n            else if (direction.indexOf(\"e\") > -1) {\r\n                right -= snapOffsetX;\r\n            }\r\n            else {\r\n                left += snapOffsetX / 2;\r\n                right -= snapOffsetX / 2;\r\n            }\r\n            if (direction.indexOf(\"n\") > -1) {\r\n                top_2 -= snapOffsetY;\r\n            }\r\n            else if (direction.indexOf(\"s\") > -1) {\r\n                bottom -= snapOffsetY;\r\n            }\r\n            else {\r\n                top_2 += snapOffsetY / 2;\r\n                bottom -= snapOffsetY / 2;\r\n            }\r\n            var nextControlPoses_2 = getRectPoses(top_2, right, bottom, left);\r\n            guidePoses.forEach(function (pos, i) {\r\n                var _a;\r\n                _a = __read(nextControlPoses_2[i].pos, 2), pos[0] = _a[0], pos[1] = _a[1];\r\n            });\r\n        }\r\n        else {\r\n            guidePoses.forEach(function (pos, j) {\r\n                var dist = dists[j];\r\n                if (dist[0]) {\r\n                    pos[0] -= snapOffsetX;\r\n                }\r\n                if (dist[1]) {\r\n                    pos[1] -= snapOffsetY;\r\n                }\r\n            });\r\n        }\r\n        var nextClipStyles = getClipStyles(moveable, clipPath, nextPoses);\r\n        var clipStyle = \"\".concat(clipType, \"(\").concat(nextClipStyles.join(splitter), \")\");\r\n        state.clipPathState = clipStyle;\r\n        if (isCircle || isEllipse) {\r\n            guideXPoses = [guidePoses[4][0], guidePoses[2][0]];\r\n            guideYPoses = [guidePoses[1][1], guidePoses[3][1]];\r\n        }\r\n        else if (isRect) {\r\n            var rectPoses = [guidePoses[0], guidePoses[2], guidePoses[4], guidePoses[6]];\r\n            guideXPoses = rectPoses.map(function (pos) { return pos[0]; });\r\n            guideYPoses = rectPoses.map(function (pos) { return pos[1]; });\r\n        }\r\n        else {\r\n            guideXPoses = guidePoses.map(function (pos) { return pos[0]; });\r\n            guideYPoses = guidePoses.map(function (pos) { return pos[1]; });\r\n        }\r\n        state.snapBoundInfos = checkSnapBounds(guidelines, props.clipTargetBounds && { left: 0, top: 0, right: width, bottom: height }, guideXPoses, guideYPoses, 1, 1);\r\n        if (originalDraggable) {\r\n            var is3d = state.is3d, allMatrix = state.allMatrix;\r\n            var n = is3d ? 4 : 3;\r\n            var dragDist = boundDelta;\r\n            if (isDragTarget) {\r\n                dragDist = [\r\n                    firstDist[0] + boundDelta[0] - originalDist[0],\r\n                    firstDist[1] + boundDelta[1] - originalDist[1],\r\n                ];\r\n            }\r\n            originalDraggable.deltaOffset = multiply(allMatrix, [dragDist[0], dragDist[1], 0, 0], n);\r\n        }\r\n        triggerEvent(moveable, \"onClip\", fillParams(moveable, e, __assign({ clipEventType: \"changed\", clipType: clipType, poses: nextPoses, clipStyle: clipStyle, clipStyles: nextClipStyles, distX: distX, distY: distY }, fillCSSObject((_c = {},\r\n            _c[clipType === \"rect\" ? \"clip\" : \"clipPath\"] = clipStyle,\r\n            _c), e))));\r\n        return true;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        this.unset(moveable);\r\n        var isDrag = e.isDrag, datas = e.datas, isDouble = e.isDouble;\r\n        var isLine = datas.isLine, isClipStart = datas.isClipStart, isControl = datas.isControl;\r\n        if (!isClipStart) {\r\n            return false;\r\n        }\r\n        triggerEvent(moveable, \"onClipEnd\", fillEndParams(moveable, e, {}));\r\n        if (isDouble) {\r\n            if (isControl) {\r\n                removeClipPath(moveable, e);\r\n            }\r\n            else if (isLine) {\r\n                // add\r\n                addClipPath(moveable, e);\r\n            }\r\n        }\r\n        return isDouble || isDrag;\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.clipPathState = \"\";\r\n        moveable.state.snapBoundInfos = null;\r\n    },\r\n};\r\n/**\r\n * Whether to clip the target. (default: false)\r\n * @name Moveable.Clippable#clippable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n *  If clippath is not set, the default value can be set. (defaultClipPath < style < customClipPath < dragging clipPath)\r\n * @name Moveable.Clippable#defaultClipPath\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * % Can be used instead of the absolute px (`rect` not possible) (default: false)\r\n * @name Moveable.Clippable#clipRelative\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * You can force the custom clipPath. (defaultClipPath < style < customClipPath < dragging clipPath)\r\n * @name Moveable.Clippable#customClipPath\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When dragging the target, the clip also moves. (default: true)\r\n * @name Moveable.Clippable#dragWithClip\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * You can drag the clip by setting clipArea.\r\n * @name Moveable.Clippable#clipArea\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n* Whether the clip is bound to the target.\r\n* @name Moveable.Clippable#clipTargetBounds\r\n* @default false\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipTargetBounds: true,\r\n* });\r\n* moveable.on(\"clipStart\", e => {\r\n*     console.log(e);\r\n* }).on(\"clip\", e => {\r\n*     if (e.clipType === \"rect\") {\r\n*         e.target.style.clip = e.clipStyle;\r\n*     } else {\r\n*         e.target.style.clipPath = e.clipStyle;\r\n*     }\r\n* }).on(\"clipEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\r\n/**\r\n * Add clip guidelines in the vertical direction.\r\n * @name Moveable.Clippable#clipVerticalGuidelines\r\n * @default 0\r\n * @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipVerticalGuidelines: [0, 100, 200],\r\n*     clipHorizontalGuidelines: [0, 100, 200],\r\n*     clipSnapThreshold: 5,\r\n* });\r\n*/\r\n/**\r\n* Add clip guidelines in the horizontal direction.\r\n* @name Moveable.Clippable#clipHorizontalGuidelines\r\n* @default []\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipVerticalGuidelines: [0, 100, 200],\r\n*     clipHorizontalGuidelines: [0, 100, 200],\r\n*     clipSnapThreshold: 5,\r\n* });\r\n*/\r\n/**\r\n* istance value that can snap to clip guidelines.\r\n* @name Moveable.Clippable#clipSnapThreshold\r\n* @default 5\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipVerticalGuidelines: [0, 100, 200],\r\n*     clipHorizontalGuidelines: [0, 100, 200],\r\n*     clipSnapThreshold: 5,\r\n* });\r\n*/\r\n/**\r\n * When drag start the clip area or controls, the `clipStart` event is called.\r\n * @memberof Moveable.Clippable\r\n * @event clipStart\r\n * @param {Moveable.Clippable.OnClipStart} - Parameters for the `clipStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag the clip area or controls, the `clip` event is called.\r\n * @memberof Moveable.Clippable\r\n * @event clip\r\n * @param {Moveable.Clippable.OnClip} - Parameters for the `clip` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag end the clip area or controls, the `clipEnd` event is called.\r\n * @memberof Moveable.Clippable\r\n * @event clipEnd\r\n * @param {Moveable.Clippable.OnClipEnd} - Parameters for the `clipEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\n\n/**\r\n * @namespace OriginDraggable\r\n * @memberof Moveable\r\n * @description Whether to drag origin (default: false)\r\n */\r\nvar OriginDraggable = {\r\n    name: \"originDraggable\",\r\n    props: [\r\n        \"originDraggable\",\r\n        \"originRelative\",\r\n    ],\r\n    events: [\r\n        \"dragOriginStart\",\r\n        \"dragOrigin\",\r\n        \"dragOriginEnd\",\r\n    ],\r\n    css: [\r\n        \":host[data-able-origindraggable] .control.origin {\\npointer-events: auto;\\n}\",\r\n    ],\r\n    dragControlCondition: function (_, e) {\r\n        if (e.isRequest) {\r\n            return e.requestAble === \"originDraggable\";\r\n        }\r\n        return hasClass(e.inputEvent.target, prefix(\"origin\"));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        setDragStart(moveable, e);\r\n        var params = fillParams(moveable, e, {\r\n            dragStart: Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e)),\r\n        });\r\n        var result = triggerEvent(moveable, \"onDragOriginStart\", params);\r\n        datas.startOrigin = moveable.state.transformOrigin;\r\n        datas.startTargetOrigin = moveable.state.targetOrigin;\r\n        datas.prevOrigin = [0, 0];\r\n        datas.isDragOrigin = true;\r\n        if (result === false) {\r\n            datas.isDragOrigin = false;\r\n            return false;\r\n        }\r\n        return params;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var datas = e.datas, isPinch = e.isPinch, isRequest = e.isRequest;\r\n        if (!datas.isDragOrigin) {\r\n            return false;\r\n        }\r\n        var _a = __read(getDragDist(e), 2), distX = _a[0], distY = _a[1];\r\n        var state = moveable.state;\r\n        var width = state.width, height = state.height, offsetMatrix = state.offsetMatrix, targetMatrix = state.targetMatrix, is3d = state.is3d;\r\n        var _b = moveable.props.originRelative, originRelative = _b === void 0 ? true : _b;\r\n        var n = is3d ? 4 : 3;\r\n        var dist = [distX, distY];\r\n        if (isRequest) {\r\n            var distOrigin = e.distOrigin;\r\n            if (distOrigin[0] || distOrigin[1]) {\r\n                dist = distOrigin;\r\n            }\r\n        }\r\n        var origin = plus(datas.startOrigin, dist);\r\n        var targetOrigin = plus(datas.startTargetOrigin, dist);\r\n        var delta = minus(dist, datas.prevOrigin);\r\n        var nextMatrix = getNextMatrix(offsetMatrix, targetMatrix, origin, n);\r\n        var rect = moveable.getRect();\r\n        var nextRect = getRect(calculatePoses(nextMatrix, width, height, n));\r\n        var dragDelta = [\r\n            rect.left - nextRect.left,\r\n            rect.top - nextRect.top,\r\n        ];\r\n        datas.prevOrigin = dist;\r\n        var transformOrigin = [\r\n            convertCSSSize(targetOrigin[0], width, originRelative),\r\n            convertCSSSize(targetOrigin[1], height, originRelative),\r\n        ].join(\" \");\r\n        var result = Draggable.drag(moveable, setCustomDrag(e, moveable.state, dragDelta, !!isPinch, false));\r\n        var params = fillParams(moveable, e, __assign(__assign({ width: width, height: height, origin: origin, dist: dist, delta: delta, transformOrigin: transformOrigin, drag: result }, fillCSSObject({\r\n            transformOrigin: transformOrigin,\r\n            transform: result.transform,\r\n        }, e)), { afterTransform: result.transform }));\r\n        triggerEvent(moveable, \"onDragOrigin\", params);\r\n        return params;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isDragOrigin) {\r\n            return false;\r\n        }\r\n        triggerEvent(moveable, \"onDragOriginEnd\", fillEndParams(moveable, e, {}));\r\n        return true;\r\n    },\r\n    dragGroupControlCondition: function (moveable, e) {\r\n        return this.dragControlCondition(moveable, e);\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var params = this.dragControlStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var params = this.dragControl(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        moveable.transformOrigin = params.transformOrigin;\r\n        return true;\r\n    },\r\n    /**\r\n    * @method Moveable.OriginDraggable#request\r\n    * @param {object} e - the OriginDraggable's request parameter\r\n    * @param {number} [e.x] - x position\r\n    * @param {number} [e.y] - y position\r\n    * @param {number} [e.deltaX] - x number to move\r\n    * @param {number} [e.deltaY] - y number to move\r\n    * @param {array} [e.deltaOrigin] - left, top number to move transform-origin\r\n    * @param {array} [e.origin] - transform-origin position\r\n    * @param {number} [e.isInstant] - Whether to execute the request instantly\r\n    * @return {Moveable.Requester} Moveable Requester\r\n    * @example\r\n\n    * // Instantly Request (requestStart - request - requestEnd)\r\n    * // Use Relative Value\r\n    * moveable.request(\"originDraggable\", { deltaX: 10, deltaY: 10 }, true);\r\n    * // Use Absolute Value\r\n    * moveable.request(\"originDraggable\", { x: 200, y: 100 }, true);\r\n    * // Use Transform Value\r\n    * moveable.request(\"originDraggable\", { deltaOrigin: [10, 0] }, true);\r\n    * moveable.request(\"originDraggable\", { origin: [100, 0] }, true);\r\n    * // requestStart\r\n    * const requester = moveable.request(\"originDraggable\");\r\n    *\r\n    * // request\r\n    * // Use Relative Value\r\n    * requester.request({ deltaX: 10, deltaY: 10 });\r\n    * requester.request({ deltaX: 10, deltaY: 10 });\r\n    * requester.request({ deltaX: 10, deltaY: 10 });\r\n    * // Use Absolute Value\r\n    * moveable.request(\"originDraggable\", { x: 200, y: 100 });\r\n    * moveable.request(\"originDraggable\", { x: 220, y: 100 });\r\n    * moveable.request(\"originDraggable\", { x: 240, y: 100 });\r\n    *\r\n    * // requestEnd\r\n    * requester.requestEnd();\r\n    */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var rect = moveable.getRect();\r\n        var distX = 0;\r\n        var distY = 0;\r\n        var transformOrigin = rect.transformOrigin;\r\n        var distOrigin = [0, 0];\r\n        return {\r\n            isControl: true,\r\n            requestStart: function () {\r\n                return { datas: datas };\r\n            },\r\n            request: function (e) {\r\n                if (\"deltaOrigin\" in e) {\r\n                    distOrigin[0] += e.deltaOrigin[0];\r\n                    distOrigin[1] += e.deltaOrigin[1];\r\n                }\r\n                else if (\"origin\" in e) {\r\n                    distOrigin[0] = e.origin[0] - transformOrigin[0];\r\n                    distOrigin[1] = e.origin[1] - transformOrigin[1];\r\n                }\r\n                else {\r\n                    if (\"x\" in e) {\r\n                        distX = e.x - rect.left;\r\n                    }\r\n                    else if (\"deltaX\" in e) {\r\n                        distX += e.deltaX;\r\n                    }\r\n                    if (\"y\" in e) {\r\n                        distY = e.y - rect.top;\r\n                    }\r\n                    else if (\"deltaY\" in e) {\r\n                        distY += e.deltaY;\r\n                    }\r\n                }\r\n                return { datas: datas, distX: distX, distY: distY, distOrigin: distOrigin };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true };\r\n            },\r\n        };\r\n    },\r\n};\r\n/**\r\n * Whether to drag origin (default: false)\r\n * @name Moveable.OriginDraggable#originDraggable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     originDraggable: true,\r\n * });\r\n * let translate = [0, 0];\r\n * moveable.on(\"dragOriginStart\", e => {\r\n *     e.dragStart && e.dragStart.set(translate);\r\n * }).on(\"dragOrigin\", e => {\r\n *     translate = e.drag.beforeTranslate;\r\n *     e.target.style.cssText\r\n *         = `transform-origin: ${e.transformOrigin};`\r\n *         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n * }).on(\"dragOriginEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * % Can be used instead of the absolute px (default: true)\r\n * @name Moveable.OriginDraggable#originRelative\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     originDraggable: true,\r\n *     originRelative: false,\r\n * });\r\n * moveable.originRelative = true;\r\n */\r\n/**\r\n* When drag start the origin, the `dragOriginStart` event is called.\r\n* @memberof Moveable.OriginDraggable\r\n* @event dragOriginStart\r\n* @param {Moveable.OriginDraggable.OnDragOriginStart} - Parameters for the `dragOriginStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     originDraggable: true,\r\n* });\r\n* let translate = [0, 0];\r\n* moveable.on(\"dragOriginStart\", e => {\r\n*     e.dragStart && e.dragStart.set(translate);\r\n* }).on(\"dragOrigin\", e => {\r\n*     translate = e.drag.beforeTranslate;\r\n*     e.target.style.cssText\r\n*         = `transform-origin: ${e.transformOrigin};`\r\n*         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n* }).on(\"dragOriginEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\r\n/**\r\n* When drag the origin, the `dragOrigin` event is called.\r\n* @memberof Moveable.OriginDraggable\r\n* @event dragOrigin\r\n* @param {Moveable.OriginDraggable.OnDragOrigin} - Parameters for the `dragOrigin` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     originDraggable: true,\r\n* });\r\n* let translate = [0, 0];\r\n* moveable.on(\"dragOriginStart\", e => {\r\n*     e.dragStart && e.dragStart.set(translate);\r\n* }).on(\"dragOrigin\", e => {\r\n*     translate = e.drag.beforeTranslate;\r\n*     e.target.style.cssText\r\n*         = `transform-origin: ${e.transformOrigin};`\r\n*         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n* }).on(\"dragOriginEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\r\n/**\r\n* When drag end the origin, the `dragOriginEnd` event is called.\r\n* @memberof Moveable.OriginDraggable\r\n* @event dragOriginEnd\r\n* @param {Moveable.OriginDraggable.OnDragOriginEnd} - Parameters for the `dragOriginEnd` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     originDraggable: true,\r\n* });\r\n* let translate = [0, 0];\r\n* moveable.on(\"dragOriginStart\", e => {\r\n*     e.dragStart && e.dragStart.set(translate);\r\n* }).on(\"dragOrigin\", e => {\r\n*     translate = e.drag.beforeTranslate;\r\n*     e.target.style.cssText\r\n*         = `transform-origin: ${e.transformOrigin};`\r\n*         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n* }).on(\"dragOriginEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\n\nfunction addBorderRadiusByLine(controlPoses, lineIndex, distX, distY) {\r\n    // lineIndex\r\n    // 0 top\r\n    // 1 right\r\n    // 2 bottom\r\n    // 3 left\r\n    var horizontalsLength = controlPoses.filter(function (_a) {\r\n        var virtual = _a.virtual, horizontal = _a.horizontal;\r\n        return horizontal && !virtual;\r\n    }).length;\r\n    var verticalsLength = controlPoses.filter(function (_a) {\r\n        var virtual = _a.virtual, vertical = _a.vertical;\r\n        return vertical && !virtual;\r\n    }).length;\r\n    var controlIndex = -1;\r\n    //top\r\n    if (lineIndex === 0) {\r\n        if (horizontalsLength === 0) {\r\n            controlIndex = 0;\r\n        }\r\n        else if (horizontalsLength === 1) {\r\n            controlIndex = 1;\r\n        }\r\n    }\r\n    // bottom\r\n    if (lineIndex === 2) {\r\n        if (horizontalsLength <= 2) {\r\n            controlIndex = 2;\r\n        }\r\n        else if (horizontalsLength <= 3) {\r\n            controlIndex = 3;\r\n        }\r\n    }\r\n    // left\r\n    if (lineIndex === 3) {\r\n        if (verticalsLength === 0) {\r\n            controlIndex = 4;\r\n        }\r\n        else if (verticalsLength < 4) {\r\n            controlIndex = 7;\r\n        }\r\n    }\r\n    // right\r\n    if (lineIndex === 1) {\r\n        if (verticalsLength <= 1) {\r\n            controlIndex = 5;\r\n        }\r\n        else if (verticalsLength <= 2) {\r\n            controlIndex = 6;\r\n        }\r\n    }\r\n    if (controlIndex === -1 || !controlPoses[controlIndex].virtual) {\r\n        return;\r\n    }\r\n    var controlPoseInfo = controlPoses[controlIndex];\r\n    addBorderRadius(controlPoses, controlIndex);\r\n    if (controlIndex < 4) {\r\n        controlPoseInfo.pos[0] = distX;\r\n    }\r\n    else {\r\n        controlPoseInfo.pos[1] = distY;\r\n    }\r\n}\r\nfunction addBorderRadius(controlPoses, index) {\r\n    if (index < 4) {\r\n        controlPoses.slice(0, index + 1).forEach(function (info) {\r\n            info.virtual = false;\r\n        });\r\n    }\r\n    else {\r\n        if (controlPoses[0].virtual) {\r\n            controlPoses[0].virtual = false;\r\n        }\r\n        controlPoses.slice(4, index + 1).forEach(function (info) {\r\n            info.virtual = false;\r\n        });\r\n    }\r\n}\r\nfunction removeBorderRadius(controlPoses, index) {\r\n    if (index < 4) {\r\n        controlPoses.slice(index, 4).forEach(function (info) {\r\n            info.virtual = true;\r\n        });\r\n    }\r\n    else {\r\n        controlPoses.slice(index).forEach(function (info) {\r\n            info.virtual = true;\r\n        });\r\n    }\r\n}\r\nfunction getBorderRadius(borderRadius, width, height, minCounts, full) {\r\n    if (minCounts === void 0) { minCounts = [0, 0]; }\r\n    var values = [];\r\n    if (!borderRadius || borderRadius === \"0px\") {\r\n        values = [];\r\n    }\r\n    else {\r\n        values = splitSpace(borderRadius);\r\n    }\r\n    return getRadiusValues(values, width, height, 0, 0, minCounts, full);\r\n}\r\nfunction triggerRoundEvent(moveable, e, dist, delta, nextPoses) {\r\n    var state = moveable.state;\r\n    var width = state.width, height = state.height;\r\n    var _a = getRadiusStyles(nextPoses, moveable.props.roundRelative, width, height), raws = _a.raws, styles = _a.styles, radiusPoses = _a.radiusPoses;\r\n    var _b = splitRadiusPoses(radiusPoses, raws), horizontals = _b.horizontals, verticals = _b.verticals;\r\n    var borderRadius = styles.join(\" \");\r\n    state.borderRadiusState = borderRadius;\r\n    var params = fillParams(moveable, e, __assign({ horizontals: horizontals, verticals: verticals, borderRadius: borderRadius, width: width, height: height, delta: delta, dist: dist }, fillCSSObject({\r\n        borderRadius: borderRadius,\r\n    }, e)));\r\n    triggerEvent(moveable, \"onRound\", params);\r\n    return params;\r\n}\r\nfunction getStyleBorderRadius(moveable) {\r\n    var _a, _b;\r\n    var style = moveable.getState().style;\r\n    var borderRadius = style.borderRadius || \"\";\r\n    if (!borderRadius && moveable.props.groupable) {\r\n        var firstMoveable = moveable.moveables[0];\r\n        var firstTarget = moveable.getTargets()[0];\r\n        if (firstTarget) {\r\n            if ((firstMoveable === null || firstMoveable === void 0 ? void 0 : firstMoveable.props.target) === firstTarget) {\r\n                borderRadius = (_b = (_a = moveable.moveables[0]) === null || _a === void 0 ? void 0 : _a.state.style.borderRadius) !== null && _b !== void 0 ? _b : \"\";\r\n                style.borderRadius = borderRadius;\r\n            }\r\n            else {\r\n                borderRadius = getComputedStyle(firstTarget).borderRadius;\r\n                style.borderRadius = borderRadius;\r\n            }\r\n        }\r\n    }\r\n    return borderRadius;\r\n}\r\n/**\r\n * @namespace Moveable.Roundable\r\n * @description Whether to show and drag or double click border-radius\r\n */\r\nvar Roundable = {\r\n    name: \"roundable\",\r\n    props: [\r\n        \"roundable\",\r\n        \"roundRelative\",\r\n        \"minRoundControls\",\r\n        \"maxRoundControls\",\r\n        \"roundClickable\",\r\n        \"roundPadding\",\r\n        \"isDisplayShadowRoundControls\",\r\n    ],\r\n    events: [\r\n        \"roundStart\",\r\n        \"round\",\r\n        \"roundEnd\",\r\n        \"roundGroupStart\",\r\n        \"roundGroup\",\r\n        \"roundGroupEnd\",\r\n    ],\r\n    css: [\r\n        \".control.border-radius {\\nbackground: #d66;\\ncursor: pointer;\\nz-index: 3;\\n}\",\r\n        \".control.border-radius.vertical {\\nbackground: #d6d;\\nz-index: 2;\\n}\",\r\n        \".control.border-radius.virtual {\\nopacity: 0.5;\\nz-index: 1;\\n}\",\r\n        \":host.round-line-clickable .line.direction {\\ncursor: pointer;\\n}\",\r\n    ],\r\n    className: function (moveable) {\r\n        var roundClickable = moveable.props.roundClickable;\r\n        return roundClickable === true || roundClickable === \"line\" ? prefix(\"round-line-clickable\") : \"\";\r\n    },\r\n    requestStyle: function () {\r\n        return [\"borderRadius\"];\r\n    },\r\n    requestChildStyle: function () {\r\n        return [\"borderRadius\"];\r\n    },\r\n    render: function (moveable, React) {\r\n        var _a = moveable.getState(), target = _a.target, width = _a.width, height = _a.height, allMatrix = _a.allMatrix, is3d = _a.is3d, left = _a.left, top = _a.top, borderRadiusState = _a.borderRadiusState;\r\n        var _b = moveable.props, _c = _b.minRoundControls, minRoundControls = _c === void 0 ? [0, 0] : _c, _d = _b.maxRoundControls, maxRoundControls = _d === void 0 ? [4, 4] : _d, zoom = _b.zoom, _e = _b.roundPadding, roundPadding = _e === void 0 ? 0 : _e, isDisplayShadowRoundControls = _b.isDisplayShadowRoundControls, groupable = _b.groupable;\r\n        if (!target) {\r\n            return null;\r\n        }\r\n        var borderRadius = borderRadiusState || getStyleBorderRadius(moveable);\r\n        var n = is3d ? 4 : 3;\r\n        var radiusValues = getBorderRadius(borderRadius, width, height, minRoundControls, true);\r\n        if (!radiusValues) {\r\n            return null;\r\n        }\r\n        var verticalCount = 0;\r\n        var horizontalCount = 0;\r\n        var basePos = groupable ? [0, 0] : [left, top];\r\n        return radiusValues.map(function (v, i) {\r\n            var horizontal = v.horizontal;\r\n            var vertical = v.vertical;\r\n            var direction = v.direction || \"\";\r\n            var originalPos = __spreadArray([], __read(v.pos), false);\r\n            horizontalCount += Math.abs(horizontal);\r\n            verticalCount += Math.abs(vertical);\r\n            if (horizontal && direction.indexOf(\"n\") > -1) {\r\n                originalPos[1] -= roundPadding;\r\n            }\r\n            if (vertical && direction.indexOf(\"w\") > -1) {\r\n                originalPos[0] -= roundPadding;\r\n            }\r\n            if (horizontal && direction.indexOf(\"s\") > -1) {\r\n                originalPos[1] += roundPadding;\r\n            }\r\n            if (vertical && direction.indexOf(\"e\") > -1) {\r\n                originalPos[0] += roundPadding;\r\n            }\r\n            var pos = minus(calculatePosition(allMatrix, originalPos, n), basePos);\r\n            var isDisplayVerticalShadow = isDisplayShadowRoundControls\r\n                && isDisplayShadowRoundControls !== \"horizontal\";\r\n            var isDisplay = v.vertical\r\n                ? verticalCount <= maxRoundControls[1] && (isDisplayVerticalShadow || !v.virtual)\r\n                : horizontalCount <= maxRoundControls[0] && (isDisplayShadowRoundControls || !v.virtual);\r\n            return React.createElement(\"div\", { key: \"borderRadiusControl\".concat(i), className: prefix(\"control\", \"border-radius\", v.vertical ? \"vertical\" : \"\", v.virtual ? \"virtual\" : \"\"), \"data-radius-index\": i, style: {\r\n                    display: isDisplay ? \"block\" : \"none\",\r\n                    transform: \"translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) scale(\").concat(zoom, \")\"),\r\n                } });\r\n        });\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        if (!e.inputEvent || e.isRequest) {\r\n            return false;\r\n        }\r\n        var className = (e.inputEvent.target.getAttribute(\"class\") || \"\");\r\n        return className.indexOf(\"border-radius\") > -1\r\n            || (className.indexOf(\"moveable-line\") > -1 && className.indexOf(\"moveable-direction\") > -1);\r\n    },\r\n    dragGroupControlCondition: function (moveable, e) {\r\n        return this.dragControlCondition(moveable, e);\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var inputEvent = e.inputEvent, datas = e.datas;\r\n        var inputTarget = inputEvent.target;\r\n        var className = (inputTarget.getAttribute(\"class\") || \"\");\r\n        var isControl = className.indexOf(\"border-radius\") > -1;\r\n        var isLine = className.indexOf(\"moveable-line\") > -1 && className.indexOf(\"moveable-direction\") > -1;\r\n        var controlIndex = isControl ? parseInt(inputTarget.getAttribute(\"data-radius-index\"), 10) : -1;\r\n        var lineIndex = -1;\r\n        if (isLine) {\r\n            var indexAttr = inputTarget.getAttribute(\"data-line-key\") || \"\";\r\n            if (indexAttr) {\r\n                lineIndex = parseInt(indexAttr.replace(/render-line-/g, \"\"), 10);\r\n                if (isNaN(lineIndex)) {\r\n                    lineIndex = -1;\r\n                }\r\n            }\r\n        }\r\n        if (!isControl && !isLine) {\r\n            return false;\r\n        }\r\n        var params = fillParams(moveable, e, {});\r\n        var result = triggerEvent(moveable, \"onRoundStart\", params);\r\n        if (result === false) {\r\n            return false;\r\n        }\r\n        datas.lineIndex = lineIndex;\r\n        datas.controlIndex = controlIndex;\r\n        datas.isControl = isControl;\r\n        datas.isLine = isLine;\r\n        setDragStart(moveable, e);\r\n        var _a = moveable.props, roundRelative = _a.roundRelative, _b = _a.minRoundControls, minRoundControls = _b === void 0 ? [0, 0] : _b;\r\n        var state = moveable.state;\r\n        var width = state.width, height = state.height;\r\n        datas.isRound = true;\r\n        datas.prevDist = [0, 0];\r\n        var borderRadius = getStyleBorderRadius(moveable);\r\n        var controlPoses = getBorderRadius(borderRadius || \"\", width, height, minRoundControls, true) || [];\r\n        datas.controlPoses = controlPoses;\r\n        state.borderRadiusState = getRadiusStyles(controlPoses, roundRelative, width, height).styles.join(\" \");\r\n        return params;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var controlPoses = datas.controlPoses;\r\n        if (!datas.isRound || !datas.isControl || !controlPoses.length) {\r\n            return false;\r\n        }\r\n        var index = datas.controlIndex;\r\n        var _a = __read(getDragDist(e), 2), distX = _a[0], distY = _a[1];\r\n        var dist = [distX, distY];\r\n        var delta = minus(dist, datas.prevDist);\r\n        var _b = moveable.props.maxRoundControls, maxRoundControls = _b === void 0 ? [4, 4] : _b;\r\n        var _c = moveable.state, width = _c.width, height = _c.height;\r\n        var selectedControlPose = controlPoses[index];\r\n        var selectedVertical = selectedControlPose.vertical;\r\n        var selectedHorizontal = selectedControlPose.horizontal;\r\n        // 0: [0, 1, 2, 3] maxCount === 1\r\n        // 0: [0, 2] maxCount === 2\r\n        // 1: [1, 3] maxCount === 2\r\n        // 0: [0] maxCount === 3\r\n        // 1: [1, 3] maxCount === 3\r\n        var dists = controlPoses.map(function (pose) {\r\n            var horizontal = pose.horizontal, vertical = pose.vertical;\r\n            var poseDist = [\r\n                horizontal * selectedHorizontal * dist[0],\r\n                vertical * selectedVertical * dist[1],\r\n            ];\r\n            if (horizontal) {\r\n                if (maxRoundControls[0] === 1) {\r\n                    return poseDist;\r\n                }\r\n                else if (maxRoundControls[0] < 4 && horizontal !== selectedHorizontal) {\r\n                    return poseDist;\r\n                }\r\n            }\r\n            else if (maxRoundControls[1] === 0) {\r\n                poseDist[1] = vertical * selectedHorizontal * dist[0] / width * height;\r\n                return poseDist;\r\n            }\r\n            else if (selectedVertical) {\r\n                if (maxRoundControls[1] === 1) {\r\n                    return poseDist;\r\n                }\r\n                else if (maxRoundControls[1] < 4 && vertical !== selectedVertical) {\r\n                    return poseDist;\r\n                }\r\n            }\r\n            return [0, 0];\r\n        });\r\n        dists[index] = dist;\r\n        var nextPoses = controlPoses.map(function (info, i) {\r\n            return __assign(__assign({}, info), { pos: plus(info.pos, dists[i]) });\r\n        });\r\n        if (index < 4) {\r\n            nextPoses.slice(0, index + 1).forEach(function (info) {\r\n                info.virtual = false;\r\n            });\r\n        }\r\n        else {\r\n            nextPoses.slice(4, index + 1).forEach(function (info) {\r\n                info.virtual = false;\r\n            });\r\n        }\r\n        datas.prevDist = [distX, distY];\r\n        return triggerRoundEvent(moveable, e, dist, delta, nextPoses);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var state = moveable.state;\r\n        state.borderRadiusState = \"\";\r\n        var datas = e.datas, isDouble = e.isDouble;\r\n        if (!datas.isRound) {\r\n            return false;\r\n        }\r\n        var isControl = datas.isControl, controlIndex = datas.controlIndex, isLine = datas.isLine, lineIndex = datas.lineIndex;\r\n        var controlPoses = datas.controlPoses;\r\n        var length = controlPoses.filter(function (_a) {\r\n            var virtual = _a.virtual;\r\n            return virtual;\r\n        }).length;\r\n        var _a = moveable.props.roundClickable, roundClickable = _a === void 0 ? true : _a;\r\n        if (isDouble && roundClickable) {\r\n            if (isControl && (roundClickable === true || roundClickable === \"control\")) {\r\n                removeBorderRadius(controlPoses, controlIndex);\r\n            }\r\n            else if (isLine && (roundClickable === true || roundClickable === \"line\")) {\r\n                var _b = __read(calculatePointerDist(moveable, e), 2), distX = _b[0], distY = _b[1];\r\n                addBorderRadiusByLine(controlPoses, lineIndex, distX, distY);\r\n            }\r\n            if (length !== controlPoses.filter(function (_a) {\r\n                var virtual = _a.virtual;\r\n                return virtual;\r\n            }).length) {\r\n                triggerRoundEvent(moveable, e, [0, 0], [0, 0], controlPoses);\r\n            }\r\n        }\r\n        var params = fillEndParams(moveable, e, {});\r\n        triggerEvent(moveable, \"onRoundEnd\", params);\r\n        state.borderRadiusState = \"\";\r\n        return params;\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var result = this.dragControlStart(moveable, e);\r\n        if (!result) {\r\n            return false;\r\n        }\r\n        var moveables = moveable.moveables;\r\n        var targets = moveable.props.targets;\r\n        var events = fillChildEvents(moveable, \"roundable\", e);\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                return __assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i] });\r\n            }) }, result);\r\n        triggerEvent(moveable, \"onRoundGroupStart\", nextParams);\r\n        return result;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var result = this.dragControl(moveable, e);\r\n        if (!result) {\r\n            return false;\r\n        }\r\n        var moveables = moveable.moveables;\r\n        var targets = moveable.props.targets;\r\n        var events = fillChildEvents(moveable, \"roundable\", e);\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                return __assign(__assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i] }), fillCSSObject({\r\n                    borderRadius: result.borderRadius,\r\n                }, ev));\r\n            }) }, result);\r\n        triggerEvent(moveable, \"onRoundGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var moveables = moveable.moveables;\r\n        var targets = moveable.props.targets;\r\n        var events = fillChildEvents(moveable, \"roundable\", e);\r\n        catchEvent(moveable, \"onRound\", function (parentEvent) {\r\n            var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                    return __assign(__assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i] }), fillCSSObject({\r\n                        borderRadius: parentEvent.borderRadius,\r\n                    }, ev));\r\n                }) }, parentEvent);\r\n            triggerEvent(moveable, \"onRoundGroup\", nextParams);\r\n        });\r\n        var result = this.dragControlEnd(moveable, e);\r\n        if (!result) {\r\n            return false;\r\n        }\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                var _a;\r\n                return __assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i], lastEvent: (_a = ev.datas) === null || _a === void 0 ? void 0 : _a.lastEvent });\r\n            }) }, result);\r\n        triggerEvent(moveable, \"onRoundGroupEnd\", nextParams);\r\n        return nextParams;\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.borderRadiusState = \"\";\r\n    },\r\n};\r\n/**\r\n * Whether to show and drag or double click border-radius, (default: false)\r\n * @name Moveable.Roundable#roundable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * % Can be used instead of the absolute px\r\n * @name Moveable.Roundable#roundRelative\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * Minimum number of round controls. It moves in proportion by control. [horizontal, vertical] (default: [0, 0])\r\n * @name Moveable.Roundable#minRoundControls\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n *     minRoundControls: [0, 0],\r\n * });\r\n * moveable.minRoundControls = [1, 0];\r\n */\r\n/**\r\n * Maximum number of round controls. It moves in proportion by control. [horizontal, vertical] (default: [4, 4])\r\n * @name Moveable.Roundable#maxRoundControls\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n *     maxRoundControls: [4, 4],\r\n * });\r\n * moveable.maxRoundControls = [1, 0];\r\n */\r\n/**\r\n * Whether you can add/delete round controls by double-clicking a line or control.\r\n * @name Moveable.Roundable#roundClickable\r\n * @default true\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n *     roundClickable: true,\r\n * });\r\n * moveable.roundClickable = false;\r\n */\r\n/**\r\n * Whether to show a round control that does not actually exist as a shadow\r\n * @name Moveable.Roundable#isDisplayShadowRoundControls\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     isDisplayShadowRoundControls: false,\r\n * });\r\n * moveable.isDisplayShadowRoundControls = true;\r\n */\r\n/**\r\n * The padding value of the position of the round control\r\n * @name Moveable.Roundable#roundPadding\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundPadding: 0,\r\n * });\r\n * moveable.roundPadding = 15;\r\n */\r\n/**\r\n * When drag start the clip area or controls, the `roundStart` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundStart\r\n * @param {Moveable.Roundable.OnRoundStart} - Parameters for the `roundStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag or double click the border area or controls, the `round` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event round\r\n * @param {Moveable.Roundable.OnRound} - Parameters for the `round` event\r\n * @example\r\n  * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag end the border area or controls, the `roundEnd` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundEnd\r\n * @param {Moveable.Roundable.onRoundEnd} - Parameters for the `roundEnd` event\r\n * @example\r\n  * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag start the clip area or controls, the `roundGroupStart` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundGroupStart\r\n * @param {Moveable.Roundable.OnRoundGroupStart} - Parameters for the `roundGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     targets: [target1, target2, target3],\r\n *     roundable: true,\r\n * });\r\n * moveable.on(\"roundGroupStart\", e => {\r\n *     console.log(e.targets);\r\n * }).on(\"roundGroup\", e => {\r\n *   e.events.forEach(ev => {\r\n *       ev.target.style.cssText += ev.cssText;\r\n *   });\r\n * }).on(\"roundGroupEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag or double click the border area or controls, the `roundGroup` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundGroup\r\n * @param {Moveable.Roundable.OnRoundGroup} - Parameters for the `roundGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     targets: [target1, target2, target3],\r\n *     roundable: true,\r\n * });\r\n * moveable.on(\"roundGroupStart\", e => {\r\n *     console.log(e.targets);\r\n * }).on(\"roundGroup\", e => {\r\n *   e.events.forEach(ev => {\r\n *       ev.target.style.cssText += ev.cssText;\r\n *   });\r\n * }).on(\"roundGroupEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag end the border area or controls, the `roundGroupEnd` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundGroupEnd\r\n * @param {Moveable.Roundable.onRoundGroupEnd} - Parameters for the `roundGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     targets: [target1, target2, target3],\r\n *     roundable: true,\r\n * });\r\n * moveable.on(\"roundGroupStart\", e => {\r\n *     console.log(e.targets);\r\n * }).on(\"roundGroup\", e => {\r\n *     e.events.forEach(ev => {\r\n *         ev.target.style.cssText += ev.cssText;\r\n *     });\r\n * }).on(\"roundGroupEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\n\nfunction isIdentityMatrix(matrix, is3d) {\r\n    var n = is3d ? 4 : 3;\r\n    var identityMatrix = createIdentityMatrix(n);\r\n    var value = \"matrix\".concat(is3d ? \"3d\" : \"\", \"(\").concat(identityMatrix.join(\",\"), \")\");\r\n    return matrix === value || matrix === \"matrix(1,0,0,1,0,0)\";\r\n}\r\nvar BeforeRenderable = {\r\n    isPinch: true,\r\n    name: \"beforeRenderable\",\r\n    props: [],\r\n    events: [\r\n        \"beforeRenderStart\",\r\n        \"beforeRender\",\r\n        \"beforeRenderEnd\",\r\n        \"beforeRenderGroupStart\",\r\n        \"beforeRenderGroup\",\r\n        \"beforeRenderGroupEnd\",\r\n    ],\r\n    dragRelation: \"weak\",\r\n    setTransform: function (moveable, e) {\r\n        var _a = moveable.state, is3d = _a.is3d, targetMatrix = _a.targetMatrix, inlineTransform = _a.inlineTransform;\r\n        var cssMatrix = is3d\r\n            ? \"matrix3d(\".concat(targetMatrix.join(\",\"), \")\")\r\n            : \"matrix(\".concat(convertMatrixtoCSS(targetMatrix, true), \")\");\r\n        var startTransform = !inlineTransform || inlineTransform === \"none\" ? cssMatrix : inlineTransform;\r\n        e.datas.startTransforms = isIdentityMatrix(startTransform, is3d) ? [] : splitSpace(startTransform);\r\n    },\r\n    resetStyle: function (e) {\r\n        var datas = e.datas;\r\n        datas.nextStyle = {};\r\n        datas.nextTransforms = e.datas.startTransforms;\r\n        datas.nextTransformAppendedIndexes = [];\r\n    },\r\n    fillDragStartParams: function (moveable, e) {\r\n        return fillParams(moveable, e, {\r\n            setTransform: function (transform) {\r\n                e.datas.startTransforms = isArray(transform) ? transform : splitSpace(transform);\r\n            },\r\n            isPinch: !!e.isPinch,\r\n        });\r\n    },\r\n    fillDragParams: function (moveable, e) {\r\n        return fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n        });\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        this.setTransform(moveable, e);\r\n        this.resetStyle(e);\r\n        triggerEvent(moveable, \"onBeforeRenderStart\", this.fillDragStartParams(moveable, e));\r\n    },\r\n    drag: function (moveable, e) {\r\n        if (!e.datas.startTransforms) {\r\n            this.setTransform(moveable, e);\r\n        }\r\n        this.resetStyle(e);\r\n        triggerEvent(moveable, \"onBeforeRender\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n        }));\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        if (!e.datas.startTransforms) {\r\n            this.setTransform(moveable, e);\r\n            this.resetStyle(e);\r\n        }\r\n        triggerEvent(moveable, \"onBeforeRenderEnd\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            isDrag: e.isDrag,\r\n        }));\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        var _this = this;\r\n        this.dragStart(moveable, e);\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            _this.setTransform(childMoveable, childEvent);\r\n            _this.resetStyle(childEvent);\r\n            return _this.fillDragStartParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onBeforeRenderGroupStart\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            targets: moveable.props.targets,\r\n            setTransform: function () { },\r\n            events: params,\r\n        }));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        var _this = this;\r\n        this.drag(moveable, e);\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            _this.resetStyle(childEvent);\r\n            return _this.fillDragParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onBeforeRenderGroup\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            targets: moveable.props.targets,\r\n            events: params,\r\n        }));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        this.dragEnd(moveable, e);\r\n        triggerEvent(moveable, \"onBeforeRenderGroupEnd\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            isDrag: e.isDrag,\r\n            targets: moveable.props.targets,\r\n        }));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, e);\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        return this.dragGroupStart(moveable, e);\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        return this.dragGroup(moveable, e);\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        return this.dragGroupEnd(moveable, e);\r\n    },\r\n};\n\nvar Renderable = {\r\n    name: \"renderable\",\r\n    props: [],\r\n    events: [\r\n        \"renderStart\",\r\n        \"render\",\r\n        \"renderEnd\",\r\n        \"renderGroupStart\",\r\n        \"renderGroup\",\r\n        \"renderGroupEnd\",\r\n    ],\r\n    dragRelation: \"weak\",\r\n    dragStart: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRenderStart\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n        }));\r\n    },\r\n    drag: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRender\", this.fillDragParams(moveable, e));\r\n    },\r\n    dragAfter: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRenderEnd\", this.fillDragEndParams(moveable, e));\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRenderGroupStart\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            targets: moveable.props.targets,\r\n        }));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        var _this = this;\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            return _this.fillDragParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onRenderGroup\", fillParams(moveable, e, __assign(__assign({ isPinch: !!e.isPinch, targets: moveable.props.targets, transform: getNextTransformText(e), transformObject: {} }, fillCSSObject(getNextStyle(e))), { events: params })));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        var _this = this;\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            return _this.fillDragEndParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onRenderGroupEnd\", fillParams(moveable, e, __assign({ isPinch: !!e.isPinch, isDrag: e.isDrag, targets: moveable.props.targets, events: params, transformObject: {}, transform: getNextTransformText(e) }, fillCSSObject(getNextStyle(e)))));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, e);\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragControlAfter: function (moveable, e) {\r\n        return this.dragAfter(moveable, e);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        return this.dragGroupStart(moveable, e);\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        return this.dragGroup(moveable, e);\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        return this.dragGroupEnd(moveable, e);\r\n    },\r\n    fillDragParams: function (moveable, e) {\r\n        var transformObject = {};\r\n        parse(getNextTransforms(e) || []).forEach(function (matrixInfo) {\r\n            transformObject[matrixInfo.name] = matrixInfo.functionValue;\r\n        });\r\n        return fillParams(moveable, e, __assign({ isPinch: !!e.isPinch, transformObject: transformObject, transform: getNextTransformText(e) }, fillCSSObject(getNextStyle(e))));\r\n    },\r\n    fillDragEndParams: function (moveable, e) {\r\n        var transformObject = {};\r\n        parse(getNextTransforms(e) || []).forEach(function (matrixInfo) {\r\n            transformObject[matrixInfo.name] = matrixInfo.functionValue;\r\n        });\r\n        return fillParams(moveable, e, __assign({ isPinch: !!e.isPinch, isDrag: e.isDrag, transformObject: transformObject, transform: getNextTransformText(e) }, fillCSSObject(getNextStyle(e))));\r\n    },\r\n};\n\nfunction triggerAble(moveable, moveableAbles, eventOperations, eventAffix, eventType, e, requestInstant) {\r\n    // pre setting\r\n    e.clientDistX = e.distX;\r\n    e.clientDistY = e.distY;\r\n    var isStart = eventType === \"Start\";\r\n    var isEnd = eventType === \"End\";\r\n    var isAfter = eventType === \"After\";\r\n    var target = moveable.state.target;\r\n    var isRequest = e.isRequest;\r\n    var isControl = eventAffix.indexOf(\"Control\") > -1;\r\n    if (!target\r\n        || (isStart && isControl && !isRequest && moveable.areaElement === e.inputEvent.target)) {\r\n        return false;\r\n    }\r\n    var ables = __spreadArray([], __read(moveableAbles), false);\r\n    if (isRequest) {\r\n        var requestAble_1 = e.requestAble;\r\n        if (!ables.some(function (able) { return able.name === requestAble_1; })) {\r\n            ables.push.apply(ables, __spreadArray([], __read(moveable.props.ables.filter(function (able) { return able.name === requestAble_1; })), false));\r\n        }\r\n    }\r\n    if (!ables.length || ables.every(function (able) { return able.dragRelation; })) {\r\n        return false;\r\n    }\r\n    // \"drag\" \"Control\" \"After\"\r\n    var inputEvent = e.inputEvent;\r\n    var inputTarget;\r\n    if (isEnd && inputEvent) {\r\n        inputTarget = document.elementFromPoint(e.clientX, e.clientY) || inputEvent.target;\r\n    }\r\n    var isDragStop = false;\r\n    var stop = function () {\r\n        var _a;\r\n        isDragStop = true;\r\n        (_a = e.stop) === null || _a === void 0 ? void 0 : _a.call(e);\r\n    };\r\n    var isFirstStart = isStart && (!moveable.targetGesto || !moveable.controlGesto\r\n        || (!moveable.targetGesto.isFlag() || !moveable.controlGesto.isFlag()));\r\n    if (isFirstStart) {\r\n        moveable.updateRect(eventType, true, false);\r\n    }\r\n    // trigger ables\r\n    var datas = e.datas;\r\n    var gestoType = isControl ? \"controlGesto\" : \"targetGesto\";\r\n    var prevGesto = moveable[gestoType];\r\n    var trigger = function (able, eventName, conditionName) {\r\n        if (!(eventName in able) || prevGesto !== moveable[gestoType]) {\r\n            return false;\r\n        }\r\n        var ableName = able.name;\r\n        var nextDatas = datas[ableName] || (datas[ableName] = {});\r\n        if (isStart) {\r\n            nextDatas.isEventStart = !conditionName\r\n                || !able[conditionName] || able[conditionName](moveable, e);\r\n        }\r\n        if (!nextDatas.isEventStart) {\r\n            return false;\r\n        }\r\n        var result = able[eventName](moveable, __assign(__assign({}, e), { stop: stop, datas: nextDatas, originalDatas: datas, inputTarget: inputTarget }));\r\n        moveable._emitter.off();\r\n        if (isStart && result === false) {\r\n            nextDatas.isEventStart = false;\r\n        }\r\n        return result;\r\n    };\r\n    // unset ables for first drag start\r\n    if (isFirstStart) {\r\n        ables.forEach(function (able) {\r\n            able.unset && able.unset(moveable);\r\n        });\r\n    }\r\n    // BeforeRenderable\r\n    trigger(BeforeRenderable, \"drag\".concat(eventAffix).concat(eventType));\r\n    var forceEndedCount = 0;\r\n    var updatedCount = 0;\r\n    eventOperations.forEach(function (eventOperation) {\r\n        if (isDragStop) {\r\n            return false;\r\n        }\r\n        var eventName = \"\".concat(eventOperation).concat(eventAffix).concat(eventType);\r\n        var conditionName = \"\".concat(eventOperation).concat(eventAffix, \"Condition\");\r\n        if (eventType === \"\" && !isRequest) {\r\n            // Convert distX, distY\r\n            convertDragDist(moveable.state, e);\r\n        }\r\n        // const isGroup = eventAffix.indexOf(\"Group\") > -1;\r\n        var eventAbles = ables.filter(function (able) { return able[eventName]; });\r\n        eventAbles = eventAbles.filter(function (able, i) {\r\n            return able.name && eventAbles.indexOf(able) === i;\r\n        });\r\n        var results = eventAbles.filter(function (able) { return trigger(able, eventName, conditionName); });\r\n        var isUpdate = results.length;\r\n        // end ables\r\n        if (isDragStop) {\r\n            ++forceEndedCount;\r\n        }\r\n        if (isUpdate) {\r\n            ++updatedCount;\r\n        }\r\n        if (!isDragStop && isStart && eventAbles.length && !isUpdate) {\r\n            forceEndedCount += eventAbles.filter(function (able) {\r\n                var ableName = able.name;\r\n                var nextDatas = datas[ableName];\r\n                if (nextDatas.isEventStart) {\r\n                    if (able.dragRelation === \"strong\") {\r\n                        return false;\r\n                    }\r\n                    // stop drag\r\n                    return true;\r\n                }\r\n                // pre stop drag\r\n                return false;\r\n            }).length ? 1 : 0;\r\n        }\r\n    });\r\n    if (!isAfter || updatedCount) {\r\n        trigger(Renderable, \"drag\".concat(eventAffix).concat(eventType));\r\n    }\r\n    // stop gesto condition\r\n    var isForceEnd = prevGesto !== moveable[gestoType] || forceEndedCount === eventOperations.length;\r\n    if (isEnd || isDragStop || isForceEnd) {\r\n        moveable.state.gestos = {};\r\n        if (moveable.moveables) {\r\n            moveable.moveables.forEach(function (childMoveable) {\r\n                childMoveable.state.gestos = {};\r\n            });\r\n        }\r\n        ables.forEach(function (able) {\r\n            able.unset && able.unset(moveable);\r\n        });\r\n    }\r\n    if (isStart && !isForceEnd && !isRequest && updatedCount && moveable.props.preventDefault) {\r\n        e === null || e === void 0 ? void 0 : e.preventDefault();\r\n    }\r\n    if (moveable.isUnmounted || isForceEnd) {\r\n        return false;\r\n    }\r\n    if ((!isStart && updatedCount && !requestInstant) || isEnd) {\r\n        var flushSync = moveable.props.flushSync || defaultSync;\r\n        flushSync(function () {\r\n            moveable.updateRect(isEnd ? eventType : \"\", true, false);\r\n            moveable.forceUpdate();\r\n        });\r\n    }\r\n    if (!isStart && !isEnd && !isAfter && updatedCount && !requestInstant) {\r\n        triggerAble(moveable, moveableAbles, eventOperations, eventAffix, eventType + \"After\", e);\r\n    }\r\n    return true;\r\n}\r\nfunction checkMoveableTarget(moveable, isControl) {\r\n    return function (e, target) {\r\n        var _a;\r\n        if (target === void 0) { target = e.inputEvent.target; }\r\n        var eventTarget = target;\r\n        var areaElement = moveable.areaElement;\r\n        var dragTargetElement = moveable._dragTarget;\r\n        if (!dragTargetElement || (!isControl && ((_a = moveable.controlGesto) === null || _a === void 0 ? void 0 : _a.isFlag()))) {\r\n            return false;\r\n        }\r\n        return eventTarget === dragTargetElement\r\n            || dragTargetElement.contains(eventTarget)\r\n            || eventTarget === areaElement\r\n            || (!moveable.isMoveableElement(eventTarget) && !moveable.controlBox.contains(eventTarget))\r\n            || hasClass(eventTarget, \"moveable-area\")\r\n            || hasClass(eventTarget, \"moveable-padding\")\r\n            || hasClass(eventTarget, \"moveable-edgeDraggable\");\r\n    };\r\n}\r\nfunction getTargetAbleGesto(moveable, moveableTarget, eventAffix) {\r\n    var controlBox = moveable.controlBox;\r\n    var targets = [];\r\n    var props = moveable.props;\r\n    var dragArea = props.dragArea;\r\n    var target = moveable.state.target;\r\n    var dragTarget = props.dragTarget;\r\n    targets.push(controlBox);\r\n    if (!dragArea || dragTarget) {\r\n        targets.push(moveableTarget);\r\n    }\r\n    if (!dragArea && dragTarget && target && moveableTarget !== target && props.dragTargetSelf) {\r\n        targets.push(target);\r\n    }\r\n    var checkTarget = checkMoveableTarget(moveable);\r\n    return getAbleGesto(moveable, targets, \"targetAbles\", eventAffix, {\r\n        dragStart: checkTarget,\r\n        pinchStart: checkTarget,\r\n    });\r\n}\r\nfunction getControlAbleGesto(moveable, eventAffix) {\r\n    var controlBox = moveable.controlBox;\r\n    var targets = [];\r\n    targets.push(controlBox);\r\n    var checkTarget = checkMoveableTarget(moveable, true);\r\n    var checkControlTarget = function (e, target) {\r\n        if (target === void 0) { target = e.inputEvent.target; }\r\n        if (target === controlBox) {\r\n            return true;\r\n        }\r\n        var result = checkTarget(e, target);\r\n        return !result;\r\n    };\r\n    return getAbleGesto(moveable, targets, \"controlAbles\", eventAffix, {\r\n        dragStart: checkControlTarget,\r\n        pinchStart: checkControlTarget,\r\n    });\r\n}\r\nfunction getAbleGesto(moveable, target, ableType, eventAffix, conditionFunctions) {\r\n    if (conditionFunctions === void 0) { conditionFunctions = {}; }\r\n    var isTargetAbles = ableType === \"targetAbles\";\r\n    var _a = moveable.props, pinchOutside = _a.pinchOutside, pinchThreshold = _a.pinchThreshold, preventClickEventOnDrag = _a.preventClickEventOnDrag, preventClickDefault = _a.preventClickDefault, checkInput = _a.checkInput, dragFocusedInput = _a.dragFocusedInput, _b = _a.preventDefault, preventDefault = _b === void 0 ? true : _b, _c = _a.preventRightClick, preventRightClick = _c === void 0 ? true : _c, _d = _a.preventWheelClick, preventWheelClick = _d === void 0 ? true : _d, dragContaienrOption = _a.dragContainer;\r\n    var dragContainer = getRefTarget(dragContaienrOption, true);\r\n    var options = {\r\n        preventDefault: preventDefault,\r\n        preventRightClick: preventRightClick,\r\n        preventWheelClick: preventWheelClick,\r\n        container: dragContainer || getWindow(moveable.getControlBoxElement()),\r\n        pinchThreshold: pinchThreshold,\r\n        pinchOutside: pinchOutside,\r\n        preventClickEventOnDrag: isTargetAbles ? preventClickEventOnDrag : false,\r\n        preventClickEventOnDragStart: isTargetAbles ? preventClickDefault : false,\r\n        preventClickEventByCondition: isTargetAbles ? null : function (e) {\r\n            return moveable.controlBox.contains(e.target);\r\n        },\r\n        checkInput: isTargetAbles ? checkInput : false,\r\n        dragFocusedInput: dragFocusedInput,\r\n    };\r\n    var gesto = new Gesto(target, options);\r\n    var isControl = eventAffix === \"Control\";\r\n    [\"drag\", \"pinch\"].forEach(function (eventOperation) {\r\n        [\"Start\", \"\", \"End\"].forEach(function (eventType) {\r\n            gesto.on(\"\".concat(eventOperation).concat(eventType), function (e) {\r\n                var _a;\r\n                var eventName = e.eventType;\r\n                var isPinchScheduled = eventOperation === \"drag\" && e.isPinch;\r\n                if (conditionFunctions[eventName] && !conditionFunctions[eventName](e)) {\r\n                    e.stop();\r\n                    return;\r\n                }\r\n                if (isPinchScheduled) {\r\n                    return;\r\n                }\r\n                var eventOperations = eventOperation === \"drag\" ? [eventOperation] : [\"drag\", eventOperation];\r\n                var moveableAbles = __spreadArray([], __read(moveable[ableType]), false);\r\n                var result = triggerAble(moveable, moveableAbles, eventOperations, eventAffix, eventType, e);\r\n                if (!result) {\r\n                    e.stop();\r\n                }\r\n                else if (moveable.props.stopPropagation || (eventType === \"Start\" && isControl)) {\r\n                    (_a = e === null || e === void 0 ? void 0 : e.inputEvent) === null || _a === void 0 ? void 0 : _a.stopPropagation();\r\n                }\r\n            });\r\n        });\r\n    });\r\n    return gesto;\r\n}\n\nvar EventManager = /*#__PURE__*/ (function () {\r\n    function EventManager(target, moveable, eventName) {\r\n        var _this = this;\r\n        this.target = target;\r\n        this.moveable = moveable;\r\n        this.eventName = eventName;\r\n        this.ables = [];\r\n        this._onEvent = function (e) {\r\n            var eventName = _this.eventName;\r\n            var moveable = _this.moveable;\r\n            if (moveable.state.disableNativeEvent) {\r\n                return;\r\n            }\r\n            _this.ables.forEach(function (able) {\r\n                able[eventName](moveable, {\r\n                    inputEvent: e,\r\n                });\r\n            });\r\n        };\r\n        target.addEventListener(eventName.toLowerCase(), this._onEvent);\r\n    }\r\n    EventManager.prototype.setAbles = function (ables) {\r\n        this.ables = ables;\r\n    };\r\n    EventManager.prototype.destroy = function () {\r\n        this.target.removeEventListener(this.eventName.toLowerCase(), this._onEvent);\r\n        this.target = null;\r\n        this.moveable = null;\r\n    };\r\n    return EventManager;\r\n}());\n\nfunction calculateMatrixStack(target, container, rootContainer, isAbsolute3d) {\r\n    var _a;\r\n    if (rootContainer === void 0) { rootContainer = container; }\r\n    var _b = getMatrixStackInfo(target, container), matrixes = _b.matrixes, is3d = _b.is3d, prevTargetMatrix = _b.targetMatrix, transformOrigin = _b.transformOrigin, targetOrigin = _b.targetOrigin, offsetContainer = _b.offsetContainer, hasFixed = _b.hasFixed, containerZoom = _b.zoom; // prevMatrix\r\n    var _c = getCachedMatrixContainerInfo(offsetContainer, rootContainer), rootMatrixes = _c.matrixes, isRoot3d = _c.is3d, offsetRootContainer = _c.offsetContainer, rootZoom = _c.zoom; // prevRootMatrix\r\n    // if (rootContainer === document.body) {\r\n    //     console.log(offsetContainer, rootContainer, rootMatrixes);\r\n    // }\r\n    var isNext3d = isAbsolute3d || isRoot3d || is3d;\r\n    var n = isNext3d ? 4 : 3;\r\n    var isSVGGraphicElement = target.tagName.toLowerCase() !== \"svg\" && \"ownerSVGElement\" in target;\r\n    var targetMatrix = prevTargetMatrix;\r\n    // let allMatrix = prevMatrix ? convertDimension(prevMatrix, prevN!, n) : createIdentityMatrix(n);\r\n    // let rootMatrix = prevRootMatrix ? convertDimension(prevRootMatrix, prevN!, n) : createIdentityMatrix(n);\r\n    // let beforeMatrix = prevMatrix ? convertDimension(prevMatrix, prevN!, n) : createIdentityMatrix(n);\r\n    var allMatrix = createIdentityMatrix(n);\r\n    var rootMatrix = createIdentityMatrix(n);\r\n    var beforeMatrix = createIdentityMatrix(n);\r\n    var offsetMatrix = createIdentityMatrix(n);\r\n    var length = matrixes.length;\r\n    var nextRootMatrixes = rootMatrixes.map(function (info) {\r\n        return __assign(__assign({}, info), { matrix: info.matrix ? __spreadArray([], __read(info.matrix), false) : undefined });\r\n    }).reverse();\r\n    matrixes.reverse();\r\n    if (!is3d && isNext3d) {\r\n        targetMatrix = convertDimension(targetMatrix, 3, 4);\r\n        convert3DMatrixes(matrixes);\r\n    }\r\n    if (!isRoot3d && isNext3d) {\r\n        convert3DMatrixes(nextRootMatrixes);\r\n    }\r\n    // rootMatrix = (...) -> container -> offset -> absolute -> offset -> absolute(targetMatrix)\r\n    // rootMatrixBeforeOffset = lastOffsetMatrix -> (...) -> container\r\n    // beforeMatrix = (... -> container -> offset -> absolute) -> offset -> absolute(targetMatrix)\r\n    // offsetMatrix = (... -> container -> offset -> absolute -> offset) -> absolute(targetMatrix)\r\n    nextRootMatrixes.forEach(function (info) {\r\n        rootMatrix = multiply(rootMatrix, info.matrix, n);\r\n    });\r\n    var originalRootContainer = rootContainer || getDocumentBody(target);\r\n    var endContainer = ((_a = nextRootMatrixes[0]) === null || _a === void 0 ? void 0 : _a.target)\r\n        || getOffsetInfo(originalRootContainer, originalRootContainer, true).offsetParent;\r\n    var rootMatrixBeforeOffset = nextRootMatrixes.slice(1).reduce(function (matrix, info) {\r\n        return multiply(matrix, info.matrix, n);\r\n    }, createIdentityMatrix(n));\r\n    matrixes.forEach(function (info, i) {\r\n        if (length - 2 === i) {\r\n            // length - 3\r\n            beforeMatrix = allMatrix.slice();\r\n        }\r\n        if (length - 1 === i) {\r\n            // length - 2\r\n            offsetMatrix = allMatrix.slice();\r\n        }\r\n        // calculate for SVGElement\r\n        if (!info.matrix) {\r\n            var nextInfo = matrixes[i + 1];\r\n            var offset = getSVGOffset(info, nextInfo, endContainer, n, multiply(rootMatrixBeforeOffset, allMatrix, n));\r\n            info.matrix = createOriginMatrix(offset, n);\r\n        }\r\n        allMatrix = multiply(allMatrix, info.matrix, n);\r\n    });\r\n    var isMatrix3d = !isSVGGraphicElement && is3d;\r\n    if (!targetMatrix) {\r\n        targetMatrix = createIdentityMatrix(isMatrix3d ? 4 : 3);\r\n    }\r\n    var targetTransform = makeMatrixCSS(isSVGGraphicElement && targetMatrix.length === 16\r\n        ? convertDimension(targetMatrix, 4, 3) : targetMatrix, isMatrix3d);\r\n    var originalRootMatrix = rootMatrix;\r\n    rootMatrix = ignoreDimension(rootMatrix, n, n);\r\n    return {\r\n        hasZoom: containerZoom !== 1 || rootZoom !== 1,\r\n        hasFixed: hasFixed,\r\n        matrixes: matrixes,\r\n        rootMatrix: rootMatrix,\r\n        originalRootMatrix: originalRootMatrix,\r\n        beforeMatrix: beforeMatrix,\r\n        offsetMatrix: offsetMatrix,\r\n        allMatrix: allMatrix,\r\n        targetMatrix: targetMatrix,\r\n        targetTransform: targetTransform,\r\n        inlineTransform: target.style.transform,\r\n        transformOrigin: transformOrigin,\r\n        targetOrigin: targetOrigin,\r\n        is3d: isNext3d,\r\n        offsetContainer: offsetContainer,\r\n        offsetRootContainer: offsetRootContainer,\r\n    };\r\n}\n\nfunction calculateElementInfo(target, container, rootContainer, isAbsolute3d) {\r\n    if (rootContainer === void 0) { rootContainer = container; }\r\n    var width = 0;\r\n    var height = 0;\r\n    var rotation = 0;\r\n    var allResult = {};\r\n    var sizes = getSize(target);\r\n    if (target) {\r\n        width = sizes.offsetWidth;\r\n        height = sizes.offsetHeight;\r\n    }\r\n    if (target) {\r\n        var result = calculateMatrixStack(target, container, rootContainer, isAbsolute3d);\r\n        var position = calculateElementPosition(result.allMatrix, result.transformOrigin, width, height);\r\n        allResult = __assign(__assign({}, result), position);\r\n        var rotationPosition = calculateElementPosition(result.allMatrix, [50, 50], 100, 100);\r\n        rotation = getRotationRad([rotationPosition.pos1, rotationPosition.pos2], rotationPosition.direction);\r\n    }\r\n    var n = isAbsolute3d ? 4 : 3;\r\n    return __assign(__assign(__assign({ hasZoom: false, width: width, height: height, rotation: rotation }, sizes), { originalRootMatrix: createIdentityMatrix(n), rootMatrix: createIdentityMatrix(n), beforeMatrix: createIdentityMatrix(n), offsetMatrix: createIdentityMatrix(n), allMatrix: createIdentityMatrix(n), targetMatrix: createIdentityMatrix(n), targetTransform: \"\", inlineTransform: \"\", transformOrigin: [0, 0], targetOrigin: [0, 0], is3d: !!isAbsolute3d, left: 0, top: 0, right: 0, bottom: 0, origin: [0, 0], pos1: [0, 0], pos2: [0, 0], pos3: [0, 0], pos4: [0, 0], direction: 1, hasFixed: false, offsetContainer: null, offsetRootContainer: null, matrixes: [] }), allResult);\r\n}\r\nfunction getElementInfo(target, container, rootContainer) {\r\n    if (rootContainer === void 0) { rootContainer = container; }\r\n    return calculateElementInfo(target, container, rootContainer, true);\r\n}\n\nfunction getMoveableTargetInfo(moveableElement, target, container, parentContainer, rootContainer, requestStyles) {\r\n    if (requestStyles === void 0) { requestStyles = []; }\r\n    var beforeDirection = 1;\r\n    var beforeOrigin = [0, 0];\r\n    var targetClientRect = resetClientRect();\r\n    var moveableClientRect = resetClientRect();\r\n    var containerClientRect = resetClientRect();\r\n    var rootContainerClientRect = resetClientRect();\r\n    var offsetDelta = [0, 0];\r\n    var style = {};\r\n    var result = calculateElementInfo(target, container, rootContainer, true);\r\n    if (target) {\r\n        var getStyle_1 = getCachedStyle(target);\r\n        requestStyles.forEach(function (name) {\r\n            style[name] = getStyle_1(name);\r\n        });\r\n        var n = result.is3d ? 4 : 3;\r\n        var beforePosition = calculateElementPosition(result.offsetMatrix, plus(result.transformOrigin, getOrigin(result.targetMatrix, n)), result.width, result.height);\r\n        beforeDirection = beforePosition.direction;\r\n        beforeOrigin = plus(beforePosition.origin, [beforePosition.left - result.left, beforePosition.top - result.top]);\r\n        rootContainerClientRect = getClientRect(result.offsetRootContainer);\r\n        var offsetContainer = getOffsetInfo(parentContainer, parentContainer, true).offsetParent\r\n            || result.offsetRootContainer;\r\n        if (result.hasZoom) {\r\n            var absoluteTargetPosition = calculateElementPosition(multiply(result.originalRootMatrix, result.allMatrix), result.transformOrigin, result.width, result.height);\r\n            var absoluteContainerPosition = calculateElementPosition(result.originalRootMatrix, getTransformOriginArray(getCachedStyle(offsetContainer)(\"transformOrigin\")).map(function (pos) { return parseFloat(pos); }), offsetContainer.offsetWidth, offsetContainer.offsetHeight);\r\n            targetClientRect = getClientRectByPosition(absoluteTargetPosition, rootContainerClientRect);\r\n            containerClientRect = getClientRectByPosition(absoluteContainerPosition, rootContainerClientRect, offsetContainer, true);\r\n            if (moveableElement) {\r\n                var left = absoluteTargetPosition.left;\r\n                var top_1 = absoluteTargetPosition.top;\r\n                moveableClientRect = getClientRectByPosition({\r\n                    left: left,\r\n                    top: top_1,\r\n                    bottom: top_1,\r\n                    right: top_1,\r\n                }, rootContainerClientRect);\r\n            }\r\n        }\r\n        else {\r\n            targetClientRect = getClientRect(target);\r\n            containerClientRect = getCachedClientRect(offsetContainer);\r\n            if (moveableElement) {\r\n                moveableClientRect = getClientRect(moveableElement);\r\n            }\r\n            var containerClientRectLeft = containerClientRect.left, containerClientRectTop = containerClientRect.top, containterClientLeft = containerClientRect.clientLeft, containerClientTop = containerClientRect.clientTop;\r\n            var clientDelta = [\r\n                targetClientRect.left - containerClientRectLeft,\r\n                targetClientRect.top - containerClientRectTop,\r\n            ];\r\n            offsetDelta = minus(calculateInversePosition(result.rootMatrix, clientDelta, 4), [containterClientLeft + result.left, containerClientTop + result.top]);\r\n        }\r\n    }\r\n    return __assign({ targetClientRect: targetClientRect, containerClientRect: containerClientRect, moveableClientRect: moveableClientRect, rootContainerClientRect: rootContainerClientRect, beforeDirection: beforeDirection, beforeOrigin: beforeOrigin, originalBeforeOrigin: beforeOrigin, target: target, style: style, offsetDelta: offsetDelta }, result);\r\n}\n\nfunction getPersistState(rect) {\r\n    var pos1 = rect.pos1, pos2 = rect.pos2, pos3 = rect.pos3, pos4 = rect.pos4;\r\n    if (!pos1 || !pos2 || !pos3 || !pos4) {\r\n        return null;\r\n    }\r\n    var minPos = getMinMaxs([pos1, pos2, pos3, pos4]);\r\n    var posDelta = [minPos.minX, minPos.minY];\r\n    var origin = minus(rect.origin, posDelta);\r\n    pos1 = minus(pos1, posDelta);\r\n    pos2 = minus(pos2, posDelta);\r\n    pos3 = minus(pos3, posDelta);\r\n    pos4 = minus(pos4, posDelta);\r\n    return __assign(__assign({}, rect), { left: rect.left, top: rect.top, posDelta: posDelta, pos1: pos1, pos2: pos2, pos3: pos3, pos4: pos4, origin: origin, beforeOrigin: origin, \r\n        // originalBeforeOrigin: origin,\r\n        isPersisted: true });\r\n}\n\nvar MoveableManager = /*#__PURE__*/ (function (_super) {\r\n    __extends(MoveableManager, _super);\r\n    function MoveableManager() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = __assign({ container: null, gestos: {}, renderLines: [\r\n                [[0, 0], [0, 0]],\r\n                [[0, 0], [0, 0]],\r\n                [[0, 0], [0, 0]],\r\n                [[0, 0], [0, 0]],\r\n            ], renderPoses: [[0, 0], [0, 0], [0, 0], [0, 0]], disableNativeEvent: false, posDelta: [0, 0] }, getMoveableTargetInfo(null));\r\n        _this.renderState = {};\r\n        _this.enabledAbles = [];\r\n        _this.targetAbles = [];\r\n        _this.controlAbles = [];\r\n        _this.rotation = 0;\r\n        _this.scale = [1, 1];\r\n        _this.isMoveableMounted = false;\r\n        _this.isUnmounted = false;\r\n        _this.events = {\r\n            \"mouseEnter\": null,\r\n            \"mouseLeave\": null,\r\n        };\r\n        _this._emitter = new EventEmitter();\r\n        _this._prevOriginalDragTarget = null;\r\n        _this._originalDragTarget = null;\r\n        _this._prevDragTarget = null;\r\n        _this._dragTarget = null;\r\n        _this._prevPropTarget = null;\r\n        _this._propTarget = null;\r\n        _this._prevDragArea = false;\r\n        _this._isPropTargetChanged = false;\r\n        _this._hasFirstTarget = false;\r\n        _this._reiszeObserver = null;\r\n        _this._observerId = 0;\r\n        _this._mutationObserver = null;\r\n        _this._rootContainer = null;\r\n        _this._viewContainer = null;\r\n        _this._viewClassNames = [];\r\n        _this._store = {};\r\n        _this.checkUpdateRect = function () {\r\n            if (_this.isDragging()) {\r\n                return;\r\n            }\r\n            var parentMoveable = _this.props.parentMoveable;\r\n            if (parentMoveable) {\r\n                parentMoveable.checkUpdateRect();\r\n                return;\r\n            }\r\n            cancelAnimationFrame(_this._observerId);\r\n            _this._observerId = requestAnimationFrame(function () {\r\n                if (_this.isDragging()) {\r\n                    return;\r\n                }\r\n                _this.updateRect();\r\n            });\r\n        };\r\n        _this._onPreventClick = function (e) {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            // removeEvent(window, \"click\", this._onPreventClick, true);\r\n        };\r\n        return _this;\r\n    }\r\n    MoveableManager.prototype.render = function () {\r\n        var props = this.props;\r\n        var state = this.getState();\r\n        var parentPosition = props.parentPosition, className = props.className, propsTarget = props.target, zoom = props.zoom, cspNonce = props.cspNonce, translateZ = props.translateZ, ControlBoxElement = props.cssStyled, groupable = props.groupable, linePadding = props.linePadding, controlPadding = props.controlPadding;\r\n        this._checkUpdateRootContainer();\r\n        this.checkUpdate();\r\n        this.updateRenderPoses();\r\n        var _a = __read(parentPosition || [0, 0], 2), parentLeft = _a[0], parentTop = _a[1];\r\n        var left = state.left, top = state.top, stateTarget = state.target, direction = state.direction, hasFixed = state.hasFixed, offsetDelta = state.offsetDelta;\r\n        var groupTargets = props.targets;\r\n        var isDragging = this.isDragging();\r\n        var ableAttributes = {};\r\n        this.getEnabledAbles().forEach(function (able) {\r\n            ableAttributes[\"data-able-\".concat(able.name.toLowerCase())] = true;\r\n        });\r\n        var ableClassName = this._getAbleClassName();\r\n        var isDisplay = (groupTargets && groupTargets.length && (stateTarget || groupable))\r\n            || propsTarget\r\n            || (!this._hasFirstTarget && this.state.isPersisted);\r\n        var isVisible = this.controlBox || this.props.firstRenderState || this.props.persistData;\r\n        var translate = [left - parentLeft, top - parentTop];\r\n        if (!groupable && props.useAccuratePosition) {\r\n            translate[0] += offsetDelta[0];\r\n            translate[1] += offsetDelta[1];\r\n        }\r\n        var style = {\r\n            \"position\": hasFixed ? \"fixed\" : \"absolute\",\r\n            \"display\": isDisplay ? \"block\" : \"none\",\r\n            \"visibility\": isVisible ? \"visible\" : \"hidden\",\r\n            \"transform\": \"translate3d(\".concat(translate[0], \"px, \").concat(translate[1], \"px, \").concat(translateZ, \")\"),\r\n            \"--zoom\": zoom,\r\n            \"--zoompx\": \"\".concat(zoom, \"px\"),\r\n        };\r\n        if (linePadding) {\r\n            style[\"--moveable-line-padding\"] = linePadding;\r\n        }\r\n        if (controlPadding) {\r\n            style[\"--moveable-control-padding\"] = controlPadding;\r\n        }\r\n        return (React.createElement(ControlBoxElement, __assign({ cspNonce: cspNonce, ref: ref(this, \"controlBox\"), className: \"\".concat(prefix(\"control-box\", direction === -1 ? \"reverse\" : \"\", isDragging ? \"dragging\" : \"\"), \" \").concat(ableClassName, \" \").concat(className) }, ableAttributes, { onClick: this._onPreventClick, style: style }),\r\n            this.renderAbles(),\r\n            this._renderLines()));\r\n    };\r\n    MoveableManager.prototype.componentDidMount = function () {\r\n        this.isMoveableMounted = true;\r\n        this.isUnmounted = false;\r\n        var props = this.props;\r\n        var parentMoveable = props.parentMoveable, container = props.container;\r\n        this._checkUpdateRootContainer();\r\n        this._checkUpdateViewContainer();\r\n        this._updateTargets();\r\n        this._updateNativeEvents();\r\n        this._updateEvents();\r\n        this.updateCheckInput();\r\n        this._updateObserver(this.props);\r\n        if (!container && !parentMoveable && !this.state.isPersisted) {\r\n            this.updateRect(\"\", false, false);\r\n            this.forceUpdate();\r\n        }\r\n    };\r\n    MoveableManager.prototype.componentDidUpdate = function (prevProps) {\r\n        this._checkUpdateRootContainer();\r\n        this._checkUpdateViewContainer();\r\n        this._updateNativeEvents();\r\n        this._updateTargets();\r\n        this._updateEvents();\r\n        this.updateCheckInput();\r\n        this._updateObserver(prevProps);\r\n    };\r\n    MoveableManager.prototype.componentWillUnmount = function () {\r\n        var _a, _b;\r\n        this.isMoveableMounted = false;\r\n        this.isUnmounted = true;\r\n        this._emitter.off();\r\n        (_a = this._reiszeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\r\n        (_b = this._mutationObserver) === null || _b === void 0 ? void 0 : _b.disconnect();\r\n        var viewContainer = this._viewContainer;\r\n        if (viewContainer) {\r\n            this._changeAbleViewClassNames([]);\r\n        }\r\n        unsetGesto(this, false);\r\n        unsetGesto(this, true);\r\n        var events = this.events;\r\n        for (var name_1 in events) {\r\n            var manager = events[name_1];\r\n            manager && manager.destroy();\r\n        }\r\n    };\r\n    MoveableManager.prototype.getTargets = function () {\r\n        var target = this.props.target;\r\n        return target ? [target] : [];\r\n    };\r\n    /**\r\n     * Get the able used in MoveableManager.\r\n     * @method Moveable#getAble\r\n     * @param - able name\r\n     */\r\n    MoveableManager.prototype.getAble = function (ableName) {\r\n        var ables = this.props.ables || [];\r\n        return find(ables, function (able) { return able.name === ableName; });\r\n    };\r\n    MoveableManager.prototype.getContainer = function () {\r\n        var _a = this.props, parentMoveable = _a.parentMoveable, wrapperMoveable = _a.wrapperMoveable, container = _a.container;\r\n        return container\r\n            || (wrapperMoveable && wrapperMoveable.getContainer())\r\n            || (parentMoveable && parentMoveable.getContainer())\r\n            || this.controlBox.parentElement;\r\n    };\r\n    /**\r\n     * Returns the element of the control box.\r\n     * @method Moveable#getControlBoxElement\r\n     */\r\n    MoveableManager.prototype.getControlBoxElement = function () {\r\n        return this.controlBox;\r\n    };\r\n    /**\r\n     * Target element to be dragged in moveable\r\n     * @method Moveable#getDragElement\r\n     */\r\n    MoveableManager.prototype.getDragElement = function () {\r\n        return this._dragTarget;\r\n    };\r\n    /**\r\n     * Check if the target is an element included in the moveable.\r\n     * @method Moveable#isMoveableElement\r\n     * @param - the target\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * window.addEventListener(\"click\", e => {\r\n     *     if (!moveable.isMoveableElement(e.target)) {\r\n     *         moveable.target = e.target;\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.isMoveableElement = function (target) {\r\n        var _a;\r\n        return target && (((_a = target.getAttribute) === null || _a === void 0 ? void 0 : _a.call(target, \"class\")) || \"\").indexOf(PREFIX) > -1;\r\n    };\r\n    /**\r\n     * You can drag start the Moveable through the external `MouseEvent`or `TouchEvent`. (Angular: ngDragStart)\r\n     * @method Moveable#dragStart\r\n     * @param - external `MouseEvent`or `TouchEvent`\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * document.body.addEventListener(\"mousedown\", e => {\r\n     *     if (!moveable.isMoveableElement(e.target)) {\r\n     *          moveable.dragStart(e);\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.dragStart = function (e, target) {\r\n        if (target === void 0) { target = e.target; }\r\n        var targetGesto = this.targetGesto;\r\n        var controlGesto = this.controlGesto;\r\n        if (targetGesto && checkMoveableTarget(this)({ inputEvent: e }, target)) {\r\n            if (!targetGesto.isFlag()) {\r\n                targetGesto.triggerDragStart(e);\r\n            }\r\n        }\r\n        else if (controlGesto && this.isMoveableElement(target)) {\r\n            if (!controlGesto.isFlag()) {\r\n                controlGesto.triggerDragStart(e);\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * Hit test an element or rect on a moveable target.\r\n     * (100% = 100)\r\n     * @method Moveable#hitTest\r\n     * @param - element or rect to test\r\n     * @return - Get hit test rate (rate > 0 is hitted)\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * document.body.addEventListener(\"mousedown\", e => {\r\n     *     if (moveable.hitTest(e.target) > 0) {\r\n     *          console.log(\"hiited\");\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.hitTest = function (el) {\r\n        var _a = this.state, target = _a.target, pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4, targetClientRect = _a.targetClientRect;\r\n        if (!target) {\r\n            return 0;\r\n        }\r\n        var rect;\r\n        if (isNode(el)) {\r\n            var clientRect = el.getBoundingClientRect();\r\n            rect = {\r\n                left: clientRect.left,\r\n                top: clientRect.top,\r\n                width: clientRect.width,\r\n                height: clientRect.height,\r\n            };\r\n        }\r\n        else {\r\n            rect = __assign({ width: 0, height: 0 }, el);\r\n        }\r\n        var rectLeft = rect.left, rectTop = rect.top, rectWidth = rect.width, rectHeight = rect.height;\r\n        var points = fitPoints([pos1, pos2, pos4, pos3], targetClientRect);\r\n        var size = getOverlapSize(points, [\r\n            [rectLeft, rectTop],\r\n            [rectLeft + rectWidth, rectTop],\r\n            [rectLeft + rectWidth, rectTop + rectHeight],\r\n            [rectLeft, rectTop + rectHeight],\r\n        ]);\r\n        var totalSize = getAreaSize(points);\r\n        if (!size || !totalSize) {\r\n            return 0;\r\n        }\r\n        return Math.min(100, size / totalSize * 100);\r\n    };\r\n    /**\r\n     * Whether the coordinates are inside Moveable\r\n     * @method Moveable#isInside\r\n     * @param - x coordinate\r\n     * @param - y coordinate\r\n     * @return - True if the coordinate is in moveable or false\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * document.body.addEventListener(\"mousedown\", e => {\r\n     *     if (moveable.isInside(e.clientX, e.clientY)) {\r\n     *          console.log(\"inside\");\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.isInside = function (clientX, clientY) {\r\n        var _a = this.state, target = _a.target, pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4, targetClientRect = _a.targetClientRect;\r\n        if (!target) {\r\n            return false;\r\n        }\r\n        return isInside([clientX, clientY], fitPoints([pos1, pos2, pos4, pos3], targetClientRect));\r\n    };\r\n    /**\r\n     * If the width, height, left, and top of all elements change, update the shape of the moveable.\r\n     * @method Moveable#updateRect\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * window.addEventListener(\"resize\", e => {\r\n     *     moveable.updateRect();\r\n     * });\r\n     */\r\n    MoveableManager.prototype.updateRect = function (type, isTarget, isSetState) {\r\n        if (isSetState === void 0) { isSetState = true; }\r\n        var props = this.props;\r\n        var isSingle = !props.parentPosition && !props.wrapperMoveable;\r\n        if (isSingle) {\r\n            setStoreCache(true);\r\n        }\r\n        var parentMoveable = props.parentMoveable;\r\n        var state = this.state;\r\n        var target = (state.target || props.target);\r\n        var container = this.getContainer();\r\n        var rootContainer = parentMoveable\r\n            ? parentMoveable._rootContainer\r\n            : this._rootContainer;\r\n        var nextState = getMoveableTargetInfo(this.controlBox, target, container, container, rootContainer || container, this._getRequestStyles());\r\n        if (!target && this._hasFirstTarget && props.persistData) {\r\n            var persistState = getPersistState(props.persistData);\r\n            for (var name_2 in persistState) {\r\n                nextState[name_2] = persistState[name_2];\r\n            }\r\n        }\r\n        if (isSingle) {\r\n            setStoreCache();\r\n        }\r\n        this.updateState(nextState, parentMoveable ? false : isSetState);\r\n    };\r\n    /**\r\n     * Check if the moveable state is being dragged.\r\n     * @method Moveable#isDragging\r\n     * @param - If you want to check if able is dragging, specify ableName.\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * // false\r\n     * console.log(moveable.isDragging());\r\n     *\r\n     * moveable.on(\"drag\", () => {\r\n     *   // true\r\n     *   console.log(moveable.isDragging());\r\n     * });\r\n     */\r\n    MoveableManager.prototype.isDragging = function (ableName) {\r\n        var _a, _b;\r\n        var targetGesto = this.targetGesto;\r\n        var controlGesto = this.controlGesto;\r\n        if (targetGesto === null || targetGesto === void 0 ? void 0 : targetGesto.isFlag()) {\r\n            if (!ableName) {\r\n                return true;\r\n            }\r\n            var data = targetGesto.getEventData();\r\n            return !!((_a = data[ableName]) === null || _a === void 0 ? void 0 : _a.isEventStart);\r\n        }\r\n        if (controlGesto === null || controlGesto === void 0 ? void 0 : controlGesto.isFlag()) {\r\n            if (!ableName) {\r\n                return true;\r\n            }\r\n            var data = controlGesto.getEventData();\r\n            return !!((_b = data[ableName]) === null || _b === void 0 ? void 0 : _b.isEventStart);\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * If the width, height, left, and top of the only target change, update the shape of the moveable.\r\n     * Use `.updateRect()` method\r\n     * @method Moveable#updateTarget\r\n     * @deprecated\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * moveable.updateTarget();\r\n     */\r\n    MoveableManager.prototype.updateTarget = function (type) {\r\n        this.updateRect(type, true);\r\n    };\r\n    /**\r\n     * You can get the vertex information, position and offset size information of the target based on the container.\r\n     * @method Moveable#getRect\r\n     * @return - The Rect Info\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * const rectInfo = moveable.getRect();\r\n     */\r\n    MoveableManager.prototype.getRect = function () {\r\n        var state = this.state;\r\n        var poses = getAbsolutePosesByState(this.state);\r\n        var _a = __read(poses, 4), pos1 = _a[0], pos2 = _a[1], pos3 = _a[2], pos4 = _a[3];\r\n        var rect = getRect(poses);\r\n        var offsetWidth = state.width, offsetHeight = state.height;\r\n        var width = rect.width, height = rect.height, left = rect.left, top = rect.top;\r\n        var statePos = [state.left, state.top];\r\n        var origin = plus(statePos, state.origin);\r\n        var beforeOrigin = plus(statePos, state.beforeOrigin);\r\n        var transformOrigin = state.transformOrigin;\r\n        return {\r\n            width: width,\r\n            height: height,\r\n            left: left,\r\n            top: top,\r\n            pos1: pos1,\r\n            pos2: pos2,\r\n            pos3: pos3,\r\n            pos4: pos4,\r\n            offsetWidth: offsetWidth,\r\n            offsetHeight: offsetHeight,\r\n            beforeOrigin: beforeOrigin,\r\n            origin: origin,\r\n            transformOrigin: transformOrigin,\r\n            rotation: this.getRotation(),\r\n        };\r\n    };\r\n    /**\r\n     * Get a manager that manages the moveable's state and props.\r\n     * @method Moveable#getManager\r\n     * @return - The Rect Info\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * const manager = moveable.getManager(); // real moveable class instance\r\n     */\r\n    MoveableManager.prototype.getManager = function () {\r\n        return this;\r\n    };\r\n    /**\r\n     * You can stop the dragging currently in progress through a method from outside.\r\n     * @method Moveable#stopDrag\r\n     * @return - The Rect Info\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * moveable.stopDrag();\r\n     */\r\n    MoveableManager.prototype.stopDrag = function (type) {\r\n        if (!type || type === \"target\") {\r\n            var gesto = this.targetGesto;\r\n            if ((gesto === null || gesto === void 0 ? void 0 : gesto.isIdle()) === false) {\r\n                unsetAbles(this, false);\r\n            }\r\n            gesto === null || gesto === void 0 ? void 0 : gesto.stop();\r\n        }\r\n        if (!type || type === \"control\") {\r\n            var gesto = this.controlGesto;\r\n            if ((gesto === null || gesto === void 0 ? void 0 : gesto.isIdle()) === false) {\r\n                unsetAbles(this, true);\r\n            }\r\n            gesto === null || gesto === void 0 ? void 0 : gesto.stop();\r\n        }\r\n    };\r\n    MoveableManager.prototype.getRotation = function () {\r\n        var _a = this.state, pos1 = _a.pos1, pos2 = _a.pos2, direction = _a.direction;\r\n        return getAbsoluteRotation(pos1, pos2, direction);\r\n    };\r\n    /**\r\n     * Request able through a method rather than an event.\r\n     * At the moment of execution, requestStart is executed,\r\n     * and then request and requestEnd can be executed through Requester.\r\n     * @method Moveable#request\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Draggable.html#request|Draggable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Resizable.html#request|Resizable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Scalable.html#request|Scalable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Rotatable.html#request|Rotatable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.OriginDraggable.html#request|OriginDraggable Requester}\r\n     * @param - ableName\r\n     * @param - request to be able params.\r\n     * @param - If isInstant is true, request and requestEnd are executed immediately.\r\n     * @return - Able Requester. If there is no request in able, nothing will work.\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * moveable.request(\"draggable\", { deltaX: 10, deltaY: 10 }, true);\r\n     *\r\n     * // Start move\r\n     * const requester = moveable.request(\"draggable\");\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.requestEnd();\r\n     */\r\n    MoveableManager.prototype.request = function (ableName, param, isInstant) {\r\n        if (param === void 0) { param = {}; }\r\n        var self = this;\r\n        var props = self.props;\r\n        var manager = props.parentMoveable || props.wrapperMoveable || self;\r\n        var allAbles = manager.props.ables;\r\n        var groupable = props.groupable;\r\n        var requsetAble = find(allAbles, function (able) { return able.name === ableName; });\r\n        if (this.isDragging() || !requsetAble || !requsetAble.request) {\r\n            return {\r\n                request: function () {\r\n                    return this;\r\n                },\r\n                requestEnd: function () {\r\n                    return this;\r\n                },\r\n            };\r\n        }\r\n        var ableRequester = requsetAble.request(self);\r\n        var requestInstant = isInstant || param.isInstant;\r\n        var ableType = ableRequester.isControl ? \"controlAbles\" : \"targetAbles\";\r\n        var eventAffix = \"\".concat((groupable ? \"Group\" : \"\")).concat(ableRequester.isControl ? \"Control\" : \"\");\r\n        var moveableAbles = __spreadArray([], __read(manager[ableType]), false);\r\n        var requester = {\r\n            request: function (ableParam) {\r\n                triggerAble(self, moveableAbles, [\"drag\"], eventAffix, \"\", __assign(__assign({}, ableRequester.request(ableParam)), { requestAble: ableName, isRequest: true }), requestInstant);\r\n                return requester;\r\n            },\r\n            requestEnd: function () {\r\n                triggerAble(self, moveableAbles, [\"drag\"], eventAffix, \"End\", __assign(__assign({}, ableRequester.requestEnd()), { requestAble: ableName, isRequest: true }), requestInstant);\r\n                return requester;\r\n            },\r\n        };\r\n        triggerAble(self, moveableAbles, [\"drag\"], eventAffix, \"Start\", __assign(__assign({}, ableRequester.requestStart(param)), { requestAble: ableName, isRequest: true }), requestInstant);\r\n        return requestInstant ? requester.request(param).requestEnd() : requester;\r\n    };\r\n    /**\r\n     * moveable is the top level that manages targets\r\n     * `Single`: MoveableManager instance\r\n     * `Group`: MoveableGroup instance\r\n     * `IndividualGroup`: MoveableIndividaulGroup instance\r\n     * Returns leaf target MoveableManagers.\r\n     */\r\n    MoveableManager.prototype.getMoveables = function () {\r\n        return [this];\r\n    };\r\n    /**\r\n     * Remove the Moveable object and the events.\r\n     * @method Moveable#destroy\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * moveable.destroy();\r\n     */\r\n    MoveableManager.prototype.destroy = function () {\r\n        this.componentWillUnmount();\r\n    };\r\n    MoveableManager.prototype.updateRenderPoses = function () {\r\n        var state = this.getState();\r\n        var props = this.props;\r\n        var padding = props.padding;\r\n        var originalBeforeOrigin = state.originalBeforeOrigin, transformOrigin = state.transformOrigin, allMatrix = state.allMatrix, is3d = state.is3d, pos1 = state.pos1, pos2 = state.pos2, pos3 = state.pos3, pos4 = state.pos4, stateLeft = state.left, stateTop = state.top, isPersisted = state.isPersisted;\r\n        var zoom = props.zoom || 1;\r\n        if (!padding && zoom <= 1) {\r\n            state.renderPoses = [\r\n                pos1,\r\n                pos2,\r\n                pos3,\r\n                pos4,\r\n            ];\r\n            state.renderLines = [\r\n                [pos1, pos2],\r\n                [pos2, pos4],\r\n                [pos4, pos3],\r\n                [pos3, pos1],\r\n            ];\r\n            return;\r\n        }\r\n        var _a = getPaddingBox(padding || {}), left = _a.left, top = _a.top, bottom = _a.bottom, right = _a.right;\r\n        var n = is3d ? 4 : 3;\r\n        // const clipPathInfo = getClipPath(\r\n        //     props.target,\r\n        //     offsetWidth,\r\n        //     offsetHeight,\r\n        // );\r\n        // if (clipPathInfo) {\r\n        //     left -= Math.max(0, clipPathInfo.left);\r\n        //     top -= Math.max(0, clipPathInfo.top);\r\n        //     bottom -= Math.max(0, offsetHeight - clipPathInfo.bottom);\r\n        //     right -= Math.max(0, offsetWidth - clipPathInfo.right);\r\n        // }\r\n        var absoluteOrigin = [];\r\n        if (isPersisted) {\r\n            absoluteOrigin = transformOrigin;\r\n        }\r\n        else if (this.controlBox && props.groupable) {\r\n            absoluteOrigin = originalBeforeOrigin;\r\n        }\r\n        else {\r\n            absoluteOrigin = plus(originalBeforeOrigin, [stateLeft, stateTop]);\r\n        }\r\n        var nextMatrix = multiplies(n, createOriginMatrix(absoluteOrigin.map(function (v) { return -v; }), n), allMatrix, createOriginMatrix(transformOrigin, n));\r\n        var renderPos1 = calculatePadding(nextMatrix, pos1, [-left, -top], n);\r\n        var renderPos2 = calculatePadding(nextMatrix, pos2, [right, -top], n);\r\n        var renderPos3 = calculatePadding(nextMatrix, pos3, [-left, bottom], n);\r\n        var renderPos4 = calculatePadding(nextMatrix, pos4, [right, bottom], n);\r\n        state.renderPoses = [\r\n            renderPos1,\r\n            renderPos2,\r\n            renderPos3,\r\n            renderPos4,\r\n        ];\r\n        state.renderLines = [\r\n            [renderPos1, renderPos2],\r\n            [renderPos2, renderPos4],\r\n            [renderPos4, renderPos3],\r\n            [renderPos3, renderPos1],\r\n        ];\r\n        if (zoom) {\r\n            var zoomOffset = zoom / 2;\r\n            state.renderLines = [\r\n                [\r\n                    calculatePadding(nextMatrix, pos1, [-left - zoomOffset, -top], n),\r\n                    calculatePadding(nextMatrix, pos2, [right + zoomOffset, -top], n),\r\n                ],\r\n                [\r\n                    calculatePadding(nextMatrix, pos2, [right, -top - zoomOffset], n),\r\n                    calculatePadding(nextMatrix, pos4, [right, bottom + zoomOffset], n),\r\n                ],\r\n                [\r\n                    calculatePadding(nextMatrix, pos4, [right + zoomOffset, bottom], n),\r\n                    calculatePadding(nextMatrix, pos3, [-left - zoomOffset, bottom], n),\r\n                ],\r\n                [\r\n                    calculatePadding(nextMatrix, pos3, [-left, bottom + zoomOffset], n),\r\n                    calculatePadding(nextMatrix, pos1, [-left, -top - zoomOffset], n),\r\n                ],\r\n            ];\r\n        }\r\n    };\r\n    MoveableManager.prototype.checkUpdate = function () {\r\n        this._isPropTargetChanged = false;\r\n        var _a = this.props, target = _a.target, container = _a.container, parentMoveable = _a.parentMoveable;\r\n        var _b = this.state, stateTarget = _b.target, stateContainer = _b.container;\r\n        if (!stateTarget && !target) {\r\n            return;\r\n        }\r\n        this.updateAbles();\r\n        var isTargetChanged = !equals(stateTarget, target);\r\n        var isChanged = isTargetChanged || !equals(stateContainer, container);\r\n        if (!isChanged) {\r\n            return;\r\n        }\r\n        var moveableContainer = container || this.controlBox;\r\n        if (moveableContainer) {\r\n            this.unsetAbles();\r\n        }\r\n        this.updateState({ target: target, container: container });\r\n        if (!parentMoveable && moveableContainer) {\r\n            this.updateRect(\"End\", false, false);\r\n        }\r\n        this._isPropTargetChanged = isTargetChanged;\r\n    };\r\n    MoveableManager.prototype.waitToChangeTarget = function () {\r\n        return new Promise(function () { });\r\n    };\r\n    MoveableManager.prototype.triggerEvent = function (name, e) {\r\n        var props = this.props;\r\n        this._emitter.trigger(name, e);\r\n        if (props.parentMoveable && e.isRequest && !e.isRequestChild) {\r\n            return props.parentMoveable.triggerEvent(name, e, true);\r\n        }\r\n        var callback = props[name];\r\n        return callback && callback(e);\r\n    };\r\n    MoveableManager.prototype.useCSS = function (tag, css) {\r\n        var customStyleMap = this.props.customStyledMap;\r\n        var key = tag + css;\r\n        if (!customStyleMap[key]) {\r\n            customStyleMap[key] = styled(tag, css);\r\n        }\r\n        return customStyleMap[key];\r\n    };\r\n    MoveableManager.prototype.getState = function () {\r\n        var _a;\r\n        var props = this.props;\r\n        if (props.target || ((_a = props.targets) === null || _a === void 0 ? void 0 : _a.length)) {\r\n            this._hasFirstTarget = true;\r\n        }\r\n        var hasControlBox = this.controlBox;\r\n        var persistData = props.persistData;\r\n        var firstRenderState = props.firstRenderState;\r\n        if (firstRenderState && !hasControlBox) {\r\n            return firstRenderState;\r\n        }\r\n        if (!this._hasFirstTarget && persistData) {\r\n            var persistState = getPersistState(persistData);\r\n            if (persistState) {\r\n                this.updateState(persistState, false);\r\n                return this.state;\r\n            }\r\n        }\r\n        this.state.isPersisted = false;\r\n        return this.state;\r\n    };\r\n    MoveableManager.prototype.updateSelectors = function () { };\r\n    MoveableManager.prototype.unsetAbles = function () {\r\n        var _this = this;\r\n        this.targetAbles.forEach(function (able) {\r\n            if (able.unset) {\r\n                able.unset(_this);\r\n            }\r\n        });\r\n    };\r\n    MoveableManager.prototype.updateAbles = function (ables, eventAffix) {\r\n        if (ables === void 0) { ables = this.props.ables; }\r\n        if (eventAffix === void 0) { eventAffix = \"\"; }\r\n        var props = this.props;\r\n        var triggerAblesSimultaneously = props.triggerAblesSimultaneously;\r\n        var enabledAbles = this.getEnabledAbles(ables);\r\n        var dragStart = \"drag\".concat(eventAffix, \"Start\");\r\n        var pinchStart = \"pinch\".concat(eventAffix, \"Start\");\r\n        var dragControlStart = \"drag\".concat(eventAffix, \"ControlStart\");\r\n        var targetAbles = filterAbles(enabledAbles, [dragStart, pinchStart], triggerAblesSimultaneously);\r\n        var controlAbles = filterAbles(enabledAbles, [dragControlStart], triggerAblesSimultaneously);\r\n        this.enabledAbles = enabledAbles;\r\n        this.targetAbles = targetAbles;\r\n        this.controlAbles = controlAbles;\r\n    };\r\n    MoveableManager.prototype.updateState = function (nextState, isSetState) {\r\n        if (isSetState) {\r\n            if (this.isUnmounted) {\r\n                return;\r\n            }\r\n            this.setState(nextState);\r\n        }\r\n        else {\r\n            var state = this.state;\r\n            for (var name_3 in nextState) {\r\n                state[name_3] = nextState[name_3];\r\n            }\r\n        }\r\n    };\r\n    MoveableManager.prototype.getEnabledAbles = function (ables) {\r\n        if (ables === void 0) { ables = this.props.ables; }\r\n        var props = this.props;\r\n        return ables.filter(function (able) { return able && ((able.always && props[able.name] !== false)\r\n            || props[able.name]); });\r\n    };\r\n    MoveableManager.prototype.renderAbles = function () {\r\n        var _this = this;\r\n        var props = this.props;\r\n        var triggerAblesSimultaneously = props.triggerAblesSimultaneously;\r\n        var Renderer = {\r\n            createElement: createElement,\r\n        };\r\n        this.renderState = {};\r\n        return groupByMap(flat(filterAbles(this.getEnabledAbles(), [\"render\"], triggerAblesSimultaneously).map(function (_a) {\r\n            var render = _a.render;\r\n            return render(_this, Renderer) || [];\r\n        })).filter(function (el) { return el; }), function (_a) {\r\n            var key = _a.key;\r\n            return key;\r\n        }).map(function (group) { return group[0]; });\r\n    };\r\n    MoveableManager.prototype.updateCheckInput = function () {\r\n        this.targetGesto && (this.targetGesto.options.checkInput = this.props.checkInput);\r\n    };\r\n    MoveableManager.prototype._getRequestStyles = function () {\r\n        var styleNames = this.getEnabledAbles().reduce(function (names, able) {\r\n            var _a, _b;\r\n            var ableStyleNames = ((_b = (_a = able.requestStyle) === null || _a === void 0 ? void 0 : _a.call(able)) !== null && _b !== void 0 ? _b : []);\r\n            return __spreadArray(__spreadArray([], __read(names), false), __read(ableStyleNames), false);\r\n        }, __spreadArray([], __read((this.props.requestStyles || [])), false));\r\n        return styleNames;\r\n    };\r\n    MoveableManager.prototype._updateObserver = function (prevProps) {\r\n        this._updateResizeObserver(prevProps);\r\n        this._updateMutationObserver(prevProps);\r\n    };\r\n    MoveableManager.prototype._updateEvents = function () {\r\n        var hasTargetAble = this.targetAbles.length;\r\n        var hasControlAble = this.controlAbles.length;\r\n        var target = this._dragTarget;\r\n        var isUnset = (!hasTargetAble && this.targetGesto)\r\n            || this._isTargetChanged(true);\r\n        if (isUnset) {\r\n            unsetGesto(this, false);\r\n            this.updateState({ gestos: {} });\r\n        }\r\n        if (!hasControlAble) {\r\n            unsetGesto(this, true);\r\n        }\r\n        if (target && hasTargetAble && !this.targetGesto) {\r\n            this.targetGesto = getTargetAbleGesto(this, target, \"\");\r\n        }\r\n        if (!this.controlGesto && hasControlAble) {\r\n            this.controlGesto = getControlAbleGesto(this, \"Control\");\r\n        }\r\n    };\r\n    MoveableManager.prototype._updateTargets = function () {\r\n        var props = this.props;\r\n        this._prevPropTarget = this._propTarget;\r\n        this._prevDragTarget = this._dragTarget;\r\n        this._prevOriginalDragTarget = this._originalDragTarget;\r\n        this._prevDragArea = props.dragArea;\r\n        this._propTarget = props.target;\r\n        this._originalDragTarget = props.dragTarget || props.target;\r\n        this._dragTarget = getRefTarget(this._originalDragTarget, true);\r\n    };\r\n    MoveableManager.prototype._renderLines = function () {\r\n        var props = this.props;\r\n        var _a = props, zoom = _a.zoom, hideDefaultLines = _a.hideDefaultLines, hideChildMoveableDefaultLines = _a.hideChildMoveableDefaultLines, parentMoveable = _a.parentMoveable;\r\n        if (hideDefaultLines || (parentMoveable && hideChildMoveableDefaultLines)) {\r\n            return [];\r\n        }\r\n        var state = this.getState();\r\n        var Renderer = {\r\n            createElement: createElement,\r\n        };\r\n        return state.renderLines.map(function (line, i) {\r\n            return renderLine(Renderer, \"\", line[0], line[1], zoom, \"render-line-\".concat(i));\r\n        });\r\n    };\r\n    MoveableManager.prototype._isTargetChanged = function (useDragArea) {\r\n        var props = this.props;\r\n        var nextTarget = props.dragTarget || props.target;\r\n        var prevTarget = this._prevOriginalDragTarget;\r\n        var prevDragArea = this._prevDragArea;\r\n        var dragArea = props.dragArea;\r\n        // check target without dragArea\r\n        var isDragTargetChanged = !dragArea && prevTarget !== nextTarget;\r\n        var isDragAreaChanged = (useDragArea || dragArea) && prevDragArea !== dragArea;\r\n        return isDragTargetChanged || isDragAreaChanged || this._prevPropTarget != this._propTarget;\r\n    };\r\n    MoveableManager.prototype._updateNativeEvents = function () {\r\n        var _this = this;\r\n        var props = this.props;\r\n        var target = props.dragArea ? this.areaElement : this.state.target;\r\n        var events = this.events;\r\n        var eventKeys = getKeys(events);\r\n        if (this._isTargetChanged()) {\r\n            for (var eventName in events) {\r\n                var manager = events[eventName];\r\n                manager && manager.destroy();\r\n                events[eventName] = null;\r\n            }\r\n        }\r\n        if (!target) {\r\n            return;\r\n        }\r\n        var enabledAbles = this.enabledAbles;\r\n        eventKeys.forEach(function (eventName) {\r\n            var ables = filterAbles(enabledAbles, [eventName]);\r\n            var hasAbles = ables.length > 0;\r\n            var manager = events[eventName];\r\n            if (!hasAbles) {\r\n                if (manager) {\r\n                    manager.destroy();\r\n                    events[eventName] = null;\r\n                }\r\n                return;\r\n            }\r\n            if (!manager) {\r\n                manager = new EventManager(target, _this, eventName);\r\n                events[eventName] = manager;\r\n            }\r\n            manager.setAbles(ables);\r\n        });\r\n    };\r\n    MoveableManager.prototype._checkUpdateRootContainer = function () {\r\n        var rootContainer = this.props.rootContainer;\r\n        if (!this._rootContainer && rootContainer) {\r\n            this._rootContainer = getRefTarget(rootContainer, true);\r\n        }\r\n    };\r\n    MoveableManager.prototype._checkUpdateViewContainer = function () {\r\n        var viewContainerOption = this.props.viewContainer;\r\n        if (!this._viewContainer && viewContainerOption) {\r\n            this._viewContainer = getRefTarget(viewContainerOption, true);\r\n        }\r\n        var viewContainer = this._viewContainer;\r\n        if (viewContainer) {\r\n            this._changeAbleViewClassNames(__spreadArray(__spreadArray([], __read(this._getAbleViewClassNames()), false), [\r\n                this.isDragging() ? VIEW_DRAGGING : \"\",\r\n            ], false));\r\n        }\r\n    };\r\n    MoveableManager.prototype._changeAbleViewClassNames = function (classNames) {\r\n        var viewContainer = this._viewContainer;\r\n        var nextClassNames = groupBy(classNames.filter(Boolean), function (el) { return el; }).map(function (_a) {\r\n            var _b = __read(_a, 1), className = _b[0];\r\n            return className;\r\n        });\r\n        var prevClassNames = this._viewClassNames;\r\n        var _a = diff$1(prevClassNames, nextClassNames), removed = _a.removed, added = _a.added;\r\n        removed.forEach(function (index) {\r\n            removeClass(viewContainer, prevClassNames[index]);\r\n        });\r\n        added.forEach(function (index) {\r\n            addClass(viewContainer, nextClassNames[index]);\r\n        });\r\n        this._viewClassNames = nextClassNames;\r\n    };\r\n    MoveableManager.prototype._getAbleViewClassNames = function () {\r\n        var _this = this;\r\n        return (this.getEnabledAbles().map(function (able) {\r\n            var _a;\r\n            return (((_a = able.viewClassName) === null || _a === void 0 ? void 0 : _a.call(able, _this)) || \"\");\r\n        }).join(\" \") + \" \".concat(this._getAbleClassName(\"-view\"))).split(/\\s+/g);\r\n    };\r\n    MoveableManager.prototype._getAbleClassName = function (classPrefix) {\r\n        var _this = this;\r\n        if (classPrefix === void 0) { classPrefix = \"\"; }\r\n        var ables = this.getEnabledAbles();\r\n        var targetGesto = this.targetGesto;\r\n        var controlGesto = this.controlGesto;\r\n        var targetGestoData = (targetGesto === null || targetGesto === void 0 ? void 0 : targetGesto.isFlag())\r\n            ? targetGesto.getEventData() : {};\r\n        var controlGestoData = (controlGesto === null || controlGesto === void 0 ? void 0 : controlGesto.isFlag())\r\n            ? controlGesto.getEventData() : {};\r\n        return ables.map(function (able) {\r\n            var _a, _b, _c;\r\n            var name = able.name;\r\n            var className = ((_a = able.className) === null || _a === void 0 ? void 0 : _a.call(able, _this)) || \"\";\r\n            if (((_b = targetGestoData[name]) === null || _b === void 0 ? void 0 : _b.isEventStart)\r\n                || ((_c = controlGestoData[name]) === null || _c === void 0 ? void 0 : _c.isEventStart)) {\r\n                className += \" \".concat(prefix(\"\".concat(name).concat(classPrefix, \"-dragging\")));\r\n            }\r\n            return className.trim();\r\n        }).filter(Boolean).join(\" \");\r\n    };\r\n    MoveableManager.prototype._updateResizeObserver = function (prevProps) {\r\n        var _a;\r\n        var props = this.props;\r\n        var target = props.target;\r\n        var win = getWindow(this.getControlBoxElement());\r\n        if (!win.ResizeObserver || !target || !props.useResizeObserver) {\r\n            (_a = this._reiszeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\r\n            return;\r\n        }\r\n        if (prevProps.target === target && this._reiszeObserver) {\r\n            return;\r\n        }\r\n        var observer = new win.ResizeObserver(this.checkUpdateRect);\r\n        observer.observe(target, {\r\n            box: \"border-box\",\r\n        });\r\n        this._reiszeObserver = observer;\r\n    };\r\n    MoveableManager.prototype._updateMutationObserver = function (prevProps) {\r\n        var _this = this;\r\n        var _a;\r\n        var props = this.props;\r\n        var target = props.target;\r\n        var win = getWindow(this.getControlBoxElement());\r\n        if (!win.MutationObserver || !target || !props.useMutationObserver) {\r\n            (_a = this._mutationObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\r\n            return;\r\n        }\r\n        if (prevProps.target === target && this._mutationObserver) {\r\n            return;\r\n        }\r\n        var observer = new win.MutationObserver(function (records) {\r\n            var e_1, _a;\r\n            try {\r\n                for (var records_1 = __values(records), records_1_1 = records_1.next(); !records_1_1.done; records_1_1 = records_1.next()) {\r\n                    var mutation = records_1_1.value;\r\n                    if (mutation.type === \"attributes\" && mutation.attributeName === \"style\") {\r\n                        _this.checkUpdateRect();\r\n                    }\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (records_1_1 && !records_1_1.done && (_a = records_1.return)) _a.call(records_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n        });\r\n        observer.observe(target, {\r\n            attributes: true,\r\n        });\r\n        this._mutationObserver = observer;\r\n    };\r\n    MoveableManager.defaultProps = {\r\n        dragTargetSelf: false,\r\n        target: null,\r\n        dragTarget: null,\r\n        container: null,\r\n        rootContainer: null,\r\n        origin: true,\r\n        parentMoveable: null,\r\n        wrapperMoveable: null,\r\n        isWrapperMounted: false,\r\n        parentPosition: null,\r\n        warpSelf: false,\r\n        svgOrigin: \"\",\r\n        dragContainer: null,\r\n        useResizeObserver: false,\r\n        useMutationObserver: false,\r\n        preventDefault: true,\r\n        preventRightClick: true,\r\n        preventWheelClick: true,\r\n        linePadding: 0,\r\n        controlPadding: 0,\r\n        ables: [],\r\n        pinchThreshold: 20,\r\n        dragArea: false,\r\n        passDragArea: false,\r\n        transformOrigin: \"\",\r\n        className: \"\",\r\n        zoom: 1,\r\n        triggerAblesSimultaneously: false,\r\n        padding: {},\r\n        pinchOutside: true,\r\n        checkInput: false,\r\n        dragFocusedInput: false,\r\n        groupable: false,\r\n        hideDefaultLines: false,\r\n        cspNonce: \"\",\r\n        translateZ: 0,\r\n        cssStyled: null,\r\n        customStyledMap: {},\r\n        props: {},\r\n        stopPropagation: false,\r\n        preventClickDefault: false,\r\n        preventClickEventOnDrag: true,\r\n        flushSync: defaultSync,\r\n        firstRenderState: null,\r\n        persistData: null,\r\n        viewContainer: null,\r\n        requestStyles: [],\r\n        useAccuratePosition: false,\r\n    };\r\n    return MoveableManager;\r\n}(React.PureComponent));\r\n/**\r\n * The target to indicate Moveable Control Box.\r\n * @name Moveable#target\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.target = document.querySelector(\".target\");\r\n */\r\n/**\r\n * Zooms in the elements of a moveable.\r\n * @name Moveable#zoom\r\n * @default 1\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.zoom = 2;\r\n */\r\n/**\r\n * Whether the target size is detected and updated whenever it changes.\r\n * @name Moveable#useResizeObserver\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.useResizeObserver = true;\r\n */\r\n/**\r\n * Resize, Scale Events at edges\r\n * @name Moveable#edge\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.edge = true;\r\n */\r\n/**\r\n * You can specify the className of the moveable controlbox.\r\n * @name Moveable#className\r\n * @default \"\"\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   className: \"\",\r\n * });\r\n *\r\n * moveable.className = \"moveable1\";\r\n */\r\n/**\r\n * The target(s) to drag Moveable target(s)\r\n * @name Moveable#dragTarget\r\n * @default target\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.target = document.querySelector(\".target\");\r\n * moveable.dragTarget = document.querySelector(\".dragTarget\");\r\n */\r\n/**\r\n * `renderStart` event occurs at the first start of all events.\r\n * @memberof Moveable\r\n * @event renderStart\r\n * @param {Moveable.OnRenderStart} - Parameters for the `renderStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"renderStart\", ({ target }) => {\r\n *     console.log(\"onRenderStart\", target);\r\n * });\r\n */\r\n/**\r\n * `render` event occurs before the target is drawn on the screen.\r\n * @memberof Moveable\r\n * @event render\r\n * @param {Moveable.OnRender} - Parameters for the `render` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"render\", ({ target }) => {\r\n *     console.log(\"onRender\", target);\r\n * });\r\n */\r\n/**\r\n * `renderEnd` event occurs at the end of all events.\r\n * @memberof Moveable\r\n * @event renderEnd\r\n * @param {Moveable.OnRenderEnd} - Parameters for the `renderEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"renderEnd\", ({ target }) => {\r\n *     console.log(\"onRenderEnd\", target);\r\n * });\r\n */\r\n/**\r\n * `renderGroupStart` event occurs at the first start of all events in group.\r\n * @memberof Moveable\r\n * @event renderGroupStart\r\n * @param {Moveable.OnRenderGroupStart} - Parameters for the `renderGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"renderGroupStart\", ({ targets }) => {\r\n *     console.log(\"onRenderGroupStart\", targets);\r\n * });\r\n */\r\n/**\r\n * `renderGroup` event occurs before the target is drawn on the screen in group.\r\n * @memberof Moveable\r\n * @event renderGroup\r\n * @param {Moveable.OnRenderGroup} - Parameters for the `renderGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"renderGroup\", ({ targets }) => {\r\n *     console.log(\"onRenderGroup\", targets);\r\n * });\r\n */\r\n/**\r\n * `renderGroupEnd` event occurs at the end of all events in group.\r\n * @memberof Moveable\r\n * @event renderGroupEnd\r\n * @param {Moveable.OnRenderGroupEnd} - Parameters for the `renderGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"renderGroupEnd\", ({ targets }) => {\r\n *     console.log(\"onRenderGroupEnd\", targets);\r\n * });\r\n */\n\nvar Groupable = {\r\n    name: \"groupable\",\r\n    props: [\r\n        \"defaultGroupRotate\",\r\n        \"useDefaultGroupRotate\",\r\n        \"defaultGroupOrigin\",\r\n        \"groupable\",\r\n        \"groupableProps\",\r\n        \"targetGroups\",\r\n        \"hideChildMoveableDefaultLines\",\r\n    ],\r\n    events: [],\r\n    render: function (moveable, React) {\r\n        var _a;\r\n        var props = moveable.props;\r\n        var targets = props.targets || [];\r\n        var _b = moveable.getState(), left = _b.left, top = _b.top, isPersisted = _b.isPersisted;\r\n        var zoom = props.zoom || 1;\r\n        var renderGroupRects = moveable.renderGroupRects;\r\n        var persistDatChildren = ((_a = props.persistData) === null || _a === void 0 ? void 0 : _a.children) || [];\r\n        if (isPersisted) {\r\n            targets = persistDatChildren.map(function () { return null; });\r\n        }\r\n        else {\r\n            persistDatChildren = [];\r\n        }\r\n        var parentPosition = watchValue(moveable, \"parentPosition\", [left, top], function (styles) { return styles.join(\",\"); });\r\n        var requestStyles = watchValue(moveable, \"requestStyles\", moveable.getRequestChildStyles(), function (styles) { return styles.join(\",\"); });\r\n        moveable.moveables = moveable.moveables.slice(0, targets.length);\r\n        return __spreadArray(__spreadArray([], __read(targets.map(function (target, i) {\r\n            return React.createElement(MoveableManager, { key: \"moveable\" + i, ref: refs(moveable, \"moveables\", i), target: target, origin: false, requestStyles: requestStyles, cssStyled: props.cssStyled, customStyledMap: props.customStyledMap, useResizeObserver: props.useResizeObserver, useMutationObserver: props.useMutationObserver, hideChildMoveableDefaultLines: props.hideChildMoveableDefaultLines, parentMoveable: moveable, parentPosition: [left, top], persistData: persistDatChildren[i], zoom: zoom });\r\n        })), false), __read(flat(renderGroupRects.map(function (_a, i) {\r\n            var pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4;\r\n            var poses = [pos1, pos2, pos3, pos4];\r\n            return [\r\n                [0, 1],\r\n                [1, 3],\r\n                [3, 2],\r\n                [2, 0],\r\n            ].map(function (_a, j) {\r\n                var _b = __read(_a, 2), from = _b[0], to = _b[1];\r\n                return renderLine(React, \"\", minus(poses[from], parentPosition), minus(poses[to], parentPosition), zoom, \"group-rect-\".concat(i, \"-\").concat(j));\r\n            });\r\n        }))), false);\r\n    },\r\n};\n\nvar Clickable = makeAble(\"clickable\", {\r\n    props: [\r\n        \"clickable\",\r\n    ],\r\n    events: [\r\n        \"click\",\r\n        \"clickGroup\",\r\n    ],\r\n    always: true,\r\n    dragRelation: \"weak\",\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    dragStart: function () {\r\n        return;\r\n    },\r\n    dragControlStart: function () {\r\n        return;\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        e.datas.inputTarget = e.inputEvent && e.inputEvent.target;\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        var target = moveable.props.target;\r\n        var inputEvent = e.inputEvent;\r\n        var inputTarget = e.inputTarget;\r\n        var isMoveableElement = moveable.isMoveableElement(inputTarget);\r\n        var containsElement = !isMoveableElement && moveable.controlBox.contains(inputTarget);\r\n        if (!inputEvent || !inputTarget || e.isDrag\r\n            || moveable.isMoveableElement(inputTarget)\r\n            || containsElement\r\n        // External event duplicate target or dragAreaElement\r\n        ) {\r\n            return;\r\n        }\r\n        var containsTarget = target.contains(inputTarget);\r\n        triggerEvent(moveable, \"onClick\", fillParams(moveable, e, {\r\n            isDouble: e.isDouble,\r\n            inputTarget: inputTarget,\r\n            isTarget: target === inputTarget,\r\n            moveableTarget: moveable.props.target,\r\n            containsTarget: containsTarget,\r\n        }));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        var inputEvent = e.inputEvent;\r\n        var inputTarget = e.inputTarget;\r\n        if (!inputEvent || !inputTarget || e.isDrag\r\n            || moveable.isMoveableElement(inputTarget)\r\n            // External event duplicate target or dragAreaElement\r\n            || e.datas.inputTarget === inputTarget) {\r\n            return;\r\n        }\r\n        var targets = moveable.props.targets;\r\n        var targetIndex = targets.indexOf(inputTarget);\r\n        var isTarget = targetIndex > -1;\r\n        var containsTarget = false;\r\n        if (targetIndex === -1) {\r\n            targetIndex = findIndex(targets, function (parentTarget) { return parentTarget.contains(inputTarget); });\r\n            containsTarget = targetIndex > -1;\r\n        }\r\n        triggerEvent(moveable, \"onClickGroup\", fillParams(moveable, e, {\r\n            isDouble: e.isDouble,\r\n            targets: targets,\r\n            inputTarget: inputTarget,\r\n            targetIndex: targetIndex,\r\n            isTarget: isTarget,\r\n            containsTarget: containsTarget,\r\n            moveableTarget: targets[targetIndex],\r\n        }));\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        this.dragEnd(moveable, e);\r\n    },\r\n});\r\n/**\r\n * When you click on the element, the `click` event is called.\r\n * @memberof Moveable\r\n * @event click\r\n * @param {Moveable.OnClick} - Parameters for the `click` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"click\", ({ hasTarget, containsTarget, targetIndex }) => {\r\n *     // If you click on an element other than the target and not included in the target, index is -1.\r\n *     console.log(\"onClickGroup\", target, hasTarget, containsTarget, targetIndex);\r\n * });\r\n */\r\n/**\r\n * When you click on the element inside the group, the `clickGroup` event is called.\r\n * @memberof Moveable\r\n * @event clickGroup\r\n * @param {Moveable.OnClickGroup} - Parameters for the `clickGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"clickGroup\", ({ inputTarget, isTarget, containsTarget, targetIndex }) => {\r\n *     // If you click on an element other than the target and not included in the target, index is -1.\r\n *     console.log(\"onClickGroup\", inputTarget, isTarget, containsTarget, targetIndex);\r\n * });\r\n */\n\nfunction getDraggableEvent(e) {\r\n    var datas = e.originalDatas.draggable;\r\n    if (!datas) {\r\n        e.originalDatas.draggable = {};\r\n        datas = e.originalDatas.draggable;\r\n    }\r\n    return __assign(__assign({}, e), { datas: datas });\r\n}\r\nvar edgeDraggable = makeAble(\"edgeDraggable\", {\r\n    css: [\r\n        \".edge.edgeDraggable.line {\\ncursor: move;\\n}\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var props = moveable.props;\r\n        var edge = props.edgeDraggable;\r\n        if (!edge) {\r\n            return [];\r\n        }\r\n        return renderEdgeLines(React, \"edgeDraggable\", edge, moveable.getState().renderPoses, props.zoom);\r\n    },\r\n    dragCondition: function (moveable, e) {\r\n        var _a;\r\n        var props = moveable.props;\r\n        var target = (_a = e.inputEvent) === null || _a === void 0 ? void 0 : _a.target;\r\n        if (!props.edgeDraggable || !target) {\r\n            return false;\r\n        }\r\n        return !props.draggable\r\n            && hasClass(target, prefix(\"direction\"))\r\n            && hasClass(target, prefix(\"edge\"))\r\n            && hasClass(target, prefix(\"edgeDraggable\"));\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        return Draggable.dragStart(moveable, getDraggableEvent(e));\r\n    },\r\n    drag: function (moveable, e) {\r\n        return Draggable.drag(moveable, getDraggableEvent(e));\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        return Draggable.dragEnd(moveable, getDraggableEvent(e));\r\n    },\r\n    dragGroupCondition: function (moveable, e) {\r\n        var _a;\r\n        var props = moveable.props;\r\n        var target = (_a = e.inputEvent) === null || _a === void 0 ? void 0 : _a.target;\r\n        if (!props.edgeDraggable || !target) {\r\n            return false;\r\n        }\r\n        return !props.draggable && hasClass(target, prefix(\"direction\")) && hasClass(target, prefix(\"line\"));\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        return Draggable.dragGroupStart(moveable, getDraggableEvent(e));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        return Draggable.dragGroup(moveable, getDraggableEvent(e));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        return Draggable.dragGroupEnd(moveable, getDraggableEvent(e));\r\n    },\r\n    unset: function (moveable) {\r\n        return Draggable.unset(moveable);\r\n    },\r\n});\r\n/**\r\n * Whether to move by dragging the edge line (default: false)\r\n * @name Moveable.Draggable#edgeDraggable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  draggable: true,\r\n *  edgeDraggable: false,\r\n * });\r\n *\r\n * moveable.edgeDraggable = true;\r\n */\n\nvar IndividualGroupable = {\r\n    name: \"individualGroupable\",\r\n    props: [\r\n        \"individualGroupable\",\r\n        \"individualGroupableProps\",\r\n    ],\r\n    events: [],\r\n};\n\nvar MOVEABLE_ABLES =  [\r\n    BeforeRenderable,\r\n    Default, Snappable, Pinchable,\r\n    Draggable, edgeDraggable,\r\n    Resizable, Scalable, Warpable, Rotatable,\r\n    Scrollable, Padding, Origin,\r\n    OriginDraggable,\r\n    Clippable, Roundable, Groupable, IndividualGroupable,\r\n    Clickable,\r\n    DragArea,\r\n    Renderable,\r\n];\r\nvar MOVEABLE_EVENTS = /*#__PURE__*/ MOVEABLE_ABLES.reduce(function (current, able) {\r\n    (able.events || []).forEach(function (name) {\r\n        pushSet(current, name);\r\n    });\r\n    return current;\r\n}, []);\r\nvar MOVEABLE_PROPS = /*#__PURE__*/ MOVEABLE_ABLES.reduce(function (current, able) {\r\n    (able.props || []).forEach(function (name) {\r\n        pushSet(current, name);\r\n    });\r\n    return current;\r\n}, []);\n\nfunction solveConstantsDistance(_a, pos) {\r\n    var _b = __read(_a, 3), a = _b[0], b = _b[1], c = _b[2];\r\n    return (a * pos[0] + b * pos[1] + c) / Math.sqrt(a * a + b * b);\r\n}\r\nfunction solveC(_a, pos) {\r\n    var _b = __read(_a, 2), a = _b[0], b = _b[1];\r\n    // ax + by + c = 0\r\n    // -ax -by;\r\n    return -a * pos[0] - b * pos[1];\r\n}\n\nfunction getMaxPos(poses, index) {\r\n    return Math.max.apply(Math, __spreadArray([], __read(poses.map(function (_a) {\r\n        var _b = __read(_a, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n        return Math.max(pos1[index], pos2[index], pos3[index], pos4[index]);\r\n    })), false));\r\n}\r\nfunction getMinPos(poses, index) {\r\n    return Math.min.apply(Math, __spreadArray([], __read(poses.map(function (_a) {\r\n        var _b = __read(_a, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n        return Math.min(pos1[index], pos2[index], pos3[index], pos4[index]);\r\n    })), false));\r\n}\r\nfunction getGroupRect(parentPoses, rotation) {\r\n    var _a, _b, _c;\r\n    var pos1 = [0, 0];\r\n    var pos2 = [0, 0];\r\n    var pos3 = [0, 0];\r\n    var pos4 = [0, 0];\r\n    var width = 0;\r\n    var height = 0;\r\n    if (!parentPoses.length) {\r\n        return {\r\n            pos1: pos1,\r\n            pos2: pos2,\r\n            pos3: pos3,\r\n            pos4: pos4,\r\n            minX: 0,\r\n            minY: 0,\r\n            maxX: 0,\r\n            maxY: 0,\r\n            width: width,\r\n            height: height,\r\n            rotation: rotation,\r\n        };\r\n    }\r\n    var fixedRotation = throttle(rotation, TINY_NUM);\r\n    if (fixedRotation % 90) {\r\n        var rad = fixedRotation / 180 * Math.PI;\r\n        var a1_1 = Math.tan(rad);\r\n        var a2_1 = -1 / a1_1;\r\n        // ax = y  // -ax + y = 0 // 0 => 1\r\n        // -ax = y // ax + y = 0  // 0 => 3\r\n        var a1MinMax_1 = [MAX_NUM, MIN_NUM];\r\n        var a1MinMaxPos_1 = [[0, 0], [0, 0]];\r\n        var a2MinMax_1 = [MAX_NUM, MIN_NUM];\r\n        var a2MinMaxPos_1 = [[0, 0], [0, 0]];\r\n        parentPoses.forEach(function (poses) {\r\n            poses.forEach(function (pos) {\r\n                // const b1 = pos[1] - a1 * pos[0];\r\n                // const b2 = pos[1] - a2 * pos[0];\r\n                var a1Dist = solveConstantsDistance([-a1_1, 1, 0], pos);\r\n                var a2Dist = solveConstantsDistance([-a2_1, 1, 0], pos);\r\n                if (a1MinMax_1[0] > a1Dist) {\r\n                    a1MinMaxPos_1[0] = pos;\r\n                    a1MinMax_1[0] = a1Dist;\r\n                }\r\n                if (a1MinMax_1[1] < a1Dist) {\r\n                    a1MinMaxPos_1[1] = pos;\r\n                    a1MinMax_1[1] = a1Dist;\r\n                }\r\n                if (a2MinMax_1[0] > a2Dist) {\r\n                    a2MinMaxPos_1[0] = pos;\r\n                    a2MinMax_1[0] = a2Dist;\r\n                }\r\n                if (a2MinMax_1[1] < a2Dist) {\r\n                    a2MinMaxPos_1[1] = pos;\r\n                    a2MinMax_1[1] = a2Dist;\r\n                }\r\n            });\r\n        });\r\n        var _d = __read(a1MinMaxPos_1, 2), a1MinPos = _d[0], a1MaxPos = _d[1];\r\n        var _e = __read(a2MinMaxPos_1, 2), a2MinPos = _e[0], a2MaxPos = _e[1];\r\n        var minHorizontalLine = [-a1_1, 1, solveC([-a1_1, 1], a1MinPos)];\r\n        var maxHorizontalLine = [-a1_1, 1, solveC([-a1_1, 1], a1MaxPos)];\r\n        var minVerticalLine = [-a2_1, 1, solveC([-a2_1, 1], a2MinPos)];\r\n        var maxVerticalLine = [-a2_1, 1, solveC([-a2_1, 1], a2MaxPos)];\r\n        _a = __read([\r\n            [minHorizontalLine, minVerticalLine],\r\n            [minHorizontalLine, maxVerticalLine],\r\n            [maxHorizontalLine, minVerticalLine],\r\n            [maxHorizontalLine, maxVerticalLine],\r\n        ].map(function (_a) {\r\n            var _b = __read(_a, 2), line1 = _b[0], line2 = _b[1];\r\n            return getIntersectionPointsByConstants(line1, line2)[0];\r\n        }), 4), pos1 = _a[0], pos2 = _a[1], pos3 = _a[2], pos4 = _a[3];\r\n        width = a2MinMax_1[1] - a2MinMax_1[0];\r\n        height = a1MinMax_1[1] - a1MinMax_1[0];\r\n    }\r\n    else {\r\n        var minX_1 = getMinPos(parentPoses, 0);\r\n        var minY_1 = getMinPos(parentPoses, 1);\r\n        var maxX_1 = getMaxPos(parentPoses, 0);\r\n        var maxY_1 = getMaxPos(parentPoses, 1);\r\n        pos1 = [minX_1, minY_1];\r\n        pos2 = [maxX_1, minY_1];\r\n        pos3 = [minX_1, maxY_1];\r\n        pos4 = [maxX_1, maxY_1];\r\n        width = maxX_1 - minX_1;\r\n        height = maxY_1 - minY_1;\r\n        if (fixedRotation % 180) {\r\n            // 0\r\n            // 1 2\r\n            // 3 4\r\n            // 90\r\n            // 3 1\r\n            // 4 2\r\n            // 180\r\n            // 4 3\r\n            // 2 1\r\n            // 270\r\n            // 2 4\r\n            // 1 3\r\n            // 1, 2, 3,4 = 3 1 4 2\r\n            var changedX = [pos3, pos1, pos4, pos2];\r\n            _b = __read(changedX, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n            width = maxY_1 - minY_1;\r\n            height = maxX_1 - minX_1;\r\n        }\r\n    }\r\n    if (fixedRotation % 360 > 180) {\r\n        // 1 2   4 3\r\n        // 3 4   2 1\r\n        var changedX = [pos4, pos3, pos2, pos1];\r\n        _c = __read(changedX, 4), pos1 = _c[0], pos2 = _c[1], pos3 = _c[2], pos4 = _c[3];\r\n    }\r\n    var _f = getMinMaxs([pos1, pos2, pos3, pos4]), minX = _f.minX, minY = _f.minY, maxX = _f.maxX, maxY = _f.maxY;\r\n    return {\r\n        pos1: pos1,\r\n        pos2: pos2,\r\n        pos3: pos3,\r\n        pos4: pos4,\r\n        width: width,\r\n        height: height,\r\n        minX: minX,\r\n        minY: minY,\r\n        maxX: maxX,\r\n        maxY: maxY,\r\n        rotation: rotation,\r\n    };\r\n}\r\nfunction findMoveableGroups(moveables, childTargetGroups) {\r\n    var groups = childTargetGroups.map(function (targetGroup) {\r\n        if (isArray(targetGroup)) {\r\n            var childMoveableGroups = findMoveableGroups(moveables, targetGroup);\r\n            var length_1 = childMoveableGroups.length;\r\n            if (length_1 > 1) {\r\n                return childMoveableGroups;\r\n            }\r\n            else if (length_1 === 1) {\r\n                return childMoveableGroups[0];\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        }\r\n        else {\r\n            var checked = find(moveables, function (_a) {\r\n                var manager = _a.manager;\r\n                return manager.props.target === targetGroup;\r\n            });\r\n            if (checked) {\r\n                checked.finded = true;\r\n                return checked.manager;\r\n            }\r\n            return null;\r\n        }\r\n    }).filter(Boolean);\r\n    if (groups.length === 1 && isArray(groups[0])) {\r\n        return groups[0];\r\n    }\r\n    return groups;\r\n}\r\n/**\r\n * @namespace Moveable.Group\r\n * @description You can make targets moveable.\r\n */\r\nvar MoveableGroup = /*#__PURE__*/ (function (_super) {\r\n    __extends(MoveableGroup, _super);\r\n    function MoveableGroup() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.differ = new ChildrenDiffer();\r\n        _this.moveables = [];\r\n        _this.transformOrigin = \"50% 50%\";\r\n        _this.renderGroupRects = [];\r\n        _this._targetGroups = [];\r\n        _this._hasFirstTargets = false;\r\n        return _this;\r\n    }\r\n    MoveableGroup.prototype.componentDidMount = function () {\r\n        _super.prototype.componentDidMount.call(this);\r\n    };\r\n    MoveableGroup.prototype.checkUpdate = function () {\r\n        this._isPropTargetChanged = false;\r\n        this.updateAbles();\r\n    };\r\n    MoveableGroup.prototype.getTargets = function () {\r\n        return this.props.targets;\r\n    };\r\n    MoveableGroup.prototype.updateRect = function (type, isTarget, isSetState) {\r\n        var _a;\r\n        if (isSetState === void 0) { isSetState = true; }\r\n        var state = this.state;\r\n        if (!this.controlBox || state.isPersisted) {\r\n            return;\r\n        }\r\n        setStoreCache(true);\r\n        this.moveables.forEach(function (moveable) {\r\n            moveable.updateRect(type, false, false);\r\n        });\r\n        var props = this.props;\r\n        var moveables = this.moveables;\r\n        var target = state.target || props.target;\r\n        var checkeds = moveables.map(function (moveable) { return ({ finded: false, manager: moveable }); });\r\n        var targetGroups = this.props.targetGroups || [];\r\n        var moveableGroups = findMoveableGroups(checkeds, targetGroups);\r\n        var useDefaultGroupRotate = props.useDefaultGroupRotate;\r\n        moveableGroups.push.apply(moveableGroups, __spreadArray([], __read(checkeds.filter(function (_a) {\r\n            var finded = _a.finded;\r\n            return !finded;\r\n        }).map(function (_a) {\r\n            var manager = _a.manager;\r\n            return manager;\r\n        })), false));\r\n        var renderGroupRects = [];\r\n        var isReset = !isTarget || (type !== \"\" && props.updateGroup);\r\n        var defaultGroupRotate = props.defaultGroupRotate || 0;\r\n        if (!this._hasFirstTargets) {\r\n            var persistedRoatation = (_a = props.persistData) === null || _a === void 0 ? void 0 : _a.rotation;\r\n            if (persistedRoatation != null) {\r\n                defaultGroupRotate = persistedRoatation;\r\n            }\r\n        }\r\n        function getMoveableGroupRect(group, parentRotation, isRoot) {\r\n            var posesRotations = group.map(function (moveable) {\r\n                if (isArray(moveable)) {\r\n                    var rect = getMoveableGroupRect(moveable, parentRotation);\r\n                    var poses = [rect.pos1, rect.pos2, rect.pos3, rect.pos4];\r\n                    renderGroupRects.push(rect);\r\n                    return { poses: poses, rotation: rect.rotation };\r\n                }\r\n                else {\r\n                    return {\r\n                        poses: getAbsolutePosesByState(moveable.state),\r\n                        rotation: moveable.getRotation(),\r\n                    };\r\n                }\r\n            });\r\n            var rotations = posesRotations.map(function (_a) {\r\n                var rotation = _a.rotation;\r\n                return rotation;\r\n            });\r\n            var groupRotation = 0;\r\n            var firstRotation = rotations[0];\r\n            var isSameRotation = rotations.every(function (nextRotation) {\r\n                return Math.abs(firstRotation - nextRotation) < 0.1;\r\n            });\r\n            if (isReset) {\r\n                groupRotation = !useDefaultGroupRotate && isSameRotation ? firstRotation : defaultGroupRotate;\r\n            }\r\n            else {\r\n                groupRotation = !useDefaultGroupRotate && !isRoot && isSameRotation ? firstRotation : parentRotation;\r\n            }\r\n            var groupPoses = posesRotations.map(function (_a) {\r\n                var poses = _a.poses;\r\n                return poses;\r\n            });\r\n            var groupRect = getGroupRect(groupPoses, groupRotation);\r\n            return groupRect;\r\n        }\r\n        var rootGroupRect = getMoveableGroupRect(moveableGroups, this.rotation, true);\r\n        if (isReset) {\r\n            // reset rotataion\r\n            this.rotation = rootGroupRect.rotation;\r\n            this.transformOrigin = props.defaultGroupOrigin || \"50% 50%\";\r\n            this.scale = [1, 1];\r\n        }\r\n        this._targetGroups = targetGroups;\r\n        this.renderGroupRects = renderGroupRects;\r\n        var transformOrigin = this.transformOrigin;\r\n        var rotation = this.rotation;\r\n        var scale = this.scale;\r\n        var width = rootGroupRect.width, height = rootGroupRect.height, minX = rootGroupRect.minX, minY = rootGroupRect.minY;\r\n        var posesInfo = rotatePosesInfo([\r\n            [0, 0],\r\n            [width, 0],\r\n            [0, height],\r\n            [width, height],\r\n        ], convertTransformOriginArray(transformOrigin, width, height), this.rotation / 180 * Math.PI);\r\n        var _b = getMinMaxs(posesInfo.result), deltaX = _b.minX, deltaY = _b.minY;\r\n        var rotateScale = \" rotate(\".concat(rotation, \"deg)\")\r\n            + \" scale(\".concat(sign(scale[0]), \", \").concat(sign(scale[1]), \")\");\r\n        var transform = \"translate(\".concat(-deltaX, \"px, \").concat(-deltaY, \"px)\").concat(rotateScale);\r\n        this.controlBox.style.transform\r\n            = \"translate3d(\".concat(minX, \"px, \").concat(minY, \"px, \").concat(this.props.translateZ || 0, \")\");\r\n        target.style.cssText += \"left:0px;top:0px;\"\r\n            + \"transform-origin:\".concat(transformOrigin, \";\")\r\n            + \"width:\".concat(width, \"px;height:\").concat(height, \"px;\")\r\n            + \"transform: \".concat(transform);\r\n        state.width = width;\r\n        state.height = height;\r\n        var container = this.getContainer();\r\n        var info = getMoveableTargetInfo(this.controlBox, target, this.controlBox, this.getContainer(), this._rootContainer || container, []);\r\n        var pos = [info.left, info.top];\r\n        var _c = __read(getAbsolutePosesByState(info), 4), pos1 = _c[0], pos2 = _c[1], pos3 = _c[2], pos4 = _c[3]; // info.left + info.pos(1 ~ 4)\r\n        var minPos = getMinMaxs([pos1, pos2, pos3, pos4]);\r\n        var delta = [minPos.minX, minPos.minY];\r\n        var direction = sign(scale[0] * scale[1]);\r\n        info.pos1 = minus(pos1, delta);\r\n        info.pos2 = minus(pos2, delta);\r\n        info.pos3 = minus(pos3, delta);\r\n        info.pos4 = minus(pos4, delta);\r\n        // info.left = info.left + delta[0];\r\n        // info.top = info.top + delta[1];\r\n        info.left = minX - info.left + delta[0];\r\n        info.top = minY - info.top + delta[1];\r\n        info.origin = minus(plus(pos, info.origin), delta);\r\n        info.beforeOrigin = minus(plus(pos, info.beforeOrigin), delta);\r\n        info.originalBeforeOrigin = plus(pos, info.originalBeforeOrigin);\r\n        info.transformOrigin = minus(plus(pos, info.transformOrigin), delta);\r\n        target.style.transform\r\n            = \"translate(\".concat(-deltaX - delta[0], \"px, \").concat(-deltaY - delta[1], \"px)\")\r\n                + rotateScale;\r\n        setStoreCache();\r\n        this.updateState(__assign(__assign({}, info), { posDelta: delta, direction: direction, beforeDirection: direction }), isSetState);\r\n    };\r\n    MoveableGroup.prototype.getRect = function () {\r\n        return __assign(__assign({}, _super.prototype.getRect.call(this)), { children: this.moveables.map(function (child) { return child.getRect(); }) });\r\n    };\r\n    MoveableGroup.prototype.triggerEvent = function (name, e, isManager) {\r\n        if (isManager || name.indexOf(\"Group\") > -1) {\r\n            return _super.prototype.triggerEvent.call(this, name, e);\r\n        }\r\n        else {\r\n            this._emitter.trigger(name, e);\r\n        }\r\n    };\r\n    MoveableGroup.prototype.getRequestChildStyles = function () {\r\n        var styleNames = this.getEnabledAbles().reduce(function (names, able) {\r\n            var _a, _b;\r\n            var ableStyleNames = ((_b = (_a = able.requestChildStyle) === null || _a === void 0 ? void 0 : _a.call(able)) !== null && _b !== void 0 ? _b : []);\r\n            return __spreadArray(__spreadArray([], __read(names), false), __read(ableStyleNames), false);\r\n        }, []);\r\n        return styleNames;\r\n    };\r\n    MoveableGroup.prototype.getMoveables = function () {\r\n        return __spreadArray([], __read(this.moveables), false);\r\n    };\r\n    MoveableGroup.prototype.updateAbles = function () {\r\n        _super.prototype.updateAbles.call(this, __spreadArray(__spreadArray([], __read(this.props.ables), false), [Groupable], false), \"Group\");\r\n    };\r\n    MoveableGroup.prototype._updateTargets = function () {\r\n        _super.prototype._updateTargets.call(this);\r\n        this._originalDragTarget = this.props.dragTarget || this.areaElement;\r\n        this._dragTarget = getRefTarget(this._originalDragTarget, true);\r\n    };\r\n    MoveableGroup.prototype._updateEvents = function () {\r\n        var state = this.state;\r\n        var props = this.props;\r\n        var prevTarget = this._prevDragTarget;\r\n        var nextTarget = props.dragTarget || this.areaElement;\r\n        var targets = props.targets;\r\n        var _a = this.differ.update(targets), added = _a.added, changed = _a.changed, removed = _a.removed;\r\n        var isTargetChanged = added.length || removed.length;\r\n        if (isTargetChanged || this._prevOriginalDragTarget !== this._originalDragTarget) {\r\n            unsetGesto(this, false);\r\n            unsetGesto(this, true);\r\n            this.updateState({ gestos: {} });\r\n        }\r\n        if (prevTarget !== nextTarget) {\r\n            state.target = null;\r\n        }\r\n        if (!state.target) {\r\n            state.target = this.areaElement;\r\n            this.controlBox.style.display = \"block\";\r\n        }\r\n        if (state.target) {\r\n            if (!this.targetGesto) {\r\n                this.targetGesto = getTargetAbleGesto(this, this._dragTarget, \"Group\");\r\n            }\r\n            if (!this.controlGesto) {\r\n                this.controlGesto = getControlAbleGesto(this, \"GroupControl\");\r\n            }\r\n        }\r\n        var isContainerChanged = !equals(state.container, props.container);\r\n        if (isContainerChanged) {\r\n            state.container = props.container;\r\n        }\r\n        if (isContainerChanged\r\n            || isTargetChanged\r\n            || this.transformOrigin !== (props.defaultGroupOrigin || \"50% 50%\")\r\n            || changed.length\r\n            || targets.length && !isDeepArrayEquals(this._targetGroups, props.targetGroups || [])) {\r\n            this.updateRect();\r\n            this._hasFirstTargets = true;\r\n        }\r\n        this._isPropTargetChanged = !!isTargetChanged;\r\n    };\r\n    MoveableGroup.prototype._updateObserver = function () { };\r\n    MoveableGroup.defaultProps = __assign(__assign({}, MoveableManager.defaultProps), { transformOrigin: [\"50%\", \"50%\"], groupable: true, dragArea: true, keepRatio: true, targets: [], defaultGroupRotate: 0, defaultGroupOrigin: \"50% 50%\" });\r\n    return MoveableGroup;\r\n}(MoveableManager));\n\n/**\r\n * @namespace Moveable.IndividualGroup\r\n * @description Create targets individually, not as a group.Create targets individually, not as a group.\r\n */\r\nvar MoveableIndividualGroup = /*#__PURE__*/ (function (_super) {\r\n    __extends(MoveableIndividualGroup, _super);\r\n    function MoveableIndividualGroup() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.moveables = [];\r\n        return _this;\r\n    }\r\n    MoveableIndividualGroup.prototype.render = function () {\r\n        var _this = this;\r\n        var _a;\r\n        var props = this.props;\r\n        var cspNonce = props.cspNonce, ControlBoxElement = props.cssStyled, persistData = props.persistData;\r\n        var targets = props.targets || [];\r\n        var length = targets.length;\r\n        var canPersist = this.isUnmounted || !length;\r\n        var persistDatChildren = (_a = persistData === null || persistData === void 0 ? void 0 : persistData.children) !== null && _a !== void 0 ? _a : [];\r\n        if (canPersist && !length && persistDatChildren.length) {\r\n            targets = persistDatChildren.map(function () { return null; });\r\n        }\r\n        else if (!canPersist) {\r\n            persistDatChildren = [];\r\n        }\r\n        return React.createElement(ControlBoxElement, { cspNonce: cspNonce, ref: ref(this, \"controlBox\"), className: prefix(\"control-box\") }, targets.map(function (target, i) {\r\n            var _a, _b;\r\n            var individualProps = (_b = (_a = props.individualGroupableProps) === null || _a === void 0 ? void 0 : _a.call(props, target, i)) !== null && _b !== void 0 ? _b : {};\r\n            return React.createElement(MoveableManager, __assign({ key: \"moveable\" + i, ref: refs(_this, \"moveables\", i) }, props, individualProps, { target: target, wrapperMoveable: _this, isWrapperMounted: _this.isMoveableMounted, persistData: persistDatChildren[i] }));\r\n        }));\r\n    };\r\n    MoveableIndividualGroup.prototype.componentDidMount = function () { };\r\n    MoveableIndividualGroup.prototype.componentDidUpdate = function () { };\r\n    MoveableIndividualGroup.prototype.getTargets = function () {\r\n        return this.props.targets;\r\n    };\r\n    MoveableIndividualGroup.prototype.updateRect = function (type, isTarget, isSetState) {\r\n        if (isSetState === void 0) { isSetState = true; }\r\n        setStoreCache(true);\r\n        this.moveables.forEach(function (moveable) {\r\n            moveable.updateRect(type, isTarget, isSetState);\r\n        });\r\n        setStoreCache();\r\n    };\r\n    MoveableIndividualGroup.prototype.getRect = function () {\r\n        return __assign(__assign({}, _super.prototype.getRect.call(this)), { children: this.moveables.map(function (child) { return child.getRect(); }) });\r\n    };\r\n    MoveableIndividualGroup.prototype.request = function (ableName, param, isInstant) {\r\n        if (param === void 0) { param = {}; }\r\n        var results = this.moveables.map(function (m) { return m.request(ableName, __assign(__assign({}, param), { isInstant: false }), false); });\r\n        var requestInstant = isInstant || param.isInstant;\r\n        var requester = {\r\n            request: function (ableParam) {\r\n                results.forEach(function (r) { return r.request(ableParam); });\r\n                return this;\r\n            },\r\n            requestEnd: function () {\r\n                results.forEach(function (r) { return r.requestEnd(); });\r\n                return this;\r\n            },\r\n        };\r\n        return requestInstant ? requester.request(param).requestEnd() : requester;\r\n    };\r\n    MoveableIndividualGroup.prototype.dragStart = function (e, target) {\r\n        if (target === void 0) { target = e.target; }\r\n        var inputTarget = target;\r\n        var childMoveable = find(this.moveables, function (child) {\r\n            var target = child.getTargets()[0];\r\n            var controlBoxElement = child.getControlBoxElement();\r\n            var dragElement = child.getDragElement();\r\n            if (!target || !dragElement) {\r\n                return false;\r\n            }\r\n            return dragElement === inputTarget || dragElement.contains(inputTarget)\r\n                || (dragElement !== target && target === inputTarget || target.contains(inputTarget))\r\n                || controlBoxElement === inputTarget || controlBoxElement.contains(inputTarget);\r\n        });\r\n        if (childMoveable) {\r\n            childMoveable.dragStart(e, target);\r\n        }\r\n        return this;\r\n    };\r\n    MoveableIndividualGroup.prototype.hitTest = function () {\r\n        return 0;\r\n    };\r\n    MoveableIndividualGroup.prototype.isInside = function () {\r\n        return false;\r\n    };\r\n    MoveableIndividualGroup.prototype.isDragging = function () {\r\n        return false;\r\n    };\r\n    MoveableIndividualGroup.prototype.getDragElement = function () {\r\n        return null;\r\n    };\r\n    MoveableIndividualGroup.prototype.getMoveables = function () {\r\n        return __spreadArray([], __read(this.moveables), false);\r\n    };\r\n    MoveableIndividualGroup.prototype.updateRenderPoses = function () { };\r\n    MoveableIndividualGroup.prototype.checkUpdate = function () { };\r\n    MoveableIndividualGroup.prototype.triggerEvent = function () { };\r\n    MoveableIndividualGroup.prototype.updateAbles = function () { };\r\n    MoveableIndividualGroup.prototype._updateEvents = function () { };\r\n    MoveableIndividualGroup.prototype._updateObserver = function () { };\r\n    return MoveableIndividualGroup;\r\n}(MoveableManager));\n\nfunction getElementTargets(refTargets, selectorMap) {\r\n    var elementTargets = [];\r\n    refTargets.forEach(function (target) {\r\n        if (!target) {\r\n            return;\r\n        }\r\n        if (isString(target)) {\r\n            if (selectorMap[target]) {\r\n                elementTargets.push.apply(elementTargets, __spreadArray([], __read(selectorMap[target]), false));\r\n            }\r\n            return;\r\n        }\r\n        if (isArray(target)) {\r\n            elementTargets.push.apply(elementTargets, __spreadArray([], __read(getElementTargets(target, selectorMap)), false));\r\n        }\r\n        else {\r\n            elementTargets.push(target);\r\n        }\r\n    });\r\n    return elementTargets;\r\n}\r\nfunction getTargetGroups(refTargets, selectorMap) {\r\n    var targetGroups = [];\r\n    refTargets.forEach(function (target) {\r\n        if (!target) {\r\n            return;\r\n        }\r\n        if (isString(target)) {\r\n            if (selectorMap[target]) {\r\n                targetGroups.push.apply(targetGroups, __spreadArray([], __read(selectorMap[target]), false));\r\n            }\r\n            return;\r\n        }\r\n        if (isArray(target)) {\r\n            targetGroups.push(getTargetGroups(target, selectorMap));\r\n        }\r\n        else {\r\n            targetGroups.push(target);\r\n        }\r\n    });\r\n    return targetGroups;\r\n}\r\nfunction compareRefTargets(prevRefTargets, nextRefTargets) {\r\n    return (prevRefTargets.length !== nextRefTargets.length) || prevRefTargets.some(function (target, i) {\r\n        var nextTarget = nextRefTargets[i];\r\n        if (!target && !nextTarget) {\r\n            return false;\r\n        }\r\n        else if (target != nextTarget) {\r\n            if (isArray(target) && isArray(nextTarget)) {\r\n                return compareRefTargets(target, nextTarget);\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n}\r\nvar InitialMoveable = /*#__PURE__*/ (function (_super) {\r\n    __extends(InitialMoveable, _super);\r\n    function InitialMoveable() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.refTargets = [];\r\n        _this.selectorMap = {};\r\n        _this._differ = new ChildrenDiffer();\r\n        _this._elementTargets = [];\r\n        _this._tmpRefTargets = [];\r\n        _this._tmpSelectorMap = {};\r\n        _this._onChangeTargets = null;\r\n        return _this;\r\n    }\r\n    InitialMoveable.makeStyled = function () {\r\n        var cssMap = {};\r\n        var ables = this.getTotalAbles();\r\n        ables.forEach(function (_a) {\r\n            var css = _a.css;\r\n            if (!css) {\r\n                return;\r\n            }\r\n            css.forEach(function (text) {\r\n                cssMap[text] = true;\r\n            });\r\n        });\r\n        var style = getKeys(cssMap).join(\"\\n\");\r\n        this.defaultStyled = styled(\"div\", prefixCSS(PREFIX, MOVEABLE_CSS + style));\r\n    };\r\n    InitialMoveable.getTotalAbles = function () {\r\n        return __spreadArray([Default, Groupable, IndividualGroupable, DragArea], __read(this.defaultAbles), false);\r\n    };\r\n    InitialMoveable.prototype.render = function () {\r\n        var _a;\r\n        var moveableContructor = this.constructor;\r\n        if (!moveableContructor.defaultStyled) {\r\n            moveableContructor.makeStyled();\r\n        }\r\n        var _b = this.props, userAbles = _b.ables, userProps = _b.props, props = __rest(_b, [\"ables\", \"props\"]);\r\n        var _c = __read(this._updateRefs(true), 2), refTargets = _c[0], nextSelectorMap = _c[1];\r\n        var elementTargets = getElementTargets(refTargets, nextSelectorMap);\r\n        var isGroup = elementTargets.length > 1;\r\n        var totalAbles = moveableContructor.getTotalAbles();\r\n        var ables = __spreadArray(__spreadArray([], __read(totalAbles), false), __read((userAbles || [])), false);\r\n        var nextProps = __assign(__assign(__assign({}, props), (userProps || {})), { ables: ables, cssStyled: moveableContructor.defaultStyled, customStyledMap: moveableContructor.customStyledMap });\r\n        this._elementTargets = elementTargets;\r\n        var firstRenderState = null;\r\n        var prevMoveable = this.moveable;\r\n        var persistData = props.persistData;\r\n        if (persistData === null || persistData === void 0 ? void 0 : persistData.children) {\r\n            isGroup = true;\r\n        }\r\n        // Even one child is treated as a group if individualGroupable is enabled. #867\r\n        if (props.individualGroupable) {\r\n            return React.createElement(MoveableIndividualGroup, __assign({ key: \"individual-group\", ref: ref(this, \"moveable\") }, nextProps, { target: null, targets: elementTargets }));\r\n        }\r\n        if (isGroup) {\r\n            var targetGroups = getTargetGroups(refTargets, nextSelectorMap);\r\n            // manager\r\n            if (prevMoveable && !prevMoveable.props.groupable && !prevMoveable.props.individualGroupable) {\r\n                var target = prevMoveable.props.target;\r\n                if (target && elementTargets.indexOf(target) > -1) {\r\n                    firstRenderState = __assign({}, prevMoveable.state);\r\n                }\r\n            }\r\n            return React.createElement(MoveableGroup, __assign({ key: \"group\", ref: ref(this, \"moveable\") }, nextProps, (_a = props.groupableProps) !== null && _a !== void 0 ? _a : {}, { target: null, targets: elementTargets, targetGroups: targetGroups, firstRenderState: firstRenderState }));\r\n        }\r\n        else {\r\n            var target_1 = elementTargets[0];\r\n            // manager\r\n            if (prevMoveable && (prevMoveable.props.groupable || prevMoveable.props.individualGroupable)) {\r\n                var moveables = prevMoveable.moveables || [];\r\n                var prevTargetMoveable = find(moveables, function (mv) { return mv.props.target === target_1; });\r\n                if (prevTargetMoveable) {\r\n                    firstRenderState = __assign({}, prevTargetMoveable.state);\r\n                }\r\n            }\r\n            return React.createElement(MoveableManager, __assign({ key: \"single\", ref: ref(this, \"moveable\") }, nextProps, { target: target_1, firstRenderState: firstRenderState }));\r\n        }\r\n    };\r\n    InitialMoveable.prototype.componentDidMount = function () {\r\n        this._checkChangeTargets();\r\n    };\r\n    InitialMoveable.prototype.componentDidUpdate = function () {\r\n        this._checkChangeTargets();\r\n    };\r\n    InitialMoveable.prototype.componentWillUnmount = function () {\r\n        this.selectorMap = {};\r\n        this.refTargets = [];\r\n    };\r\n    /**\r\n     * Get targets set in moveable through target or targets of props.\r\n     * @method Moveable#getTargets\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body, {\r\n     *    target: [targetRef, \".target\", document.querySelectorAll(\".target\")],\r\n     * });\r\n     *\r\n     * console.log(moveable.getTargets());\r\n     */\r\n    InitialMoveable.prototype.getTargets = function () {\r\n        var _a, _b;\r\n        return (_b = (_a = this.moveable) === null || _a === void 0 ? void 0 : _a.getTargets()) !== null && _b !== void 0 ? _b : [];\r\n    };\r\n    /**\r\n     * If the element list corresponding to the selector among the targets is changed, it is updated.\r\n     * @method Moveable#updateSelectors\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body, {\r\n     *    target: \".target\",\r\n     * });\r\n     *\r\n     * moveable.updateSelectors();\r\n     */\r\n    InitialMoveable.prototype.updateSelectors = function () {\r\n        this.selectorMap = {};\r\n        this._updateRefs();\r\n        this.forceUpdate();\r\n    };\r\n    /**\r\n     * User changes target and waits for target to change.\r\n     * @method Moveable#waitToChangeTarget\r\n     * @story combination-with-other-components--components-selecto\r\n     * @example\r\n     * document.querySelector(\".target\").addEventListener(\"mousedown\", e => {\r\n     *   moveable.waitToChangeTarget().then(() => {\r\n     *      moveable.dragStart(e, e.currentTarget);\r\n     *   });\r\n     *   moveable.target = e.currentTarget;\r\n     * });\r\n     */\r\n    InitialMoveable.prototype.waitToChangeTarget = function () {\r\n        // let resolvePromise: (e: OnChangeTarget) => void;\r\n        var _this = this;\r\n        // this._onChangeTargets = () => {\r\n        //     this._onChangeTargets = null;\r\n        //     resolvePromise({\r\n        //         moveable: this.getManager(),\r\n        //         targets: this._elementTargets,\r\n        //     });\r\n        // };\r\n        // return new Promise<OnChangeTarget>(resolve => {\r\n        //     resolvePromise = resolve;\r\n        // });\r\n        var resolvePromise;\r\n        this._onChangeTargets = function () {\r\n            _this._onChangeTargets = null;\r\n            resolvePromise();\r\n        };\r\n        return new Promise(function (resolve) {\r\n            resolvePromise = resolve;\r\n        });\r\n    };\r\n    InitialMoveable.prototype.waitToChangeTargets = function () {\r\n        return this.waitToChangeTarget();\r\n    };\r\n    InitialMoveable.prototype.getManager = function () {\r\n        return this.moveable;\r\n    };\r\n    InitialMoveable.prototype.getMoveables = function () {\r\n        return this.moveable.getMoveables();\r\n    };\r\n    InitialMoveable.prototype.getDragElement = function () {\r\n        return this.moveable.getDragElement();\r\n    };\r\n    InitialMoveable.prototype._updateRefs = function (isRender) {\r\n        var prevRefTargets = this.refTargets;\r\n        var nextRefTargets = getRefTargets((this.props.target || this.props.targets));\r\n        var isBrowser = typeof document !== \"undefined\";\r\n        var isUpdate = compareRefTargets(prevRefTargets, nextRefTargets);\r\n        var selectorMap = this.selectorMap;\r\n        var nextSelectorMap = {};\r\n        this.refTargets.forEach(function updateSelectorMap(target) {\r\n            if (isString(target)) {\r\n                var selectorTarget = selectorMap[target];\r\n                if (selectorTarget) {\r\n                    nextSelectorMap[target] = selectorMap[target];\r\n                }\r\n                else if (isBrowser) {\r\n                    isUpdate = true;\r\n                    nextSelectorMap[target] = [].slice.call(document.querySelectorAll(target));\r\n                }\r\n            }\r\n            else if (isArray(target)) {\r\n                target.forEach(updateSelectorMap);\r\n            }\r\n        });\r\n        this._tmpRefTargets = nextRefTargets;\r\n        this._tmpSelectorMap = nextSelectorMap;\r\n        return [\r\n            nextRefTargets,\r\n            nextSelectorMap,\r\n            !isRender && isUpdate,\r\n        ];\r\n    };\r\n    InitialMoveable.prototype._checkChangeTargets = function () {\r\n        var _a, _b, _c;\r\n        this.refTargets = this._tmpRefTargets;\r\n        this.selectorMap = this._tmpSelectorMap;\r\n        var _d = this._differ.update(this._elementTargets), added = _d.added, removed = _d.removed;\r\n        var isTargetChanged = added.length || removed.length;\r\n        if (isTargetChanged) {\r\n            (_b = (_a = this.props).onChangeTargets) === null || _b === void 0 ? void 0 : _b.call(_a, {\r\n                moveable: this.moveable,\r\n                targets: this._elementTargets,\r\n            });\r\n            (_c = this._onChangeTargets) === null || _c === void 0 ? void 0 : _c.call(this);\r\n        }\r\n        var _e = __read(this._updateRefs(), 3), refTargets = _e[0], selectorMap = _e[1], isUpdate = _e[2];\r\n        this.refTargets = refTargets;\r\n        this.selectorMap = selectorMap;\r\n        if (isUpdate) {\r\n            this.forceUpdate();\r\n        }\r\n    };\r\n    InitialMoveable.defaultAbles = [];\r\n    InitialMoveable.customStyledMap = {};\r\n    InitialMoveable.defaultStyled = null;\r\n    __decorate([\r\n        withMethods(MOVEABLE_METHODS)\r\n    ], InitialMoveable.prototype, \"moveable\", void 0);\r\n    return InitialMoveable;\r\n}(React.PureComponent));\n\nvar Moveable = /*#__PURE__*/ (function (_super) {\r\n    __extends(Moveable, _super);\r\n    function Moveable() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Moveable.defaultAbles = MOVEABLE_ABLES;\r\n    return Moveable;\r\n}(InitialMoveable));\n\nfunction makeMoveable(ables) {\r\n    var _a;\r\n    return _a = /*#__PURE__*/ (function (_super) {\r\n            __extends(Moveable, _super);\r\n            function Moveable() {\r\n                return _super !== null && _super.apply(this, arguments) || this;\r\n            }\r\n            return Moveable;\r\n        }(InitialMoveable)),\r\n        _a.defaultAbles = ables,\r\n        _a;\r\n}\n\nexport { Clippable, DIRECTIONS, Draggable, edgeDraggable as EdgeDraggable, InitialMoveable, MOVEABLE_ABLES, MOVEABLE_EVENTS, MOVEABLE_METHODS, MOVEABLE_PROPS, Pinchable, Resizable, Rotatable, Roundable, Scalable, Snappable, Warpable, calculateElementPosition, Moveable as default, getElementInfo, makeAble, makeMoveable };\n","/*\nCopyright (c) 2019 Daybrush\nname: moveable\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/moveable/blob/master/packages/moveable\nversion: 0.53.0\n*/\nimport { ref, Properties } from 'framework-utils';\nimport * as React from 'croact';\nimport { renderSelf } from 'croact';\nimport Moveable$1, { MOVEABLE_PROPS, MOVEABLE_METHODS, MOVEABLE_EVENTS, getElementInfo as getElementInfo$1, makeAble as makeAble$1 } from 'croact-moveable';\nimport { camelize, getDocument, isArray } from '@daybrush/utils';\nimport EventEmitter from '@scena/event-emitter';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\n\nvar InnerMoveable = /*#__PURE__*/function (_super) {\n  __extends(InnerMoveable, _super);\n\n  function InnerMoveable(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {};\n    _this.state = _this.props;\n    return _this;\n  }\n\n  var __proto = InnerMoveable.prototype;\n\n  __proto.render = function () {\n    return React.createElement(Moveable$1, __assign({\n      ref: ref(this, \"moveable\")\n    }, this.state));\n  };\n\n  return InnerMoveable;\n}(React.Component);\n\nvar PROPERTIES = MOVEABLE_PROPS;\nvar METHODS = MOVEABLE_METHODS;\nvar EVENTS = MOVEABLE_EVENTS;\n\n/**\r\n * Moveable is Draggable! Resizable! Scalable! Rotatable!\r\n * @sort 1\r\n * @alias Moveable\r\n * @extends EventEmitter\r\n */\n\nvar MoveableManager = /*#__PURE__*/function (_super) {\n  __extends(MoveableManager, _super);\n  /**\r\n   *\r\n   */\n\n\n  function MoveableManager(parentElement, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.containerProvider = null;\n    _this.selfElement = null;\n    _this._warp = false;\n\n    var nextOptions = __assign({}, options);\n\n    var events = {};\n    EVENTS.forEach(function (name) {\n      events[camelize(\"on \".concat(name))] = function (e) {\n        return _this.trigger(name, e);\n      };\n    });\n    var selfElement;\n\n    if (options.warpSelf) {\n      delete options.warpSelf;\n      _this._warp = true;\n      selfElement = parentElement;\n    } else {\n      selfElement = getDocument(parentElement).createElement(\"div\");\n      parentElement.appendChild(selfElement);\n    }\n\n    _this.containerProvider = renderSelf(React.createElement(InnerMoveable, __assign({\n      ref: ref(_this, \"innerMoveable\")\n    }, nextOptions, events)), selfElement);\n    _this.selfElement = selfElement;\n    var target = nextOptions.target;\n\n    if (isArray(target) && target.length > 1) {\n      _this.updateRect();\n    }\n\n    return _this;\n  }\n\n  var __proto = MoveableManager.prototype;\n\n  __proto.setState = function (state, callback) {\n    this.innerMoveable.setState(state, callback);\n  };\n\n  __proto.forceUpdate = function (callback) {\n    this.innerMoveable.forceUpdate(callback);\n  };\n\n  __proto.dragStart = function (e, target) {\n    if (target === void 0) {\n      target = e.target;\n    }\n\n    var innerMoveable = this.innerMoveable;\n\n    if (innerMoveable.$_timer) {\n      this.forceUpdate();\n    }\n\n    this.getMoveable().dragStart(e, target);\n  };\n\n  __proto.destroy = function () {\n    var _a;\n\n    var selfElement = this.selfElement;\n    renderSelf(null, selfElement, this.containerProvider);\n\n    if (!this._warp) {\n      (_a = selfElement === null || selfElement === void 0 ? void 0 : selfElement.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(selfElement);\n    }\n\n    this.containerProvider = null;\n    this.off();\n    this.selfElement = null;\n    this.innerMoveable = null;\n  };\n\n  __proto.getMoveable = function () {\n    return this.innerMoveable.moveable;\n  };\n\n  MoveableManager = __decorate([Properties(METHODS, function (prototype, property) {\n    if (prototype[property]) {\n      return;\n    }\n\n    prototype[property] = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      var self = this.getMoveable();\n\n      if (!self || !self[property]) {\n        return;\n      }\n\n      return self[property].apply(self, args);\n    };\n  }), Properties(PROPERTIES, function (prototype, property) {\n    Object.defineProperty(prototype, property, {\n      get: function () {\n        return this.getMoveable().props[property];\n      },\n      set: function (value) {\n        var _a;\n\n        this.setState((_a = {}, _a[property] = value, _a));\n      },\n      enumerable: true,\n      configurable: true\n    });\n  })], MoveableManager);\n  return MoveableManager;\n}(EventEmitter);\n\nvar Moveable = /*#__PURE__*/function (_super) {\n  __extends(Moveable, _super);\n\n  function Moveable() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return Moveable;\n}(MoveableManager);\n\nfunction getElementInfo(target, container, rootContainer) {\n  return getElementInfo$1(target, container, rootContainer);\n}\nfunction makeAble(name, able) {\n  return makeAble$1(name, able);\n}\n\nexport { EVENTS, METHODS, PROPERTIES, Moveable as default, getElementInfo, makeAble };\n//# sourceMappingURL=moveable.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: keycon\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/keycon.git\nversion: 1.2.2\n*/\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\n/*\nCopyright (c) 2018 Daybrush\n@name: @daybrush/utils\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/utils\n@version 1.7.1\n*/\n/**\n* get string \"object\"\n* @memberof Consts\n* @example\nimport {OBJECT} from \"@daybrush/utils\";\n\nconsole.log(OBJECT); // \"object\"\n*/\n\nvar OBJECT = \"object\";\n/**\n* get string \"string\"\n* @memberof Consts\n* @example\nimport {STRING} from \"@daybrush/utils\";\n\nconsole.log(STRING); // \"string\"\n*/\n\nvar STRING = \"string\";\n/**\n* Check the type that the value is object.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isObject} from \"@daybrush/utils\";\n\nconsole.log(isObject({})); // true\nconsole.log(isObject(undefined)); // false\nconsole.log(isObject(\"\")); // false\nconsole.log(isObject(null)); // false\n*/\n\nfunction isObject(value) {\n  return value && typeof value === OBJECT;\n}\n/**\n* Check the type that the value is isArray.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isArray} from \"@daybrush/utils\";\n\nconsole.log(isArray([])); // true\nconsole.log(isArray({})); // false\nconsole.log(isArray(undefined)); // false\nconsole.log(isArray(null)); // false\n*/\n\nfunction isArray(value) {\n  return Array.isArray(value);\n}\n/**\n* Check the type that the value is string.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isString} from \"@daybrush/utils\";\n\nconsole.log(isString(\"1234\")); // true\nconsole.log(isString(undefined)); // false\nconsole.log(isString(1)); // false\nconsole.log(isString(null)); // false\n*/\n\nfunction isString(value) {\n  return typeof value === STRING;\n}\n/**\n* Returns the index of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findIndex` was called upon.\n* @param - A function to execute on each value in the array until the function returns true, indicating that the satisfying element was found.\n* @param - Returns defaultIndex if not found by the function.\n* @example\nimport { findIndex } from \"@daybrush/utils\";\n\nfindIndex([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // 1\n*/\n\nfunction findIndex(arr, callback, defaultIndex) {\n  if (defaultIndex === void 0) {\n    defaultIndex = -1;\n  }\n\n  var length = arr.length;\n\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i, arr)) {\n      return i;\n    }\n  }\n\n  return defaultIndex;\n}\n/**\n* Sets up a function that will be called whenever the specified event is delivered to the target\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The object which receives a notification (an object that implements the Event interface) when an event of the specified type occurs\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent} from \"@daybrush/utils\";\n\naddEvent(el, \"click\", e => {\n  console.log(e);\n});\n*/\n\nfunction addEvent(el, type, listener, options) {\n  el.addEventListener(type, listener, options);\n}\n/**\n* removes from the EventTarget an event listener previously registered with EventTarget.addEventListener()\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The EventListener function of the event handler to remove from the event target.\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent, removeEvent} from \"@daybrush/utils\";\nconst listener = e => {\n  console.log(e);\n};\naddEvent(el, \"click\", listener);\nremoveEvent(el, \"click\", listener);\n*/\n\nfunction removeEvent(el, type, listener, options) {\n  el.removeEventListener(type, listener, options);\n}\n\n/*\nCopyright (c) 2019 Daybrush\nname: @scena/event-emitter\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/gesture.git\nversion: 1.0.5\n*/\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n}\n\n/**\n * Implement EventEmitter on object or component.\n */\n\nvar EventEmitter =\n/*#__PURE__*/\nfunction () {\n  function EventEmitter() {\n    this._events = {};\n  }\n  /**\n   * Add a listener to the registered event.\n   * @param - Name of the event to be added\n   * @param - listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add listener in \"a\" event\n   * emitter.on(\"a\", () => {\n   * });\n   * // Add listeners\n   * emitter.on({\n   *  a: () => {},\n   *  b: () => {},\n   * });\n   */\n\n\n  var __proto = EventEmitter.prototype;\n\n  __proto.on = function (eventName, listener) {\n    if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.on(name, eventName[name]);\n      }\n    } else {\n      this._addEvent(eventName, listener, {});\n    }\n\n    return this;\n  };\n  /**\n   * Remove listeners registered in the event target.\n   * @param - Name of the event to be removed\n   * @param - listener function of the event to be removed\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Remove all listeners.\n   * emitter.off();\n   *\n   * // Remove all listeners in \"A\" event.\n   * emitter.off(\"a\");\n   *\n   *\n   * // Remove \"listener\" listener in \"a\" event.\n   * emitter.off(\"a\", listener);\n   */\n\n\n  __proto.off = function (eventName, listener) {\n    if (!eventName) {\n      this._events = {};\n    } else if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.off(name);\n      }\n    } else if (!listener) {\n      this._events[eventName] = [];\n    } else {\n      var events = this._events[eventName];\n\n      if (events) {\n        var index = findIndex(events, function (e) {\n          return e.listener === listener;\n        });\n\n        if (index > -1) {\n          events.splice(index, 1);\n        }\n      }\n    }\n\n    return this;\n  };\n  /**\n   * Add a disposable listener and Use promise to the registered event.\n   * @param - Name of the event to be added\n   * @param - disposable listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add a disposable listener in \"a\" event\n   * emitter.once(\"a\", () => {\n   * });\n   *\n   * // Use Promise\n   * emitter.once(\"a\").then(e => {\n   * });\n   */\n\n\n  __proto.once = function (eventName, listener) {\n    var _this = this;\n\n    if (listener) {\n      this._addEvent(eventName, listener, {\n        once: true\n      });\n    }\n\n    return new Promise(function (resolve) {\n      _this._addEvent(eventName, resolve, {\n        once: true\n      });\n    });\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n\n  __proto.emit = function (eventName, param) {\n    var _this = this;\n\n    if (param === void 0) {\n      param = {};\n    }\n\n    var events = this._events[eventName];\n\n    if (!eventName || !events) {\n      return true;\n    }\n\n    var isStop = false;\n    param.eventType = eventName;\n\n    param.stop = function () {\n      isStop = true;\n    };\n\n    param.currentTarget = this;\n\n    __spreadArrays(events).forEach(function (info) {\n      info.listener(param);\n\n      if (info.once) {\n        _this.off(eventName, info.listener);\n      }\n    });\n\n    return !isStop;\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n  /**\n  * Fires an event to call listeners.\n  * @param - Event name\n  * @param - Event parameter\n  * @return If false, stop the event.\n  * @example\n  *\n  * import EventEmitter from \"@scena/event-emitter\";\n  *\n  *\n  * const emitter = new EventEmitter();\n  *\n  * emitter.on(\"a\", e => {\n  * });\n  *\n  * // emit\n  * emitter.trigger(\"a\", {\n  *   a: 1,\n  * });\n  */\n\n\n  __proto.trigger = function (eventName, param) {\n    if (param === void 0) {\n      param = {};\n    }\n\n    return this.emit(eventName, param);\n  };\n\n  __proto._addEvent = function (eventName, listener, options) {\n    var events = this._events;\n    events[eventName] = events[eventName] || [];\n    var listeners = events[eventName];\n    listeners.push(__assign({\n      listener: listener\n    }, options));\n  };\n\n  return EventEmitter;\n}();\n\nfunction createCommonjsModule(fn, module) {\n  return module = {\n    exports: {}\n  }, fn(module, module.exports), module.exports;\n}\n\nvar keycode = createCommonjsModule(function (module, exports) {\n// Source: http://jsfiddle.net/vWx8V/\n// http://stackoverflow.com/questions/5603195/full-list-of-javascript-keycodes\n\n/**\n * Conenience method returns corresponding value for given keyName or keyCode.\n *\n * @param {Mixed} keyCode {Number} or keyName {String}\n * @return {Mixed}\n * @api public\n */\n\nfunction keyCode(searchInput) {\n  // Keyboard Events\n  if (searchInput && 'object' === typeof searchInput) {\n    var hasKeyCode = searchInput.which || searchInput.keyCode || searchInput.charCode;\n    if (hasKeyCode) searchInput = hasKeyCode;\n  }\n\n  // Numbers\n  if ('number' === typeof searchInput) return names[searchInput]\n\n  // Everything else (cast to string)\n  var search = String(searchInput);\n\n  // check codes\n  var foundNamedKey = codes[search.toLowerCase()];\n  if (foundNamedKey) return foundNamedKey\n\n  // check aliases\n  var foundNamedKey = aliases[search.toLowerCase()];\n  if (foundNamedKey) return foundNamedKey\n\n  // weird character?\n  if (search.length === 1) return search.charCodeAt(0)\n\n  return undefined\n}\n\n/**\n * Compares a keyboard event with a given keyCode or keyName.\n *\n * @param {Event} event Keyboard event that should be tested\n * @param {Mixed} keyCode {Number} or keyName {String}\n * @return {Boolean}\n * @api public\n */\nkeyCode.isEventKey = function isEventKey(event, nameOrCode) {\n  if (event && 'object' === typeof event) {\n    var keyCode = event.which || event.keyCode || event.charCode;\n    if (keyCode === null || keyCode === undefined) { return false; }\n    if (typeof nameOrCode === 'string') {\n      // check codes\n      var foundNamedKey = codes[nameOrCode.toLowerCase()];\n      if (foundNamedKey) { return foundNamedKey === keyCode; }\n    \n      // check aliases\n      var foundNamedKey = aliases[nameOrCode.toLowerCase()];\n      if (foundNamedKey) { return foundNamedKey === keyCode; }\n    } else if (typeof nameOrCode === 'number') {\n      return nameOrCode === keyCode;\n    }\n    return false;\n  }\n};\n\nexports = module.exports = keyCode;\n\n/**\n * Get by name\n *\n *   exports.code['enter'] // => 13\n */\n\nvar codes = exports.code = exports.codes = {\n  'backspace': 8,\n  'tab': 9,\n  'enter': 13,\n  'shift': 16,\n  'ctrl': 17,\n  'alt': 18,\n  'pause/break': 19,\n  'caps lock': 20,\n  'esc': 27,\n  'space': 32,\n  'page up': 33,\n  'page down': 34,\n  'end': 35,\n  'home': 36,\n  'left': 37,\n  'up': 38,\n  'right': 39,\n  'down': 40,\n  'insert': 45,\n  'delete': 46,\n  'command': 91,\n  'left command': 91,\n  'right command': 93,\n  'numpad *': 106,\n  'numpad +': 107,\n  'numpad -': 109,\n  'numpad .': 110,\n  'numpad /': 111,\n  'num lock': 144,\n  'scroll lock': 145,\n  'my computer': 182,\n  'my calculator': 183,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  \"'\": 222\n};\n\n// Helper aliases\n\nvar aliases = exports.aliases = {\n  'windows': 91,\n  '': 16,\n  '': 18,\n  '': 17,\n  '': 91,\n  'ctl': 17,\n  'control': 17,\n  'option': 18,\n  'pause': 19,\n  'break': 19,\n  'caps': 20,\n  'return': 13,\n  'escape': 27,\n  'spc': 32,\n  'spacebar': 32,\n  'pgup': 33,\n  'pgdn': 34,\n  'ins': 45,\n  'del': 46,\n  'cmd': 91\n};\n\n/*!\n * Programatically add the following\n */\n\n// lower case chars\nfor (i = 97; i < 123; i++) codes[String.fromCharCode(i)] = i - 32;\n\n// numbers\nfor (var i = 48; i < 58; i++) codes[i - 48] = i;\n\n// function keys\nfor (i = 1; i < 13; i++) codes['f'+i] = i + 111;\n\n// numpad keys\nfor (i = 0; i < 10; i++) codes['numpad '+i] = i + 96;\n\n/**\n * Get by code\n *\n *   exports.name[13] // => 'Enter'\n */\n\nvar names = exports.names = exports.title = {}; // title for backward compat\n\n// Create reverse mapping\nfor (i in codes) names[codes[i]] = i;\n\n// Add aliases\nfor (var alias in aliases) {\n  codes[alias] = aliases[alias];\n}\n});\nvar keycode_1 = keycode.code;\nvar keycode_2 = keycode.codes;\nvar keycode_3 = keycode.aliases;\nvar keycode_4 = keycode.names;\nvar keycode_5 = keycode.title;\n\nvar codeData = {\n  \"+\": \"plus\",\n  \"left command\": \"meta\",\n  \"right command\": \"meta\"\n};\nvar keysSort = {\n  shift: 1,\n  ctrl: 2,\n  alt: 3,\n  meta: 4\n};\n/**\n * @memberof KeyController\n */\n\nfunction getKey(keyCode, keyName) {\n  var key = (keycode_4[keyCode] || keyName || \"\").toLowerCase();\n\n  for (var name in codeData) {\n    key = key.replace(name, codeData[name]);\n  }\n\n  return key.replace(/\\s/g, \"\");\n}\n/**\n * @memberof KeyController\n */\n\nfunction getCombi(e, key) {\n  if (key === void 0) {\n    key = getKey(e.keyCode, e.key);\n  }\n\n  var keys = getModifierCombi(e);\n  keys.indexOf(key) === -1 && keys.push(key);\n  return keys.filter(Boolean);\n}\n/**\n * @memberof KeyController\n */\n\nfunction getModifierCombi(e) {\n  var keys = [e.shiftKey && \"shift\", e.ctrlKey && \"ctrl\", e.altKey && \"alt\", e.metaKey && \"meta\"];\n  return keys.filter(Boolean);\n}\n\nfunction getArrangeCombi(keys) {\n  var arrangeKeys = keys.slice();\n  arrangeKeys.sort(function (prev, next) {\n    var prevScore = keysSort[prev] || 5;\n    var nextScore = keysSort[next] || 5;\n    return prevScore - nextScore;\n  });\n  return arrangeKeys;\n}\n\nvar globalKeyController;\n/**\n */\n\nvar KeyController =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(KeyController, _super);\n  /**\n   *\n   */\n\n\n  function KeyController(container) {\n    if (container === void 0) {\n      container = window;\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.container = container;\n    /**\n     */\n\n    _this.ctrlKey = false;\n    /**\n     */\n\n    _this.altKey = false;\n    /**\n     *\n     */\n\n    _this.shiftKey = false;\n    /**\n     *\n     */\n\n    _this.metaKey = false;\n\n    _this.clear = function () {\n      _this.ctrlKey = false;\n      _this.altKey = false;\n      _this.shiftKey = false;\n      _this.metaKey = false;\n      return _this;\n    };\n\n    _this.keydownEvent = function (e) {\n      _this.triggerEvent(\"keydown\", e);\n    };\n\n    _this.keyupEvent = function (e) {\n      _this.triggerEvent(\"keyup\", e);\n    };\n\n    _this.blur = function () {\n      _this.clear();\n\n      _this.trigger(\"blur\");\n    };\n\n    addEvent(container, \"blur\", _this.blur);\n    addEvent(container, \"keydown\", _this.keydownEvent);\n    addEvent(container, \"keyup\", _this.keyupEvent);\n    return _this;\n  }\n\n  var __proto = KeyController.prototype;\n  Object.defineProperty(KeyController, \"global\", {\n    /**\n     */\n    get: function () {\n      return globalKeyController || (globalKeyController = new KeyController());\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  KeyController.setGlobal = function () {\n    return this.global;\n  };\n  /**\n   *\n   */\n\n\n  __proto.destroy = function () {\n    var container = this.container;\n    this.clear();\n    this.off();\n    removeEvent(container, \"blur\", this.blur);\n    removeEvent(container, \"keydown\", this.keydownEvent);\n    removeEvent(container, \"keyup\", this.keyupEvent);\n  };\n  /**\n   *\n   */\n\n\n  __proto.keydown = function (comb, callback) {\n    return this.addEvent(\"keydown\", comb, callback);\n  };\n  /**\n   *\n   */\n\n\n  __proto.offKeydown = function (comb, callback) {\n    return this.removeEvent(\"keydown\", comb, callback);\n  };\n  /**\n   *\n   */\n\n\n  __proto.offKeyup = function (comb, callback) {\n    return this.removeEvent(\"keyup\", comb, callback);\n  };\n  /**\n   *\n   */\n\n\n  __proto.keyup = function (comb, callback) {\n    return this.addEvent(\"keyup\", comb, callback);\n  };\n\n  __proto.addEvent = function (type, comb, callback) {\n    if (isArray(comb)) {\n      this.on(type + \".\" + getArrangeCombi(comb).join(\".\"), callback);\n    } else if (isString(comb)) {\n      this.on(type + \".\" + comb, callback);\n    } else {\n      this.on(type, comb);\n    }\n\n    return this;\n  };\n\n  __proto.removeEvent = function (type, comb, callback) {\n    if (isArray(comb)) {\n      this.off(type + \".\" + getArrangeCombi(comb).join(\".\"), callback);\n    } else if (isString(comb)) {\n      this.off(type + \".\" + comb, callback);\n    } else {\n      this.off(type, comb);\n    }\n\n    return this;\n  };\n\n  __proto.triggerEvent = function (type, e) {\n    this.ctrlKey = e.ctrlKey;\n    this.shiftKey = e.shiftKey;\n    this.altKey = e.altKey;\n    this.metaKey = e.metaKey;\n    var key = getKey(e.keyCode, e.key);\n    var isToggle = key === \"ctrl\" || key === \"shift\" || key === \"meta\" || key === \"alt\";\n    var param = {\n      key: key,\n      isToggle: isToggle,\n      inputEvent: e,\n      keyCode: e.keyCode,\n      ctrlKey: e.ctrlKey,\n      altKey: e.altKey,\n      shiftKey: e.shiftKey,\n      metaKey: e.metaKey\n    };\n    this.trigger(type, param);\n    this.trigger(type + \".\" + key, param);\n    var combi = getCombi(e, key);\n    combi.length > 1 && this.trigger(type + \".\" + combi.join(\".\"), param);\n  };\n\n  return KeyController;\n}(EventEmitter);\n\nexport default KeyController;\nexport { getCombi, getKey, getModifierCombi };\n//# sourceMappingURL=keycon.esm.js.map\n","/*\nCopyright (c) 2020 Daybrush\nname: selecto\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/selecto.git\nversion: 1.26.3\n*/\nimport EventEmitter from '@scena/event-emitter';\nimport Gesto from 'gesto';\nimport { Properties } from 'framework-utils';\nimport { getDocument, hasClass, addClass, calculateBoundSize, getDist, getWindow, isObject, isString, isNode, removeEvent, isFunction, addEvent, isArray, camelize, splitUnit, between } from '@daybrush/utils';\nimport { diff } from '@egjs/children-differ';\nimport DragScroll from '@scena/dragscroll';\nimport KeyController, { getCombi } from 'keycon';\nimport { fitPoints, getOverlapPoints, isInside, getAreaSize } from 'overlap-area';\nimport { createMatrix, getDistElementMatrix, calculateMatrixDist } from 'css-to-mat';\nimport styled from 'css-styled';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\nfunction __decorate(decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\nfunction __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nfunction getClient(e) {\n  if (\"touches\" in e) {\n    var touch = e.touches[0] || e.changedTouches[0];\n    return {\n      clientX: touch.clientX,\n      clientY: touch.clientY\n    };\n  } else {\n    return {\n      clientX: e.clientX,\n      clientY: e.clientY\n    };\n  }\n}\nfunction filterDuplicated(arr) {\n  if (typeof Map === \"undefined\") {\n    return arr.filter(function (value, index) {\n      return arr.indexOf(value) === index;\n    });\n  }\n\n  var map = new Map();\n  return arr.filter(function (value) {\n    if (map.has(value)) {\n      return false;\n    }\n\n    map.set(value, true);\n    return true;\n  });\n}\nfunction elementFromPoint(baseNode, clientX, clientY) {\n  var doc = getDocument(baseNode);\n  return doc.elementFromPoint && doc.elementFromPoint(clientX, clientY) || null;\n}\nfunction createElement(jsx, prevTarget, container) {\n  var tag = jsx.tag,\n      children = jsx.children,\n      attributes = jsx.attributes,\n      className = jsx.className,\n      style = jsx.style;\n  var el = prevTarget || getDocument(container).createElement(tag);\n\n  for (var name in attributes) {\n    el.setAttribute(name, attributes[name]);\n  }\n\n  var elChildren = el.children;\n  children.forEach(function (child, i) {\n    createElement(child, elChildren[i], el);\n  });\n\n  if (className) {\n    className.split(/\\s+/g).forEach(function (name) {\n      if (name && !hasClass(el, name)) {\n        addClass(el, name);\n      }\n    });\n  }\n\n  if (style) {\n    var elStyle = el.style;\n\n    for (var name in style) {\n      elStyle[name] = style[name];\n    }\n  }\n\n  if (!prevTarget && container) {\n    container.appendChild(el);\n  }\n\n  return el;\n}\nfunction h(tag, attrs) {\n  var children = [];\n\n  for (var _i = 2; _i < arguments.length; _i++) {\n    children[_i - 2] = arguments[_i];\n  }\n\n  var _a = attrs || {},\n      _b = _a.className,\n      className = _b === void 0 ? \"\" : _b,\n      _c = _a.style,\n      style = _c === void 0 ? {} : _c,\n      attributes = __rest(_a, [\"className\", \"style\"]);\n\n  return {\n    tag: tag,\n    className: className,\n    style: style,\n    attributes: attributes,\n    children: children\n  };\n}\nfunction diffValue(prev, cur, func) {\n  if (prev !== cur) {\n    func(prev, cur);\n  }\n}\nfunction getRect(e, ratio, boundArea) {\n  var _a;\n\n  if (boundArea === void 0) {\n    boundArea = e.data.boundArea;\n  }\n\n  var _b = e.distX,\n      distX = _b === void 0 ? 0 : _b,\n      _c = e.distY,\n      distY = _c === void 0 ? 0 : _c;\n  var _d = e.data,\n      startX = _d.startX,\n      startY = _d.startY;\n\n  if (ratio > 0) {\n    var nextHeight = Math.sqrt((distX * distX + distY * distY) / (1 + ratio * ratio));\n    var nextWidth = ratio * nextHeight;\n    distX = (distX >= 0 ? 1 : -1) * nextWidth;\n    distY = (distY >= 0 ? 1 : -1) * nextHeight;\n  }\n\n  var width = Math.abs(distX);\n  var height = Math.abs(distY);\n  var maxWidth = distX < 0 ? startX - boundArea.left : boundArea.right - startX;\n  var maxHeight = distY < 0 ? startY - boundArea.top : boundArea.bottom - startY;\n  _a = calculateBoundSize([width, height], [0, 0], [maxWidth, maxHeight], !!ratio), width = _a[0], height = _a[1];\n  distX = (distX >= 0 ? 1 : -1) * width;\n  distY = (distY >= 0 ? 1 : -1) * height;\n  var tx = Math.min(0, distX);\n  var ty = Math.min(0, distY);\n  var left = startX + tx;\n  var top = startY + ty;\n  return {\n    left: left,\n    top: top,\n    right: left + width,\n    bottom: top + height,\n    width: width,\n    height: height\n  };\n}\nfunction getDefaultElementRect(el) {\n  var rect = el.getBoundingClientRect();\n  var left = rect.left,\n      top = rect.top,\n      width = rect.width,\n      height = rect.height;\n  return {\n    pos1: [left, top],\n    pos2: [left + width, top],\n    pos3: [left, top + height],\n    pos4: [left + width, top + height]\n  };\n}\nfunction passTargets(beforeTargets, afterTargets, continueSelectWithoutDeselect) {\n  var _a = diff(beforeTargets, afterTargets),\n      list = _a.list,\n      prevList = _a.prevList,\n      added = _a.added,\n      removed = _a.removed,\n      maintained = _a.maintained;\n\n  return __spreadArray(__spreadArray(__spreadArray([], added.map(function (index) {\n    return list[index];\n  }), true), removed.map(function (index) {\n    return prevList[index];\n  }), true), continueSelectWithoutDeselect ? maintained.map(function (_a) {\n    var nextIndex = _a[1];\n    return list[nextIndex];\n  }) : [], true);\n}\nfunction getLineSize(points) {\n  var size = 0;\n  var length = points.length;\n\n  for (var i = 1; i < length; ++i) {\n    size = Math.max(getDist(points[i], points[i - 1]), size);\n  }\n\n  return size;\n}\n\nvar injector = styled(\"\\n:host {\\n    position: fixed;\\n    display: none;\\n    border: 1px solid #4af;\\n    background: rgba(68, 170, 255, 0.5);\\n    pointer-events: none;\\n    will-change: transform;\\n    z-index: 100;\\n}\\n\");\n/**\n * @memberof Selecto\n */\n\nvar CLASS_NAME = \"selecto-selection \".concat(injector.className);\nvar PROPERTIES = [\"className\", \"boundContainer\", \"selectableTargets\", \"selectByClick\", \"selectFromInside\", \"continueSelect\", \"continueSelectWithoutDeselect\", \"toggleContinueSelect\", \"toggleContinueSelectWithoutDeselect\", \"keyContainer\", \"hitRate\", \"scrollOptions\", \"checkInput\", \"preventDefault\", \"ratio\", \"getElementRect\", \"preventDragFromInside\", \"rootContainer\", \"dragCondition\", \"clickBySelectEnd\", \"checkOverflow\", \"innerScrollOptions\"];\n/**\n * @memberof Selecto\n */\n\nvar OPTIONS = __spreadArray([// ignore target, container,\n\"dragContainer\", \"cspNonce\", \"preventClickEventOnDrag\", \"preventClickEventOnDragStart\", \"preventRightClick\"], PROPERTIES, true);\nvar OPTION_TYPES = {\n  className: String,\n  boundContainer: null,\n  portalContainer: null,\n  container: null,\n  dragContainer: null,\n  selectableTargets: Array,\n  selectByClick: Boolean,\n  selectFromInside: Boolean,\n  continueSelect: Boolean,\n  toggleContinueSelect: Array,\n  toggleContinueSelectWithoutDeselect: Array,\n  keyContainer: null,\n  hitRate: Number,\n  scrollOptions: Object,\n  checkInput: Boolean,\n  preventDefault: Boolean,\n  cspNonce: String,\n  ratio: Number,\n  getElementRect: Function,\n  preventDragFromInside: Boolean,\n  rootContainer: Object,\n  dragCondition: Function,\n  clickBySelectEnd: Boolean,\n  continueSelectWithoutDeselect: Boolean,\n  preventClickEventOnDragStart: Boolean,\n  preventClickEventOnDrag: Boolean,\n  checkOverflow: Boolean,\n  innerScrollOptions: Object\n};\n/**\n * @memberof Selecto\n */\n\nvar EVENTS = [\"dragStart\", \"drag\", \"dragEnd\", \"selectStart\", \"select\", \"selectEnd\", \"keydown\", \"keyup\", \"scroll\", \"innerScroll\"];\n/**\n * @memberof Selecto\n */\n\nvar METHODS = [\"clickTarget\", \"getSelectableElements\", \"setSelectedTargets\", \"getElementPoints\", \"getSelectedTargets\", \"findSelectableTargets\", \"triggerDragStart\", \"checkScroll\", \"selectTargetsByPoints\", \"setSelectedTargetsByPoints\"];\n\n/**\n * Selecto.js is a component that allows you to select elements in the drag area using the mouse or touch.\n * @sort 1\n * @extends EventEmitter\n */\n\nvar Selecto =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(Selecto, _super);\n  /**\n   *\n   */\n\n\n  function Selecto(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.selectedTargets = [];\n    _this.dragScroll = new DragScroll();\n\n    _this._onDragStart = function (e, clickedTarget) {\n      var data = e.data,\n          clientX = e.clientX,\n          clientY = e.clientY,\n          inputEvent = e.inputEvent;\n      var _a = _this.options,\n          selectFromInside = _a.selectFromInside,\n          selectByClick = _a.selectByClick,\n          rootContainer = _a.rootContainer,\n          boundContainer = _a.boundContainer,\n          _b = _a.preventDragFromInside,\n          preventDragFromInside = _b === void 0 ? true : _b,\n          clickBySelectEnd = _a.clickBySelectEnd,\n          dragCondition = _a.dragCondition;\n\n      if (dragCondition && !dragCondition(e)) {\n        e.stop();\n        return;\n      }\n\n      data.data = {};\n      var win = getWindow(_this.container);\n      data.innerWidth = win.innerWidth;\n      data.innerHeight = win.innerHeight;\n\n      _this.findSelectableTargets(data);\n\n      data.startSelectedTargets = _this.selectedTargets;\n      data.scaleMatrix = createMatrix();\n      data.containerX = 0;\n      data.containerY = 0;\n      var container = _this.container;\n      var boundArea = {\n        left: -Infinity,\n        top: -Infinity,\n        right: Infinity,\n        bottom: Infinity\n      };\n\n      if (rootContainer) {\n        var containerRect = _this.container.getBoundingClientRect();\n\n        data.containerX = containerRect.left;\n        data.containerY = containerRect.top;\n        data.scaleMatrix = getDistElementMatrix(_this.container, rootContainer);\n      }\n\n      if (boundContainer) {\n        var boundInfo = isObject(boundContainer) && \"element\" in boundContainer ? __assign({\n          left: true,\n          top: true,\n          bottom: true,\n          right: true\n        }, boundContainer) : {\n          element: boundContainer,\n          left: true,\n          top: true,\n          bottom: true,\n          right: true\n        };\n        var boundElement = boundInfo.element;\n        var rectElement = void 0;\n\n        if (boundElement) {\n          if (isString(boundElement)) {\n            rectElement = getDocument(container).querySelector(boundElement);\n          } else if (boundElement === true) {\n            rectElement = _this.container;\n          } else {\n            rectElement = boundElement;\n          }\n\n          var rect = rectElement.getBoundingClientRect();\n\n          if (boundInfo.left) {\n            boundArea.left = rect.left;\n          }\n\n          if (boundInfo.top) {\n            boundArea.top = rect.top;\n          }\n\n          if (boundInfo.right) {\n            boundArea.right = rect.right;\n          }\n\n          if (boundInfo.bottom) {\n            boundArea.bottom = rect.bottom;\n          }\n        }\n      }\n\n      data.boundArea = boundArea;\n      var hitRect = {\n        left: clientX,\n        top: clientY,\n        right: clientX,\n        bottom: clientY,\n        width: 0,\n        height: 0\n      };\n      var firstPassedTargets = []; // allow click on select\n\n      var allowClickBySelectEnd = selectByClick && !clickBySelectEnd;\n      var hasInsideTargets = false;\n\n      if (!selectFromInside || allowClickBySelectEnd) {\n        var pointTarget = _this._findElement(clickedTarget || inputEvent.target, // elementFromPoint(clientX, clientY),\n        data.selectableTargets);\n\n        hasInsideTargets = !!pointTarget;\n\n        if (allowClickBySelectEnd) {\n          firstPassedTargets = pointTarget ? [pointTarget] : [];\n        }\n      }\n\n      var isPreventSelect = !selectFromInside && hasInsideTargets; // prevent drag from inside when selectByClick is false\n\n      if (isPreventSelect && !selectByClick) {\n        e.stop();\n        return false;\n      }\n\n      var type = inputEvent.type;\n      var isTrusted = type === \"mousedown\" || type === \"touchstart\";\n      /**\n       * When the drag starts (triggers on mousedown or touchstart), the dragStart event is called.\n       * Call the stop () function if you have a specific element or don't want to raise a select\n       * @memberof Selecto\n       * @event dragStart\n       * @param {OnDragStart} - Parameters for the dragStart event\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   selectByClick: true,\n       *   selectFromInside: false,\n       * });\n       *\n       * selecto.on(\"dragStart\", e => {\n       *   if (e.inputEvent.target.tagName === \"SPAN\") {\n       *     e.stop();\n       *   }\n       * }).on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n\n      var result = !e.isClick && isTrusted ? _this.emit(\"dragStart\", __assign(__assign({}, e), {\n        data: data.data\n      })) : true;\n\n      if (!result) {\n        e.stop();\n        return false;\n      }\n\n      if (_this.continueSelect) {\n        firstPassedTargets = passTargets(_this.selectedTargets, firstPassedTargets, _this.continueSelectWithoutDeselect);\n        data.startPassedTargets = _this.selectedTargets;\n      } else {\n        data.startPassedTargets = [];\n      }\n\n      _this._select(firstPassedTargets, hitRect, e, true, isPreventSelect && selectByClick && !clickBySelectEnd && preventDragFromInside);\n\n      data.startX = clientX;\n      data.startY = clientY;\n      data.selectFlag = false;\n      data.preventDragFromInside = false;\n\n      if (inputEvent.target) {\n        var offsetPos = calculateMatrixDist(data.scaleMatrix, [clientX - data.containerX, clientY - data.containerY]);\n        _this.target.style.cssText += \"position: \".concat(rootContainer ? \"absolute\" : \"fixed\", \";\") + \"left:0px;top:0px;\" + \"transform: translate(\".concat(offsetPos[0], \"px, \").concat(offsetPos[1], \"px)\");\n      }\n\n      if (isPreventSelect && selectByClick && !clickBySelectEnd) {\n        inputEvent.preventDefault(); // prevent drag from inside when selectByClick is true and force call `selectEnd`\n\n        if (preventDragFromInside) {\n          _this._selectEnd(data.startSelectedTargets, data.startPassedTargets, hitRect, e, true);\n\n          data.preventDragFromInside = true;\n        }\n      } else {\n        data.selectFlag = true; // why?\n        // if (type === \"touchstart\") {\n        //     inputEvent.preventDefault();\n        // }\n\n        var _c = _this.options,\n            scrollOptions = _c.scrollOptions,\n            innerScrollOptions = _c.innerScrollOptions;\n        var isInnerScroll = false;\n\n        if (innerScrollOptions) {\n          var inputEvent_1 = e.inputEvent;\n          var target = inputEvent_1.target;\n          var innerScrollElement = null;\n          var parentElement = target;\n\n          while (parentElement && parentElement !== getDocument(container).body) {\n            var overflow = getComputedStyle(parentElement).overflow !== \"visible\";\n\n            if (overflow) {\n              innerScrollElement = parentElement;\n              break;\n            }\n\n            parentElement = parentElement.parentElement;\n          }\n\n          if (innerScrollElement) {\n            data.innerScrollOptions = __assign({\n              container: innerScrollElement,\n              checkScrollEvent: true\n            }, innerScrollOptions === true ? {} : innerScrollOptions);\n\n            _this.dragScroll.dragStart(e, data.innerScrollOptions);\n\n            isInnerScroll = true;\n          }\n        }\n\n        if (!isInnerScroll && scrollOptions && scrollOptions.container) {\n          _this.dragScroll.dragStart(e, scrollOptions);\n        }\n\n        if (isPreventSelect && selectByClick && clickBySelectEnd) {\n          data.selectFlag = false;\n          e.preventDrag();\n        }\n      }\n\n      return true;\n    };\n\n    _this._onDrag = function (e) {\n      if (e.data.selectFlag) {\n        var scrollOptions = _this.scrollOptions;\n        var innerScrollOptions = e.data.innerScrollOptions;\n        var hasScrollOptions = innerScrollOptions || (scrollOptions === null || scrollOptions === void 0 ? void 0 : scrollOptions.container); // If it is a scrolling position, pass drag\n\n        if (hasScrollOptions && !e.isScroll && _this.dragScroll.drag(e, innerScrollOptions || scrollOptions)) {\n          return;\n        }\n      }\n\n      _this._checkSelected(e);\n    };\n\n    _this._onDragEnd = function (e) {\n      var data = e.data,\n          inputEvent = e.inputEvent;\n      var rect = getRect(e, _this.options.ratio);\n      var selectFlag = data.selectFlag;\n      var container = _this.container;\n      /**\n       * When the drag ends (triggers on mouseup or touchend after drag), the dragEnd event is called.\n       * @memberof Selecto\n       * @event dragEnd\n       * @param {OnDragEnd} - Parameters for the dragEnd event\n       */\n\n      if (inputEvent) {\n        _this.emit(\"dragEnd\", __assign(__assign({\n          isDouble: !!e.isDouble,\n          isClick: !!e.isClick,\n          isDrag: false,\n          isSelect: selectFlag\n        }, e), {\n          data: data.data,\n          rect: rect\n        }));\n      }\n\n      _this.target.style.cssText += \"display: none;\";\n\n      if (selectFlag) {\n        data.selectFlag = false;\n\n        _this.dragScroll.dragEnd();\n      } else if (_this.selectByClick && _this.clickBySelectEnd) {\n        // only clickBySelectEnd\n        var pointTarget = _this._findElement((inputEvent === null || inputEvent === void 0 ? void 0 : inputEvent.target) || elementFromPoint(container, e.clientX, e.clientY), data.selectableTargets);\n\n        _this._select(pointTarget ? [pointTarget] : [], rect, e);\n      }\n\n      if (!data.preventDragFromInside) {\n        _this._selectEnd(data.startSelectedTargets, data.startPassedTargets, rect, e);\n      }\n    };\n\n    _this._onKeyDown = function (e) {\n      var options = _this.options;\n      var isKeyDown = false;\n\n      if (!_this._keydownContinueSelect) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelect);\n\n        _this._keydownContinueSelect = result;\n        isKeyDown || (isKeyDown = result);\n      }\n\n      if (!_this._keydownContinueSelectWithoutDeselection) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelectWithoutDeselect);\n\n        _this._keydownContinueSelectWithoutDeselection = result;\n        isKeyDown || (isKeyDown = result);\n      }\n\n      if (!isKeyDown) {\n        return;\n      }\n      /**\n       * When you keydown the key you specified in toggleContinueSelect, the keydown event is called.\n       * @memberof Selecto\n       * @event keydown\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   toggleContinueSelect: \"shift\";\n       *   keyContainer: window,\n       * });\n       *\n       * selecto.on(\"keydown\", () => {\n       *   document.querySelector(\".button\").classList.add(\"selected\");\n       * }).on(\"keyup\", () => {\n       *   document.querySelector(\".button\").classList.remove(\"selected\");\n       * }).on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n\n\n      _this.emit(\"keydown\", {\n        keydownContinueSelect: _this._keydownContinueSelect,\n        keydownContinueSelectWithoutDeselection: _this._keydownContinueSelectWithoutDeselection\n      });\n    };\n\n    _this._onKeyUp = function (e) {\n      var options = _this.options;\n      var isKeyUp = false;\n\n      if (_this._keydownContinueSelect) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelect, true);\n\n        _this._keydownContinueSelect = !result;\n        isKeyUp || (isKeyUp = result);\n      }\n\n      if (_this._keydownContinueSelectWithoutDeselection) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelectWithoutDeselect, true);\n\n        _this._keydownContinueSelectWithoutDeselection = !result;\n        isKeyUp || (isKeyUp = result);\n      }\n\n      if (!isKeyUp) {\n        return;\n      }\n      /**\n       * When you keyup the key you specified in toggleContinueSelect, the keyup event is called.\n       * @memberof Selecto\n       * @event keyup\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   toggleContinueSelect: \"shift\";\n       *   keyContainer: window,\n       * });\n       *\n       * selecto.on(\"keydown\", () => {\n       *   document.querySelector(\".button\").classList.add(\"selected\");\n       * }).on(\"keyup\", () => {\n       *   document.querySelector(\".button\").classList.remove(\"selected\");\n       * }).on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n\n\n      _this.emit(\"keyup\", {\n        keydownContinueSelect: _this._keydownContinueSelect,\n        keydownContinueSelectWithoutDeselection: _this._keydownContinueSelectWithoutDeselection\n      });\n    };\n\n    _this._onBlur = function () {\n      if (_this._keydownContinueSelect || _this._keydownContinueSelectWithoutDeselection) {\n        _this._keydownContinueSelect = false;\n        _this._keydownContinueSelectWithoutDeselection = false;\n\n        _this.emit(\"keyup\", {\n          keydownContinueSelect: _this._keydownContinueSelect,\n          keydownContinueSelectWithoutDeselection: _this._keydownContinueSelectWithoutDeselection\n        });\n      }\n    };\n\n    _this._onDocumentSelectStart = function (e) {\n      var doc = getDocument(_this.container);\n\n      if (!_this.gesto.isFlag()) {\n        return;\n      }\n\n      var dragContainer = _this.dragContainer;\n\n      if (dragContainer === getWindow(_this.container)) {\n        dragContainer = doc.documentElement;\n      }\n\n      var containers = isNode(dragContainer) ? [dragContainer] : [].slice.call(dragContainer);\n      var target = e.target;\n      containers.some(function (container) {\n        if (container === target || container.contains(target)) {\n          e.preventDefault();\n          return true;\n        }\n      });\n    };\n\n    _this.target = options.portalContainer;\n    var container = options.container;\n    _this.options = __assign({\n      className: \"\",\n      portalContainer: null,\n      container: null,\n      dragContainer: null,\n      selectableTargets: [],\n      selectByClick: true,\n      selectFromInside: true,\n      clickBySelectEnd: false,\n      hitRate: 100,\n      continueSelect: false,\n      continueSelectWithoutDeselect: false,\n      toggleContinueSelect: null,\n      toggleContinueSelectWithoutDeselect: null,\n      keyContainer: null,\n      scrollOptions: null,\n      checkInput: false,\n      preventDefault: false,\n      boundContainer: false,\n      preventDragFromInside: true,\n      dragCondition: null,\n      rootContainer: null,\n      checkOverflow: false,\n      innerScrollOptions: false,\n      getElementRect: getDefaultElementRect,\n      cspNonce: \"\",\n      ratio: 0\n    }, options);\n    var portalContainer = _this.options.portalContainer;\n\n    if (portalContainer) {\n      container = portalContainer.parentElement;\n    }\n\n    _this.container = container || document.body;\n\n    _this.initElement();\n\n    _this.initDragScroll();\n\n    _this.setKeyController();\n\n    return _this;\n  }\n  /**\n   * You can set the currently selected targets.\n   * selectByClick, continueSelect, and continueSelectWithoutDeselect are not applied.\n   */\n\n\n  var __proto = Selecto.prototype;\n\n  __proto.setSelectedTargets = function (selectedTargets) {\n    var beforeSelected = this.selectedTargets;\n\n    var _a = diff(beforeSelected, selectedTargets),\n        added = _a.added,\n        removed = _a.removed,\n        prevList = _a.prevList,\n        list = _a.list;\n\n    this.selectedTargets = selectedTargets;\n    return {\n      added: added.map(function (index) {\n        return list[index];\n      }),\n      removed: removed.map(function (index) {\n        return prevList[index];\n      }),\n      beforeSelected: beforeSelected,\n      selected: selectedTargets\n    };\n  };\n  /**\n   * You can set the currently selected targets by points\n   * selectByClick, continueSelect, and continueSelectWithoutDeselect are not applied.\n   */\n\n\n  __proto.setSelectedTargetsByPoints = function (point1, point2) {\n    var left = Math.min(point1[0], point2[0]);\n    var top = Math.min(point1[1], point2[1]);\n    var right = Math.max(point1[0], point2[0]);\n    var bottom = Math.max(point1[1], point2[1]);\n    var rect = {\n      left: left,\n      top: top,\n      right: right,\n      bottom: bottom,\n      width: right - left,\n      height: bottom - top\n    };\n    var data = {\n      ignoreClick: true\n    };\n    this.findSelectableTargets(data);\n    var selectedElements = this.hitTest(rect, data, true, null);\n    var result = this.setSelectedTargets(selectedElements);\n    return __assign(__assign({}, result), {\n      rect: rect\n    });\n  };\n  /**\n   * Select target by virtual drag from startPoint to endPoint.\n   * The target of inputEvent is null.\n   */\n\n\n  __proto.selectTargetsByPoints = function (startPoint, endPoint) {\n    var mousedown = new MouseEvent(\"mousedown\", {\n      clientX: startPoint[0],\n      clientY: startPoint[1],\n      cancelable: true,\n      bubbles: true\n    });\n    var mousemove = new MouseEvent(\"mousemove\", {\n      clientX: endPoint[0],\n      clientY: endPoint[1],\n      cancelable: true,\n      bubbles: true\n    });\n    var mouseup = new MouseEvent(\"mousemove\", {\n      clientX: endPoint[0],\n      clientY: endPoint[1],\n      cancelable: true,\n      bubbles: true\n    });\n    var gesto = this.gesto;\n    var result = gesto.onDragStart(mousedown);\n\n    if (result !== false) {\n      gesto.onDrag(mousemove);\n      gesto.onDragEnd(mouseup);\n    }\n  };\n  /**\n   * You can get the currently selected targets.\n   */\n\n\n  __proto.getSelectedTargets = function () {\n    return this.selectedTargets;\n  };\n  /**\n   * `OnDragStart` is triggered by an external event.\n   * @param - external event\n   * @example\n   * import Selecto from \"selecto\";\n   *\n   * const selecto = new Selecto();\n   *\n   * window.addEventListener(\"mousedown\", e => {\n   *   selecto.triggerDragStart(e);\n   * });\n   */\n\n\n  __proto.triggerDragStart = function (e) {\n    this.gesto.triggerDragStart(e);\n    return this;\n  };\n  /**\n   * Destroy elements, properties, and events.\n   */\n\n\n  __proto.destroy = function () {\n    var _a;\n\n    this.off();\n    this.keycon && this.keycon.destroy();\n    this.gesto.unset();\n    this.injectResult.destroy();\n    this.dragScroll.dragEnd();\n    removeEvent(document, \"selectstart\", this._onDocumentSelectStart);\n\n    if (!this.options.portalContainer) {\n      (_a = this.target.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(this.target);\n    }\n\n    this.keycon = null;\n    this.gesto = null;\n    this.injectResult = null;\n    this.target = null;\n    this.container = null;\n    this.options = null;\n  };\n\n  __proto.getElementPoints = function (target) {\n    var getElementRect = this.getElementRect || getDefaultElementRect;\n    var info = getElementRect(target);\n    var points = [info.pos1, info.pos2, info.pos4, info.pos3];\n\n    if (getElementRect !== getDefaultElementRect) {\n      var rect = target.getBoundingClientRect();\n      return fitPoints(points, rect);\n    }\n\n    return points;\n  };\n  /**\n   * Get all elements set in `selectableTargets`.\n   */\n\n\n  __proto.getSelectableElements = function () {\n    var container = this.container;\n    var selectableElements = [];\n    this.options.selectableTargets.forEach(function (target) {\n      if (isFunction(target)) {\n        var result = target();\n\n        if (result) {\n          selectableElements.push.apply(selectableElements, [].slice.call(result));\n        }\n      } else if (isNode(target)) {\n        selectableElements.push(target);\n      } else if (isObject(target)) {\n        selectableElements.push(target.value || target.current);\n      } else {\n        var elements = [].slice.call(getDocument(container).querySelectorAll(target));\n        selectableElements.push.apply(selectableElements, elements);\n      }\n    });\n    return selectableElements;\n  };\n  /**\n   * If scroll occurs during dragging, you can manually call this method to check the position again.\n   */\n\n\n  __proto.checkScroll = function () {\n    if (!this.gesto.isFlag()) {\n      return;\n    }\n\n    var scrollOptions = this.scrollOptions;\n    var innerScrollOptions = this.gesto.getEventData().innerScrollOptions;\n    var hasScrollOptions = innerScrollOptions || (scrollOptions === null || scrollOptions === void 0 ? void 0 : scrollOptions.container); // If it is a scrolling position, pass drag\n\n    if (hasScrollOptions) {\n      this.dragScroll.checkScroll(__assign({\n        inputEvent: this.gesto.getCurrentEvent()\n      }, innerScrollOptions || scrollOptions));\n    }\n  };\n  /**\n   * Find for selectableTargets again during drag event\n   * You can update selectable targets during an event.\n   */\n\n\n  __proto.findSelectableTargets = function (data) {\n    var _this = this;\n\n    if (data === void 0) {\n      data = this.gesto.getEventData();\n    }\n\n    var selectableTargets = this.getSelectableElements();\n    var selectablePoints = selectableTargets.map(function (target) {\n      return _this.getElementPoints(target);\n    });\n    data.selectableTargets = selectableTargets;\n    data.selectablePoints = selectablePoints;\n    data.selectableParentMap = null;\n    var options = this.options;\n    var hasIndexesMap = options.checkOverflow || options.innerScrollOptions;\n    var doc = getDocument(this.container);\n\n    if (hasIndexesMap) {\n      var parentMap_1 = new Map();\n      data.selectableInnerScrollParentMap = parentMap_1;\n      data.selectableInnerScrollPathsList = selectableTargets.map(function (target, index) {\n        var parentElement = target.parentElement;\n        var parents = [];\n        var paths = [];\n\n        var _loop_1 = function () {\n          var info = parentMap_1.get(parentElement);\n\n          if (!info) {\n            var overflow = getComputedStyle(parentElement).overflow !== \"visible\";\n\n            if (overflow) {\n              var rect = getDefaultElementRect(parentElement);\n              info = {\n                parentElement: parentElement,\n                indexes: [],\n                points: [rect.pos1, rect.pos2, rect.pos4, rect.pos3],\n                paths: __spreadArray([], paths, true)\n              };\n              parents.push(parentElement);\n              parents.forEach(function (prevParentElement) {\n                parentMap_1.set(prevParentElement, info);\n              });\n              parents = [];\n            }\n          }\n\n          if (info) {\n            parentElement = info.parentElement;\n            parentMap_1.get(parentElement).indexes.push(index);\n            paths.push(parentElement);\n          } else {\n            parents.push(parentElement);\n          }\n\n          parentElement = parentElement.parentElement;\n        };\n\n        while (parentElement && parentElement !== doc.body) {\n          _loop_1();\n        }\n\n        return paths;\n      });\n    }\n\n    if (!options.checkOverflow) {\n      data.selectableInners = selectableTargets.map(function () {\n        return true;\n      });\n    }\n\n    this._refreshGroups(data);\n\n    return selectableTargets;\n  };\n  /**\n   * External click or mouse events can be applied to the selecto.\n   * @params - Extenal click or mouse event\n   * @params - Specify the clicked target directly.\n   */\n\n\n  __proto.clickTarget = function (e, clickedTarget) {\n    var _a = getClient(e),\n        clientX = _a.clientX,\n        clientY = _a.clientY;\n\n    var dragEvent = {\n      data: {\n        selectFlag: false\n      },\n      clientX: clientX,\n      clientY: clientY,\n      inputEvent: e,\n      isClick: true,\n      isTrusted: false,\n      stop: function () {\n        return false;\n      }\n    };\n\n    if (this._onDragStart(dragEvent, clickedTarget)) {\n      this._onDragEnd(dragEvent);\n    }\n\n    return this;\n  };\n\n  __proto.setKeyController = function () {\n    var _a = this.options,\n        keyContainer = _a.keyContainer,\n        toggleContinueSelect = _a.toggleContinueSelect,\n        toggleContinueSelectWithoutDeselect = _a.toggleContinueSelectWithoutDeselect;\n\n    if (this.keycon) {\n      this.keycon.destroy();\n      this.keycon = null;\n    }\n\n    if (toggleContinueSelect || toggleContinueSelectWithoutDeselect) {\n      this.keycon = new KeyController(keyContainer || getWindow(this.container));\n      this.keycon.keydown(this._onKeyDown).keyup(this._onKeyUp).on(\"blur\", this._onBlur);\n    }\n  };\n\n  __proto.setClassName = function (nextClassName) {\n    this.options.className = nextClassName;\n    this.target.setAttribute(\"class\", \"\".concat(CLASS_NAME, \" \").concat(nextClassName || \"\"));\n  };\n\n  __proto.setKeyEvent = function () {\n    var _a = this.options,\n        toggleContinueSelect = _a.toggleContinueSelect,\n        toggleContinueSelectWithoutDeselect = _a.toggleContinueSelectWithoutDeselect;\n\n    if (!toggleContinueSelect && !toggleContinueSelectWithoutDeselect || this.keycon) {\n      return;\n    }\n\n    this.setKeyController();\n  }; // with getter, setter property\n\n\n  __proto.setKeyContainer = function (keyContainer) {\n    var _this = this;\n\n    var options = this.options;\n    diffValue(options.keyContainer, keyContainer, function () {\n      options.keyContainer = keyContainer;\n\n      _this.setKeyController();\n    });\n  };\n\n  __proto.getContinueSelect = function () {\n    var _a = this.options,\n        continueSelect = _a.continueSelect,\n        toggleContinueSelect = _a.toggleContinueSelect;\n\n    if (!toggleContinueSelect || !this._keydownContinueSelect) {\n      return continueSelect;\n    }\n\n    return !continueSelect;\n  };\n\n  __proto.getContinueSelectWithoutDeselect = function () {\n    var _a = this.options,\n        continueSelectWithoutDeselect = _a.continueSelectWithoutDeselect,\n        toggleContinueSelectWithoutDeselect = _a.toggleContinueSelectWithoutDeselect;\n\n    if (!toggleContinueSelectWithoutDeselect || !this._keydownContinueSelectWithoutDeselection) {\n      return continueSelectWithoutDeselect;\n    }\n\n    return !continueSelectWithoutDeselect;\n  };\n\n  __proto.setToggleContinueSelect = function (toggleContinueSelect) {\n    var _this = this;\n\n    var options = this.options;\n    diffValue(options.toggleContinueSelect, toggleContinueSelect, function () {\n      options.toggleContinueSelect = toggleContinueSelect;\n\n      _this.setKeyEvent();\n    });\n  };\n\n  __proto.setToggleContinueSelectWithoutDeselect = function (toggleContinueSelectWithoutDeselect) {\n    var _this = this;\n\n    var options = this.options;\n    diffValue(options.toggleContinueSelectWithoutDeselect, toggleContinueSelectWithoutDeselect, function () {\n      options.toggleContinueSelectWithoutDeselect = toggleContinueSelectWithoutDeselect;\n\n      _this.setKeyEvent();\n    });\n  };\n\n  __proto.setPreventDefault = function (value) {\n    this.gesto.options.preventDefault = value;\n  };\n\n  __proto.setCheckInput = function (value) {\n    this.gesto.options.checkInput = value;\n  };\n\n  __proto.initElement = function () {\n    var _a = this.options,\n        dragContainer = _a.dragContainer,\n        checkInput = _a.checkInput,\n        preventDefault = _a.preventDefault,\n        preventClickEventOnDragStart = _a.preventClickEventOnDragStart,\n        preventClickEventOnDrag = _a.preventClickEventOnDrag,\n        preventClickEventByCondition = _a.preventClickEventByCondition,\n        _b = _a.preventRightClick,\n        preventRightClick = _b === void 0 ? true : _b,\n        className = _a.className;\n    var container = this.container;\n    this.target = createElement(h(\"div\", {\n      className: \"\".concat(CLASS_NAME, \" \").concat(className || \"\")\n    }), this.target, container);\n    var target = this.target;\n    this.dragContainer = typeof dragContainer === \"string\" ? [].slice.call(getDocument(container).querySelectorAll(dragContainer)) : dragContainer || this.target.parentNode;\n    this.gesto = new Gesto(this.dragContainer, {\n      checkWindowBlur: true,\n      container: getWindow(container),\n      checkInput: checkInput,\n      preventDefault: preventDefault,\n      preventClickEventOnDragStart: preventClickEventOnDragStart,\n      preventClickEventOnDrag: preventClickEventOnDrag,\n      preventClickEventByCondition: preventClickEventByCondition,\n      preventRightClick: preventRightClick\n    }).on({\n      dragStart: this._onDragStart,\n      drag: this._onDrag,\n      dragEnd: this._onDragEnd\n    });\n    addEvent(document, \"selectstart\", this._onDocumentSelectStart);\n    this.injectResult = injector.inject(target, {\n      nonce: this.options.cspNonce\n    });\n  };\n\n  __proto.hitTest = function (selectRect, data, isDrag, gestoEvent) {\n    var _a = this.options,\n        hitRate = _a.hitRate,\n        selectByClick = _a.selectByClick;\n    var left = selectRect.left,\n        top = selectRect.top,\n        right = selectRect.right,\n        bottom = selectRect.bottom;\n    var innerGroups = data.innerGroups;\n    var innerWidth = data.innerWidth;\n    var innerHeight = data.innerHeight;\n    var clientX = gestoEvent === null || gestoEvent === void 0 ? void 0 : gestoEvent.clientX;\n    var clientY = gestoEvent === null || gestoEvent === void 0 ? void 0 : gestoEvent.clientY;\n    var ignoreClick = data.ignoreClick;\n    var rectPoints = [[left, top], [right, top], [right, bottom], [left, bottom]];\n\n    var isHit = function (points, el) {\n      var hitRateValue = typeof hitRate === \"function\" ? splitUnit(\"\".concat(hitRate(el))) : splitUnit(\"\".concat(hitRate));\n      var inArea = ignoreClick ? false : isInside([clientX, clientY], points);\n\n      if (!isDrag && selectByClick && inArea) {\n        return true;\n      }\n\n      var overlapPoints = getOverlapPoints(rectPoints, points);\n\n      if (!overlapPoints.length) {\n        return false;\n      }\n\n      var overlapSize = getAreaSize(overlapPoints); // Line\n\n      var targetSize = 0;\n\n      if (overlapSize === 0 && getAreaSize(points) === 0) {\n        targetSize = getLineSize(points);\n        overlapSize = getLineSize(overlapPoints);\n      } else {\n        targetSize = getAreaSize(points);\n      }\n\n      if (hitRateValue.unit === \"px\") {\n        return overlapSize >= hitRateValue.value;\n      } else {\n        var rate = between(Math.round(overlapSize / targetSize * 100), 0, 100);\n        return rate >= Math.min(100, hitRateValue.value);\n      }\n    };\n\n    var selectableTargets = data.selectableTargets;\n    var selectablePoints = data.selectablePoints;\n    var selectableInners = data.selectableInners;\n\n    if (!innerGroups) {\n      return selectableTargets.filter(function (_, i) {\n        if (!selectableInners[i]) {\n          return false;\n        }\n\n        return isHit(selectablePoints[i], selectableTargets[i]);\n      });\n    }\n\n    var selectedTargets = [];\n    var minX = Math.floor(left / innerWidth);\n    var maxX = Math.floor(right / innerWidth);\n    var minY = Math.floor(top / innerHeight);\n    var maxY = Math.floor(bottom / innerHeight);\n\n    for (var x = minX; x <= maxX; ++x) {\n      var yGroups = innerGroups[x];\n\n      if (!yGroups) {\n        continue;\n      }\n\n      for (var y = minY; y <= maxY; ++y) {\n        var group = yGroups[y];\n\n        if (!group) {\n          continue;\n        }\n\n        group.forEach(function (index) {\n          var points = selectablePoints[index];\n          var inner = selectableInners[index];\n          var target = selectableTargets[index];\n\n          if (inner && isHit(points, target)) {\n            selectedTargets.push(target);\n          }\n        });\n      }\n    }\n\n    return filterDuplicated(selectedTargets);\n  };\n\n  __proto.initDragScroll = function () {\n    var _this = this;\n\n    this.dragScroll.on(\"scrollDrag\", function (_a) {\n      var next = _a.next;\n      next(_this.gesto.getCurrentEvent());\n    }).on(\"scroll\", function (_a) {\n      var container = _a.container,\n          direction = _a.direction;\n\n      var innerScrollOptions = _this.gesto.getEventData().innerScrollOptions;\n\n      if (innerScrollOptions) {\n        _this.emit(\"innerScroll\", {\n          container: container,\n          direction: direction\n        });\n      } else {\n        _this.emit(\"scroll\", {\n          container: container,\n          direction: direction\n        });\n      }\n    }).on(\"move\", function (_a) {\n      var offsetX = _a.offsetX,\n          offsetY = _a.offsetY,\n          inputEvent = _a.inputEvent;\n      var gesto = _this.gesto;\n\n      if (!gesto || !gesto.isFlag()) {\n        return;\n      }\n\n      var data = _this.gesto.getEventData();\n\n      var boundArea = data.boundArea;\n      data.startX -= offsetX;\n      data.startY -= offsetY;\n\n      var innerScrollOptions = _this.gesto.getEventData().innerScrollOptions;\n\n      var container = innerScrollOptions === null || innerScrollOptions === void 0 ? void 0 : innerScrollOptions.container;\n      var isMoveInnerScroll = false;\n\n      if (container) {\n        var parentMap_2 = data.selectableInnerScrollParentMap;\n        var parentInfo = parentMap_2.get(container);\n\n        if (parentInfo) {\n          parentInfo.paths.forEach(function (scrollContainer) {\n            var containerInfo = parentMap_2.get(scrollContainer);\n            containerInfo.points.forEach(function (pos) {\n              pos[0] -= offsetX;\n              pos[1] -= offsetY;\n            });\n          });\n          parentInfo.indexes.forEach(function (index) {\n            data.selectablePoints[index].forEach(function (pos) {\n              pos[0] -= offsetX;\n              pos[1] -= offsetY;\n            });\n          });\n          isMoveInnerScroll = true;\n        }\n      }\n\n      if (!isMoveInnerScroll) {\n        data.selectablePoints.forEach(function (points) {\n          points.forEach(function (pos) {\n            pos[0] -= offsetX;\n            pos[1] -= offsetY;\n          });\n        });\n      }\n\n      _this._refreshGroups(data);\n\n      boundArea.left -= offsetX;\n      boundArea.right -= offsetX;\n      boundArea.top -= offsetY;\n      boundArea.bottom -= offsetY;\n\n      _this.gesto.scrollBy(offsetX, offsetY, inputEvent.inputEvent);\n\n      _this._checkSelected(_this.gesto.getCurrentEvent());\n    });\n  };\n\n  __proto._select = function (selectedTargets, rect, e, isStart, isDragStartEnd) {\n    if (isDragStartEnd === void 0) {\n      isDragStartEnd = false;\n    }\n\n    var inputEvent = e.inputEvent;\n    var data = e.data;\n    var result = this.setSelectedTargets(selectedTargets);\n\n    var _a = diff(data.startSelectedTargets, selectedTargets),\n        added = _a.added,\n        removed = _a.removed,\n        prevList = _a.prevList,\n        list = _a.list;\n\n    var startResult = {\n      startSelected: prevList,\n      startAdded: added.map(function (i) {\n        return list[i];\n      }),\n      startRemoved: removed.map(function (i) {\n        return prevList[i];\n      })\n    };\n\n    if (isStart) {\n      /**\n       * When the select(drag) starts, the selectStart event is called.\n       * @memberof Selecto\n       * @event selectStart\n       * @param {Selecto.OnSelect} - Parameters for the selectStart event\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   selectByClick: true,\n       *   selectFromInside: false,\n       * });\n       *\n       * selecto.on(\"selectStart\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * }).on(\"selectEnd\", e => {\n       *   e.afterAdded.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.afterRemoved.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n      this.emit(\"selectStart\", __assign(__assign(__assign({}, result), startResult), {\n        rect: rect,\n        inputEvent: inputEvent,\n        data: data.data,\n        isTrusted: e.isTrusted,\n        isDragStartEnd: isDragStartEnd\n      }));\n    }\n\n    if (result.added.length || result.removed.length) {\n      /**\n       * When the select in real time, the select event is called.\n       * @memberof Selecto\n       * @event select\n       * @param {Selecto.OnSelect} - Parameters for the select event\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   selectByClick: true,\n       *   selectFromInside: false,\n       * });\n       *\n       * selecto.on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n      this.emit(\"select\", __assign(__assign(__assign({}, result), startResult), {\n        rect: rect,\n        inputEvent: inputEvent,\n        data: data.data,\n        isTrusted: e.isTrusted,\n        isDragStartEnd: isDragStartEnd\n      }));\n    }\n  };\n\n  __proto._selectEnd = function (startSelectedTargets, startPassedTargets, rect, e, isDragStartEnd) {\n    if (isDragStartEnd === void 0) {\n      isDragStartEnd = false;\n    }\n\n    var inputEvent = e.inputEvent,\n        isDouble = e.isDouble,\n        data = e.data;\n    var type = inputEvent && inputEvent.type;\n    var isDragStart = type === \"mousedown\" || type === \"touchstart\";\n\n    var _a = diff(startSelectedTargets, this.selectedTargets),\n        added = _a.added,\n        removed = _a.removed,\n        prevList = _a.prevList,\n        list = _a.list;\n\n    var _b = diff(startPassedTargets, this.selectedTargets),\n        afterAdded = _b.added,\n        afterRemoved = _b.removed,\n        afterPrevList = _b.prevList,\n        afterList = _b.list;\n    /**\n     * When the select(dragEnd or click) ends, the selectEnd event is called.\n     * @memberof Selecto\n     * @event selectEnd\n     * @param {Selecto.OnSelectEnd} - Parameters for the selectEnd event\n     * @example\n     * import Selecto from \"selecto\";\n     *\n     * const selecto = new Selecto({\n     *   container: document.body,\n     *   selectByClick: true,\n     *   selectFromInside: false,\n     * });\n     *\n     * selecto.on(\"selectStart\", e => {\n     *   e.added.forEach(el => {\n     *     el.classList.add(\"selected\");\n     *   });\n     *   e.removed.forEach(el => {\n     *     el.classList.remove(\"selected\");\n     *   });\n     * }).on(\"selectEnd\", e => {\n     *   e.afterAdded.forEach(el => {\n     *     el.classList.add(\"selected\");\n     *   });\n     *   e.afterRemoved.forEach(el => {\n     *     el.classList.remove(\"selected\");\n     *   });\n     * });\n     */\n\n\n    this.emit(\"selectEnd\", {\n      startSelected: startSelectedTargets,\n      beforeSelected: startPassedTargets,\n      selected: this.selectedTargets,\n      added: added.map(function (index) {\n        return list[index];\n      }),\n      removed: removed.map(function (index) {\n        return prevList[index];\n      }),\n      afterAdded: afterAdded.map(function (index) {\n        return afterList[index];\n      }),\n      afterRemoved: afterRemoved.map(function (index) {\n        return afterPrevList[index];\n      }),\n      isDragStart: isDragStart && isDragStartEnd,\n      isDragStartEnd: isDragStart && isDragStartEnd,\n      isClick: !!e.isClick,\n      isDouble: !!isDouble,\n      rect: rect,\n      inputEvent: inputEvent,\n      data: data.data,\n      isTrusted: e.isTrusted\n    });\n  };\n\n  __proto._checkSelected = function (e, rect) {\n    if (rect === void 0) {\n      rect = getRect(e, this.options.ratio);\n    }\n\n    var data = e.data;\n    var top = rect.top,\n        left = rect.left,\n        width = rect.width,\n        height = rect.height;\n    var selectFlag = data.selectFlag;\n    var containerX = data.containerX,\n        containerY = data.containerY,\n        scaleMatrix = data.scaleMatrix;\n    var offsetPos = calculateMatrixDist(scaleMatrix, [left - containerX, top - containerY]);\n    var offsetSize = calculateMatrixDist(scaleMatrix, [width, height]);\n    var selectedTargets = [];\n\n    if (selectFlag) {\n      this.target.style.cssText += \"display: block;\" + \"left:0px;top:0px;\" + \"transform: translate(\".concat(offsetPos[0], \"px, \").concat(offsetPos[1], \"px);\") + \"width:\".concat(offsetSize[0], \"px;height:\").concat(offsetSize[1], \"px;\");\n      var passedTargets = this.hitTest(rect, data, true, e);\n      selectedTargets = passTargets(data.startPassedTargets, passedTargets, this.continueSelect && this.continueSelectWithoutDeselect);\n    }\n    /**\n     * When the drag, the drag event is called.\n     * Call the stop () function if you have a specific element or don't want to raise a select\n     * @memberof Selecto\n     * @event drag\n     * @param {OnDrag} - Parameters for the drag event\n     * @example\n     * import Selecto from \"selecto\";\n     *\n     * const selecto = new Selecto({\n     *   container: document.body,\n     *   selectByClick: true,\n     *   selectFromInside: false,\n     * });\n     *\n     * selecto.on(\"drag\", e => {\n     *   e.stop();\n     * }).on(\"select\", e => {\n     *   e.added.forEach(el => {\n     *     el.classList.add(\"selected\");\n     *   });\n     *   e.removed.forEach(el => {\n     *     el.classList.remove(\"selected\");\n     *   });\n     * });\n     */\n\n\n    var result = this.emit(\"drag\", __assign(__assign({}, e), {\n      data: data.data,\n      isSelect: selectFlag,\n      rect: rect\n    }));\n\n    if (result === false) {\n      this.target.style.cssText += \"display: none;\";\n      e.stop();\n      return;\n    }\n\n    if (selectFlag) {\n      this._select(selectedTargets, rect, e);\n    }\n  };\n\n  __proto._sameCombiKey = function (e, keys, isKeyup) {\n    if (!keys) {\n      return false;\n    }\n\n    var combi = getCombi(e.inputEvent, e.key);\n    var nextKeys = [].concat(keys);\n    var toggleKeys = isArray(nextKeys[0]) ? nextKeys : [nextKeys];\n\n    if (isKeyup) {\n      var singleKey_1 = e.key;\n      return toggleKeys.some(function (keys) {\n        return keys.some(function (key) {\n          return key === singleKey_1;\n        });\n      });\n    }\n\n    return toggleKeys.some(function (keys) {\n      return keys.every(function (key) {\n        return combi.indexOf(key) > -1;\n      });\n    });\n  };\n\n  __proto._findElement = function (clickedTarget, selectableTargets) {\n    var pointTarget = clickedTarget;\n\n    while (pointTarget) {\n      if (selectableTargets.indexOf(pointTarget) > -1) {\n        break;\n      }\n\n      pointTarget = pointTarget.parentElement;\n    }\n\n    return pointTarget;\n  };\n\n  __proto._refreshGroups = function (data) {\n    var _a;\n\n    var innerWidth = data.innerWidth;\n    var innerHeight = data.innerHeight;\n    var selectablePoints = data.selectablePoints;\n\n    if (this.options.checkOverflow) {\n      var innerScrollContainer_1 = (_a = this.gesto.getEventData().innerScrollOptions) === null || _a === void 0 ? void 0 : _a.container;\n      var parentMap_3 = data.selectableInnerScrollParentMap;\n      var innerScrollPathsList = data.selectableInnerScrollPathsList;\n      data.selectableInners = innerScrollPathsList.map(function (innerScrollPaths, i) {\n        var isAlwaysTrue = false;\n        return innerScrollPaths.every(function (target) {\n          if (isAlwaysTrue) {\n            return true;\n          }\n\n          if (target === innerScrollContainer_1) {\n            isAlwaysTrue = true;\n            return true;\n          }\n\n          var rect = parentMap_3.get(target);\n\n          if (rect) {\n            var points1 = selectablePoints[i];\n            var points2 = rect.points;\n            var overlapPoints = getOverlapPoints(points1, points2);\n\n            if (!overlapPoints.length) {\n              return false;\n            }\n          }\n\n          return true;\n        });\n      });\n    }\n\n    if (!innerWidth || !innerHeight) {\n      data.innerGroups = null;\n    } else {\n      var selectablePoints_1 = data.selectablePoints;\n      var groups_1 = {};\n      selectablePoints_1.forEach(function (points, i) {\n        var minX = Infinity;\n        var maxX = -Infinity;\n        var minY = Infinity;\n        var maxY = -Infinity;\n        points.forEach(function (pos) {\n          var x = Math.floor(pos[0] / innerWidth);\n          var y = Math.floor(pos[1] / innerHeight);\n          minX = Math.min(x, minX);\n          maxX = Math.max(x, maxX);\n          minY = Math.min(y, minY);\n          maxY = Math.max(y, maxY);\n        });\n\n        for (var x = minX; x <= maxX; ++x) {\n          for (var y = minY; y <= maxY; ++y) {\n            groups_1[x] = groups_1[x] || {};\n            groups_1[x][y] = groups_1[x][y] || [];\n            groups_1[x][y].push(i);\n          }\n        }\n      });\n      data.innerGroups = groups_1;\n    }\n  };\n\n  Selecto = __decorate([Properties(PROPERTIES, function (prototype, property) {\n    var attributes = {\n      enumerable: true,\n      configurable: true,\n      get: function () {\n        return this.options[property];\n      }\n    };\n    var getter = camelize(\"get \".concat(property));\n\n    if (prototype[getter]) {\n      attributes.get = function () {\n        return this[getter]();\n      };\n    } else {\n      attributes.get = function () {\n        return this.options[property];\n      };\n    }\n\n    var setter = camelize(\"set \".concat(property));\n\n    if (prototype[setter]) {\n      attributes.set = function (value) {\n        this[setter](value);\n      };\n    } else {\n      attributes.set = function (value) {\n        this.options[property] = value;\n      };\n    }\n\n    Object.defineProperty(prototype, property, attributes);\n  })], Selecto);\n  return Selecto;\n}(EventEmitter);\n\nvar Selecto$1 =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(Selecto, _super);\n\n  function Selecto() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return Selecto;\n}(Selecto);\n\nexport default Selecto$1;\nexport { CLASS_NAME, EVENTS, METHODS, OPTIONS, OPTION_TYPES, PROPERTIES };\n//# sourceMappingURL=selecto.esm.js.map\n","import { css } from '@emotion/css';\nimport { useRef } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\nimport { ConnectionCoordinates } from 'app/features/canvas/element';\n\ntype Props = {\n  setRef: (anchorElement: HTMLDivElement) => void;\n  setAnchorsRef: (anchorsElement: HTMLDivElement) => void;\n  handleMouseLeave: (\n    event: React.MouseEvent<Element, MouseEvent> | React.FocusEvent<HTMLDivElement, Element>\n  ) => boolean;\n};\n\nexport const CONNECTION_ANCHOR_DIV_ID = 'connectionControl';\nexport const CONNECTION_ANCHOR_ALT = 'connection anchor';\nexport const CONNECTION_ANCHOR_HIGHLIGHT_OFFSET = 8;\n// Unit is percentage from the middle of the element\n// 0, 0 middle; -1, -1 bottom left; 1, 1 top right\nexport const ANCHORS = [\n  { x: -1, y: 1 },\n  { x: -0.5, y: 1 },\n  { x: 0, y: 1 },\n  { x: 0.5, y: 1 },\n  { x: 1, y: 1 },\n  { x: 1, y: 0.5 },\n  { x: 1, y: 0 },\n  { x: 1, y: -0.5 },\n  { x: 1, y: -1 },\n  { x: 0.5, y: -1 },\n  { x: 0, y: -1 },\n  { x: -0.5, y: -1 },\n  { x: -1, y: -1 },\n  { x: -1, y: -0.5 },\n  { x: -1, y: 0 },\n  { x: -1, y: 0.5 },\n];\n\nexport const ANCHOR_PADDING = 3;\nexport const HALF_SIZE = 2.5;\n\nexport const ConnectionAnchors = ({ setRef, setAnchorsRef, handleMouseLeave }: Props) => {\n  const highlightEllipseRef = useRef<HTMLDivElement>(null);\n  const styles = useStyles2(getStyles);\n  const halfSizeHighlightEllipse = 5.5;\n  const anchorImage =\n    'data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1cHgiIGhlaWdodD0iNXB4IiB2ZXJzaW9uPSIxLjEiPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2Utd2lkdGg9IjIiIHN0eWxlPSJzdHJva2Utb3BhY2l0eTowLjQiIHN0cm9rZT0iI2ZmZmZmZiIvPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2U9IiMyOWI2ZjIiLz48L3N2Zz4=';\n\n  const onMouseEnterAnchor = (event: React.MouseEvent) => {\n    if (!(event.target instanceof HTMLImageElement)) {\n      return;\n    }\n\n    if (highlightEllipseRef.current && event.target.style) {\n      highlightEllipseRef.current.style.display = 'block';\n      highlightEllipseRef.current.style.top = `calc(${event.target.style.top} - ${halfSizeHighlightEllipse}px + ${ANCHOR_PADDING}px)`;\n      highlightEllipseRef.current.style.left = `calc(${event.target.style.left} - ${halfSizeHighlightEllipse}px + ${ANCHOR_PADDING}px)`;\n    }\n  };\n\n  const onMouseLeaveHighlightElement = () => {\n    if (highlightEllipseRef.current) {\n      highlightEllipseRef.current.style.display = 'none';\n    }\n  };\n\n  const handleMouseLeaveAnchors = (\n    event: React.MouseEvent<Element, MouseEvent> | React.FocusEvent<HTMLDivElement, Element>\n  ) => {\n    const didHideAnchors = handleMouseLeave(event);\n\n    if (didHideAnchors) {\n      onMouseLeaveHighlightElement();\n    }\n  };\n\n  const generateAnchors = (anchors: ConnectionCoordinates[] = ANCHORS) => {\n    return anchors.map((anchor) => {\n      const id = `${anchor.x},${anchor.y}`;\n\n      // Convert anchor coords to relative percentage\n      const style = {\n        top: `calc(${-anchor.y * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`,\n        left: `calc(${anchor.x * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`,\n      };\n\n      return (\n        <img\n          id={id}\n          ref={(element) => {\n            if (element) {\n              // After React 15+, inline styles no longer support !important\n              element.style.setProperty('pointer-events', 'auto', 'important');\n            }\n          }}\n          key={id}\n          alt={CONNECTION_ANCHOR_ALT}\n          className={styles.anchor}\n          style={style}\n          src={anchorImage}\n          onMouseEnter={onMouseEnterAnchor}\n        />\n      );\n    });\n  };\n\n  return (\n    <div className={styles.root} ref={setRef}>\n      <div className={styles.mouseoutDiv} onMouseOut={handleMouseLeaveAnchors} onBlur={handleMouseLeaveAnchors} />\n      <div\n        id={CONNECTION_ANCHOR_DIV_ID}\n        ref={highlightEllipseRef}\n        className={styles.highlightElement}\n        onMouseLeave={onMouseLeaveHighlightElement}\n      />\n      <div ref={setAnchorsRef}>{generateAnchors()}</div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  root: css({\n    position: 'absolute',\n    display: 'none',\n  }),\n  mouseoutDiv: css({\n    position: 'absolute',\n    margin: '-30px',\n    width: 'calc(100% + 60px)',\n    height: 'calc(100% + 60px)',\n  }),\n  anchor: css({\n    padding: `${ANCHOR_PADDING}px`,\n    position: 'absolute',\n    cursor: 'cursor',\n    width: `calc(5px + 2 * ${ANCHOR_PADDING}px)`,\n    height: `calc(5px + 2 * ${ANCHOR_PADDING}px)`,\n    zIndex: 100,\n  }),\n  highlightElement: css({\n    backgroundColor: '#00ff00',\n    opacity: 0.3,\n    position: 'absolute',\n    cursor: 'cursor',\n    pointerEvents: 'auto',\n    width: '16px',\n    height: '16px',\n    borderRadius: theme.shape.radius.circle,\n    display: 'none',\n    zIndex: 110,\n  }),\n});\n","import { first } from 'rxjs/operators';\n\nimport { Placement } from 'app/plugins/panel/canvas/panelcfg.gen';\nimport { LayerActionID } from 'app/plugins/panel/canvas/types';\n\nimport { ElementState } from './element';\nimport { FrameState } from './frame';\nimport { RootElement } from './root';\nimport { Scene } from './scene';\n\n// TODO: Consider whether or not reorderElements + updateElements should be moved to TreeNavigationEditor\n// Reorder elements in the DOM when rearranging them in the tree navigation editor\nexport const reorderElements = (src: ElementState, dest: ElementState, dragToGap: boolean, destPosition: number) => {\n  switch (dragToGap) {\n    case true:\n      switch (destPosition) {\n        case -1:\n          // top of the tree\n          if (src.parent instanceof FrameState) {\n            // move outside the frame\n            if (dest.parent) {\n              updateElements(src, dest.parent, dest.parent.elements.length);\n              src.updateData(dest.parent.scene.context);\n            }\n          } else {\n            dest.parent?.reorderTree(src, dest, true);\n          }\n          break;\n        default:\n          if (dest.parent) {\n            updateElements(src, dest.parent, dest.parent.elements.indexOf(dest));\n            src.updateData(dest.parent.scene.context);\n          }\n          break;\n      }\n      break;\n    case false:\n      if (dest instanceof FrameState) {\n        if (src.parent === dest) {\n          // same frame parent\n          src.parent?.reorderTree(src, dest, true);\n        } else {\n          updateElements(src, dest);\n          src.updateData(dest.scene.context);\n        }\n      } else if (src.parent === dest.parent) {\n        src.parent?.reorderTree(src, dest);\n      } else {\n        if (dest.parent) {\n          updateElements(src, dest.parent);\n          src.updateData(dest.parent.scene.context);\n        }\n      }\n      break;\n  }\n};\n\n// Reorders canvas elements\nconst updateElements = (src: ElementState, dest: FrameState | RootElement, idx: number | null = null) => {\n  src.parent?.doAction(LayerActionID.Delete, src);\n  src.parent = dest;\n\n  const elementContainer = src.div?.getBoundingClientRect();\n  src.setPlacementFromConstraint(elementContainer, dest.div?.getBoundingClientRect());\n\n  const destIndex = idx ?? dest.elements.length - 1;\n  dest.elements.splice(destIndex, 0, src);\n  dest.scene.save();\n\n  dest.reinitializeMoveable();\n};\n\n// Finds the element state if it exists for a given DOM element\nexport const findElementByTarget = (target: Element, sceneElements: ElementState[]): ElementState | undefined => {\n  // We will probably want to add memoization to this as we are calling on drag / resize\n\n  const stack = [...sceneElements];\n  while (stack.length > 0) {\n    const currentElement = stack.shift();\n\n    if (currentElement && currentElement.div && currentElement.div === target) {\n      return currentElement;\n    }\n\n    const nestedElements = currentElement instanceof FrameState ? currentElement.elements : [];\n    for (const nestedElement of nestedElements) {\n      stack.unshift(nestedElement);\n    }\n  }\n\n  return undefined;\n};\n\n// Nest selected elements into a frame object\nexport const frameSelection = (scene: Scene) => {\n  scene.selection.pipe(first()).subscribe((currentSelectedElements) => {\n    const currentLayer = currentSelectedElements[0].parent!;\n\n    const newLayer = new FrameState(\n      {\n        type: 'frame',\n        name: scene.getNextElementName(true),\n        elements: [],\n      },\n      scene,\n      currentSelectedElements[0].parent\n    );\n\n    const framePlacement = generateFrameContainer(currentSelectedElements);\n\n    newLayer.options.placement = framePlacement;\n\n    currentSelectedElements.forEach((element: ElementState) => {\n      const elementContainer = element.div?.getBoundingClientRect();\n\n      // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n      element.setPlacementFromConstraint(elementContainer, framePlacement as DOMRect);\n      currentLayer.doAction(LayerActionID.Delete, element);\n      newLayer.doAction(LayerActionID.Duplicate, element, false, false);\n    });\n\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    newLayer.setPlacementFromConstraint(framePlacement as DOMRect, currentLayer.div?.getBoundingClientRect());\n\n    currentLayer.elements.push(newLayer);\n\n    scene.byName.set(newLayer.getName(), newLayer);\n\n    scene.save();\n  });\n};\n\n// Helper function to generate the a frame object based on the selected elements' dimensions\nconst generateFrameContainer = (elements: ElementState[]): Placement => {\n  let minTop = Infinity;\n  let minLeft = Infinity;\n  let maxRight = 0;\n  let maxBottom = 0;\n\n  elements.forEach((element: ElementState) => {\n    const elementContainer = element.div?.getBoundingClientRect();\n\n    if (!elementContainer) {\n      return;\n    }\n\n    if (minTop > elementContainer.top) {\n      minTop = elementContainer.top;\n    }\n\n    if (minLeft > elementContainer.left) {\n      minLeft = elementContainer.left;\n    }\n\n    if (maxRight < elementContainer.right) {\n      maxRight = elementContainer.right;\n    }\n\n    if (maxBottom < elementContainer.bottom) {\n      maxBottom = elementContainer.bottom;\n    }\n  });\n\n  return {\n    top: minTop,\n    left: minLeft,\n    width: maxRight - minLeft,\n    height: maxBottom - minTop,\n  };\n};\n","import { css } from '@emotion/css';\nimport { useEffect, useMemo, useRef, useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { ConnectionDirection } from 'app/features/canvas/element';\nimport { Scene } from 'app/features/canvas/runtime/scene';\n\nimport { ConnectionCoordinates } from '../../panelcfg.gen';\nimport { ConnectionState } from '../../types';\nimport {\n  calculateAngle,\n  calculateCoordinates,\n  calculateDistance,\n  calculateMidpoint,\n  getConnectionStyles,\n  getParentBoundingClientRect,\n} from '../../utils';\n\nimport { CONNECTION_VERTEX_ADD_ID, CONNECTION_VERTEX_ID } from './Connections';\n\ntype Props = {\n  setSVGRef: (anchorElement: SVGSVGElement) => void;\n  setLineRef: (anchorElement: SVGLineElement) => void;\n  setSVGVertexRef: (anchorElement: SVGSVGElement) => void;\n  setVertexPathRef: (anchorElement: SVGPathElement) => void;\n  setVertexRef: (anchorElement: SVGCircleElement) => void;\n  scene: Scene;\n};\n\nlet idCounter = 0;\nconst htmlElementTypes = ['input', 'textarea'];\n\nexport const ConnectionSVG = ({\n  setSVGRef,\n  setLineRef,\n  setSVGVertexRef,\n  setVertexPathRef,\n  setVertexRef,\n  scene,\n}: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const headId = Date.now() + '_' + idCounter++;\n  const CONNECTION_LINE_ID = useMemo(() => `connectionLineId-${headId}`, [headId]);\n  const EDITOR_HEAD_ID = useMemo(() => `editorHead-${headId}`, [headId]);\n  const defaultArrowColor = config.theme2.colors.text.primary;\n  const defaultArrowSize = 2;\n  const defaultArrowDirection = ConnectionDirection.Forward;\n  const maximumVertices = 10;\n\n  const [selectedConnection, setSelectedConnection] = useState<ConnectionState | undefined>(undefined);\n\n  // Need to use ref to ensure state is not stale in event handler\n  const selectedConnectionRef = useRef(selectedConnection);\n  useEffect(() => {\n    selectedConnectionRef.current = selectedConnection;\n  });\n\n  useEffect(() => {\n    if (scene.panel.context.instanceState?.selectedConnection) {\n      setSelectedConnection(scene.panel.context.instanceState?.selectedConnection);\n    }\n  }, [scene.panel.context.instanceState?.selectedConnection]);\n\n  const onKeyUp = (e: KeyboardEvent) => {\n    const target = e.target;\n\n    if (!(target instanceof HTMLElement)) {\n      return;\n    }\n\n    if (htmlElementTypes.indexOf(target.nodeName.toLowerCase()) > -1) {\n      return;\n    }\n\n    // Backspace (8) or delete (46)\n    if (e.keyCode === 8 || e.keyCode === 46) {\n      if (selectedConnectionRef.current && selectedConnectionRef.current.source) {\n        selectedConnectionRef.current.source.options.connections =\n          selectedConnectionRef.current.source.options.connections?.filter(\n            (connection) => connection !== selectedConnectionRef.current?.info\n          );\n        selectedConnectionRef.current.source.onChange(selectedConnectionRef.current.source.options);\n\n        setSelectedConnection(undefined);\n        scene.connections.select(undefined);\n        scene.connections.updateState();\n        scene.save();\n      }\n    } else {\n      // Prevent removing event listener if key is not delete\n      return;\n    }\n\n    document.removeEventListener('keyup', onKeyUp);\n    scene.selecto!.rootContainer!.removeEventListener('click', clearSelectedConnection);\n  };\n\n  const clearSelectedConnection = (event: MouseEvent) => {\n    const eventTarget = event.target;\n\n    const shouldResetSelectedConnection = !(\n      eventTarget instanceof SVGLineElement && eventTarget.id === CONNECTION_LINE_ID\n    );\n\n    if (shouldResetSelectedConnection) {\n      setSelectedConnection(undefined);\n      scene.connections.select(undefined);\n    }\n  };\n\n  const selectConnection = (connection: ConnectionState) => {\n    if (scene.isEditingEnabled) {\n      setSelectedConnection(connection);\n      scene.connections.select(connection);\n\n      document.addEventListener('keyup', onKeyUp);\n      scene.selecto!.rootContainer!.addEventListener('click', clearSelectedConnection);\n    }\n  };\n\n  // Figure out target and then target's relative coordinates drawing (if no target do parent)\n  const renderConnections = () => {\n    return (\n      scene.connections.state\n        // Render selected connection last, ensuring it is above other connections\n        .sort((_a, b) => (selectedConnection === b && scene.panel.context.instanceState.selectedConnection ? -1 : 0))\n        .map((v, idx) => {\n          const { source, target, info, vertices, index } = v;\n          const sourceRect = source.div?.getBoundingClientRect();\n          const parent = source.div?.parentElement;\n          const transformScale = scene.scale;\n          const parentRect = getParentBoundingClientRect(scene);\n\n          if (!sourceRect || !parent || !parentRect) {\n            return;\n          }\n\n          const { x1, y1, x2, y2 } = calculateCoordinates(sourceRect, parentRect, info, target, transformScale);\n\n          let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n          if (v.sourceOriginal && v.targetOriginal) {\n            xStart = v.sourceOriginal.x;\n            yStart = v.sourceOriginal.y;\n            xEnd = v.targetOriginal.x;\n            yEnd = v.targetOriginal.y;\n          } else if (source.options.connections) {\n            // If original source or target coordinates are not set for the current connection, set them\n            if (\n              !source.options.connections[index].sourceOriginal ||\n              !source.options.connections[index].targetOriginal\n            ) {\n              source.options.connections[index].sourceOriginal = { x: x1, y: y1 };\n              source.options.connections[index].targetOriginal = { x: x2, y: y2 };\n            }\n          }\n\n          const midpoint = calculateMidpoint(x1, y1, x2, y2);\n          const xDist = xEnd - xStart;\n          const yDist = yEnd - yStart;\n\n          const { strokeColor, strokeWidth, strokeRadius, arrowDirection, lineStyle, shouldAnimate } =\n            getConnectionStyles(info, scene, defaultArrowSize, defaultArrowDirection);\n\n          const isSelected = selectedConnection === v && scene.panel.context.instanceState.selectedConnection;\n\n          const connectionCursorStyle = scene.isEditingEnabled ? 'grab' : '';\n          const selectedStyles = { stroke: '#44aaff', strokeOpacity: 0.6, strokeWidth: strokeWidth + 5 };\n\n          const CONNECTION_HEAD_ID_START = `connectionHeadStart-${headId + Math.random()}`;\n          const CONNECTION_HEAD_ID_END = `connectionHeadEnd-${headId + Math.random()}`;\n\n          const radius = strokeRadius;\n          // Create vertex path and populate array of add vertex controls\n          const addVertices: ConnectionCoordinates[] = [];\n          let pathString = `M${x1} ${y1} `;\n          if (vertices?.length) {\n            vertices.map((vertex, index) => {\n              const x = vertex.x;\n              const y = vertex.y;\n\n              // Convert vertex relative coordinates to scene coordinates\n              const X = x * xDist + xStart;\n              const Y = y * yDist + yStart;\n\n              // Initialize coordinates for first arc control point\n              let xa = X;\n              let ya = Y;\n\n              // Initialize coordinates for second arc control point\n              let xb = X;\n              let yb = Y;\n\n              // Initialize half arc distance and segment angles\n              let lHalfArc = 0;\n              let angle1 = 0;\n              let angle2 = 0;\n\n              // Only calculate arcs if there is a radius\n              if (radius) {\n                if (index < vertices.length - 1) {\n                  const Xn = vertices[index + 1].x * xDist + xStart;\n                  const Yn = vertices[index + 1].y * yDist + yStart;\n                  if (index === 0) {\n                    // First vertex\n                    angle1 = calculateAngle(x1, y1, X, Y);\n                    angle2 = calculateAngle(X, Y, Xn, Yn);\n                  } else {\n                    // All vertices\n                    const previousVertex = vertices[index - 1];\n                    const Xp = previousVertex.x * xDist + xStart;\n                    const Yp = previousVertex.y * yDist + yStart;\n                    angle1 = calculateAngle(Xp, Yp, X, Y);\n                    angle2 = calculateAngle(X, Y, Xn, Yn);\n                  }\n                } else {\n                  // Last vertex\n                  if (index > 0) {\n                    // Not also the first vertex\n                    const previousVertex = vertices[index - 1];\n                    const Xp = previousVertex.x * xDist + xStart;\n                    const Yp = previousVertex.y * yDist + yStart;\n                    angle1 = calculateAngle(Xp, Yp, X, Y);\n                  } else {\n                    angle1 = calculateAngle(x1, y1, X, Y);\n                  }\n                  angle2 = calculateAngle(X, Y, x2, y2);\n                }\n\n                // Calculate angle between two segments where arc will be placed\n                const theta = angle2 - angle1; //radians\n                // Attempt to determine if arc is counter clockwise (ccw)\n                const ccw = theta < 0;\n                // Half arc is used for arc control points\n                lHalfArc = radius * Math.tan(theta / 2);\n                if (ccw) {\n                  lHalfArc *= -1;\n                }\n              }\n\n              if (index === 0) {\n                // For first vertex\n                addVertices.push(\n                  calculateMidpoint((x1 - xStart) / (xEnd - xStart), (y1 - yStart) / (yEnd - yStart), x, y)\n                );\n\n                // Only calculate arcs if there is a radius\n                if (radius) {\n                  // Length of segment\n                  const lSegment = calculateDistance(X, Y, x1, y1);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegment)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegment;\n                  }\n                  // Default next point to last point\n                  let Xn = x2;\n                  let Yn = y2;\n                  if (index < vertices.length - 1) {\n                    // Not also the last point\n                    const nextVertex = vertices[index + 1];\n                    Xn = nextVertex.x * xDist + xStart;\n                    Yn = nextVertex.y * yDist + yStart;\n                  }\n\n                  // Length of next segment\n                  const lSegmentNext = calculateDistance(X, Y, Xn, Yn);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegmentNext)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegmentNext;\n                  }\n                  // Calculate arc control points\n                  const lDelta = lSegment - lHalfArc;\n                  xa = Math.round(lDelta * Math.cos(angle1) + x1);\n                  ya = Math.round(lDelta * Math.sin(angle1) + y1);\n                  xb = Math.round(lHalfArc * Math.cos(angle2) + X);\n                  yb = Math.round(lHalfArc * Math.sin(angle2) + Y);\n\n                  // Check if arc control points are inside of segment, otherwise swap sign\n                  if ((xa > X && xa > x1) || (xa < X && xa < x1)) {\n                    xa = (lDelta + 2 * lHalfArc) * Math.cos(angle1) + x1;\n                    ya = (lDelta + 2 * lHalfArc) * Math.sin(angle1) + y1;\n                    xb = -lHalfArc * Math.cos(angle2) + X;\n                    yb = -lHalfArc * Math.sin(angle2) + Y;\n                  }\n                }\n              } else {\n                // For all other vertices\n                const previousVertex = vertices[index - 1];\n                addVertices.push(calculateMidpoint(previousVertex.x, previousVertex.y, x, y));\n\n                // Only calculate arcs if there is a radius\n                if (radius) {\n                  // Convert previous vertex relative coorindates to scene coordinates\n                  const Xp = previousVertex.x * xDist + xStart;\n                  const Yp = previousVertex.y * yDist + yStart;\n\n                  // Length of segment\n                  const lSegment = calculateDistance(X, Y, Xp, Yp);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegment)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegment;\n                  }\n                  // Default next point to last point\n                  let Xn = x2;\n                  let Yn = y2;\n                  if (index < vertices.length - 1) {\n                    // Not also the last point\n                    const nextVertex = vertices[index + 1];\n                    Xn = nextVertex.x * xDist + xStart;\n                    Yn = nextVertex.y * yDist + yStart;\n                  }\n\n                  // Length of next segment\n                  const lSegmentNext = calculateDistance(X, Y, Xn, Yn);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegmentNext)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegmentNext;\n                  }\n\n                  // Calculate arc control points\n                  const lDelta = lSegment - lHalfArc;\n                  xa = Math.round(lDelta * Math.cos(angle1) + Xp);\n                  ya = Math.round(lDelta * Math.sin(angle1) + Yp);\n                  xb = Math.round(lHalfArc * Math.cos(angle2) + X);\n                  yb = Math.round(lHalfArc * Math.sin(angle2) + Y);\n\n                  // Check if arc control points are inside of segment, otherwise swap sign\n                  if ((xa > X && xa > Xp) || (xa < X && xa < Xp)) {\n                    xa = (lDelta + 2 * lHalfArc) * Math.cos(angle1) + Xp;\n                    ya = (lDelta + 2 * lHalfArc) * Math.sin(angle1) + Yp;\n                    xb = -lHalfArc * Math.cos(angle2) + X;\n                    yb = -lHalfArc * Math.sin(angle2) + Y;\n                  }\n                }\n              }\n              if (index === vertices.length - 1) {\n                // For last vertex only\n                addVertices.push(\n                  calculateMidpoint((x2 - xStart) / (xEnd - xStart), (y2 - yStart) / (yEnd - yStart), x, y)\n                );\n              }\n              // Add segment to path\n              pathString += `L${xa} ${ya} `;\n\n              if (lHalfArc !== 0) {\n                // Add arc if applicable\n                pathString += `Q ${X} ${Y} ${xb} ${yb} `;\n              }\n            });\n            // Add last segment\n            pathString += `L${x2} ${y2}`;\n          }\n\n          const markerStart =\n            arrowDirection === ConnectionDirection.Reverse || arrowDirection === ConnectionDirection.Both\n              ? `url(#${CONNECTION_HEAD_ID_START})`\n              : undefined;\n\n          const markerEnd =\n            arrowDirection === ConnectionDirection.Forward || arrowDirection === ConnectionDirection.Both\n              ? `url(#${CONNECTION_HEAD_ID_END})`\n              : undefined;\n\n          const getAnimationDirection = () => {\n            let values = '100;0';\n\n            if (arrowDirection === ConnectionDirection.Reverse) {\n              values = '0;100';\n            }\n\n            return values;\n          };\n\n          return (\n            <svg className={styles.connection} key={idx}>\n              <g onClick={() => selectConnection(v)}>\n                <defs>\n                  <marker\n                    id={CONNECTION_HEAD_ID_START}\n                    markerWidth=\"10\"\n                    markerHeight=\"7\"\n                    refX=\"0\"\n                    refY=\"3.5\"\n                    orient=\"auto\"\n                    stroke={strokeColor}\n                  >\n                    <polygon points=\"10 0, 0 3.5, 10 7\" fill={strokeColor} />\n                  </marker>\n                  <marker\n                    id={CONNECTION_HEAD_ID_END}\n                    markerWidth=\"10\"\n                    markerHeight=\"7\"\n                    refX=\"10\"\n                    refY=\"3.5\"\n                    orient=\"auto\"\n                    stroke={strokeColor}\n                  >\n                    <polygon points=\"0 0, 10 3.5, 0 7\" fill={strokeColor} />\n                  </marker>\n                </defs>\n                {vertices?.length ? (\n                  <g>\n                    <path\n                      id={`${CONNECTION_LINE_ID}_transparent`}\n                      d={pathString}\n                      cursor={connectionCursorStyle}\n                      pointerEvents=\"auto\"\n                      stroke=\"transparent\"\n                      strokeWidth={15}\n                      fill={'none'}\n                      style={isSelected ? selectedStyles : {}}\n                    />\n                    <path\n                      d={pathString}\n                      stroke={strokeColor}\n                      strokeWidth={strokeWidth}\n                      strokeDasharray={lineStyle}\n                      strokeDashoffset={1}\n                      fill={'none'}\n                      markerEnd={markerEnd}\n                      markerStart={markerStart}\n                    >\n                      {shouldAnimate && (\n                        <animate\n                          attributeName=\"stroke-dashoffset\"\n                          values={getAnimationDirection()}\n                          dur=\"5s\"\n                          calcMode=\"linear\"\n                          repeatCount=\"indefinite\"\n                          fill={'freeze'}\n                        />\n                      )}\n                    </path>\n                    {isSelected && (\n                      <g>\n                        {vertices.map((value, index) => {\n                          return (\n                            <circle\n                              id={CONNECTION_VERTEX_ID}\n                              data-index={index}\n                              key={`${CONNECTION_VERTEX_ID}${index}_${idx}`}\n                              cx={value.x * xDist + xStart}\n                              cy={value.y * yDist + yStart}\n                              r={5}\n                              stroke={strokeColor}\n                              className={styles.vertex}\n                              cursor={'crosshair'}\n                              pointerEvents=\"auto\"\n                            />\n                          );\n                        })}\n                        {vertices.length < maximumVertices &&\n                          addVertices.map((value, index) => {\n                            return (\n                              <circle\n                                id={CONNECTION_VERTEX_ADD_ID}\n                                data-index={index}\n                                key={`${CONNECTION_VERTEX_ADD_ID}${index}_${idx}`}\n                                cx={value.x * xDist + xStart}\n                                cy={value.y * yDist + yStart}\n                                r={4}\n                                stroke={strokeColor}\n                                className={styles.addVertex}\n                                cursor={'crosshair'}\n                                pointerEvents=\"auto\"\n                              />\n                            );\n                          })}\n                      </g>\n                    )}\n                  </g>\n                ) : (\n                  <g>\n                    <line\n                      id={`${CONNECTION_LINE_ID}_transparent`}\n                      cursor={connectionCursorStyle}\n                      pointerEvents=\"auto\"\n                      stroke=\"transparent\"\n                      strokeWidth={15}\n                      style={isSelected ? selectedStyles : {}}\n                      x1={x1}\n                      y1={y1}\n                      x2={x2}\n                      y2={y2}\n                    />\n                    <line\n                      id={CONNECTION_LINE_ID}\n                      stroke={strokeColor}\n                      pointerEvents=\"auto\"\n                      strokeWidth={strokeWidth}\n                      markerEnd={markerEnd}\n                      markerStart={markerStart}\n                      strokeDasharray={lineStyle}\n                      strokeDashoffset={1}\n                      x1={x1}\n                      y1={y1}\n                      x2={x2}\n                      y2={y2}\n                      cursor={connectionCursorStyle}\n                    >\n                      {shouldAnimate && (\n                        <animate\n                          attributeName=\"stroke-dashoffset\"\n                          values={getAnimationDirection()}\n                          dur=\"5s\"\n                          calcMode=\"linear\"\n                          repeatCount=\"indefinite\"\n                          fill={'freeze'}\n                        />\n                      )}\n                    </line>\n                    {isSelected && (\n                      <circle\n                        id={CONNECTION_VERTEX_ADD_ID}\n                        data-index={0}\n                        cx={midpoint.x}\n                        cy={midpoint.y}\n                        r={4}\n                        stroke={strokeColor}\n                        className={styles.addVertex}\n                        cursor={'crosshair'}\n                        pointerEvents=\"auto\"\n                      />\n                    )}\n                  </g>\n                )}\n              </g>\n            </svg>\n          );\n        })\n    );\n  };\n\n  return (\n    <>\n      <svg ref={setSVGRef} className={styles.editorSVG}>\n        <defs>\n          <marker\n            id={EDITOR_HEAD_ID}\n            markerWidth=\"10\"\n            markerHeight=\"7\"\n            refX=\"10\"\n            refY=\"3.5\"\n            orient=\"auto\"\n            stroke={defaultArrowColor}\n          >\n            <polygon points=\"0 0, 10 3.5, 0 7\" fill={defaultArrowColor} />\n          </marker>\n        </defs>\n        <line ref={setLineRef} stroke={defaultArrowColor} strokeWidth={2} markerEnd={`url(#${EDITOR_HEAD_ID})`} />\n      </svg>\n      <svg ref={setSVGVertexRef} className={styles.editorSVG}>\n        <path\n          ref={setVertexPathRef}\n          stroke={defaultArrowColor}\n          strokeWidth={2}\n          strokeDasharray={'5, 5'}\n          fill={'none'}\n        />\n        <circle ref={setVertexRef} stroke={defaultArrowColor} r={4} className={styles.vertex} />\n      </svg>\n      {renderConnections()}\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  editorSVG: css({\n    position: 'absolute',\n    pointerEvents: 'none',\n    width: '100%',\n    height: '100%',\n    zIndex: 1000,\n    display: 'none',\n  }),\n  connection: css({\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    zIndex: 1000,\n    pointerEvents: 'none',\n  }),\n  vertex: css({\n    fill: '#44aaff',\n    strokeWidth: 2,\n  }),\n  addVertex: css({\n    fill: '#44aaff',\n    opacity: 0.5,\n    strokeWidth: 1,\n  }),\n});\n","import * as React from 'react';\nimport { BehaviorSubject } from 'rxjs';\n\nimport { config } from '@grafana/runtime';\nimport { CanvasConnection, ConnectionCoordinates, ConnectionPath } from 'app/features/canvas/element';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { findElementByTarget } from 'app/features/canvas/runtime/sceneElementManagement';\n\nimport { ConnectionState } from '../../types';\nimport {\n  calculateAngle,\n  calculateCoordinates,\n  getConnections,\n  getParentBoundingClientRect,\n  isConnectionSource,\n  isConnectionTarget,\n} from '../../utils';\n\nimport {\n  CONNECTION_ANCHOR_ALT,\n  ConnectionAnchors,\n  CONNECTION_ANCHOR_HIGHLIGHT_OFFSET,\n  ANCHORS,\n  ANCHOR_PADDING,\n  HALF_SIZE,\n} from './ConnectionAnchors';\nimport { ConnectionSVG } from './ConnectionSVG';\n\nexport const CONNECTION_VERTEX_ID = 'vertex';\nexport const CONNECTION_VERTEX_ADD_ID = 'vertexAdd';\nconst CONNECTION_VERTEX_ORTHO_TOLERANCE = 0.05; // Cartesian ratio against vertical or horizontal tolerance\nconst CONNECTION_VERTEX_SNAP_TOLERANCE = (5 / 180) * Math.PI; // Multi-segment snapping angle in radians to trigger vertex removal\n\nexport class Connections {\n  scene: Scene;\n  connectionAnchorDiv?: HTMLDivElement;\n  anchorsDiv?: HTMLDivElement;\n  connectionSVG?: SVGElement;\n  connectionLine?: SVGLineElement;\n  connectionSVGVertex?: SVGElement;\n  connectionVertexPath?: SVGPathElement;\n  connectionVertex?: SVGCircleElement;\n  connectionSource?: ElementState;\n  connectionTarget?: ElementState;\n  isDrawingConnection?: boolean;\n  selectedVertexIndex?: number;\n  didConnectionLeaveHighlight?: boolean;\n  state: ConnectionState[] = [];\n  readonly selection = new BehaviorSubject<ConnectionState | undefined>(undefined);\n\n  constructor(scene: Scene) {\n    this.scene = scene;\n    this.updateState();\n  }\n\n  select = (connection: ConnectionState | undefined) => {\n    if (connection === this.selection.value) {\n      return;\n    }\n    this.selection.next(connection);\n  };\n\n  updateState = () => {\n    const s = this.selection.value;\n    this.state = getConnections(this.scene.byName);\n\n    if (s) {\n      for (let c of this.state) {\n        if (c.source === s.source && c.index === s.index) {\n          this.selection.next(c);\n          break;\n        }\n      }\n    }\n  };\n\n  setConnectionAnchorRef = (anchorElement: HTMLDivElement) => {\n    this.connectionAnchorDiv = anchorElement;\n  };\n\n  setAnchorsRef = (anchorsElement: HTMLDivElement) => {\n    this.anchorsDiv = anchorsElement;\n  };\n\n  setConnectionSVGRef = (connectionSVG: SVGSVGElement) => {\n    this.connectionSVG = connectionSVG;\n  };\n\n  setConnectionLineRef = (connectionLine: SVGLineElement) => {\n    this.connectionLine = connectionLine;\n  };\n\n  setConnectionSVGVertexRef = (connectionSVG: SVGSVGElement) => {\n    this.connectionSVGVertex = connectionSVG;\n  };\n\n  setConnectionVertexRef = (connectionVertex: SVGCircleElement) => {\n    this.connectionVertex = connectionVertex;\n  };\n\n  setConnectionVertexPathRef = (connectionVertexPath: SVGPathElement) => {\n    this.connectionVertexPath = connectionVertexPath;\n  };\n\n  // Recursively find the first parent that is a canvas element\n  findElementTarget = (element: Element): ElementState | undefined => {\n    let elementTarget = undefined;\n\n    // Cap recursion at the scene level\n    if (element === this.scene.div) {\n      return undefined;\n    }\n\n    elementTarget = findElementByTarget(element, this.scene.root.elements);\n\n    if (!elementTarget && element.parentElement) {\n      elementTarget = this.findElementTarget(element.parentElement);\n    }\n\n    return elementTarget;\n  };\n\n  handleMouseEnter = (event: React.MouseEvent) => {\n    if (!(event.target instanceof Element) || !this.scene.isEditingEnabled) {\n      return;\n    }\n\n    let element: ElementState | undefined = this.findElementTarget(event.target);\n\n    if (!element) {\n      console.log('no element');\n      return;\n    }\n\n    if (this.isDrawingConnection) {\n      this.connectionTarget = element;\n    } else {\n      this.connectionSource = element;\n      if (!this.connectionSource) {\n        console.log('no connection source');\n        return;\n      }\n    }\n\n    const customElementAnchors = element?.item.customConnectionAnchors || ANCHORS;\n    // This type cast is necessary as TS doesn't understand that `Element` is an `HTMLElement`\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const anchors = Array.from(this.anchorsDiv?.children as HTMLCollectionOf<HTMLElement>);\n    const anchorsAmount = customElementAnchors.length;\n\n    // re-calculate the position of the existing anchors on hover\n    // and hide the rest of the anchors if there are more than the custom ones\n    anchors.forEach((anchor, index) => {\n      if (index >= anchorsAmount) {\n        anchor.style.display = 'none';\n      } else {\n        const { x, y } = customElementAnchors[index];\n        anchor.style.top = `calc(${-y * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`;\n        anchor.style.left = `calc(${x * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`;\n        anchor.style.display = 'block';\n      }\n    });\n\n    const elementBoundingRect = element.div!.getBoundingClientRect();\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    const relativeTop = elementBoundingRect.top - (parentBoundingRect?.top ?? 0);\n    const relativeLeft = elementBoundingRect.left - (parentBoundingRect?.left ?? 0);\n\n    if (this.connectionAnchorDiv) {\n      this.connectionAnchorDiv.style.display = 'none';\n      this.connectionAnchorDiv.style.display = 'block';\n      this.connectionAnchorDiv.style.top = `${relativeTop / transformScale}px`;\n      this.connectionAnchorDiv.style.left = `${relativeLeft / transformScale}px`;\n      this.connectionAnchorDiv.style.height = `${elementBoundingRect.height / transformScale}px`;\n      this.connectionAnchorDiv.style.width = `${elementBoundingRect.width / transformScale}px`;\n    }\n  };\n\n  // Return boolean indicates if connection anchors were hidden or not\n  handleMouseLeave = (event: React.MouseEvent | React.FocusEvent): boolean => {\n    // If mouse is leaving INTO the anchor image, don't remove div\n    if (\n      event.relatedTarget instanceof HTMLImageElement &&\n      event.relatedTarget.getAttribute('alt') === CONNECTION_ANCHOR_ALT\n    ) {\n      return false;\n    }\n\n    this.connectionTarget = undefined;\n    this.connectionAnchorDiv!.style.display = 'none';\n    return true;\n  };\n\n  connectionListener = (event: MouseEvent) => {\n    event.preventDefault();\n\n    if (!(this.connectionLine && this.scene.div && this.scene.div.parentElement)) {\n      return;\n    }\n\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const x = event.pageX - parentBoundingRect.x ?? 0;\n    const y = event.pageY - parentBoundingRect.y ?? 0;\n\n    this.connectionLine.setAttribute('x2', `${x / transformScale}`);\n    this.connectionLine.setAttribute('y2', `${y / transformScale}`);\n\n    const connectionLineX1 = this.connectionLine.x1.baseVal.value;\n    const connectionLineY1 = this.connectionLine.y1.baseVal.value;\n    if (!this.didConnectionLeaveHighlight) {\n      const connectionLength = Math.hypot(x - connectionLineX1, y - connectionLineY1);\n      if (connectionLength > CONNECTION_ANCHOR_HIGHLIGHT_OFFSET && this.connectionSVG) {\n        this.didConnectionLeaveHighlight = true;\n        this.connectionSVG.style.display = 'block';\n        this.isDrawingConnection = true;\n      }\n    }\n\n    if (!event.buttons) {\n      if (this.connectionSource && this.connectionSource.div && this.connectionSource.div.parentElement) {\n        const sourceRect = this.connectionSource.div.getBoundingClientRect();\n\n        const transformScale = this.scene.scale;\n        const parentRect = getParentBoundingClientRect(this.scene);\n\n        if (!parentRect) {\n          return;\n        }\n\n        const sourceVerticalCenter = (sourceRect.top - parentRect.top + sourceRect.height / 2) / transformScale;\n        const sourceHorizontalCenter = (sourceRect.left - parentRect.left + sourceRect.width / 2) / transformScale;\n\n        // Convert from DOM coords to connection coords\n        // TODO: Break this out into util function and add tests\n        const sourceX = (connectionLineX1 - sourceHorizontalCenter) / (sourceRect.width / 2 / transformScale);\n        const sourceY = (sourceVerticalCenter - connectionLineY1) / (sourceRect.height / 2 / transformScale);\n\n        let targetX;\n        let targetY;\n        let targetName;\n\n        if (this.connectionTarget && this.connectionTarget.div) {\n          const targetRect = this.connectionTarget.div.getBoundingClientRect();\n\n          const targetVerticalCenter = targetRect.top - parentRect.top + targetRect.height / 2;\n          const targetHorizontalCenter = targetRect.left - parentRect.left + targetRect.width / 2;\n\n          targetX = (x - targetHorizontalCenter) / (targetRect.width / 2);\n          targetY = (targetVerticalCenter - y) / (targetRect.height / 2);\n          targetName = this.connectionTarget.options.name;\n        } else {\n          const parentVerticalCenter = parentRect.height / 2;\n          const parentHorizontalCenter = parentRect.width / 2;\n\n          targetX = (x - parentHorizontalCenter) / (parentRect.width / 2);\n          targetY = (parentVerticalCenter - y) / (parentRect.height / 2);\n        }\n\n        const connection = {\n          source: {\n            x: sourceX,\n            y: sourceY,\n          },\n          target: {\n            x: targetX,\n            y: targetY,\n          },\n          targetName: targetName,\n          color: {\n            fixed: config.theme2.colors.text.primary,\n          },\n          size: {\n            fixed: 2,\n            min: 1,\n            max: 10,\n          },\n          path: ConnectionPath.Straight,\n        };\n\n        const { options } = this.connectionSource;\n        if (!options.connections) {\n          options.connections = [];\n        }\n        if (this.didConnectionLeaveHighlight) {\n          this.connectionSource.options.connections = [...options.connections, connection];\n          this.connectionSource.onChange(this.connectionSource.options);\n        }\n      }\n\n      if (this.connectionSVG) {\n        this.connectionSVG.style.display = 'none';\n      }\n\n      if (this.scene.selecto && this.scene.selecto.rootContainer) {\n        this.scene.selecto.rootContainer.style.cursor = 'default';\n        this.scene.selecto.rootContainer.removeEventListener('mousemove', this.connectionListener);\n      }\n\n      this.isDrawingConnection = false;\n      this.updateState();\n      this.scene.save();\n    }\n  };\n\n  // Handles mousemove and mouseup events when dragging an existing vertex\n  vertexListener = (event: MouseEvent) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n\n    event.preventDefault();\n\n    if (!(this.connectionVertex && this.scene.div && this.scene.div.parentElement)) {\n      return;\n    }\n\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const x = (event.pageX - parentBoundingRect.x) / transformScale ?? 0;\n    const y = (event.pageY - parentBoundingRect.y) / transformScale ?? 0;\n\n    this.connectionVertex?.setAttribute('cx', `${x}`);\n    this.connectionVertex?.setAttribute('cy', `${y}`);\n\n    const selectedValue = this.selection.value;\n    const sourceRect = selectedValue!.source.div!.getBoundingClientRect();\n\n    // calculate relative coordinates based on source and target coorindates of connection\n    const { x1, y1, x2, y2 } = calculateCoordinates(\n      sourceRect,\n      parentBoundingRect,\n      selectedValue?.info!,\n      selectedValue!.target,\n      transformScale\n    );\n\n    let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n    if (selectedValue?.sourceOriginal && selectedValue.targetOriginal) {\n      xStart = selectedValue.sourceOriginal.x;\n      yStart = selectedValue.sourceOriginal.y;\n      xEnd = selectedValue.targetOriginal.x;\n      yEnd = selectedValue.targetOriginal.y;\n    }\n\n    const xDist = xEnd - xStart;\n    const yDist = yEnd - yStart;\n\n    let vx1 = x1;\n    let vy1 = y1;\n    let vx2 = x2;\n    let vy2 = y2;\n    if (selectedValue && selectedValue.vertices) {\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex > 0) {\n        vx1 = selectedValue.vertices[this.selectedVertexIndex - 1].x * xDist + xStart;\n        vy1 = selectedValue.vertices[this.selectedVertexIndex - 1].y * yDist + yStart;\n      }\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex < selectedValue.vertices.length - 1) {\n        vx2 = selectedValue.vertices[this.selectedVertexIndex + 1].x * xDist + xStart;\n        vy2 = selectedValue.vertices[this.selectedVertexIndex + 1].y * yDist + yStart;\n      }\n    }\n\n    // Check if slope before vertex and after vertex is within snapping tolerance\n    let xSnap = x;\n    let ySnap = y;\n    let deleteVertex = false;\n    // Ignore if control key being held\n    if (!event.ctrlKey) {\n      // Check if segment before and after vertex are close to vertical or horizontal\n      const verticalBefore = Math.abs((x - vx1) / (y - vy1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const verticalAfter = Math.abs((x - vx2) / (y - vy2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalBefore = Math.abs((y - vy1) / (x - vx1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalAfter = Math.abs((y - vy2) / (x - vx2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n\n      if (verticalBefore) {\n        xSnap = vx1;\n      } else if (verticalAfter) {\n        xSnap = vx2;\n      }\n      if (horizontalBefore) {\n        ySnap = vy1;\n      } else if (horizontalAfter) {\n        ySnap = vy2;\n      }\n\n      if ((verticalBefore || verticalAfter) && (horizontalBefore || horizontalAfter)) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'move';\n      } else if (verticalBefore || verticalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'col-resize';\n      } else if (horizontalBefore || horizontalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'row-resize';\n      }\n\n      const angleOverall = calculateAngle(vx1, vy1, vx2, vy2);\n      const angleBefore = calculateAngle(vx1, vy1, x, y);\n      deleteVertex = Math.abs(angleBefore - angleOverall) < CONNECTION_VERTEX_SNAP_TOLERANCE;\n    }\n\n    if (deleteVertex) {\n      // Display temporary vertex removal\n      this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${vx2} ${vy2}`);\n      this.connectionSVGVertex!.style.display = 'block';\n      this.connectionVertex.style.display = 'none';\n    } else {\n      // Display temporary vertex during drag\n      this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${xSnap} ${ySnap} L${vx2} ${vy2}`);\n      this.connectionSVGVertex!.style.display = 'block';\n      this.connectionVertex.style.display = 'block';\n    }\n\n    // Handle mouseup\n    if (!event.buttons) {\n      // Remove existing event listener\n      this.scene.selecto?.rootContainer?.removeEventListener('mousemove', this.vertexListener);\n      this.scene.selecto?.rootContainer?.removeEventListener('mouseup', this.vertexListener);\n      this.scene.selecto!.rootContainer!.style.cursor = 'auto';\n      this.connectionSVGVertex!.style.display = 'none';\n\n      // call onChange here and update appropriate index of connection vertices array\n      const connectionIndex = selectedValue?.index;\n      const vertexIndex = this.selectedVertexIndex;\n\n      if (connectionIndex !== undefined && vertexIndex !== undefined) {\n        const currentSource = selectedValue!.source;\n        if (currentSource.options.connections) {\n          const currentConnections = [...currentSource.options.connections];\n          if (currentConnections[connectionIndex].vertices) {\n            const currentVertices = [...currentConnections[connectionIndex].vertices!];\n\n            // TODO for vertex removal, clear out originals?\n            if (deleteVertex) {\n              currentVertices.splice(vertexIndex, 1);\n            } else {\n              const currentVertex = { ...currentVertices[vertexIndex] };\n\n              currentVertex.x = (xSnap - xStart) / xDist;\n              currentVertex.y = (ySnap - yStart) / yDist;\n\n              currentVertices[vertexIndex] = currentVertex;\n            }\n\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n\n            // Update save model\n            currentSource.onChange({ ...currentSource.options, connections: currentConnections });\n            this.updateState();\n            this.scene.save();\n          }\n        }\n      }\n    }\n  };\n\n  // Handles mousemove and mouseup events when dragging a new vertex\n  vertexAddListener = (event: MouseEvent) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n\n    event.preventDefault();\n\n    if (!(this.connectionVertex && this.scene.div && this.scene.div.parentElement)) {\n      return;\n    }\n\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const x = (event.pageX - parentBoundingRect.x) / transformScale ?? 0;\n    const y = (event.pageY - parentBoundingRect.y) / transformScale ?? 0;\n\n    this.connectionVertex?.setAttribute('cx', `${x}`);\n    this.connectionVertex?.setAttribute('cy', `${y}`);\n\n    const selectedValue = this.selection.value;\n    const sourceRect = selectedValue!.source.div!.getBoundingClientRect();\n\n    // calculate relative coordinates based on source and target coorindates of connection\n    const { x1, y1, x2, y2 } = calculateCoordinates(\n      sourceRect,\n      parentBoundingRect,\n      selectedValue?.info!,\n      selectedValue!.target,\n      transformScale\n    );\n\n    let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n    if (selectedValue?.sourceOriginal && selectedValue.targetOriginal) {\n      xStart = selectedValue.sourceOriginal.x;\n      yStart = selectedValue.sourceOriginal.y;\n      xEnd = selectedValue.targetOriginal.x;\n      yEnd = selectedValue.targetOriginal.y;\n    }\n\n    const xDist = xEnd - xStart;\n    const yDist = yEnd - yStart;\n\n    let vx1 = x1;\n    let vy1 = y1;\n    let vx2 = x2;\n    let vy2 = y2;\n    if (selectedValue && selectedValue.vertices) {\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex > 0) {\n        vx1 = selectedValue.vertices[this.selectedVertexIndex - 1].x * xDist + xStart;\n        vy1 = selectedValue.vertices[this.selectedVertexIndex - 1].y * yDist + yStart;\n      }\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex < selectedValue.vertices.length) {\n        vx2 = selectedValue.vertices[this.selectedVertexIndex].x * xDist + xStart;\n        vy2 = selectedValue.vertices[this.selectedVertexIndex].y * yDist + yStart;\n      }\n    }\n\n    // Check if slope before vertex and after vertex is within snapping tolerance\n    let xSnap = x;\n    let ySnap = y;\n    // Ignore if control key being held\n    if (!event.ctrlKey) {\n      // Check if segment before and after vertex are close to vertical or horizontal\n      const verticalBefore = Math.abs((x - vx1) / (y - vy1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const verticalAfter = Math.abs((x - vx2) / (y - vy2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalBefore = Math.abs((y - vy1) / (x - vx1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalAfter = Math.abs((y - vy2) / (x - vx2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n\n      if (verticalBefore) {\n        xSnap = vx1;\n      } else if (verticalAfter) {\n        xSnap = vx2;\n      }\n      if (horizontalBefore) {\n        ySnap = vy1;\n      } else if (horizontalAfter) {\n        ySnap = vy2;\n      }\n\n      if ((verticalBefore || verticalAfter) && (horizontalBefore || horizontalAfter)) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'move';\n      } else if (verticalBefore || verticalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'col-resize';\n      } else if (horizontalBefore || horizontalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'row-resize';\n      }\n    }\n\n    this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${xSnap} ${ySnap} L${vx2} ${vy2}`);\n    this.connectionSVGVertex!.style.display = 'block';\n    this.connectionVertex.style.display = 'block';\n\n    // Handle mouseup\n    if (!event.buttons) {\n      // Remove existing event listener\n      this.scene.selecto?.rootContainer?.removeEventListener('mousemove', this.vertexAddListener);\n      this.scene.selecto?.rootContainer?.removeEventListener('mouseup', this.vertexAddListener);\n      this.scene.selecto!.rootContainer!.style.cursor = 'auto';\n      this.connectionSVGVertex!.style.display = 'none';\n\n      // call onChange here and insert new vertex at appropriate index of connection vertices array\n      const connectionIndex = selectedValue?.index;\n      const vertexIndex = this.selectedVertexIndex;\n\n      if (connectionIndex !== undefined && vertexIndex !== undefined) {\n        const currentSource = selectedValue!.source;\n        if (currentSource.options.connections) {\n          const currentConnections = [...currentSource.options.connections];\n          const newVertex = { x: (x - xStart) / xDist, y: (y - yStart) / yDist };\n          if (currentConnections[connectionIndex].vertices) {\n            const currentVertices = [...currentConnections[connectionIndex].vertices!];\n            currentVertices.splice(vertexIndex, 0, newVertex);\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n          } else {\n            // For first vertex creation\n            const currentVertices: ConnectionCoordinates[] = [newVertex];\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n          }\n\n          // Check for original state\n          if (\n            !currentConnections[connectionIndex].sourceOriginal ||\n            !currentConnections[connectionIndex].targetOriginal\n          ) {\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              sourceOriginal: { x: x1, y: y1 },\n              targetOriginal: { x: x2, y: y2 },\n            };\n          }\n          // Update save model\n          currentSource.onChange({ ...currentSource.options, connections: currentConnections });\n          this.updateState();\n          this.scene.save();\n        }\n      }\n    }\n  };\n\n  handleConnectionDragStart = (selectedTarget: HTMLElement, clientX: number, clientY: number) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n    if (this.connectionSVG && this.connectionLine && this.scene.div && this.scene.div.parentElement) {\n      const connectionStartTargetBox = selectedTarget.getBoundingClientRect();\n\n      const transformScale = this.scene.scale;\n      const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n      if (!parentBoundingRect) {\n        return;\n      }\n\n      // Multiply by transform scale to calculate the correct scaled offset\n      const connectionAnchorOffsetX = CONNECTION_ANCHOR_HIGHLIGHT_OFFSET * transformScale;\n      const connectionAnchorOffsetY = CONNECTION_ANCHOR_HIGHLIGHT_OFFSET * transformScale;\n\n      const x = (connectionStartTargetBox.x - parentBoundingRect.x + connectionAnchorOffsetX) / transformScale;\n      const y = (connectionStartTargetBox.y - parentBoundingRect.y + connectionAnchorOffsetY) / transformScale;\n\n      const mouseX = clientX - parentBoundingRect.x;\n      const mouseY = clientY - parentBoundingRect.y;\n\n      this.connectionLine.setAttribute('x1', `${x}`);\n      this.connectionLine.setAttribute('y1', `${y}`);\n      this.connectionLine.setAttribute('x2', `${mouseX}`);\n      this.connectionLine.setAttribute('y2', `${mouseY}`);\n      this.didConnectionLeaveHighlight = false;\n    }\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.connectionListener);\n  };\n\n  // Add event listener at root container during existing vertex drag\n  handleVertexDragStart = (selectedTarget: HTMLElement) => {\n    // Get vertex index from selected target data\n    this.selectedVertexIndex = Number(selectedTarget.getAttribute('data-index'));\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.vertexListener);\n    this.scene.selecto?.rootContainer?.addEventListener('mouseup', this.vertexListener);\n  };\n\n  // Add event listener at root container during creation of new vertex\n  handleVertexAddDragStart = (selectedTarget: HTMLElement) => {\n    // Get vertex index from selected target data\n    this.selectedVertexIndex = Number(selectedTarget.getAttribute('data-index'));\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.vertexAddListener);\n    this.scene.selecto?.rootContainer?.addEventListener('mouseup', this.vertexAddListener);\n  };\n\n  onChange = (current: ConnectionState, update: CanvasConnection) => {\n    const connections = current.source.options.connections?.splice(0) ?? [];\n    connections[current.index] = update;\n    current.source.onChange({ ...current.source.options, connections });\n    this.updateState();\n  };\n\n  // used for moveable actions\n  connectionsNeedUpdate = (element: ElementState): boolean => {\n    return isConnectionSource(element) || isConnectionTarget(element, this.scene.byName);\n  };\n\n  render() {\n    return (\n      <>\n        <ConnectionAnchors\n          setRef={this.setConnectionAnchorRef}\n          setAnchorsRef={this.setAnchorsRef}\n          handleMouseLeave={this.handleMouseLeave}\n        />\n        <ConnectionSVG\n          setSVGRef={this.setConnectionSVGRef}\n          setLineRef={this.setConnectionLineRef}\n          setSVGVertexRef={this.setConnectionSVGVertexRef}\n          setVertexPathRef={this.setConnectionVertexPathRef}\n          setVertexRef={this.setConnectionVertexRef}\n          scene={this.scene}\n        />\n      </>\n    );\n  }\n}\n","import { MoveableManagerInterface, Renderer } from 'moveable';\n\nimport { VerticalConstraint, HorizontalConstraint } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { Scene } from './scene';\nimport { findElementByTarget } from './sceneElementManagement';\n\nexport const settingsViewable = (scene: Scene) => ({\n  name: 'settingsViewable',\n  props: [],\n  events: [],\n  render(moveable: MoveableManagerInterface<unknown, unknown>, React: Renderer) {\n    // If selection is more than 1 element don't display settings button\n    if (scene.selecto?.getSelectedTargets() && scene.selecto?.getSelectedTargets().length > 1) {\n      return;\n    }\n\n    const openSettings = (x: number, y: number) => {\n      const container = moveable.getContainer();\n      const evt = new PointerEvent('contextmenu', { clientX: x, clientY: y });\n      container.dispatchEvent(evt);\n    };\n\n    const onClick = (event: React.MouseEvent) => {\n      openSettings(event.clientX, event.clientY);\n    };\n\n    const onKeyPress = (event: React.KeyboardEvent) => {\n      if (event.key === 'Enter') {\n        const rect = event.currentTarget.getBoundingClientRect();\n        openSettings(rect.x, rect.y);\n      }\n    };\n\n    const rect = moveable.getRect();\n    return (\n      <div\n        key={'settings-viewable'}\n        className={'moveable-settings'}\n        style={{\n          position: 'absolute',\n          left: `${rect.width + 18}px`,\n          top: '0px',\n          color: 'white',\n          fontSize: '18px',\n          cursor: 'pointer',\n          userSelect: 'none',\n          willChange: 'transform',\n          transform: 'translate(-50%, 0px)',\n          zIndex: 100,\n        }}\n        onClick={onClick}\n        onKeyDown={onKeyPress}\n        role=\"button\"\n        tabIndex={0}\n      >\n        {``}\n        \n        {``}\n      </div>\n    );\n  },\n});\n\nexport const dimensionViewable = {\n  name: 'dimensionViewable',\n  props: [],\n  events: [],\n  render(moveable: MoveableManagerInterface<unknown, unknown>, React: Renderer) {\n    const rect = moveable.getRect();\n    return (\n      <div\n        key={'dimension-viewable'}\n        className={'moveable-dimension'}\n        style={{\n          position: 'absolute',\n          left: `${rect.width / 2}px`,\n          top: `${rect.height + 20}px`,\n          background: '#4af',\n          borderRadius: '2px',\n          padding: '2px 4px',\n          color: 'white',\n          fontSize: '13px',\n          whiteSpace: 'nowrap',\n          fontWeight: 'bold',\n          willChange: 'transform',\n          transform: 'translate(-50%, 0px)',\n          zIndex: 100,\n        }}\n      >\n        {Math.round(rect.offsetWidth)} x {Math.round(rect.offsetHeight)}\n      </div>\n    );\n  },\n};\n\nexport const constraintViewable = (scene: Scene) => ({\n  name: 'constraintViewable',\n  props: [],\n  events: [],\n  render(moveable: MoveableManagerInterface<unknown, unknown>, React: Renderer) {\n    const rect = moveable.getRect();\n    const targetElement = findElementByTarget(moveable.state.target!, scene.root.elements);\n\n    // If selection is more than 1 element don't display constraint visualizations\n    if (scene.selecto?.getSelectedTargets() && scene.selecto?.getSelectedTargets().length > 1) {\n      return;\n    }\n\n    let verticalConstraintVisualization = null;\n    let horizontalConstraintVisualization = null;\n\n    const constraint = targetElement?.tempConstraint ?? targetElement?.options.constraint ?? {};\n\n    const borderStyle = '1px dashed #4af';\n\n    const centerIndicatorLineOne = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height / 2 - rect.height / 16}px`,\n        borderLeft: borderStyle,\n        height: `${rect.height / 8}px`,\n        transform: 'rotate(45deg)',\n      },\n    });\n\n    const centerIndicatorLineTwo = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height / 2 - rect.height / 16}px`,\n        borderLeft: borderStyle,\n        height: `${rect.height / 8}px`,\n        transform: 'rotate(-45deg)',\n      },\n    });\n\n    const centerIndicator = React.createElement('div', {}, [centerIndicatorLineOne, centerIndicatorLineTwo]);\n\n    const verticalConstraintTop = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        bottom: '0px',\n        borderLeft: borderStyle,\n        height: '100vh',\n      },\n    });\n\n    const verticalConstraintBottom = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height}px`,\n        borderLeft: borderStyle,\n        height: '100vh',\n      },\n    });\n\n    const verticalConstraintTopBottom = React.createElement('div', {}, [\n      verticalConstraintTop,\n      verticalConstraintBottom,\n    ]);\n\n    const verticalConstraintCenterLine = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height / 4}px`,\n        borderLeft: borderStyle,\n        height: `${rect.height / 2}px`,\n      },\n    });\n\n    const verticalConstraintCenter = React.createElement('div', {}, [verticalConstraintCenterLine, centerIndicator]);\n\n    switch (constraint.vertical) {\n      case VerticalConstraint.Top:\n        verticalConstraintVisualization = verticalConstraintTop;\n        break;\n      case VerticalConstraint.Bottom:\n        verticalConstraintVisualization = verticalConstraintBottom;\n        break;\n      case VerticalConstraint.TopBottom:\n        verticalConstraintVisualization = verticalConstraintTopBottom;\n        break;\n      case VerticalConstraint.Center:\n        verticalConstraintVisualization = verticalConstraintCenter;\n        break;\n    }\n\n    const horizontalConstraintLeft = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        right: '0px',\n        top: `${rect.height / 2}px`,\n        borderTop: borderStyle,\n        width: '100vw',\n      },\n    });\n\n    const horizontalConstraintRight = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width}px`,\n        top: `${rect.height / 2}px`,\n        borderTop: borderStyle,\n        width: '100vw',\n      },\n    });\n\n    const horizontalConstraintLeftRight = React.createElement('div', {}, [\n      horizontalConstraintLeft,\n      horizontalConstraintRight,\n    ]);\n\n    const horizontalConstraintCenterLine = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 4}px`,\n        top: `${rect.height / 2}px`,\n        borderTop: borderStyle,\n        width: `${rect.width / 2}px`,\n      },\n    });\n\n    const horizontalConstraintCenter = React.createElement('div', {}, [\n      horizontalConstraintCenterLine,\n      centerIndicator,\n    ]);\n\n    switch (constraint.horizontal) {\n      case HorizontalConstraint.Left:\n        horizontalConstraintVisualization = horizontalConstraintLeft;\n        break;\n      case HorizontalConstraint.Right:\n        horizontalConstraintVisualization = horizontalConstraintRight;\n        break;\n      case HorizontalConstraint.LeftRight:\n        horizontalConstraintVisualization = horizontalConstraintLeftRight;\n        break;\n      case HorizontalConstraint.Center:\n        horizontalConstraintVisualization = horizontalConstraintCenter;\n        break;\n    }\n\n    const constraintVisualization = React.createElement('div', {}, [\n      verticalConstraintVisualization,\n      horizontalConstraintVisualization,\n    ]);\n\n    return constraintVisualization;\n  },\n});\n","import Moveable from 'moveable';\nimport Selecto from 'selecto';\n\nimport { CONNECTION_ANCHOR_DIV_ID } from 'app/plugins/panel/canvas/components/connections/ConnectionAnchors';\nimport {\n  CONNECTION_VERTEX_ID,\n  CONNECTION_VERTEX_ADD_ID,\n} from 'app/plugins/panel/canvas/components/connections/Connections';\nimport { VerticalConstraint, HorizontalConstraint } from 'app/plugins/panel/canvas/panelcfg.gen';\nimport { getParent } from 'app/plugins/panel/canvas/utils';\n\nimport { dimensionViewable, constraintViewable, settingsViewable } from './ables';\nimport { ElementState } from './element';\nimport { FrameState } from './frame';\nimport { Scene } from './scene';\nimport { findElementByTarget } from './sceneElementManagement';\n\n// Helper function that disables custom able functionality\nconst disableCustomables = (moveable: Moveable) => {\n  moveable!.props = {\n    dimensionViewable: false,\n    constraintViewable: false,\n    settingsViewable: false,\n  };\n};\n\n// Helper function that enables custom able functionality\nconst enableCustomables = (moveable: Moveable) => {\n  moveable!.props = {\n    dimensionViewable: true,\n    constraintViewable: true,\n    settingsViewable: true,\n  };\n};\n\n/* \n  Helper function that determines if the selected DOM target is currently selected in selecto state.\n\n  For context canvas elements each have a different level of nesting.\n  Given this, we need to traverse up the DOM tree from the selected target to find\n  the element's registered selecto div to determine if the selected target is already selected in selecto state.\n  See `initMoveable` and `generateTargetElements` for more context.\n*/\nconst isTargetAlreadySelected = (selectedTarget: HTMLElement, scene: Scene) => {\n  let selectedTargetParent = selectedTarget.parentElement;\n  let isTargetAlreadySelected = false;\n\n  // Traverse up the DOM tree to check if the selected target is already selected\n  while (selectedTargetParent) {\n    // If the selected target is the scene's root element div, break the loop\n    if (selectedTargetParent === scene.root.div) {\n      break;\n    }\n\n    // Check if the selected target is already selected\n    isTargetAlreadySelected = scene.selecto?.getSelectedTargets().includes(selectedTargetParent) ?? false;\n    if (isTargetAlreadySelected) {\n      break;\n    }\n\n    // Move up the DOM tree to the next parent element to check\n    selectedTargetParent = selectedTargetParent.parentElement;\n  }\n\n  return isTargetAlreadySelected;\n};\n\n// Generate HTML element divs for every canvas element to configure selecto / moveable\nconst generateTargetElements = (rootElements: ElementState[]): HTMLDivElement[] => {\n  let targetElements: HTMLDivElement[] = [];\n\n  const stack = [...rootElements];\n  while (stack.length > 0) {\n    const currentElement = stack.shift();\n\n    if (currentElement && currentElement.div) {\n      targetElements.push(currentElement.div);\n    }\n\n    const nestedElements = currentElement instanceof FrameState ? currentElement.elements : [];\n    for (const nestedElement of nestedElements) {\n      stack.unshift(nestedElement);\n    }\n  }\n\n  return targetElements;\n};\n\n// Main entry point for initializing / updating moveable and selecto configuration\nexport const initMoveable = (destroySelecto = false, allowChanges = true, scene: Scene) => {\n  const targetElements = generateTargetElements(scene.root.elements);\n\n  if (destroySelecto && scene.selecto) {\n    scene.selecto.destroy();\n  }\n\n  scene.selecto = new Selecto({\n    container: scene.div,\n    rootContainer: getParent(scene),\n    selectableTargets: targetElements,\n    toggleContinueSelect: 'shift',\n    selectFromInside: false,\n    hitRate: 0,\n  });\n\n  const snapDirections = { top: true, left: true, bottom: true, right: true, center: true, middle: true };\n  const elementSnapDirections = { top: true, left: true, bottom: true, right: true, center: true, middle: true };\n\n  scene.moveable = new Moveable(scene.div!, {\n    draggable: allowChanges && !scene.editModeEnabled.getValue(),\n    resizable: allowChanges,\n\n    // Setup rotatable\n    rotatable: allowChanges,\n    throttleRotate: 5,\n    rotationPosition: ['top', 'right'],\n\n    // Setup snappable\n    snappable: allowChanges,\n    snapDirections: snapDirections,\n    elementSnapDirections: elementSnapDirections,\n    elementGuidelines: targetElements,\n\n    ables: [dimensionViewable, constraintViewable(scene), settingsViewable(scene)],\n    props: {\n      dimensionViewable: allowChanges,\n      constraintViewable: allowChanges,\n      settingsViewable: allowChanges,\n    },\n    origin: false,\n  })\n    .on('rotateStart', () => {\n      disableCustomables(scene.moveable!);\n    })\n    .on('rotate', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n\n      if (targetedElement) {\n        targetedElement.applyRotate(event);\n      }\n    })\n    .on('rotateGroup', (e) => {\n      for (let event of e.events) {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          targetedElement.applyRotate(event);\n        }\n      }\n    })\n    .on('rotateEnd', () => {\n      enableCustomables(scene.moveable!);\n      // Update the editor with the new rotation\n      scene.moved.next(Date.now());\n    })\n    .on('click', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      let elementSupportsEditing = false;\n      if (targetedElement) {\n        elementSupportsEditing = targetedElement.item.hasEditMode ?? false;\n      }\n\n      if (event.isDouble && allowChanges && !scene.editModeEnabled.getValue() && elementSupportsEditing) {\n        scene.editModeEnabled.next(true);\n      }\n    })\n    .on('clickGroup', (event) => {\n      scene.selecto!.clickTarget(event.inputEvent, event.inputTarget);\n    })\n    .on('dragStart', (event) => {\n      scene.ignoreDataUpdate = true;\n      scene.setNonTargetPointerEvents(event.target, true);\n\n      // Remove the selected element from the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n        if (targetIndex > -1) {\n          scene.moveable.elementGuidelines.splice(targetIndex, 1);\n        }\n      }\n    })\n    .on('dragGroupStart', (e) => {\n      scene.ignoreDataUpdate = true;\n\n      // Remove the selected elements from the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        for (let event of e.events) {\n          const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n          if (targetIndex > -1) {\n            scene.moveable.elementGuidelines.splice(targetIndex, 1);\n          }\n        }\n      }\n    })\n    .on('drag', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      if (targetedElement) {\n        targetedElement.applyDrag(event);\n\n        if (scene.connections.connectionsNeedUpdate(targetedElement) && scene.moveableActionCallback) {\n          scene.moveableActionCallback(true);\n        }\n      }\n    })\n    .on('dragGroup', (e) => {\n      let needsUpdate = false;\n      for (let event of e.events) {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          targetedElement.applyDrag(event);\n          if (!needsUpdate) {\n            needsUpdate = scene.connections.connectionsNeedUpdate(targetedElement);\n          }\n        }\n      }\n\n      if (needsUpdate && scene.moveableActionCallback) {\n        scene.moveableActionCallback(true);\n      }\n    })\n    .on('dragGroupEnd', (e) => {\n      e.events.forEach((event) => {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          if (targetedElement) {\n            targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n          }\n\n          // re-add the selected elements to the snappable guidelines\n          if (scene.moveable && scene.moveable.elementGuidelines) {\n            scene.moveable.elementGuidelines.push(event.target);\n          }\n        }\n      });\n\n      scene.moved.next(Date.now());\n      scene.ignoreDataUpdate = false;\n    })\n    .on('dragEnd', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      if (targetedElement) {\n        targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n      }\n\n      scene.moved.next(Date.now());\n      scene.ignoreDataUpdate = false;\n      scene.setNonTargetPointerEvents(event.target, false);\n\n      // re-add the selected element to the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        scene.moveable.elementGuidelines.push(event.target);\n      }\n    })\n    .on('resizeStart', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n\n      if (targetedElement) {\n        // Remove the selected element from the snappable guidelines\n        if (scene.moveable && scene.moveable.elementGuidelines) {\n          const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n          if (targetIndex > -1) {\n            scene.moveable.elementGuidelines.splice(targetIndex, 1);\n          }\n        }\n\n        targetedElement.tempConstraint = { ...targetedElement.options.constraint };\n        targetedElement.options.constraint = {\n          vertical: VerticalConstraint.Top,\n          horizontal: HorizontalConstraint.Left,\n        };\n        targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n      }\n    })\n    .on('resizeGroupStart', (e) => {\n      // Remove the selected elements from the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        for (let event of e.events) {\n          const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n          if (targetIndex > -1) {\n            scene.moveable.elementGuidelines.splice(targetIndex, 1);\n          }\n        }\n      }\n    })\n    .on('resize', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      if (targetedElement) {\n        targetedElement.applyResize(event, scene.scale);\n\n        if (scene.connections.connectionsNeedUpdate(targetedElement) && scene.moveableActionCallback) {\n          scene.moveableActionCallback(true);\n        }\n      }\n      scene.moved.next(Date.now()); // TODO only on end\n    })\n    .on('resizeGroup', (e) => {\n      let needsUpdate = false;\n      for (let event of e.events) {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          targetedElement.applyResize(event);\n\n          if (!needsUpdate) {\n            needsUpdate = scene.connections.connectionsNeedUpdate(targetedElement);\n          }\n        }\n      }\n\n      if (needsUpdate && scene.moveableActionCallback) {\n        scene.moveableActionCallback(true);\n      }\n\n      scene.moved.next(Date.now()); // TODO only on end\n    })\n    .on('resizeEnd', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n\n      if (targetedElement) {\n        if (targetedElement.tempConstraint) {\n          targetedElement.options.constraint = targetedElement.tempConstraint;\n          targetedElement.tempConstraint = undefined;\n        }\n\n        targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n\n        // re-add the selected element to the snappable guidelines\n        if (scene.moveable && scene.moveable.elementGuidelines) {\n          scene.moveable.elementGuidelines.push(event.target);\n        }\n      }\n    })\n    .on('resizeGroupEnd', (e) => {\n      // re-add the selected elements to the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        for (let event of e.events) {\n          scene.moveable.elementGuidelines.push(event.target);\n        }\n      }\n    });\n\n  let targets: Array<HTMLElement | SVGElement> = [];\n  scene\n    .selecto!.on('dragStart', (event) => {\n      const selectedTarget = event.inputEvent.target;\n\n      // If selected target is a connection control, eject to handle connection event\n      if (selectedTarget.id === CONNECTION_ANCHOR_DIV_ID) {\n        scene.connections.handleConnectionDragStart(selectedTarget, event.inputEvent.clientX, event.inputEvent.clientY);\n        event.stop();\n        return;\n      }\n\n      // If selected target is a vertex, eject to handle vertex event\n      if (selectedTarget.id === CONNECTION_VERTEX_ID) {\n        scene.connections.handleVertexDragStart(selectedTarget);\n        event.stop();\n        return;\n      }\n\n      // If selected target is an add vertex point, eject to handle add vertex event\n      if (selectedTarget.id === CONNECTION_VERTEX_ADD_ID) {\n        scene.connections.handleVertexAddDragStart(selectedTarget);\n        event.stop();\n        return;\n      }\n\n      const isTargetMoveableElement =\n        scene.moveable!.isMoveableElement(selectedTarget) ||\n        targets.some((target) => target === selectedTarget || target.contains(selectedTarget));\n\n      const isElementSelected = isTargetAlreadySelected(selectedTarget, scene);\n\n      // Apply grabbing cursor while dragging, applyLayoutStylesToDiv() resets it to grab when done\n      if (\n        scene.isEditingEnabled &&\n        !scene.editModeEnabled.getValue() &&\n        isTargetMoveableElement &&\n        scene.selecto?.getSelectedTargets().length\n      ) {\n        scene.selecto.getSelectedTargets()[0].style.cursor = 'grabbing';\n      }\n\n      if (isTargetMoveableElement || isElementSelected || !scene.isEditingEnabled) {\n        // Prevent drawing selection box when selected target is a moveable element or already selected\n        event.stop();\n      }\n    })\n    .on('select', () => {\n      scene.editModeEnabled.next(false);\n\n      // Hide connection anchors on select\n      if (scene.connections.connectionAnchorDiv) {\n        scene.connections.connectionAnchorDiv.style.display = 'none';\n      }\n    })\n    .on('selectEnd', (event) => {\n      targets = event.selected;\n      scene.updateSelection({ targets });\n\n      if (event.isDragStart) {\n        if (scene.isEditingEnabled && !scene.editModeEnabled.getValue() && scene.selecto?.getSelectedTargets().length) {\n          scene.selecto.getSelectedTargets()[0].style.cursor = 'grabbing';\n        }\n        event.inputEvent.preventDefault();\n        event.data.timer = setTimeout(() => {\n          scene.moveable!.dragStart(event.inputEvent);\n        });\n      }\n    })\n    .on('dragEnd', (event) => {\n      clearTimeout(event.data.timer);\n    });\n};\n","import { cloneDeep } from 'lodash';\n\nimport { notFoundItem } from 'app/features/canvas/elements/notFound';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { HorizontalConstraint, Placement, VerticalConstraint } from 'app/plugins/panel/canvas/panelcfg.gen';\nimport { LayerActionID } from 'app/plugins/panel/canvas/types';\n\nimport { updateConnectionsForSource } from '../../../plugins/panel/canvas/utils';\nimport { CanvasElementItem } from '../element';\nimport { CanvasFrameOptions } from '../frame';\nimport { canvasElementRegistry } from '../registry';\n\nimport { ElementState } from './element';\nimport { RootElement } from './root';\nimport { Scene } from './scene';\nimport { initMoveable } from './sceneAbleManagement';\n\nconst DEFAULT_OFFSET = 10;\nconst HORIZONTAL_OFFSET = 50;\n\nexport const frameItemDummy: CanvasElementItem = {\n  id: 'frame',\n  name: 'Frame',\n  description: 'Frame',\n\n  getNewOptions: () => ({\n    config: {},\n  }),\n\n  display: () => {\n    return <div>FRAME!</div>;\n  },\n};\n\nexport class FrameState extends ElementState {\n  elements: ElementState[] = [];\n  scene: Scene;\n\n  constructor(\n    public options: CanvasFrameOptions,\n    scene: Scene,\n    public parent?: FrameState\n  ) {\n    super(frameItemDummy, options, parent);\n\n    this.scene = scene;\n\n    // mutate options object\n    let { elements } = this.options;\n    if (!elements) {\n      this.options.elements = elements = [];\n    }\n\n    for (const element of elements) {\n      if (element.type === 'frame') {\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        this.elements.push(new FrameState(element as CanvasFrameOptions, scene, this));\n      } else {\n        const item = canvasElementRegistry.getIfExists(element.type) ?? notFoundItem;\n        this.elements.push(new ElementState(item, element, this));\n      }\n    }\n  }\n\n  isRoot(): this is RootElement {\n    return false;\n  }\n\n  updateData(ctx: DimensionContext) {\n    super.updateData(ctx);\n    for (const elem of this.elements) {\n      elem.updateData(ctx);\n    }\n  }\n\n  // used in the layer editor\n  reorder(startIndex: number, endIndex: number) {\n    const result = Array.from(this.elements);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n    this.elements = result;\n\n    this.reinitializeMoveable();\n  }\n\n  // used for tree view\n  reorderTree(src: ElementState, dest: ElementState, firstPosition = false) {\n    const result = Array.from(this.elements);\n    const srcIndex = this.elements.indexOf(src);\n    const destIndex = firstPosition ? this.elements.length - 1 : this.elements.indexOf(dest);\n\n    const [removed] = result.splice(srcIndex, 1);\n    result.splice(destIndex, 0, removed);\n    this.elements = result;\n\n    this.reinitializeMoveable();\n  }\n\n  doMove(child: ElementState, action: LayerActionID) {\n    const vals = this.elements.filter((v) => v !== child);\n    if (action === LayerActionID.MoveBottom) {\n      vals.unshift(child);\n    } else {\n      vals.push(child);\n    }\n    this.elements = vals;\n    this.scene.save();\n    this.reinitializeMoveable();\n  }\n\n  reinitializeMoveable() {\n    // Need to first clear current selection and then re-init moveable with slight delay\n    this.scene.clearCurrentSelection();\n    setTimeout(() => initMoveable(true, this.scene.isEditingEnabled, this.scene));\n  }\n\n  // ??? or should this be on the element directly?\n  // are actions scoped to layers?\n  doAction = (action: LayerActionID, element: ElementState, updateName = true, shiftItemsOnDuplicate = true) => {\n    switch (action) {\n      case LayerActionID.Delete:\n        this.elements = this.elements.filter((e) => e !== element);\n        updateConnectionsForSource(element, this.scene);\n        this.scene.byName.delete(element.options.name);\n        this.scene.save();\n        this.reinitializeMoveable();\n        break;\n      case LayerActionID.Duplicate:\n        if (element.item.id === 'frame') {\n          console.log('Can not duplicate frames (yet)', action, element);\n          return;\n        }\n        const opts = cloneDeep(element.options);\n\n        if (shiftItemsOnDuplicate) {\n          const { constraint, placement: oldPlacement } = element.options;\n          const { vertical, horizontal } = constraint ?? {};\n          const placement: Placement = { ...oldPlacement } ?? {};\n\n          switch (vertical) {\n            case VerticalConstraint.Top:\n              if (placement.top == null) {\n                placement.top = 25;\n              } else {\n                placement.top += DEFAULT_OFFSET;\n              }\n              break;\n            case VerticalConstraint.Bottom:\n              if (placement.bottom == null) {\n                placement.bottom = 100;\n              } else {\n                placement.bottom -= DEFAULT_OFFSET;\n              }\n              break;\n            case VerticalConstraint.TopBottom:\n              if (placement.top == null) {\n                placement.top = 25;\n              } else {\n                placement.top += DEFAULT_OFFSET;\n              }\n\n              if (placement.bottom == null) {\n                placement.bottom = 100;\n              } else {\n                placement.bottom -= DEFAULT_OFFSET;\n              }\n              break;\n            case VerticalConstraint.Center:\n              if (placement.top != null) {\n                placement.top -= DEFAULT_OFFSET;\n              }\n              break;\n          }\n\n          switch (horizontal) {\n            case HorizontalConstraint.Left:\n              if (placement.left == null) {\n                placement.left = HORIZONTAL_OFFSET;\n              } else {\n                placement.left += DEFAULT_OFFSET;\n              }\n              break;\n            case HorizontalConstraint.Right:\n              if (placement.right == null) {\n                placement.right = HORIZONTAL_OFFSET;\n              } else {\n                placement.right -= DEFAULT_OFFSET;\n              }\n              break;\n            case HorizontalConstraint.LeftRight:\n              if (placement.left == null) {\n                placement.left = HORIZONTAL_OFFSET;\n              } else {\n                placement.left += DEFAULT_OFFSET;\n              }\n\n              if (placement.right == null) {\n                placement.right = HORIZONTAL_OFFSET;\n              } else {\n                placement.right -= DEFAULT_OFFSET;\n              }\n              break;\n            case HorizontalConstraint.Center:\n              if (placement.left != null) {\n                placement.left -= DEFAULT_OFFSET;\n              }\n              break;\n          }\n\n          opts.placement = placement;\n        }\n\n        // Clear connections on duplicate\n        opts.connections = undefined;\n\n        const copy = new ElementState(element.item, opts, this);\n        copy.updateData(this.scene.context);\n        if (updateName) {\n          copy.options.name = this.scene.getNextElementName();\n        }\n        this.elements.push(copy);\n        this.scene.byName.set(copy.options.name, copy);\n\n        // Update scene byName map for original element (to avoid stale references (e.g. for connections))\n        this.scene.byName.set(element.options.name, element);\n\n        this.scene.save();\n        this.reinitializeMoveable();\n\n        setTimeout(() => {\n          this.scene.targetsToSelect.add(copy.div!);\n        });\n        break;\n      case LayerActionID.MoveTop:\n      case LayerActionID.MoveBottom:\n        element.parent?.doMove(element, action);\n        break;\n\n      default:\n        console.log('DO action', action, element);\n        return;\n    }\n  };\n\n  render() {\n    return (\n      <div key={this.UID} ref={this.initElement}>\n        {this.elements.map((v) => v.render())}\n      </div>\n    );\n  }\n\n  /** Recursively visit all nodes */\n  visit(visitor: (v: ElementState) => void) {\n    super.visit(visitor);\n    for (const e of this.elements) {\n      visitor(e);\n    }\n  }\n\n  getSaveModel() {\n    return {\n      ...this.options,\n      elements: this.elements.map((v) => v.getSaveModel()),\n    };\n  }\n}\n","import { css } from '@emotion/css';\nimport { useCallback, useEffect, useState } from 'react';\nimport * as React from 'react';\nimport { first } from 'rxjs/operators';\n\nimport { SelectableValue } from '@grafana/data';\nimport { ContextMenu, MenuItem, MenuItemProps } from '@grafana/ui';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { findElementByTarget } from 'app/features/canvas/runtime/sceneElementManagement';\n\nimport { CanvasPanel } from '../CanvasPanel';\nimport { AnchorPoint, LayerActionID } from '../types';\nimport { getElementTypes, onAddItem } from '../utils';\n\ntype Props = {\n  scene: Scene;\n  panel: CanvasPanel;\n  onVisibilityChange: (v: boolean) => void;\n};\n\nexport const CanvasContextMenu = ({ scene, panel, onVisibilityChange }: Props) => {\n  const inlineEditorOpen = panel.state.openInlineEdit;\n  const [isMenuVisible, setIsMenuVisible] = useState<boolean>(false);\n  const [anchorPoint, setAnchorPoint] = useState<AnchorPoint>({ x: 0, y: 0 });\n\n  const styles = getStyles();\n\n  const selectedElements = scene.selecto?.getSelectedTargets();\n  const rootLayer: FrameState | undefined = panel.context?.instanceState?.layer;\n\n  const handleContextMenu = useCallback(\n    (event: Event) => {\n      if (!(event instanceof MouseEvent) || event.ctrlKey) {\n        return;\n      }\n\n      event.preventDefault();\n      panel.setActivePanel();\n\n      const shouldSelectElement = event.currentTarget !== scene.div;\n      if (\n        shouldSelectElement &&\n        (event.currentTarget instanceof HTMLElement || event.currentTarget instanceof SVGElement)\n      ) {\n        scene.select({ targets: [event.currentTarget] });\n      }\n      setAnchorPoint({ x: event.pageX, y: event.pageY });\n      setIsMenuVisible(true);\n      onVisibilityChange(true);\n    },\n    [scene, panel, onVisibilityChange]\n  );\n\n  useEffect(() => {\n    if (scene.selecto) {\n      scene.selecto.getSelectableElements().forEach((element) => {\n        element.addEventListener('contextmenu', handleContextMenu);\n      });\n    }\n  }, [handleContextMenu, scene.selecto]);\n\n  useEffect(() => {\n    if (scene.div) {\n      scene.div.addEventListener('contextmenu', handleContextMenu);\n    }\n  }, [handleContextMenu, scene.div]);\n\n  const closeContextMenu = () => {\n    setIsMenuVisible(false);\n    onVisibilityChange(false);\n  };\n\n  const renderMenuItems = () => {\n    // This is disabled when panel is in edit mode because opening inline editor over panel editor is not ideal UX\n    const openCloseEditorMenuItem = !scene.isPanelEditing && (\n      <MenuItem\n        label={inlineEditorOpen ? 'Close Editor' : 'Open Editor'}\n        onClick={() => {\n          if (scene.inlineEditingCallback) {\n            if (inlineEditorOpen) {\n              panel.closeInlineEdit();\n            } else {\n              scene.inlineEditingCallback();\n            }\n          }\n          closeContextMenu();\n        }}\n        className={styles.menuItem}\n      />\n    );\n\n    const editElementMenuItem = () => {\n      if (selectedElements?.length === 1) {\n        const onClickEditElementMenuItem = () => {\n          scene.editModeEnabled.next(true);\n          closeContextMenu();\n        };\n\n        const element = findElementByTarget(selectedElements[0], scene.root.elements);\n        return (\n          element &&\n          element.item.hasEditMode && (\n            <MenuItem label=\"Edit\" onClick={onClickEditElementMenuItem} className={styles.menuItem} />\n          )\n        );\n      }\n      return null;\n    };\n\n    const typeOptions = getElementTypes(scene.shouldShowAdvancedTypes).options;\n\n    const getTypeOptionsSubmenu = () => {\n      const submenuItems: Array<\n        React.ReactElement<MenuItemProps<unknown>, string | React.JSXElementConstructor<unknown>>\n      > = [];\n\n      const onClickItem = (option: SelectableValue<string>) => {\n        let offsetY = anchorPoint.y;\n        let offsetX = anchorPoint.x;\n        if (scene.div) {\n          const transformScale = scene.scale;\n          const sceneContainerDimensions = scene.div.getBoundingClientRect();\n          offsetY = (offsetY - sceneContainerDimensions.top) / transformScale;\n          offsetX = (offsetX - sceneContainerDimensions.left) / transformScale;\n        }\n\n        onAddItem(option, rootLayer, {\n          ...anchorPoint,\n          y: offsetY,\n          x: offsetX,\n        });\n      };\n\n      typeOptions.map((option) => {\n        submenuItems.push(\n          <MenuItem key={option.value} label={option.label ?? 'Canvas item'} onClick={() => onClickItem(option)} />\n        );\n      });\n\n      return submenuItems;\n    };\n\n    const addItemMenuItem = (\n      <MenuItem\n        label=\"Add item\"\n        className={styles.menuItem}\n        childItems={getTypeOptionsSubmenu()}\n        customSubMenuContainerStyles={{ maxHeight: '150px', overflowY: 'auto' }}\n      />\n    );\n\n    const setBackgroundMenuItem = (\n      <MenuItem\n        label={'Set background'}\n        onClick={() => {\n          if (scene.setBackgroundCallback) {\n            scene.setBackgroundCallback(anchorPoint);\n          }\n          closeContextMenu();\n        }}\n        className={styles.menuItem}\n      />\n    );\n\n    if (selectedElements && selectedElements.length >= 1) {\n      return (\n        <>\n          {editElementMenuItem()}\n          <MenuItem\n            label=\"Delete\"\n            onClick={() => {\n              contextMenuAction(LayerActionID.Delete);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          <MenuItem\n            label=\"Duplicate\"\n            onClick={() => {\n              contextMenuAction(LayerActionID.Duplicate);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          <MenuItem\n            label=\"Bring to front\"\n            onClick={() => {\n              contextMenuAction(LayerActionID.MoveTop);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          <MenuItem\n            label=\"Send to back\"\n            onClick={() => {\n              contextMenuAction(LayerActionID.MoveBottom);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          {openCloseEditorMenuItem}\n        </>\n      );\n    } else {\n      return (\n        <>\n          {openCloseEditorMenuItem}\n          {setBackgroundMenuItem}\n          {addItemMenuItem}\n        </>\n      );\n    }\n  };\n\n  const contextMenuAction = (actionType: LayerActionID) => {\n    scene.selection.pipe(first()).subscribe((currentSelectedElements) => {\n      const currentLayer = currentSelectedElements[0].parent!;\n      currentSelectedElements.forEach((currentSelectedElement: ElementState) => {\n        currentLayer.doAction(actionType, currentSelectedElement);\n      });\n    });\n\n    setTimeout(() => {\n      scene.addToSelection();\n      scene.targetsToSelect.clear();\n    });\n  };\n\n  if (isMenuVisible) {\n    return (\n      <div\n        onContextMenu={(event) => {\n          event.preventDefault();\n          closeContextMenu();\n        }}\n      >\n        <ContextMenu\n          x={anchorPoint.x}\n          y={anchorPoint.y}\n          onClose={closeContextMenu}\n          renderMenuItems={renderMenuItems}\n          focusOnOpen={false}\n        />\n      </div>\n    );\n  }\n\n  return <></>;\n};\n\nconst getStyles = () => ({\n  menuItem: css({\n    maxWidth: '200px',\n  }),\n});\n","import { css, cx } from '@emotion/css';\nimport { useDialog } from '@react-aria/dialog';\nimport { useOverlay } from '@react-aria/overlays';\nimport { createRef } from 'react';\n\nimport {\n  Field,\n  LinkModel,\n  FieldType,\n  GrafanaTheme2,\n  formattedValueToString,\n  getFieldDisplayName,\n} from '@grafana/data/src';\nimport { Portal, useStyles2, VizTooltipContainer } from '@grafana/ui';\nimport { VizTooltipContent } from '@grafana/ui/src/components/VizTooltip/VizTooltipContent';\nimport { VizTooltipFooter } from '@grafana/ui/src/components/VizTooltip/VizTooltipFooter';\nimport { VizTooltipHeader } from '@grafana/ui/src/components/VizTooltip/VizTooltipHeader';\nimport { VizTooltipItem } from '@grafana/ui/src/components/VizTooltip/types';\nimport { CloseButton } from '@grafana/ui/src/components/uPlot/plugins/CloseButton';\nimport { Scene } from 'app/features/canvas/runtime/scene';\n\nimport { getRowIndex } from '../utils';\n\ninterface Props {\n  scene: Scene;\n}\n\nexport const CanvasTooltip = ({ scene }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const onClose = () => {\n    if (scene?.tooltipCallback && scene.tooltip) {\n      scene.tooltipCallback(undefined);\n    }\n  };\n\n  const ref = createRef<HTMLElement>();\n  const { overlayProps } = useOverlay({ onClose: onClose, isDismissable: true }, ref);\n  const { dialogProps } = useDialog({}, ref);\n\n  const element = scene.tooltip?.element;\n  if (!element) {\n    return <></>;\n  }\n\n  // Retrieve timestamp of the last data point if available\n  const timeField = scene.data?.series[0].fields?.find((field) => field.type === FieldType.time);\n  const lastTimeValue = timeField?.values[timeField.values.length - 1];\n  const shouldDisplayTimeContentItem =\n    timeField && lastTimeValue && element.data.field && getFieldDisplayName(timeField) !== element.data.field;\n\n  const headerItem: VizTooltipItem | null = {\n    label: element.getName(),\n    value: '',\n  };\n\n  const contentItems: VizTooltipItem[] = [\n    {\n      label: element.data.field ?? 'Fixed',\n      value: element.data.text,\n    },\n    ...(shouldDisplayTimeContentItem\n      ? [\n          {\n            label: 'Time',\n            value: formattedValueToString(timeField?.display!(lastTimeValue)),\n          },\n        ]\n      : []),\n  ];\n\n  const links: Array<LinkModel<Field>> = [];\n  const linkLookup = new Set<string>();\n\n  const elementHasLinks = (element.options.links?.length ?? 0) > 0;\n  if (elementHasLinks && element.getLinks) {\n    element.getLinks({ valueRowIndex: getRowIndex(element.data.field, scene) }).forEach((link) => {\n      const key = `${link.title}/${link.href}`;\n      if (!linkLookup.has(key)) {\n        links.push(link);\n        linkLookup.add(key);\n      }\n    });\n  }\n\n  return (\n    <>\n      {scene.tooltip?.element && scene.tooltip.anchorPoint && (\n        <Portal>\n          <VizTooltipContainer\n            className={cx(styles.tooltipWrapper, scene.tooltip.isOpen && styles.pinned)}\n            position={{ x: scene.tooltip.anchorPoint.x, y: scene.tooltip.anchorPoint.y }}\n            offset={{ x: 5, y: 0 }}\n            allowPointerEvents={scene.tooltip.isOpen}\n          >\n            <section ref={ref} {...overlayProps} {...dialogProps}>\n              {scene.tooltip.isOpen && <CloseButton style={{ zIndex: 1 }} onClick={onClose} />}\n              <VizTooltipHeader item={headerItem} isPinned={scene.tooltip.isOpen!} />\n              {element.data.text && <VizTooltipContent items={contentItems} isPinned={scene.tooltip.isOpen!} />}\n              {links.length > 0 && <VizTooltipFooter dataLinks={links} />}\n            </section>\n          </VizTooltipContainer>\n        </Portal>\n      )}\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    marginTop: '20px',\n    background: theme.colors.background.primary,\n  }),\n  tooltipWrapper: css({\n    top: 0,\n    left: 0,\n    zIndex: theme.zIndex.portal,\n    whiteSpace: 'pre',\n    borderRadius: theme.shape.radius.default,\n    position: 'fixed',\n    background: theme.colors.background.primary,\n    border: `1px solid ${theme.colors.border.weak}`,\n    boxShadow: theme.shadows.z2,\n    userSelect: 'text',\n    padding: 0,\n  }),\n  pinned: css({\n    boxShadow: theme.shadows.z3,\n  }),\n});\n","import React, { useRef, useImperativeHandle, useEffect, useContext, useLayoutEffect, useState, useCallback, useMemo } from 'react';\n\n/**\n * Rounds number to given decimal\n * eg. roundNumber(2.34343, 1) => 2.3\n */\nvar roundNumber = function (num, decimal) {\n    return Number(num.toFixed(decimal));\n};\n/**\n * Checks if value is number, if not it returns default value\n * 1# eg. checkIsNumber(2, 30) => 2\n * 2# eg. checkIsNumber(null, 30) => 30\n */\nvar checkIsNumber = function (num, defaultValue) {\n    return typeof num === \"number\" ? num : defaultValue;\n};\n\nvar handleCallback = function (context, event, callback) {\n    if (callback && typeof callback === \"function\") {\n        callback(context, event);\n    }\n};\n\n/* eslint-disable no-plusplus */\n/* eslint-disable no-param-reassign */\n/**\n * Functions should return denominator of the target value, which is the next animation step.\n * t is a value from 0 to 1, reflecting the percentage of animation status.\n */\nvar easeOut = function (t) {\n    return -Math.cos(t * Math.PI) / 2 + 0.5;\n};\n// linear\nvar linear = function (t) {\n    return t;\n};\n// accelerating from zero velocity\nvar easeInQuad = function (t) {\n    return t * t;\n};\n// decelerating to zero velocity\nvar easeOutQuad = function (t) {\n    return t * (2 - t);\n};\n// acceleration until halfway, then deceleration\nvar easeInOutQuad = function (t) {\n    return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n};\n// accelerating from zero velocity\nvar easeInCubic = function (t) {\n    return t * t * t;\n};\n// decelerating to zero velocity\nvar easeOutCubic = function (t) {\n    return --t * t * t + 1;\n};\n// acceleration until halfway, then deceleration\nvar easeInOutCubic = function (t) {\n    return t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n};\n// accelerating from zero velocity\nvar easeInQuart = function (t) {\n    return t * t * t * t;\n};\n// decelerating to zero velocity\nvar easeOutQuart = function (t) {\n    return 1 - --t * t * t * t;\n};\n// acceleration until halfway, then deceleration\nvar easeInOutQuart = function (t) {\n    return t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\n};\n// accelerating from zero velocity\nvar easeInQuint = function (t) {\n    return t * t * t * t * t;\n};\n// decelerating to zero velocity\nvar easeOutQuint = function (t) {\n    return 1 + --t * t * t * t * t;\n};\n// acceleration until halfway, then deceleration\nvar easeInOutQuint = function (t) {\n    return t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\n};\nvar animations = {\n    easeOut: easeOut,\n    linear: linear,\n    easeInQuad: easeInQuad,\n    easeOutQuad: easeOutQuad,\n    easeInOutQuad: easeInOutQuad,\n    easeInCubic: easeInCubic,\n    easeOutCubic: easeOutCubic,\n    easeInOutCubic: easeInOutCubic,\n    easeInQuart: easeInQuart,\n    easeOutQuart: easeOutQuart,\n    easeInOutQuart: easeInOutQuart,\n    easeInQuint: easeInQuint,\n    easeOutQuint: easeOutQuint,\n    easeInOutQuint: easeInOutQuint,\n};\n\n/* eslint-disable no-param-reassign */\nvar handleCancelAnimationFrame = function (animation) {\n    if (typeof animation === \"number\") {\n        cancelAnimationFrame(animation);\n    }\n};\nvar handleCancelAnimation = function (contextInstance) {\n    if (!contextInstance.mounted)\n        return;\n    handleCancelAnimationFrame(contextInstance.animation);\n    // Clear animation state\n    contextInstance.animate = false;\n    contextInstance.animation = null;\n    contextInstance.velocity = null;\n};\nfunction handleSetupAnimation(contextInstance, animationName, animationTime, callback) {\n    if (!contextInstance.mounted)\n        return;\n    var startTime = new Date().getTime();\n    var lastStep = 1;\n    // if another animation is active\n    handleCancelAnimation(contextInstance);\n    // new animation\n    contextInstance.animation = function () {\n        if (!contextInstance.mounted) {\n            return handleCancelAnimationFrame(contextInstance.animation);\n        }\n        var frameTime = new Date().getTime() - startTime;\n        var animationProgress = frameTime / animationTime;\n        var animationType = animations[animationName];\n        var step = animationType(animationProgress);\n        if (frameTime >= animationTime) {\n            callback(lastStep);\n            contextInstance.animation = null;\n        }\n        else if (contextInstance.animation) {\n            callback(step);\n            requestAnimationFrame(contextInstance.animation);\n        }\n    };\n    requestAnimationFrame(contextInstance.animation);\n}\nfunction isValidTargetState(targetState) {\n    var scale = targetState.scale, positionX = targetState.positionX, positionY = targetState.positionY;\n    if (Number.isNaN(scale) ||\n        Number.isNaN(positionX) ||\n        Number.isNaN(positionY)) {\n        return false;\n    }\n    return true;\n}\nfunction animate(contextInstance, targetState, animationTime, animationName) {\n    var isValid = isValidTargetState(targetState);\n    if (!contextInstance.mounted || !isValid)\n        return;\n    var setTransformState = contextInstance.setTransformState;\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    var scaleDiff = targetState.scale - scale;\n    var positionXDiff = targetState.positionX - positionX;\n    var positionYDiff = targetState.positionY - positionY;\n    if (animationTime === 0) {\n        setTransformState(targetState.scale, targetState.positionX, targetState.positionY);\n    }\n    else {\n        // animation start timestamp\n        handleSetupAnimation(contextInstance, animationName, animationTime, function (step) {\n            var newScale = scale + scaleDiff * step;\n            var newPositionX = positionX + positionXDiff * step;\n            var newPositionY = positionY + positionYDiff * step;\n            setTransformState(newScale, newPositionX, newPositionY);\n        });\n    }\n}\n\n/* eslint-disable no-param-reassign */\nfunction getComponentsSizes(wrapperComponent, contentComponent, newScale) {\n    var wrapperWidth = wrapperComponent.offsetWidth;\n    var wrapperHeight = wrapperComponent.offsetHeight;\n    var contentWidth = contentComponent.offsetWidth;\n    var contentHeight = contentComponent.offsetHeight;\n    var newContentWidth = contentWidth * newScale;\n    var newContentHeight = contentHeight * newScale;\n    var newDiffWidth = wrapperWidth - newContentWidth;\n    var newDiffHeight = wrapperHeight - newContentHeight;\n    return {\n        wrapperWidth: wrapperWidth,\n        wrapperHeight: wrapperHeight,\n        newContentWidth: newContentWidth,\n        newDiffWidth: newDiffWidth,\n        newContentHeight: newContentHeight,\n        newDiffHeight: newDiffHeight,\n    };\n}\nvar getBounds = function (wrapperWidth, newContentWidth, diffWidth, wrapperHeight, newContentHeight, diffHeight, centerZoomedOut) {\n    var scaleWidthFactor = wrapperWidth > newContentWidth\n        ? diffWidth * (centerZoomedOut ? 1 : 0.5)\n        : 0;\n    var scaleHeightFactor = wrapperHeight > newContentHeight\n        ? diffHeight * (centerZoomedOut ? 1 : 0.5)\n        : 0;\n    var minPositionX = wrapperWidth - newContentWidth - scaleWidthFactor;\n    var maxPositionX = scaleWidthFactor;\n    var minPositionY = wrapperHeight - newContentHeight - scaleHeightFactor;\n    var maxPositionY = scaleHeightFactor;\n    return { minPositionX: minPositionX, maxPositionX: maxPositionX, minPositionY: minPositionY, maxPositionY: maxPositionY };\n};\nvar calculateBounds = function (contextInstance, newScale) {\n    var wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n    var centerZoomedOut = contextInstance.setup.centerZoomedOut;\n    if (!wrapperComponent || !contentComponent) {\n        throw new Error(\"Components are not mounted\");\n    }\n    var _a = getComponentsSizes(wrapperComponent, contentComponent, newScale), wrapperWidth = _a.wrapperWidth, wrapperHeight = _a.wrapperHeight, newContentWidth = _a.newContentWidth, newDiffWidth = _a.newDiffWidth, newContentHeight = _a.newContentHeight, newDiffHeight = _a.newDiffHeight;\n    var bounds = getBounds(wrapperWidth, newContentWidth, newDiffWidth, wrapperHeight, newContentHeight, newDiffHeight, Boolean(centerZoomedOut));\n    return bounds;\n};\n/**\n * Keeps value between given bounds, used for limiting view to given boundaries\n * 1# eg. boundLimiter(2, 0, 3, true) => 2\n * 2# eg. boundLimiter(4, 0, 3, true) => 3\n * 3# eg. boundLimiter(-2, 0, 3, true) => 0\n * 4# eg. boundLimiter(10, 0, 3, false) => 10\n */\nvar boundLimiter = function (value, minBound, maxBound, isActive) {\n    if (!isActive)\n        return roundNumber(value, 2);\n    if (value < minBound)\n        return roundNumber(minBound, 2);\n    if (value > maxBound)\n        return roundNumber(maxBound, 2);\n    return roundNumber(value, 2);\n};\nvar handleCalculateBounds = function (contextInstance, newScale) {\n    var bounds = calculateBounds(contextInstance, newScale);\n    // Save bounds\n    contextInstance.bounds = bounds;\n    return bounds;\n};\nfunction getMouseBoundedPosition(positionX, positionY, bounds, limitToBounds, paddingValueX, paddingValueY, wrapperComponent) {\n    var minPositionX = bounds.minPositionX, minPositionY = bounds.minPositionY, maxPositionX = bounds.maxPositionX, maxPositionY = bounds.maxPositionY;\n    var paddingX = 0;\n    var paddingY = 0;\n    if (wrapperComponent) {\n        paddingX = paddingValueX;\n        paddingY = paddingValueY;\n    }\n    var x = boundLimiter(positionX, minPositionX - paddingX, maxPositionX + paddingX, limitToBounds);\n    var y = boundLimiter(positionY, minPositionY - paddingY, maxPositionY + paddingY, limitToBounds);\n    return { x: x, y: y };\n}\n\nfunction handleCalculateZoomPositions(contextInstance, mouseX, mouseY, newScale, bounds, limitToBounds) {\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    var scaleDifference = newScale - scale;\n    if (typeof mouseX !== \"number\" || typeof mouseY !== \"number\") {\n        console.error(\"Mouse X and Y position were not provided!\");\n        return { x: positionX, y: positionY };\n    }\n    var calculatedPositionX = positionX - mouseX * scaleDifference;\n    var calculatedPositionY = positionY - mouseY * scaleDifference;\n    // do not limit to bounds when there is padding animation,\n    // it causes animation strange behaviour\n    var newPositions = getMouseBoundedPosition(calculatedPositionX, calculatedPositionY, bounds, limitToBounds, 0, 0, null);\n    return newPositions;\n}\nfunction checkZoomBounds(zoom, minScale, maxScale, zoomPadding, enablePadding) {\n    var scalePadding = enablePadding ? zoomPadding : 0;\n    var minScaleWithPadding = minScale - scalePadding;\n    if (!Number.isNaN(maxScale) && zoom >= maxScale)\n        return maxScale;\n    if (!Number.isNaN(minScale) && zoom <= minScaleWithPadding)\n        return minScaleWithPadding;\n    return zoom;\n}\n\nvar isPanningStartAllowed = function (contextInstance, event) {\n    var excluded = contextInstance.setup.panning.excluded;\n    var isInitialized = contextInstance.isInitialized, wrapperComponent = contextInstance.wrapperComponent;\n    var target = event.target;\n    var targetIsShadowDom = \"shadowRoot\" in target && \"composedPath\" in event;\n    var isWrapperChild = targetIsShadowDom\n        ? event.composedPath().some(function (el) {\n            if (!(el instanceof Element)) {\n                return false;\n            }\n            return wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.contains(el);\n        })\n        : wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.contains(target);\n    var isAllowed = isInitialized && target && isWrapperChild;\n    if (!isAllowed)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\nvar isPanningAllowed = function (contextInstance) {\n    var isInitialized = contextInstance.isInitialized, isPanning = contextInstance.isPanning, setup = contextInstance.setup;\n    var disabled = setup.panning.disabled;\n    var isAllowed = isInitialized && isPanning && !disabled;\n    if (!isAllowed)\n        return false;\n    return true;\n};\nvar handlePanningSetup = function (contextInstance, event) {\n    var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY;\n    contextInstance.isPanning = true;\n    // Panning with mouse\n    var x = event.clientX;\n    var y = event.clientY;\n    contextInstance.startCoords = { x: x - positionX, y: y - positionY };\n};\nvar handleTouchPanningSetup = function (contextInstance, event) {\n    var touches = event.touches;\n    var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY;\n    contextInstance.isPanning = true;\n    // Panning with touch\n    var oneFingerTouch = touches.length === 1;\n    if (oneFingerTouch) {\n        var x = touches[0].clientX;\n        var y = touches[0].clientY;\n        contextInstance.startCoords = { x: x - positionX, y: y - positionY };\n    }\n};\nfunction handlePanToBounds(contextInstance) {\n    var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY, scale = _a.scale;\n    var _b = contextInstance.setup, disabled = _b.disabled, limitToBounds = _b.limitToBounds, centerZoomedOut = _b.centerZoomedOut;\n    var wrapperComponent = contextInstance.wrapperComponent;\n    if (disabled || !wrapperComponent || !contextInstance.bounds)\n        return;\n    var _c = contextInstance.bounds, maxPositionX = _c.maxPositionX, minPositionX = _c.minPositionX, maxPositionY = _c.maxPositionY, minPositionY = _c.minPositionY;\n    var xChanged = positionX > maxPositionX || positionX < minPositionX;\n    var yChanged = positionY > maxPositionY || positionY < minPositionY;\n    var mousePosX = positionX > maxPositionX\n        ? wrapperComponent.offsetWidth\n        : contextInstance.setup.minPositionX || 0;\n    var mousePosY = positionY > maxPositionY\n        ? wrapperComponent.offsetHeight\n        : contextInstance.setup.minPositionY || 0;\n    var _d = handleCalculateZoomPositions(contextInstance, mousePosX, mousePosY, scale, contextInstance.bounds, limitToBounds || centerZoomedOut), x = _d.x, y = _d.y;\n    return {\n        scale: scale,\n        positionX: xChanged ? x : positionX,\n        positionY: yChanged ? y : positionY,\n    };\n}\nfunction handleNewPosition(contextInstance, newPositionX, newPositionY, paddingValueX, paddingValueY) {\n    var limitToBounds = contextInstance.setup.limitToBounds;\n    var wrapperComponent = contextInstance.wrapperComponent, bounds = contextInstance.bounds;\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    if (wrapperComponent === null ||\n        bounds === null ||\n        (newPositionX === positionX && newPositionY === positionY)) {\n        return;\n    }\n    var _b = getMouseBoundedPosition(newPositionX, newPositionY, bounds, limitToBounds, paddingValueX, paddingValueY, wrapperComponent), x = _b.x, y = _b.y;\n    contextInstance.setTransformState(scale, x, y);\n}\nvar getPanningClientPosition = function (contextInstance, clientX, clientY) {\n    var startCoords = contextInstance.startCoords, transformState = contextInstance.transformState;\n    var panning = contextInstance.setup.panning;\n    var lockAxisX = panning.lockAxisX, lockAxisY = panning.lockAxisY;\n    var positionX = transformState.positionX, positionY = transformState.positionY;\n    if (!startCoords) {\n        return { x: positionX, y: positionY };\n    }\n    var mouseX = clientX - startCoords.x;\n    var mouseY = clientY - startCoords.y;\n    var newPositionX = lockAxisX ? positionX : mouseX;\n    var newPositionY = lockAxisY ? positionY : mouseY;\n    return { x: newPositionX, y: newPositionY };\n};\nvar getPaddingValue = function (contextInstance, size) {\n    var setup = contextInstance.setup, transformState = contextInstance.transformState;\n    var scale = transformState.scale;\n    var minScale = setup.minScale, disablePadding = setup.disablePadding;\n    if (size > 0 && scale >= minScale && !disablePadding) {\n        return size;\n    }\n    return 0;\n};\n\nvar isVelocityCalculationAllowed = function (contextInstance) {\n    var mounted = contextInstance.mounted;\n    var _a = contextInstance.setup, disabled = _a.disabled, velocityAnimation = _a.velocityAnimation;\n    var scale = contextInstance.transformState.scale;\n    var disabledVelocity = velocityAnimation.disabled;\n    var isAllowed = !disabledVelocity || scale > 1 || !disabled || mounted;\n    if (!isAllowed)\n        return false;\n    return true;\n};\nvar isVelocityAllowed = function (contextInstance) {\n    var mounted = contextInstance.mounted, velocity = contextInstance.velocity, bounds = contextInstance.bounds;\n    var _a = contextInstance.setup, disabled = _a.disabled, velocityAnimation = _a.velocityAnimation;\n    var scale = contextInstance.transformState.scale;\n    var disabledVelocity = velocityAnimation.disabled;\n    var isAllowed = !disabledVelocity || scale > 1 || !disabled || mounted;\n    if (!isAllowed)\n        return false;\n    if (!velocity || !bounds)\n        return false;\n    return true;\n};\nfunction getVelocityMoveTime(contextInstance, velocity) {\n    var velocityAnimation = contextInstance.setup.velocityAnimation;\n    var equalToMove = velocityAnimation.equalToMove, animationTime = velocityAnimation.animationTime, sensitivity = velocityAnimation.sensitivity;\n    if (equalToMove) {\n        return animationTime * velocity * sensitivity;\n    }\n    return animationTime;\n}\nfunction getVelocityPosition(newPosition, startPosition, currentPosition, isLocked, limitToBounds, minPosition, maxPosition, minTarget, maxTarget, step) {\n    if (limitToBounds) {\n        if (startPosition > maxPosition && currentPosition > maxPosition) {\n            var calculatedPosition = maxPosition + (newPosition - maxPosition) * step;\n            if (calculatedPosition > maxTarget)\n                return maxTarget;\n            if (calculatedPosition < maxPosition)\n                return maxPosition;\n            return calculatedPosition;\n        }\n        if (startPosition < minPosition && currentPosition < minPosition) {\n            var calculatedPosition = minPosition + (newPosition - minPosition) * step;\n            if (calculatedPosition < minTarget)\n                return minTarget;\n            if (calculatedPosition > minPosition)\n                return minPosition;\n            return calculatedPosition;\n        }\n    }\n    if (isLocked)\n        return startPosition;\n    return boundLimiter(newPosition, minPosition, maxPosition, limitToBounds);\n}\n\nfunction getSizeMultiplier(wrapperComponent, equalToMove) {\n    var defaultMultiplier = 1;\n    if (equalToMove) {\n        return Math.min(defaultMultiplier, wrapperComponent.offsetWidth / window.innerWidth);\n    }\n    return defaultMultiplier;\n}\nfunction handleCalculateVelocity(contextInstance, position) {\n    var isAllowed = isVelocityCalculationAllowed(contextInstance);\n    if (!isAllowed) {\n        return;\n    }\n    var lastMousePosition = contextInstance.lastMousePosition, velocityTime = contextInstance.velocityTime, setup = contextInstance.setup;\n    var wrapperComponent = contextInstance.wrapperComponent;\n    var equalToMove = setup.velocityAnimation.equalToMove;\n    var now = Date.now();\n    if (lastMousePosition && velocityTime && wrapperComponent) {\n        var sizeMultiplier = getSizeMultiplier(wrapperComponent, equalToMove);\n        var distanceX = position.x - lastMousePosition.x;\n        var distanceY = position.y - lastMousePosition.y;\n        var velocityX = distanceX / sizeMultiplier;\n        var velocityY = distanceY / sizeMultiplier;\n        var interval = now - velocityTime;\n        var speed = distanceX * distanceX + distanceY * distanceY;\n        var velocity = Math.sqrt(speed) / interval;\n        contextInstance.velocity = { velocityX: velocityX, velocityY: velocityY, total: velocity };\n    }\n    contextInstance.lastMousePosition = position;\n    contextInstance.velocityTime = now;\n}\nfunction handleVelocityPanning(contextInstance) {\n    var velocity = contextInstance.velocity, bounds = contextInstance.bounds, setup = contextInstance.setup, wrapperComponent = contextInstance.wrapperComponent;\n    var isAllowed = isVelocityAllowed(contextInstance);\n    if (!isAllowed || !velocity || !bounds || !wrapperComponent) {\n        return;\n    }\n    var velocityX = velocity.velocityX, velocityY = velocity.velocityY, total = velocity.total;\n    var maxPositionX = bounds.maxPositionX, minPositionX = bounds.minPositionX, maxPositionY = bounds.maxPositionY, minPositionY = bounds.minPositionY;\n    var limitToBounds = setup.limitToBounds, alignmentAnimation = setup.alignmentAnimation;\n    var zoomAnimation = setup.zoomAnimation, panning = setup.panning;\n    var lockAxisY = panning.lockAxisY, lockAxisX = panning.lockAxisX;\n    var animationType = zoomAnimation.animationType;\n    var sizeX = alignmentAnimation.sizeX, sizeY = alignmentAnimation.sizeY, velocityAlignmentTime = alignmentAnimation.velocityAlignmentTime;\n    var alignAnimationTime = velocityAlignmentTime;\n    var moveAnimationTime = getVelocityMoveTime(contextInstance, total);\n    var finalAnimationTime = Math.max(moveAnimationTime, alignAnimationTime);\n    var paddingValueX = getPaddingValue(contextInstance, sizeX);\n    var paddingValueY = getPaddingValue(contextInstance, sizeY);\n    var paddingX = (paddingValueX * wrapperComponent.offsetWidth) / 100;\n    var paddingY = (paddingValueY * wrapperComponent.offsetHeight) / 100;\n    var maxTargetX = maxPositionX + paddingX;\n    var minTargetX = minPositionX - paddingX;\n    var maxTargetY = maxPositionY + paddingY;\n    var minTargetY = minPositionY - paddingY;\n    var startState = contextInstance.transformState;\n    var startTime = new Date().getTime();\n    handleSetupAnimation(contextInstance, animationType, finalAnimationTime, function (step) {\n        var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n        var frameTime = new Date().getTime() - startTime;\n        var animationProgress = frameTime / alignAnimationTime;\n        var alignAnimation = animations[alignmentAnimation.animationType];\n        var alignStep = 1 - alignAnimation(Math.min(1, animationProgress));\n        var customStep = 1 - step;\n        var newPositionX = positionX + velocityX * customStep;\n        var newPositionY = positionY + velocityY * customStep;\n        var currentPositionX = getVelocityPosition(newPositionX, startState.positionX, positionX, lockAxisX, limitToBounds, minPositionX, maxPositionX, minTargetX, maxTargetX, alignStep);\n        var currentPositionY = getVelocityPosition(newPositionY, startState.positionY, positionY, lockAxisY, limitToBounds, minPositionY, maxPositionY, minTargetY, maxTargetY, alignStep);\n        if (positionX !== newPositionX || positionY !== newPositionY) {\n            contextInstance.setTransformState(scale, currentPositionX, currentPositionY);\n        }\n    });\n}\n\nfunction handlePanningStart(contextInstance, event) {\n    var scale = contextInstance.transformState.scale;\n    handleCancelAnimation(contextInstance);\n    handleCalculateBounds(contextInstance, scale);\n    if (window.TouchEvent !== undefined && event instanceof TouchEvent) {\n        handleTouchPanningSetup(contextInstance, event);\n    }\n    else {\n        handlePanningSetup(contextInstance, event);\n    }\n}\nfunction handleAlignToBounds(contextInstance) {\n    var scale = contextInstance.transformState.scale;\n    var _a = contextInstance.setup, minScale = _a.minScale, alignmentAnimation = _a.alignmentAnimation;\n    var disabled = alignmentAnimation.disabled, sizeX = alignmentAnimation.sizeX, sizeY = alignmentAnimation.sizeY, animationTime = alignmentAnimation.animationTime, animationType = alignmentAnimation.animationType;\n    var isDisabled = disabled || scale < minScale || (!sizeX && !sizeY);\n    if (isDisabled)\n        return;\n    var targetState = handlePanToBounds(contextInstance);\n    if (targetState) {\n        animate(contextInstance, targetState, animationTime, animationType);\n    }\n}\nfunction handlePanning(contextInstance, clientX, clientY) {\n    var startCoords = contextInstance.startCoords, setup = contextInstance.setup;\n    var _a = setup.alignmentAnimation, sizeX = _a.sizeX, sizeY = _a.sizeY;\n    if (!startCoords)\n        return;\n    var _b = getPanningClientPosition(contextInstance, clientX, clientY), x = _b.x, y = _b.y;\n    var paddingValueX = getPaddingValue(contextInstance, sizeX);\n    var paddingValueY = getPaddingValue(contextInstance, sizeY);\n    handleCalculateVelocity(contextInstance, { x: x, y: y });\n    handleNewPosition(contextInstance, x, y, paddingValueX, paddingValueY);\n}\nfunction handlePanningEnd(contextInstance) {\n    if (contextInstance.isPanning) {\n        var velocityDisabled = contextInstance.setup.panning.velocityDisabled;\n        var velocity = contextInstance.velocity, wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n        contextInstance.isPanning = false;\n        contextInstance.animate = false;\n        contextInstance.animation = null;\n        var wrapperRect = wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.getBoundingClientRect();\n        var contentRect = contentComponent === null || contentComponent === void 0 ? void 0 : contentComponent.getBoundingClientRect();\n        var wrapperWidth = (wrapperRect === null || wrapperRect === void 0 ? void 0 : wrapperRect.width) || 0;\n        var wrapperHeight = (wrapperRect === null || wrapperRect === void 0 ? void 0 : wrapperRect.height) || 0;\n        var contentWidth = (contentRect === null || contentRect === void 0 ? void 0 : contentRect.width) || 0;\n        var contentHeight = (contentRect === null || contentRect === void 0 ? void 0 : contentRect.height) || 0;\n        var isZoomed = wrapperWidth < contentWidth || wrapperHeight < contentHeight;\n        var shouldAnimate = !velocityDisabled && velocity && (velocity === null || velocity === void 0 ? void 0 : velocity.total) > 0.1 && isZoomed;\n        if (shouldAnimate) {\n            handleVelocityPanning(contextInstance);\n        }\n        else {\n            handleAlignToBounds(contextInstance);\n        }\n    }\n}\n\nfunction handleZoomToPoint(contextInstance, scale, mouseX, mouseY) {\n    var _a = contextInstance.setup, minScale = _a.minScale, maxScale = _a.maxScale, limitToBounds = _a.limitToBounds;\n    var newScale = checkZoomBounds(roundNumber(scale, 2), minScale, maxScale, 0, false);\n    var bounds = handleCalculateBounds(contextInstance, newScale);\n    var _b = handleCalculateZoomPositions(contextInstance, mouseX, mouseY, newScale, bounds, limitToBounds), x = _b.x, y = _b.y;\n    return { scale: newScale, positionX: x, positionY: y };\n}\nfunction handleAlignToScaleBounds(contextInstance, mousePositionX, mousePositionY) {\n    var scale = contextInstance.transformState.scale;\n    var wrapperComponent = contextInstance.wrapperComponent;\n    var _a = contextInstance.setup, minScale = _a.minScale, limitToBounds = _a.limitToBounds, zoomAnimation = _a.zoomAnimation;\n    var disabled = zoomAnimation.disabled, animationTime = zoomAnimation.animationTime, animationType = zoomAnimation.animationType;\n    var isDisabled = disabled || scale >= minScale;\n    if (scale >= 1 || limitToBounds) {\n        // fire fit to bounds animation\n        handleAlignToBounds(contextInstance);\n    }\n    if (isDisabled || !wrapperComponent || !contextInstance.mounted)\n        return;\n    var mouseX = mousePositionX || wrapperComponent.offsetWidth / 2;\n    var mouseY = mousePositionY || wrapperComponent.offsetHeight / 2;\n    var targetState = handleZoomToPoint(contextInstance, minScale, mouseX, mouseY);\n    if (targetState) {\n        animate(contextInstance, targetState, animationTime, animationType);\n    }\n}\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nvar initialState = {\n    previousScale: 1,\n    scale: 1,\n    positionX: 0,\n    positionY: 0,\n};\nvar initialSetup = {\n    disabled: false,\n    minPositionX: null,\n    maxPositionX: null,\n    minPositionY: null,\n    maxPositionY: null,\n    minScale: 1,\n    maxScale: 8,\n    limitToBounds: true,\n    centerZoomedOut: false,\n    centerOnInit: false,\n    disablePadding: false,\n    smooth: true,\n    wheel: {\n        step: 0.2,\n        disabled: false,\n        smoothStep: 0.001,\n        wheelDisabled: false,\n        touchPadDisabled: false,\n        activationKeys: [],\n        excluded: [],\n    },\n    panning: {\n        disabled: false,\n        velocityDisabled: false,\n        lockAxisX: false,\n        lockAxisY: false,\n        allowLeftClickPan: true,\n        allowMiddleClickPan: true,\n        allowRightClickPan: true,\n        wheelPanning: false,\n        activationKeys: [],\n        excluded: [],\n    },\n    pinch: {\n        step: 5,\n        disabled: false,\n        excluded: [],\n    },\n    doubleClick: {\n        disabled: false,\n        step: 0.7,\n        mode: \"zoomIn\",\n        animationType: \"easeOut\",\n        animationTime: 200,\n        excluded: [],\n    },\n    zoomAnimation: {\n        disabled: false,\n        size: 0.4,\n        animationTime: 200,\n        animationType: \"easeOut\",\n    },\n    alignmentAnimation: {\n        disabled: false,\n        sizeX: 100,\n        sizeY: 100,\n        animationTime: 200,\n        velocityAlignmentTime: 400,\n        animationType: \"easeOut\",\n    },\n    velocityAnimation: {\n        disabled: false,\n        sensitivity: 1,\n        animationTime: 400,\n        animationType: \"easeOut\",\n        equalToMove: true,\n    },\n};\nvar baseClasses = {\n    wrapperClass: \"react-transform-wrapper\",\n    contentClass: \"react-transform-component\",\n};\n\nvar createState = function (props) {\n    var _a, _b, _c, _d;\n    return {\n        previousScale: (_a = props.initialScale) !== null && _a !== void 0 ? _a : initialState.scale,\n        scale: (_b = props.initialScale) !== null && _b !== void 0 ? _b : initialState.scale,\n        positionX: (_c = props.initialPositionX) !== null && _c !== void 0 ? _c : initialState.positionX,\n        positionY: (_d = props.initialPositionY) !== null && _d !== void 0 ? _d : initialState.positionY,\n    };\n};\nvar createSetup = function (props) {\n    var newSetup = __assign({}, initialSetup);\n    Object.keys(props).forEach(function (key) {\n        var validValue = typeof props[key] !== \"undefined\";\n        var validParameter = typeof initialSetup[key] !== \"undefined\";\n        if (validParameter && validValue) {\n            var dataType = Object.prototype.toString.call(initialSetup[key]);\n            var isObject = dataType === \"[object Object]\";\n            var isArray = dataType === \"[object Array]\";\n            if (isObject) {\n                newSetup[key] = __assign(__assign({}, initialSetup[key]), props[key]);\n            }\n            else if (isArray) {\n                newSetup[key] = __spreadArray(__spreadArray([], initialSetup[key], true), props[key], true);\n            }\n            else {\n                newSetup[key] = props[key];\n            }\n        }\n    });\n    return newSetup;\n};\n\nvar handleCalculateButtonZoom = function (contextInstance, delta, step) {\n    var scale = contextInstance.transformState.scale;\n    var wrapperComponent = contextInstance.wrapperComponent, setup = contextInstance.setup;\n    var maxScale = setup.maxScale, minScale = setup.minScale, zoomAnimation = setup.zoomAnimation, smooth = setup.smooth;\n    var size = zoomAnimation.size;\n    if (!wrapperComponent) {\n        throw new Error(\"Wrapper is not mounted\");\n    }\n    var targetScale = smooth\n        ? scale * Math.exp(delta * step)\n        : scale + delta * step;\n    var newScale = checkZoomBounds(roundNumber(targetScale, 3), minScale, maxScale, size, false);\n    return newScale;\n};\nfunction handleZoomToViewCenter(contextInstance, delta, step, animationTime, animationType) {\n    var wrapperComponent = contextInstance.wrapperComponent;\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    if (!wrapperComponent)\n        return console.error(\"No WrapperComponent found\");\n    var wrapperWidth = wrapperComponent.offsetWidth;\n    var wrapperHeight = wrapperComponent.offsetHeight;\n    var mouseX = (wrapperWidth / 2 - positionX) / scale;\n    var mouseY = (wrapperHeight / 2 - positionY) / scale;\n    var newScale = handleCalculateButtonZoom(contextInstance, delta, step);\n    var targetState = handleZoomToPoint(contextInstance, newScale, mouseX, mouseY);\n    if (!targetState) {\n        return console.error(\"Error during zoom event. New transformation state was not calculated.\");\n    }\n    animate(contextInstance, targetState, animationTime, animationType);\n}\nfunction resetTransformations(contextInstance, animationTime, animationType, onResetTransformation) {\n    var setup = contextInstance.setup, wrapperComponent = contextInstance.wrapperComponent;\n    var limitToBounds = setup.limitToBounds;\n    var initialTransformation = createState(contextInstance.props);\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    if (!wrapperComponent)\n        return;\n    var newBounds = calculateBounds(contextInstance, initialTransformation.scale);\n    var boundedPositions = getMouseBoundedPosition(initialTransformation.positionX, initialTransformation.positionY, newBounds, limitToBounds, 0, 0, wrapperComponent);\n    var newState = {\n        scale: initialTransformation.scale,\n        positionX: boundedPositions.x,\n        positionY: boundedPositions.y,\n    };\n    if (scale === initialTransformation.scale &&\n        positionX === initialTransformation.positionX &&\n        positionY === initialTransformation.positionY) {\n        return;\n    }\n    onResetTransformation === null || onResetTransformation === void 0 ? void 0 : onResetTransformation();\n    animate(contextInstance, newState, animationTime, animationType);\n}\nfunction getOffset(element, wrapper, content, state) {\n    var offset = element.getBoundingClientRect();\n    var wrapperOffset = wrapper.getBoundingClientRect();\n    var contentOffset = content.getBoundingClientRect();\n    var xOff = wrapperOffset.x * state.scale;\n    var yOff = wrapperOffset.y * state.scale;\n    return {\n        x: (offset.x - contentOffset.x + xOff) / state.scale,\n        y: (offset.y - contentOffset.y + yOff) / state.scale,\n    };\n}\nfunction calculateZoomToNode(contextInstance, node, customZoom) {\n    var wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent, transformState = contextInstance.transformState;\n    var _a = contextInstance.setup, limitToBounds = _a.limitToBounds, minScale = _a.minScale, maxScale = _a.maxScale;\n    if (!wrapperComponent || !contentComponent)\n        return transformState;\n    var wrapperRect = wrapperComponent.getBoundingClientRect();\n    var nodeRect = node.getBoundingClientRect();\n    var nodeOffset = getOffset(node, wrapperComponent, contentComponent, transformState);\n    var nodeLeft = nodeOffset.x;\n    var nodeTop = nodeOffset.y;\n    var nodeWidth = nodeRect.width / transformState.scale;\n    var nodeHeight = nodeRect.height / transformState.scale;\n    var scaleX = wrapperComponent.offsetWidth / nodeWidth;\n    var scaleY = wrapperComponent.offsetHeight / nodeHeight;\n    var newScale = checkZoomBounds(customZoom || Math.min(scaleX, scaleY), minScale, maxScale, 0, false);\n    var offsetX = (wrapperRect.width - nodeWidth * newScale) / 2;\n    var offsetY = (wrapperRect.height - nodeHeight * newScale) / 2;\n    var newPositionX = (wrapperRect.left - nodeLeft) * newScale + offsetX;\n    var newPositionY = (wrapperRect.top - nodeTop) * newScale + offsetY;\n    var bounds = calculateBounds(contextInstance, newScale);\n    var _b = getMouseBoundedPosition(newPositionX, newPositionY, bounds, limitToBounds, 0, 0, wrapperComponent), x = _b.x, y = _b.y;\n    return { positionX: x, positionY: y, scale: newScale };\n}\n\nvar zoomIn = function (contextInstance) {\n    return function (step, animationTime, animationType) {\n        if (step === void 0) { step = 0.5; }\n        if (animationTime === void 0) { animationTime = 300; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        handleZoomToViewCenter(contextInstance, 1, step, animationTime, animationType);\n    };\n};\nvar zoomOut = function (contextInstance) {\n    return function (step, animationTime, animationType) {\n        if (step === void 0) { step = 0.5; }\n        if (animationTime === void 0) { animationTime = 300; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        handleZoomToViewCenter(contextInstance, -1, step, animationTime, animationType);\n    };\n};\nvar setTransform = function (contextInstance) {\n    return function (newPositionX, newPositionY, newScale, animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 300; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY, scale = _a.scale;\n        var wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n        var disabled = contextInstance.setup.disabled;\n        if (disabled || !wrapperComponent || !contentComponent)\n            return;\n        var targetState = {\n            positionX: Number.isNaN(newPositionX) ? positionX : newPositionX,\n            positionY: Number.isNaN(newPositionY) ? positionY : newPositionY,\n            scale: Number.isNaN(newScale) ? scale : newScale,\n        };\n        animate(contextInstance, targetState, animationTime, animationType);\n    };\n};\nvar resetTransform = function (contextInstance) {\n    return function (animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 200; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        resetTransformations(contextInstance, animationTime, animationType);\n    };\n};\nvar centerView = function (contextInstance) {\n    return function (scale, animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 200; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        var transformState = contextInstance.transformState, wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n        if (wrapperComponent && contentComponent) {\n            var targetState = getCenterPosition(scale || transformState.scale, wrapperComponent, contentComponent);\n            animate(contextInstance, targetState, animationTime, animationType);\n        }\n    };\n};\nvar zoomToElement = function (contextInstance) {\n    return function (node, scale, animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 600; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        handleCancelAnimation(contextInstance);\n        var wrapperComponent = contextInstance.wrapperComponent;\n        var target = typeof node === \"string\" ? document.getElementById(node) : node;\n        if (wrapperComponent && target && wrapperComponent.contains(target)) {\n            var targetState = calculateZoomToNode(contextInstance, target, scale);\n            animate(contextInstance, targetState, animationTime, animationType);\n        }\n    };\n};\n\nvar getControls = function (contextInstance) {\n    return {\n        instance: contextInstance,\n        zoomIn: zoomIn(contextInstance),\n        zoomOut: zoomOut(contextInstance),\n        setTransform: setTransform(contextInstance),\n        resetTransform: resetTransform(contextInstance),\n        centerView: centerView(contextInstance),\n        zoomToElement: zoomToElement(contextInstance),\n    };\n};\nvar getState = function (contextInstance) {\n    return {\n        instance: contextInstance,\n        state: contextInstance.transformState,\n    };\n};\nvar getContext = function (contextInstance) {\n    var ref = {};\n    Object.assign(ref, getState(contextInstance));\n    Object.assign(ref, getControls(contextInstance));\n    return ref;\n};\n\n// We want to make event listeners non-passive, and to do so have to check\n// that browsers support EventListenerOptions in the first place.\n// https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Safely_detecting_option_support\nvar passiveSupported = false;\nfunction makePassiveEventOption() {\n    try {\n        var options = {\n            get passive() {\n                // This function will be called when the browser\n                //   attempts to access the passive property.\n                passiveSupported = true;\n                return false;\n            },\n        };\n        return options;\n    }\n    catch (err) {\n        passiveSupported = false;\n        return passiveSupported;\n    }\n}\n\nvar matchPrefix = \".\".concat(baseClasses.wrapperClass);\nvar isExcludedNode = function (node, excluded) {\n    return excluded.some(function (exclude) {\n        return node.matches(\"\".concat(matchPrefix, \" \").concat(exclude, \", \").concat(matchPrefix, \" .\").concat(exclude, \", \").concat(matchPrefix, \" \").concat(exclude, \" *, \").concat(matchPrefix, \" .\").concat(exclude, \" *\"));\n    });\n};\nvar cancelTimeout = function (timeout) {\n    if (timeout) {\n        clearTimeout(timeout);\n    }\n};\n\nvar getTransformStyles = function (x, y, scale) {\n    // Standard translate prevents blurry svg on the safari\n    return \"translate(\".concat(x, \"px, \").concat(y, \"px) scale(\").concat(scale, \")\");\n};\nvar getMatrixTransformStyles = function (x, y, scale) {\n    // The shorthand for matrix does not work for Safari hence the need to explicitly use matrix3d\n    // Refer to https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function/matrix\n    var a = scale;\n    var b = 0;\n    var c = 0;\n    var d = scale;\n    var tx = x;\n    var ty = y;\n    return \"matrix3d(\".concat(a, \", \").concat(b, \", 0, 0, \").concat(c, \", \").concat(d, \", 0, 0, 0, 0, 1, 0, \").concat(tx, \", \").concat(ty, \", 0, 1)\");\n};\nvar getCenterPosition = function (scale, wrapperComponent, contentComponent) {\n    var contentWidth = contentComponent.offsetWidth * scale;\n    var contentHeight = contentComponent.offsetHeight * scale;\n    var centerPositionX = (wrapperComponent.offsetWidth - contentWidth) / 2;\n    var centerPositionY = (wrapperComponent.offsetHeight - contentHeight) / 2;\n    return {\n        scale: scale,\n        positionX: centerPositionX,\n        positionY: centerPositionY,\n    };\n};\n\nfunction mergeRefs(refs) {\n    return function (value) {\n        refs.forEach(function (ref) {\n            if (typeof ref === \"function\") {\n                ref(value);\n            }\n            else if (ref != null) {\n                ref.current = value;\n            }\n        });\n    };\n}\n\nvar isWheelAllowed = function (contextInstance, event) {\n    var _a = contextInstance.setup.wheel, disabled = _a.disabled, wheelDisabled = _a.wheelDisabled, touchPadDisabled = _a.touchPadDisabled, excluded = _a.excluded;\n    var isInitialized = contextInstance.isInitialized, isPanning = contextInstance.isPanning;\n    var target = event.target;\n    var isAllowed = isInitialized && !isPanning && !disabled && target;\n    if (!isAllowed)\n        return false;\n    // Event ctrlKey detects if touchpad action is executing wheel or pinch gesture\n    if (wheelDisabled && !event.ctrlKey)\n        return false;\n    if (touchPadDisabled && event.ctrlKey)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\nvar getDeltaY = function (event) {\n    if (event) {\n        return event.deltaY < 0 ? 1 : -1;\n    }\n    return 0;\n};\nfunction getDelta(event, customDelta) {\n    var deltaY = getDeltaY(event);\n    var delta = checkIsNumber(customDelta, deltaY);\n    return delta;\n}\nfunction getMousePosition(event, contentComponent, scale) {\n    var contentRect = contentComponent.getBoundingClientRect();\n    var mouseX = 0;\n    var mouseY = 0;\n    if (\"clientX\" in event) {\n        // mouse position x, y over wrapper component\n        mouseX = (event.clientX - contentRect.left) / scale;\n        mouseY = (event.clientY - contentRect.top) / scale;\n    }\n    else {\n        var touch = event.touches[0];\n        mouseX = (touch.clientX - contentRect.left) / scale;\n        mouseY = (touch.clientY - contentRect.top) / scale;\n    }\n    if (Number.isNaN(mouseX) || Number.isNaN(mouseY))\n        console.error(\"No mouse or touch offset found\");\n    return {\n        x: mouseX,\n        y: mouseY,\n    };\n}\nvar handleCalculateWheelZoom = function (contextInstance, delta, step, disable, getTarget) {\n    var scale = contextInstance.transformState.scale;\n    var wrapperComponent = contextInstance.wrapperComponent, setup = contextInstance.setup;\n    var maxScale = setup.maxScale, minScale = setup.minScale, zoomAnimation = setup.zoomAnimation, disablePadding = setup.disablePadding;\n    var size = zoomAnimation.size, disabled = zoomAnimation.disabled;\n    if (!wrapperComponent) {\n        throw new Error(\"Wrapper is not mounted\");\n    }\n    var targetScale = scale + delta * step;\n    if (getTarget)\n        return targetScale;\n    var paddingEnabled = disable ? false : !disabled;\n    var newScale = checkZoomBounds(roundNumber(targetScale, 3), minScale, maxScale, size, paddingEnabled && !disablePadding);\n    return newScale;\n};\nvar handleWheelZoomStop = function (contextInstance, event) {\n    var previousWheelEvent = contextInstance.previousWheelEvent;\n    var scale = contextInstance.transformState.scale;\n    var _a = contextInstance.setup, maxScale = _a.maxScale, minScale = _a.minScale;\n    if (!previousWheelEvent)\n        return false;\n    if (scale < maxScale || scale > minScale)\n        return true;\n    if (Math.sign(previousWheelEvent.deltaY) !== Math.sign(event.deltaY))\n        return true;\n    if (previousWheelEvent.deltaY > 0 && previousWheelEvent.deltaY < event.deltaY)\n        return true;\n    if (previousWheelEvent.deltaY < 0 && previousWheelEvent.deltaY > event.deltaY)\n        return true;\n    if (Math.sign(previousWheelEvent.deltaY) !== Math.sign(event.deltaY))\n        return true;\n    return false;\n};\n\nvar isPinchStartAllowed = function (contextInstance, event) {\n    var _a = contextInstance.setup.pinch, disabled = _a.disabled, excluded = _a.excluded;\n    var isInitialized = contextInstance.isInitialized;\n    var target = event.target;\n    var isAllowed = isInitialized && !disabled && target;\n    if (!isAllowed)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\nvar isPinchAllowed = function (contextInstance) {\n    var disabled = contextInstance.setup.pinch.disabled;\n    var isInitialized = contextInstance.isInitialized, pinchStartDistance = contextInstance.pinchStartDistance;\n    var isAllowed = isInitialized && !disabled && pinchStartDistance;\n    if (!isAllowed)\n        return false;\n    return true;\n};\nvar calculateTouchMidPoint = function (event, scale, contentComponent) {\n    var contentRect = contentComponent.getBoundingClientRect();\n    var touches = event.touches;\n    var firstPointX = roundNumber(touches[0].clientX - contentRect.left, 5);\n    var firstPointY = roundNumber(touches[0].clientY - contentRect.top, 5);\n    var secondPointX = roundNumber(touches[1].clientX - contentRect.left, 5);\n    var secondPointY = roundNumber(touches[1].clientY - contentRect.top, 5);\n    return {\n        x: (firstPointX + secondPointX) / 2 / scale,\n        y: (firstPointY + secondPointY) / 2 / scale,\n    };\n};\nvar getTouchDistance = function (event) {\n    return Math.sqrt(Math.pow((event.touches[0].pageX - event.touches[1].pageX), 2) +\n        Math.pow((event.touches[0].pageY - event.touches[1].pageY), 2));\n};\nvar calculatePinchZoom = function (contextInstance, currentDistance) {\n    var pinchStartScale = contextInstance.pinchStartScale, pinchStartDistance = contextInstance.pinchStartDistance, setup = contextInstance.setup;\n    var maxScale = setup.maxScale, minScale = setup.minScale, zoomAnimation = setup.zoomAnimation, disablePadding = setup.disablePadding;\n    var size = zoomAnimation.size, disabled = zoomAnimation.disabled;\n    if (!pinchStartScale || pinchStartDistance === null || !currentDistance) {\n        throw new Error(\"Pinch touches distance was not provided\");\n    }\n    if (currentDistance < 0) {\n        return contextInstance.transformState.scale;\n    }\n    var touchProportion = currentDistance / pinchStartDistance;\n    var scaleDifference = touchProportion * pinchStartScale;\n    return checkZoomBounds(roundNumber(scaleDifference, 2), minScale, maxScale, size, !disabled && !disablePadding);\n};\n\nvar wheelStopEventTime = 160;\nvar wheelAnimationTime = 100;\nvar handleWheelStart = function (contextInstance, event) {\n    var _a = contextInstance.props, onWheelStart = _a.onWheelStart, onZoomStart = _a.onZoomStart;\n    if (!contextInstance.wheelStopEventTimer) {\n        handleCancelAnimation(contextInstance);\n        handleCallback(getContext(contextInstance), event, onWheelStart);\n        handleCallback(getContext(contextInstance), event, onZoomStart);\n    }\n};\nvar handleWheelZoom = function (contextInstance, event) {\n    var _a = contextInstance.props, onWheel = _a.onWheel, onZoom = _a.onZoom;\n    var contentComponent = contextInstance.contentComponent, setup = contextInstance.setup, transformState = contextInstance.transformState;\n    var scale = transformState.scale;\n    var limitToBounds = setup.limitToBounds, centerZoomedOut = setup.centerZoomedOut, zoomAnimation = setup.zoomAnimation, wheel = setup.wheel, disablePadding = setup.disablePadding, smooth = setup.smooth;\n    var size = zoomAnimation.size, disabled = zoomAnimation.disabled;\n    var step = wheel.step, smoothStep = wheel.smoothStep;\n    if (!contentComponent) {\n        throw new Error(\"Component not mounted\");\n    }\n    event.preventDefault();\n    event.stopPropagation();\n    var delta = getDelta(event, null);\n    var zoomStep = smooth ? smoothStep * Math.abs(event.deltaY) : step;\n    var newScale = handleCalculateWheelZoom(contextInstance, delta, zoomStep, !event.ctrlKey);\n    // if scale not change\n    if (scale === newScale)\n        return;\n    var bounds = handleCalculateBounds(contextInstance, newScale);\n    var mousePosition = getMousePosition(event, contentComponent, scale);\n    var isPaddingDisabled = disabled || size === 0 || centerZoomedOut || disablePadding;\n    var isLimitedToBounds = limitToBounds && isPaddingDisabled;\n    var _b = handleCalculateZoomPositions(contextInstance, mousePosition.x, mousePosition.y, newScale, bounds, isLimitedToBounds), x = _b.x, y = _b.y;\n    contextInstance.previousWheelEvent = event;\n    contextInstance.setTransformState(newScale, x, y);\n    handleCallback(getContext(contextInstance), event, onWheel);\n    handleCallback(getContext(contextInstance), event, onZoom);\n};\nvar handleWheelStop = function (contextInstance, event) {\n    var _a = contextInstance.props, onWheelStop = _a.onWheelStop, onZoomStop = _a.onZoomStop;\n    // fire animation\n    cancelTimeout(contextInstance.wheelAnimationTimer);\n    contextInstance.wheelAnimationTimer = setTimeout(function () {\n        if (!contextInstance.mounted)\n            return;\n        handleAlignToScaleBounds(contextInstance, event.x, event.y);\n        contextInstance.wheelAnimationTimer = null;\n    }, wheelAnimationTime);\n    // Wheel stop event\n    var hasStoppedZooming = handleWheelZoomStop(contextInstance, event);\n    if (hasStoppedZooming) {\n        cancelTimeout(contextInstance.wheelStopEventTimer);\n        contextInstance.wheelStopEventTimer = setTimeout(function () {\n            if (!contextInstance.mounted)\n                return;\n            contextInstance.wheelStopEventTimer = null;\n            handleCallback(getContext(contextInstance), event, onWheelStop);\n            handleCallback(getContext(contextInstance), event, onZoomStop);\n        }, wheelStopEventTime);\n    }\n};\n\nvar getTouchCenter = function (event) {\n    var totalX = 0;\n    var totalY = 0;\n    // Sum up the positions of all touches\n    for (var i = 0; i < 2; i += 1) {\n        totalX += event.touches[i].clientX;\n        totalY += event.touches[i].clientY;\n    }\n    // Calculate the average position\n    var x = totalX / 2;\n    var y = totalY / 2;\n    return { x: x, y: y };\n};\nvar handlePinchStart = function (contextInstance, event) {\n    var distance = getTouchDistance(event);\n    contextInstance.pinchStartDistance = distance;\n    contextInstance.lastDistance = distance;\n    contextInstance.pinchStartScale = contextInstance.transformState.scale;\n    contextInstance.isPanning = false;\n    var center = getTouchCenter(event);\n    contextInstance.pinchLastCenterX = center.x;\n    contextInstance.pinchLastCenterY = center.y;\n    handleCancelAnimation(contextInstance);\n};\nvar handlePinchZoom = function (contextInstance, event) {\n    var contentComponent = contextInstance.contentComponent, pinchStartDistance = contextInstance.pinchStartDistance, wrapperComponent = contextInstance.wrapperComponent;\n    var scale = contextInstance.transformState.scale;\n    var _a = contextInstance.setup, limitToBounds = _a.limitToBounds, centerZoomedOut = _a.centerZoomedOut, zoomAnimation = _a.zoomAnimation, alignmentAnimation = _a.alignmentAnimation;\n    var disabled = zoomAnimation.disabled, size = zoomAnimation.size;\n    // if one finger starts from outside of wrapper\n    if (pinchStartDistance === null || !contentComponent)\n        return;\n    var midPoint = calculateTouchMidPoint(event, scale, contentComponent);\n    // if touches goes off of the wrapper element\n    if (!Number.isFinite(midPoint.x) || !Number.isFinite(midPoint.y))\n        return;\n    var currentDistance = getTouchDistance(event);\n    var newScale = calculatePinchZoom(contextInstance, currentDistance);\n    var center = getTouchCenter(event);\n    // pan should be scale invariant.\n    var panX = center.x - (contextInstance.pinchLastCenterX || 0);\n    var panY = center.y - (contextInstance.pinchLastCenterY || 0);\n    if (newScale === scale && panX === 0 && panY === 0)\n        return;\n    contextInstance.pinchLastCenterX = center.x;\n    contextInstance.pinchLastCenterY = center.y;\n    var bounds = handleCalculateBounds(contextInstance, newScale);\n    var isPaddingDisabled = disabled || size === 0 || centerZoomedOut;\n    var isLimitedToBounds = limitToBounds && isPaddingDisabled;\n    var _b = handleCalculateZoomPositions(contextInstance, midPoint.x, midPoint.y, newScale, bounds, isLimitedToBounds), x = _b.x, y = _b.y;\n    contextInstance.pinchMidpoint = midPoint;\n    contextInstance.lastDistance = currentDistance;\n    var sizeX = alignmentAnimation.sizeX, sizeY = alignmentAnimation.sizeY;\n    var paddingValueX = getPaddingValue(contextInstance, sizeX);\n    var paddingValueY = getPaddingValue(contextInstance, sizeY);\n    var newPositionX = x + panX;\n    var newPositionY = y + panY;\n    var _c = getMouseBoundedPosition(newPositionX, newPositionY, bounds, limitToBounds, paddingValueX, paddingValueY, wrapperComponent), finalX = _c.x, finalY = _c.y;\n    contextInstance.setTransformState(newScale, finalX, finalY);\n};\nvar handlePinchStop = function (contextInstance) {\n    var pinchMidpoint = contextInstance.pinchMidpoint;\n    contextInstance.velocity = null;\n    contextInstance.lastDistance = null;\n    contextInstance.pinchMidpoint = null;\n    contextInstance.pinchStartScale = null;\n    contextInstance.pinchStartDistance = null;\n    handleAlignToScaleBounds(contextInstance, pinchMidpoint === null || pinchMidpoint === void 0 ? void 0 : pinchMidpoint.x, pinchMidpoint === null || pinchMidpoint === void 0 ? void 0 : pinchMidpoint.y);\n};\n\nvar handleDoubleClickStop = function (contextInstance, event) {\n    var onZoomStop = contextInstance.props.onZoomStop;\n    var animationTime = contextInstance.setup.doubleClick.animationTime;\n    cancelTimeout(contextInstance.doubleClickStopEventTimer);\n    contextInstance.doubleClickStopEventTimer = setTimeout(function () {\n        contextInstance.doubleClickStopEventTimer = null;\n        handleCallback(getContext(contextInstance), event, onZoomStop);\n    }, animationTime);\n};\nvar handleDoubleClickResetMode = function (contextInstance, event) {\n    var _a = contextInstance.props, onZoomStart = _a.onZoomStart, onZoom = _a.onZoom;\n    var _b = contextInstance.setup.doubleClick, animationTime = _b.animationTime, animationType = _b.animationType;\n    handleCallback(getContext(contextInstance), event, onZoomStart);\n    resetTransformations(contextInstance, animationTime, animationType, function () {\n        return handleCallback(getContext(contextInstance), event, onZoom);\n    });\n    handleDoubleClickStop(contextInstance, event);\n};\nfunction getDoubleClickScale(mode, scale) {\n    if (mode === \"toggle\") {\n        return scale === 1 ? 1 : -1;\n    }\n    return mode === \"zoomOut\" ? -1 : 1;\n}\nfunction handleDoubleClick(contextInstance, event) {\n    var setup = contextInstance.setup, doubleClickStopEventTimer = contextInstance.doubleClickStopEventTimer, transformState = contextInstance.transformState, contentComponent = contextInstance.contentComponent;\n    var scale = transformState.scale;\n    var _a = contextInstance.props, onZoomStart = _a.onZoomStart, onZoom = _a.onZoom;\n    var _b = setup.doubleClick, disabled = _b.disabled, mode = _b.mode, step = _b.step, animationTime = _b.animationTime, animationType = _b.animationType;\n    if (disabled)\n        return;\n    if (doubleClickStopEventTimer)\n        return;\n    if (mode === \"reset\") {\n        return handleDoubleClickResetMode(contextInstance, event);\n    }\n    if (!contentComponent)\n        return console.error(\"No ContentComponent found\");\n    var delta = getDoubleClickScale(mode, contextInstance.transformState.scale);\n    var newScale = handleCalculateButtonZoom(contextInstance, delta, step);\n    // stop execution when scale didn't change\n    if (scale === newScale)\n        return;\n    handleCallback(getContext(contextInstance), event, onZoomStart);\n    var mousePosition = getMousePosition(event, contentComponent, scale);\n    var targetState = handleZoomToPoint(contextInstance, newScale, mousePosition.x, mousePosition.y);\n    if (!targetState) {\n        return console.error(\"Error during zoom event. New transformation state was not calculated.\");\n    }\n    handleCallback(getContext(contextInstance), event, onZoom);\n    animate(contextInstance, targetState, animationTime, animationType);\n    handleDoubleClickStop(contextInstance, event);\n}\nvar isDoubleClickAllowed = function (contextInstance, event) {\n    var isInitialized = contextInstance.isInitialized, setup = contextInstance.setup, wrapperComponent = contextInstance.wrapperComponent;\n    var _a = setup.doubleClick, disabled = _a.disabled, excluded = _a.excluded;\n    var target = event.target;\n    var isWrapperChild = wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.contains(target);\n    var isAllowed = isInitialized && target && isWrapperChild && !disabled;\n    if (!isAllowed)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\n\nvar ZoomPanPinch = /** @class */ (function () {\n    function ZoomPanPinch(props) {\n        var _this = this;\n        this.mounted = true;\n        this.pinchLastCenterX = null;\n        this.pinchLastCenterY = null;\n        this.onChangeCallbacks = new Set();\n        this.onInitCallbacks = new Set();\n        // Components\n        this.wrapperComponent = null;\n        this.contentComponent = null;\n        // Initialization\n        this.isInitialized = false;\n        this.bounds = null;\n        // wheel helpers\n        this.previousWheelEvent = null;\n        this.wheelStopEventTimer = null;\n        this.wheelAnimationTimer = null;\n        // panning helpers\n        this.isPanning = false;\n        this.isWheelPanning = false;\n        this.startCoords = null;\n        this.lastTouch = null;\n        // pinch helpers\n        this.distance = null;\n        this.lastDistance = null;\n        this.pinchStartDistance = null;\n        this.pinchStartScale = null;\n        this.pinchMidpoint = null;\n        // double click helpers\n        this.doubleClickStopEventTimer = null;\n        // velocity helpers\n        this.velocity = null;\n        this.velocityTime = null;\n        this.lastMousePosition = null;\n        // animations helpers\n        this.animate = false;\n        this.animation = null;\n        this.maxBounds = null;\n        // key press\n        this.pressedKeys = {};\n        this.mount = function () {\n            _this.initializeWindowEvents();\n        };\n        this.unmount = function () {\n            _this.cleanupWindowEvents();\n        };\n        this.update = function (newProps) {\n            _this.props = newProps;\n            handleCalculateBounds(_this, _this.transformState.scale);\n            _this.setup = createSetup(newProps);\n        };\n        this.initializeWindowEvents = function () {\n            var _a, _b;\n            var passive = makePassiveEventOption();\n            var currentDocument = (_a = _this.wrapperComponent) === null || _a === void 0 ? void 0 : _a.ownerDocument;\n            var currentWindow = currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.defaultView;\n            (_b = _this.wrapperComponent) === null || _b === void 0 ? void 0 : _b.addEventListener(\"wheel\", _this.onWheelPanning, passive);\n            // Panning on window to allow panning when mouse is out of component wrapper\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"mousedown\", _this.onPanningStart, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"mousemove\", _this.onPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"mouseup\", _this.onPanningStop, passive);\n            currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.addEventListener(\"mouseleave\", _this.clearPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"keyup\", _this.setKeyUnPressed, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"keydown\", _this.setKeyPressed, passive);\n        };\n        this.cleanupWindowEvents = function () {\n            var _a, _b;\n            var passive = makePassiveEventOption();\n            var currentDocument = (_a = _this.wrapperComponent) === null || _a === void 0 ? void 0 : _a.ownerDocument;\n            var currentWindow = currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.defaultView;\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"mousedown\", _this.onPanningStart, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"mousemove\", _this.onPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"mouseup\", _this.onPanningStop, passive);\n            currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.removeEventListener(\"mouseleave\", _this.clearPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"keyup\", _this.setKeyUnPressed, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"keydown\", _this.setKeyPressed, passive);\n            document.removeEventListener(\"mouseleave\", _this.clearPanning, passive);\n            handleCancelAnimation(_this);\n            (_b = _this.observer) === null || _b === void 0 ? void 0 : _b.disconnect();\n        };\n        this.handleInitializeWrapperEvents = function (wrapper) {\n            // Zooming events on wrapper\n            var passive = makePassiveEventOption();\n            wrapper.addEventListener(\"wheel\", _this.onWheelZoom, passive);\n            wrapper.addEventListener(\"dblclick\", _this.onDoubleClick, passive);\n            wrapper.addEventListener(\"touchstart\", _this.onTouchPanningStart, passive);\n            wrapper.addEventListener(\"touchmove\", _this.onTouchPanning, passive);\n            wrapper.addEventListener(\"touchend\", _this.onTouchPanningStop, passive);\n        };\n        this.handleInitialize = function (contentComponent) {\n            var centerOnInit = _this.setup.centerOnInit;\n            _this.applyTransformation();\n            _this.onInitCallbacks.forEach(function (callback) { return callback(getContext(_this)); });\n            if (centerOnInit) {\n                _this.setCenter();\n                _this.observer = new ResizeObserver(function () {\n                    var _a;\n                    var currentWidth = contentComponent.offsetWidth;\n                    var currentHeight = contentComponent.offsetHeight;\n                    if (currentWidth > 0 || currentHeight > 0) {\n                        _this.onInitCallbacks.forEach(function (callback) {\n                            return callback(getContext(_this));\n                        });\n                        _this.setCenter();\n                        (_a = _this.observer) === null || _a === void 0 ? void 0 : _a.disconnect();\n                    }\n                });\n                // if nothing about the contentComponent has changed after 5 seconds, disconnect the observer\n                setTimeout(function () {\n                    var _a;\n                    (_a = _this.observer) === null || _a === void 0 ? void 0 : _a.disconnect();\n                }, 5000);\n                // Start observing the target node for configured mutations\n                _this.observer.observe(contentComponent);\n            }\n        };\n        /// ///////\n        // Zoom\n        /// ///////\n        this.onWheelZoom = function (event) {\n            var disabled = _this.setup.disabled;\n            if (disabled)\n                return;\n            var isAllowed = isWheelAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            var keysPressed = _this.isPressingKeys(_this.setup.wheel.activationKeys);\n            if (!keysPressed)\n                return;\n            handleWheelStart(_this, event);\n            handleWheelZoom(_this, event);\n            handleWheelStop(_this, event);\n        };\n        /// ///////\n        // Pan\n        /// ///////\n        this.onWheelPanning = function (event) {\n            var _a = _this.setup, disabled = _a.disabled, wheel = _a.wheel, panning = _a.panning;\n            if (!_this.wrapperComponent ||\n                !_this.contentComponent ||\n                disabled ||\n                !wheel.wheelDisabled ||\n                panning.disabled ||\n                !panning.wheelPanning ||\n                event.ctrlKey) {\n                return;\n            }\n            event.preventDefault();\n            event.stopPropagation();\n            var _b = _this.transformState, positionX = _b.positionX, positionY = _b.positionY;\n            var mouseX = positionX - event.deltaX;\n            var mouseY = positionY - event.deltaY;\n            var newPositionX = panning.lockAxisX ? positionX : mouseX;\n            var newPositionY = panning.lockAxisY ? positionY : mouseY;\n            var _c = _this.setup.alignmentAnimation, sizeX = _c.sizeX, sizeY = _c.sizeY;\n            var paddingValueX = getPaddingValue(_this, sizeX);\n            var paddingValueY = getPaddingValue(_this, sizeY);\n            if (newPositionX === positionX && newPositionY === positionY)\n                return;\n            handleNewPosition(_this, newPositionX, newPositionY, paddingValueX, paddingValueY);\n        };\n        this.onPanningStart = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanningStart = _this.props.onPanningStart;\n            if (disabled)\n                return;\n            var isAllowed = isPanningStartAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            var keysPressed = _this.isPressingKeys(_this.setup.panning.activationKeys);\n            if (!keysPressed)\n                return;\n            if (event.button === 0 && !_this.setup.panning.allowLeftClickPan)\n                return;\n            if (event.button === 1 && !_this.setup.panning.allowMiddleClickPan)\n                return;\n            if (event.button === 2 && !_this.setup.panning.allowRightClickPan)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            handleCancelAnimation(_this);\n            handlePanningStart(_this, event);\n            handleCallback(getContext(_this), event, onPanningStart);\n        };\n        this.onPanning = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanning = _this.props.onPanning;\n            if (disabled)\n                return;\n            var isAllowed = isPanningAllowed(_this);\n            if (!isAllowed)\n                return;\n            var keysPressed = _this.isPressingKeys(_this.setup.panning.activationKeys);\n            if (!keysPressed)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            handlePanning(_this, event.clientX, event.clientY);\n            handleCallback(getContext(_this), event, onPanning);\n        };\n        this.onPanningStop = function (event) {\n            var onPanningStop = _this.props.onPanningStop;\n            if (_this.isPanning) {\n                handlePanningEnd(_this);\n                handleCallback(getContext(_this), event, onPanningStop);\n            }\n        };\n        /// ///////\n        // Pinch\n        /// ///////\n        this.onPinchStart = function (event) {\n            var disabled = _this.setup.disabled;\n            var _a = _this.props, onPinchingStart = _a.onPinchingStart, onZoomStart = _a.onZoomStart;\n            if (disabled)\n                return;\n            var isAllowed = isPinchStartAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            handlePinchStart(_this, event);\n            handleCancelAnimation(_this);\n            handleCallback(getContext(_this), event, onPinchingStart);\n            handleCallback(getContext(_this), event, onZoomStart);\n        };\n        this.onPinch = function (event) {\n            var disabled = _this.setup.disabled;\n            var _a = _this.props, onPinching = _a.onPinching, onZoom = _a.onZoom;\n            if (disabled)\n                return;\n            var isAllowed = isPinchAllowed(_this);\n            if (!isAllowed)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            handlePinchZoom(_this, event);\n            handleCallback(getContext(_this), event, onPinching);\n            handleCallback(getContext(_this), event, onZoom);\n        };\n        this.onPinchStop = function (event) {\n            var _a = _this.props, onPinchingStop = _a.onPinchingStop, onZoomStop = _a.onZoomStop;\n            if (_this.pinchStartScale) {\n                handlePinchStop(_this);\n                handleCallback(getContext(_this), event, onPinchingStop);\n                handleCallback(getContext(_this), event, onZoomStop);\n            }\n        };\n        /// ///////\n        // Touch\n        /// ///////\n        this.onTouchPanningStart = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanningStart = _this.props.onPanningStart;\n            if (disabled)\n                return;\n            var isAllowed = isPanningStartAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            var isDoubleTap = _this.lastTouch && +new Date() - _this.lastTouch < 200;\n            if (!isDoubleTap) {\n                _this.lastTouch = +new Date();\n                handleCancelAnimation(_this);\n                var touches = event.touches;\n                var isPanningAction = touches.length === 1;\n                var isPinchAction = touches.length === 2;\n                if (isPanningAction) {\n                    handleCancelAnimation(_this);\n                    handlePanningStart(_this, event);\n                    handleCallback(getContext(_this), event, onPanningStart);\n                }\n                if (isPinchAction) {\n                    _this.onPinchStart(event);\n                }\n            }\n        };\n        this.onTouchPanning = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanning = _this.props.onPanning;\n            if (_this.isPanning && event.touches.length === 1) {\n                if (disabled)\n                    return;\n                var isAllowed = isPanningAllowed(_this);\n                if (!isAllowed)\n                    return;\n                event.preventDefault();\n                event.stopPropagation();\n                var touch = event.touches[0];\n                handlePanning(_this, touch.clientX, touch.clientY);\n                handleCallback(getContext(_this), event, onPanning);\n            }\n            else if (event.touches.length > 1) {\n                _this.onPinch(event);\n            }\n        };\n        this.onTouchPanningStop = function (event) {\n            _this.onPanningStop(event);\n            _this.onPinchStop(event);\n        };\n        /// ///////\n        // Double Click\n        /// ///////\n        this.onDoubleClick = function (event) {\n            var disabled = _this.setup.disabled;\n            if (disabled)\n                return;\n            var isAllowed = isDoubleClickAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            handleDoubleClick(_this, event);\n        };\n        /// ///////\n        // Helpers\n        /// ///////\n        this.clearPanning = function (event) {\n            if (_this.isPanning) {\n                _this.onPanningStop(event);\n            }\n        };\n        this.setKeyPressed = function (e) {\n            _this.pressedKeys[e.key] = true;\n        };\n        this.setKeyUnPressed = function (e) {\n            _this.pressedKeys[e.key] = false;\n        };\n        this.isPressingKeys = function (keys) {\n            if (!keys.length) {\n                return true;\n            }\n            return Boolean(keys.find(function (key) { return _this.pressedKeys[key]; }));\n        };\n        this.setTransformState = function (scale, positionX, positionY) {\n            var onTransformed = _this.props.onTransformed;\n            if (!Number.isNaN(scale) &&\n                !Number.isNaN(positionX) &&\n                !Number.isNaN(positionY)) {\n                if (scale !== _this.transformState.scale) {\n                    _this.transformState.previousScale = _this.transformState.scale;\n                    _this.transformState.scale = scale;\n                }\n                _this.transformState.positionX = positionX;\n                _this.transformState.positionY = positionY;\n                _this.applyTransformation();\n                var ctx_1 = getContext(_this);\n                _this.onChangeCallbacks.forEach(function (callback) { return callback(ctx_1); });\n                handleCallback(ctx_1, { scale: scale, positionX: positionX, positionY: positionY }, onTransformed);\n            }\n            else {\n                console.error(\"Detected NaN set state values\");\n            }\n        };\n        this.setCenter = function () {\n            if (_this.wrapperComponent && _this.contentComponent) {\n                var targetState = getCenterPosition(_this.transformState.scale, _this.wrapperComponent, _this.contentComponent);\n                _this.setTransformState(targetState.scale, targetState.positionX, targetState.positionY);\n            }\n        };\n        this.handleTransformStyles = function (x, y, scale) {\n            if (_this.props.customTransform) {\n                return _this.props.customTransform(x, y, scale);\n            }\n            return getTransformStyles(x, y, scale);\n        };\n        this.applyTransformation = function () {\n            if (!_this.mounted || !_this.contentComponent)\n                return;\n            var _a = _this.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n            var transform = _this.handleTransformStyles(positionX, positionY, scale);\n            _this.contentComponent.style.transform = transform;\n        };\n        this.getContext = function () {\n            return getContext(_this);\n        };\n        /**\n         * Hooks\n         */\n        this.onChange = function (callback) {\n            if (!_this.onChangeCallbacks.has(callback)) {\n                _this.onChangeCallbacks.add(callback);\n            }\n            return function () {\n                _this.onChangeCallbacks.delete(callback);\n            };\n        };\n        this.onInit = function (callback) {\n            if (!_this.onInitCallbacks.has(callback)) {\n                _this.onInitCallbacks.add(callback);\n            }\n            return function () {\n                _this.onInitCallbacks.delete(callback);\n            };\n        };\n        /**\n         * Initialization\n         */\n        this.init = function (wrapperComponent, contentComponent) {\n            _this.cleanupWindowEvents();\n            _this.wrapperComponent = wrapperComponent;\n            _this.contentComponent = contentComponent;\n            handleCalculateBounds(_this, _this.transformState.scale);\n            _this.handleInitializeWrapperEvents(wrapperComponent);\n            _this.handleInitialize(contentComponent);\n            _this.initializeWindowEvents();\n            _this.isInitialized = true;\n            var ctx = getContext(_this);\n            handleCallback(ctx, undefined, _this.props.onInit);\n        };\n        this.props = props;\n        this.setup = createSetup(this.props);\n        this.transformState = createState(this.props);\n    }\n    return ZoomPanPinch;\n}());\n\nvar Context = React.createContext(null);\nvar getContent = function (children, ctx) {\n    if (typeof children === \"function\") {\n        return children(ctx);\n    }\n    return children;\n};\nvar TransformWrapper = React.forwardRef(function (props, ref) {\n    var instance = useRef(new ZoomPanPinch(props)).current;\n    var content = getContent(props.children, getControls(instance));\n    useImperativeHandle(ref, function () { return getControls(instance); }, [instance]);\n    useEffect(function () {\n        instance.update(props);\n    }, [instance, props]);\n    return React.createElement(Context.Provider, { value: instance }, content);\n});\n\nvar KeepScale = React.forwardRef(function (props, ref) {\n    var localRef = useRef(null);\n    var instance = useContext(Context);\n    useEffect(function () {\n        return instance.onChange(function (ctx) {\n            if (localRef.current) {\n                var positionX = 0;\n                var positionY = 0;\n                localRef.current.style.transform = instance.handleTransformStyles(positionX, positionY, 1 / ctx.instance.transformState.scale);\n            }\n        });\n    }, [instance]);\n    return React.createElement(\"div\", __assign({}, props, { ref: mergeRefs([localRef, ref]) }));\n});\n\nvar initialElementRect = {\n    width: 0,\n    height: 0,\n    y: 0,\n    x: 0,\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n};\nvar useResize = function (ref, onResize, dependencies) {\n    var resizeObserverRef = useRef();\n    var rectRef = useRef(initialElementRect);\n    var didUnmount = useRef(false);\n    useLayoutEffect(function () {\n        var _a;\n        didUnmount.current = false;\n        if (!(\"ResizeObserver\" in window)) {\n            return;\n        }\n        if (ref) {\n            resizeObserverRef.current = new ResizeObserver(function (entries) {\n                var newSize = ref.getBoundingClientRect();\n                if (!Array.isArray(entries) ||\n                    !entries.length ||\n                    didUnmount.current ||\n                    (newSize.width === rectRef.current.width &&\n                        newSize.height === rectRef.current.height))\n                    return;\n                onResize(newSize, ref);\n                rectRef.current = newSize;\n            });\n            (_a = resizeObserverRef.current) === null || _a === void 0 ? void 0 : _a.observe(ref);\n        }\n        return function () {\n            var _a;\n            didUnmount.current = true;\n            if (ref) {\n                (_a = resizeObserverRef.current) === null || _a === void 0 ? void 0 : _a.unobserve(ref);\n            }\n        };\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, __spreadArray([onResize, ref], dependencies, true));\n};\n\nvar previewStyles = {\n    position: \"absolute\",\n    zIndex: 2,\n    top: \"0px\",\n    left: \"0px\",\n    boxSizing: \"border-box\",\n    border: \"3px solid red\",\n    transformOrigin: \"0% 0%\",\n    boxShadow: \"rgba(0,0,0,0.2) 0 0 0 10000000px\",\n};\nvar MiniMap = function (_a) {\n    var _b = _a.width, width = _b === void 0 ? 200 : _b, _c = _a.height, height = _c === void 0 ? 200 : _c, _d = _a.borderColor, borderColor = _d === void 0 ? \"red\" : _d, children = _a.children, rest = __rest(_a, [\"width\", \"height\", \"borderColor\", \"children\"]);\n    var _e = useState(false), initialized = _e[0], setInitialized = _e[1];\n    var instance = useTransformContext();\n    var miniMapInstance = useRef(null);\n    var mainRef = useRef(null);\n    var wrapperRef = useRef(null);\n    var previewRef = useRef(null);\n    var getViewportSize = useCallback(function () {\n        if (instance.wrapperComponent) {\n            var rect = instance.wrapperComponent.getBoundingClientRect();\n            return {\n                width: rect.width,\n                height: rect.height\n            };\n        }\n        return {\n            width: 0,\n            height: 0\n        };\n    }, [instance.wrapperComponent]);\n    var getContentSize = useCallback(function () {\n        if (instance.contentComponent) {\n            var rect = instance.contentComponent.getBoundingClientRect();\n            return {\n                width: rect.width / instance.transformState.scale,\n                height: rect.height / instance.transformState.scale,\n            };\n        }\n        return {\n            width: 0,\n            height: 0,\n        };\n    }, [instance.contentComponent, instance.transformState.scale]);\n    var computeMiniMapScale = useCallback(function () {\n        var contentSize = getContentSize();\n        var scaleX = width / contentSize.width;\n        var scaleY = height / contentSize.height;\n        var scale = scaleY > scaleX ? scaleX : scaleY;\n        return scale;\n    }, [getContentSize, height, width]);\n    var computeMiniMapSize = function () {\n        var contentSize = getContentSize();\n        var scaleX = width / contentSize.width;\n        var scaleY = height / contentSize.height;\n        if (scaleY > scaleX) {\n            return { width: width, height: contentSize.height * scaleX };\n        }\n        return { width: contentSize.width * scaleY, height: height };\n    };\n    var computeMiniMapStyle = function () {\n        var scale = computeMiniMapScale();\n        var style = {\n            transform: \"scale(\".concat(scale || 1, \")\"),\n            transformOrigin: \"0% 0%\",\n            position: \"absolute\",\n            boxSizing: \"border-box\",\n            zIndex: 1,\n            overflow: \"hidden\",\n        };\n        Object.keys(style).forEach(function (key) {\n            if (wrapperRef.current) {\n                wrapperRef.current.style[key] = style[key];\n            }\n        });\n    };\n    var transformMiniMap = function () {\n        computeMiniMapStyle();\n        var miniSize = computeMiniMapSize();\n        var wrapSize = getContentSize();\n        if (wrapperRef.current) {\n            wrapperRef.current.style.width = \"\".concat(wrapSize.width, \"px\");\n            wrapperRef.current.style.height = \"\".concat(wrapSize.height, \"px\");\n        }\n        if (mainRef.current) {\n            mainRef.current.style.width = \"\".concat(miniSize.width, \"px\");\n            mainRef.current.style.height = \"\".concat(miniSize.height, \"px\");\n        }\n        if (previewRef.current) {\n            var size = getViewportSize();\n            var scale = computeMiniMapScale();\n            var previewScale = scale * (1 / instance.transformState.scale);\n            var transform = instance.handleTransformStyles(-instance.transformState.positionX * previewScale, -instance.transformState.positionY * previewScale, 1);\n            previewRef.current.style.transform = transform;\n            previewRef.current.style.width = \"\".concat(size.width * previewScale, \"px\");\n            previewRef.current.style.height = \"\".concat(size.height * previewScale, \"px\");\n        }\n    };\n    var initialize = function () {\n        transformMiniMap();\n    };\n    useTransformEffect(function () {\n        transformMiniMap();\n    });\n    useTransformInit(function () {\n        initialize();\n        setInitialized(true);\n    });\n    useResize(instance.contentComponent, initialize, [initialized]);\n    useEffect(function () {\n        return instance.onChange(function (zpp) {\n            var scale = computeMiniMapScale();\n            if (miniMapInstance.current) {\n                miniMapInstance.current.instance.transformState.scale =\n                    zpp.instance.transformState.scale;\n                miniMapInstance.current.instance.transformState.positionX =\n                    zpp.instance.transformState.positionX * scale;\n                miniMapInstance.current.instance.transformState.positionY =\n                    zpp.instance.transformState.positionY * scale;\n            }\n        });\n    }, [computeMiniMapScale, instance, miniMapInstance]);\n    var wrapperStyle = useMemo(function () {\n        return {\n            position: \"relative\",\n            zIndex: 2,\n            overflow: \"hidden\",\n        };\n    }, []);\n    return (React.createElement(\"div\", __assign({}, rest, { ref: mainRef, style: wrapperStyle, className: \"rzpp-mini-map \".concat(rest.className || \"\") }),\n        React.createElement(\"div\", __assign({}, rest, { ref: wrapperRef, className: \"rzpp-wrapper\" }), children),\n        React.createElement(\"div\", { className: \"rzpp-preview\", ref: previewRef, style: __assign(__assign({}, previewStyles), { borderColor: borderColor }) })));\n};\n\nfunction styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".transform-component-module_wrapper__SPB86 {\\n  position: relative;\\n  width: -moz-fit-content;\\n  width: fit-content;\\n  height: -moz-fit-content;\\n  height: fit-content;\\n  overflow: hidden;\\n  -webkit-touch-callout: none; /* iOS Safari */\\n  -webkit-user-select: none; /* Safari */\\n  -khtml-user-select: none; /* Konqueror HTML */\\n  -moz-user-select: none; /* Firefox */\\n  -ms-user-select: none; /* Internet Explorer/Edge */\\n  user-select: none;\\n  margin: 0;\\n  padding: 0;\\n}\\n.transform-component-module_content__FBWxo {\\n  display: flex;\\n  flex-wrap: wrap;\\n  width: -moz-fit-content;\\n  width: fit-content;\\n  height: -moz-fit-content;\\n  height: fit-content;\\n  margin: 0;\\n  padding: 0;\\n  transform-origin: 0% 0%;\\n}\\n.transform-component-module_content__FBWxo img {\\n  pointer-events: none;\\n}\\n\";\nvar styles = {\"wrapper\":\"transform-component-module_wrapper__SPB86\",\"content\":\"transform-component-module_content__FBWxo\"};\nstyleInject(css_248z);\n\nvar TransformComponent = function (_a) {\n    var children = _a.children, _b = _a.wrapperClass, wrapperClass = _b === void 0 ? \"\" : _b, _c = _a.contentClass, contentClass = _c === void 0 ? \"\" : _c, wrapperStyle = _a.wrapperStyle, contentStyle = _a.contentStyle, _d = _a.wrapperProps, wrapperProps = _d === void 0 ? {} : _d, _e = _a.contentProps, contentProps = _e === void 0 ? {} : _e;\n    var _f = useContext(Context), init = _f.init, cleanupWindowEvents = _f.cleanupWindowEvents;\n    var wrapperRef = useRef(null);\n    var contentRef = useRef(null);\n    useEffect(function () {\n        var wrapper = wrapperRef.current;\n        var content = contentRef.current;\n        if (wrapper !== null && content !== null && init) {\n            init === null || init === void 0 ? void 0 : init(wrapper, content);\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        return function () {\n            cleanupWindowEvents === null || cleanupWindowEvents === void 0 ? void 0 : cleanupWindowEvents();\n        };\n    }, []);\n    return (React.createElement(\"div\", __assign({}, wrapperProps, { ref: wrapperRef, className: \"\".concat(baseClasses.wrapperClass, \" \").concat(styles.wrapper, \" \").concat(wrapperClass), style: wrapperStyle }),\n        React.createElement(\"div\", __assign({}, contentProps, { ref: contentRef, className: \"\".concat(baseClasses.contentClass, \" \").concat(styles.content, \" \").concat(contentClass), style: contentStyle }), children)));\n};\n\nvar useTransformContext = function () {\n    var libraryContext = useContext(Context);\n    if (!libraryContext) {\n        throw new Error(\"Transform context must be placed inside TransformWrapper\");\n    }\n    return libraryContext;\n};\n\nvar useControls = function () {\n    var libraryContext = useTransformContext();\n    return getControls(libraryContext);\n};\n\nvar useTransformInit = function (callback) {\n    var libraryContext = useTransformContext();\n    useEffect(function () {\n        var unmountCallback;\n        var unmount;\n        if (libraryContext.contentComponent && libraryContext.wrapperComponent) {\n            unmountCallback = callback(getState(libraryContext));\n        }\n        else {\n            unmount = libraryContext.onInit(function (ref) {\n                unmountCallback = callback(getState(ref.instance));\n            });\n        }\n        return function () {\n            unmount === null || unmount === void 0 ? void 0 : unmount();\n            unmountCallback === null || unmountCallback === void 0 ? void 0 : unmountCallback();\n        };\n    }, []);\n};\n\nvar useTransformEffect = function (callback) {\n    var libraryContext = useTransformContext();\n    useEffect(function () {\n        var unmountCallback;\n        var unmount = libraryContext.onChange(function (ref) {\n            unmountCallback = callback(getState(ref.instance));\n        });\n        return function () {\n            unmount();\n            unmountCallback === null || unmountCallback === void 0 ? void 0 : unmountCallback();\n        };\n    }, [callback, libraryContext]);\n};\n\nfunction useTransformComponent(callback) {\n    var libraryContext = useTransformContext();\n    var _a = useState(callback(getState(libraryContext))), transformRender = _a[0], setTransformRender = _a[1];\n    useEffect(function () {\n        var mounted = true;\n        var unmount = libraryContext.onChange(function (ref) {\n            if (mounted) {\n                setTransformRender(callback(getState(ref.instance)));\n            }\n        });\n        return function () {\n            unmount();\n            mounted = false;\n        };\n    }, [callback, libraryContext]);\n    return transformRender;\n}\n\nexport { Context, KeepScale, MiniMap, TransformComponent, TransformWrapper, getCenterPosition, getMatrixTransformStyles, getTransformStyles, useControls, useTransformComponent, useTransformContext, useTransformEffect, useTransformInit };\n//# sourceMappingURL=index.esm.js.map\n","import * as React from 'react';\nimport { TransformWrapper, TransformComponent, ReactZoomPanPinchRef } from 'react-zoom-pan-pinch';\n\nimport { config } from '@grafana/runtime';\n\nimport { Scene } from './scene';\n\ntype SceneTransformWrapperProps = {\n  scene: Scene;\n  children: React.ReactNode;\n};\n\nexport const SceneTransformWrapper = ({ scene, children: sceneDiv }: SceneTransformWrapperProps) => {\n  const onZoom = (zoomPanPinchRef: ReactZoomPanPinchRef) => {\n    const scale = zoomPanPinchRef.state.scale;\n    scene.scale = scale;\n\n    if (scene.shouldInfinitePan) {\n      const isScaleZoomedOut = scale < 1;\n\n      if (isScaleZoomedOut) {\n        scene.updateSize(scene.width / scale, scene.height / scale);\n        scene.panel.forceUpdate();\n      }\n    }\n  };\n\n  const onZoomStop = (zoomPanPinchRef: ReactZoomPanPinchRef) => {\n    const scale = zoomPanPinchRef.state.scale;\n    scene.scale = scale;\n    updateMoveable(scale);\n  };\n\n  const onTransformed = (\n    _: ReactZoomPanPinchRef,\n    state: {\n      scale: number;\n      positionX: number;\n      positionY: number;\n    }\n  ) => {\n    const scale = state.scale;\n    scene.scale = scale;\n    updateMoveable(scale);\n  };\n\n  const updateMoveable = (scale: number) => {\n    if (scene.moveable && scale > 0) {\n      scene.moveable.zoom = 1 / scale;\n      if (scale === 1) {\n        scene.moveable.snappable = true;\n      } else {\n        scene.moveable.snappable = false;\n      }\n    }\n  };\n\n  const onPanning = (_: ReactZoomPanPinchRef, event: MouseEvent | TouchEvent) => {\n    if (scene.shouldInfinitePan && event instanceof MouseEvent) {\n      // Get deltaX and deltaY from pan event and add it to current canvas dimensions\n      let deltaX = event.movementX;\n      let deltaY = event.movementY;\n      if (deltaX > 0) {\n        deltaX = 0;\n      }\n      if (deltaY > 0) {\n        deltaY = 0;\n      }\n\n      // TODO: Consider bounding to the scene elements instead of allowing \"infinite\" panning\n      // TODO: Consider making scene grow in all directions vs just down to the right / bottom\n      scene.updateSize(scene.width - deltaX, scene.height - deltaY);\n      scene.panel.forceUpdate();\n    }\n  };\n\n  const onSceneContainerMouseDown = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    // If pan and zoom is disabled or context menu is visible, don't pan\n    if ((!scene.shouldPanZoom || scene.contextMenuVisible) && (e.button === 1 || (e.button === 2 && e.ctrlKey))) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n\n    // If context menu is hidden, ignore left mouse or non-ctrl right mouse for pan\n    if (!scene.contextMenuVisible && !scene.isPanelEditing && e.button === 2 && !e.ctrlKey) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  };\n\n  // Set panel content overflow to hidden to prevent canvas content from overflowing\n  scene.div?.parentElement?.parentElement?.parentElement?.parentElement?.setAttribute('style', `overflow: hidden`);\n\n  return (\n    <TransformWrapper\n      doubleClick={{ mode: 'reset' }}\n      ref={scene.transformComponentRef}\n      onZoom={onZoom}\n      onZoomStop={onZoomStop}\n      onTransformed={onTransformed}\n      disabled={!config.featureToggles.canvasPanelPanZoom || !scene.shouldPanZoom}\n      panning={{ allowLeftClickPan: false }}\n      limitToBounds={!scene.shouldInfinitePan}\n      minScale={scene.shouldInfinitePan ? 0.1 : undefined}\n      onPanning={onPanning}\n    >\n      <TransformComponent>\n        {/* The <div> element has child elements that allow for mouse events, so we need to disable the linter rule */}\n        {/* eslint-disable-next-line jsx-a11y/no-static-element-interactions */}\n        <div onMouseDown={onSceneContainerMouseDown}>{sceneDiv}</div>\n      </TransformComponent>\n    </TransformWrapper>\n  );\n};\n","import { CanvasFrameOptions } from '../frame';\n\nimport { FrameState } from './frame';\nimport { Scene } from './scene';\n\nexport class RootElement extends FrameState {\n  constructor(\n    public options: CanvasFrameOptions,\n    public scene: Scene,\n    private changeCallback: () => void\n  ) {\n    super(options, scene);\n\n    this.sizeStyle = {\n      height: '100%',\n      width: '100%',\n    };\n  }\n\n  isRoot(): this is RootElement {\n    return true;\n  }\n\n  // root type can not change\n  onChange(options: CanvasFrameOptions) {\n    this.revId++;\n    this.options = { ...options };\n    this.changeCallback();\n  }\n\n  getSaveModel(): CanvasFrameOptions {\n    const { placement, constraint, ...rest } = this.options;\n\n    return {\n      ...rest, // everything except placement & constraint\n      elements: this.elements.map((v) => v.getSaveModel()),\n    };\n  }\n\n  setRootRef = (target: HTMLDivElement) => {\n    this.div = target;\n  };\n\n  render() {\n    return (\n      <div\n        onContextMenu={(event) => event.preventDefault()}\n        key={this.UID}\n        ref={this.setRootRef}\n        style={{ ...this.sizeStyle, ...this.dataStyle }}\n      >\n        {this.elements.map((v) => v.render())}\n      </div>\n    );\n  }\n}\n","import { css } from '@emotion/css';\nimport Moveable from 'moveable';\nimport { createRef, CSSProperties, RefObject } from 'react';\nimport { ReactZoomPanPinchContentRef } from 'react-zoom-pan-pinch';\nimport { BehaviorSubject, ReplaySubject, Subject, Subscription } from 'rxjs';\nimport Selecto from 'selecto';\n\nimport { AppEvents, PanelData } from '@grafana/data';\nimport { locationService } from '@grafana/runtime/src';\nimport {\n  ColorDimensionConfig,\n  ResourceDimensionConfig,\n  ScalarDimensionConfig,\n  ScaleDimensionConfig,\n  TextDimensionConfig,\n} from '@grafana/schema';\nimport { Portal } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions';\nimport {\n  getColorDimensionFromData,\n  getResourceDimensionFromData,\n  getScalarDimensionFromData,\n  getScaleDimensionFromData,\n  getTextDimensionFromData,\n} from 'app/features/dimensions/utils';\nimport { CanvasContextMenu } from 'app/plugins/panel/canvas/components/CanvasContextMenu';\nimport { CanvasTooltip } from 'app/plugins/panel/canvas/components/CanvasTooltip';\nimport { Connections } from 'app/plugins/panel/canvas/components/connections/Connections';\nimport { AnchorPoint, CanvasTooltipPayload } from 'app/plugins/panel/canvas/types';\nimport { getTransformInstance } from 'app/plugins/panel/canvas/utils';\n\nimport appEvents from '../../../core/app_events';\nimport { CanvasPanel } from '../../../plugins/panel/canvas/CanvasPanel';\nimport { CanvasFrameOptions } from '../frame';\nimport { DEFAULT_CANVAS_ELEMENT_CONFIG } from '../registry';\n\nimport { SceneTransformWrapper } from './SceneTransformWrapper';\nimport { ElementState } from './element';\nimport { FrameState } from './frame';\nimport { RootElement } from './root';\nimport { initMoveable } from './sceneAbleManagement';\nimport { findElementByTarget } from './sceneElementManagement';\n\nexport interface SelectionParams {\n  targets: Array<HTMLElement | SVGElement>;\n  frame?: FrameState;\n}\n\nexport class Scene {\n  styles = getStyles();\n  readonly selection = new ReplaySubject<ElementState[]>(1);\n  readonly moved = new Subject<number>(); // called after resize/drag for editor updates\n  readonly byName = new Map<string, ElementState>();\n\n  root: RootElement;\n\n  revId = 0;\n\n  width = 0;\n  height = 0;\n  scale = 1;\n  style: CSSProperties = {};\n  data?: PanelData;\n  selecto?: Selecto;\n  moveable?: Moveable;\n  div?: HTMLDivElement;\n  connections: Connections;\n  currentLayer?: FrameState;\n  isEditingEnabled?: boolean;\n  shouldShowAdvancedTypes?: boolean;\n  shouldPanZoom?: boolean;\n  shouldInfinitePan?: boolean;\n  skipNextSelectionBroadcast = false;\n  ignoreDataUpdate = false;\n  panel: CanvasPanel;\n  contextMenuVisible?: boolean;\n  contextMenuOnVisibilityChange = (visible: boolean) => {\n    this.contextMenuVisible = visible;\n    const transformInstance = getTransformInstance(this);\n    if (transformInstance) {\n      if (visible) {\n        transformInstance.setup.disabled = true;\n      } else {\n        transformInstance.setup.disabled = false;\n      }\n    }\n  };\n\n  isPanelEditing = locationService.getSearchObject().editPanel !== undefined;\n\n  inlineEditingCallback?: () => void;\n  setBackgroundCallback?: (anchorPoint: AnchorPoint) => void;\n\n  tooltipCallback?: (tooltip: CanvasTooltipPayload | undefined) => void;\n  tooltip?: CanvasTooltipPayload;\n\n  moveableActionCallback?: (moved: boolean) => void;\n\n  readonly editModeEnabled = new BehaviorSubject<boolean>(false);\n  subscription: Subscription;\n\n  targetsToSelect = new Set<HTMLDivElement>();\n  transformComponentRef: RefObject<ReactZoomPanPinchContentRef> | undefined;\n\n  constructor(\n    cfg: CanvasFrameOptions,\n    enableEditing: boolean,\n    showAdvancedTypes: boolean,\n    panZoom: boolean,\n    infinitePan: boolean,\n    public onSave: (cfg: CanvasFrameOptions) => void,\n    panel: CanvasPanel\n  ) {\n    this.root = this.load(cfg, enableEditing, showAdvancedTypes, panZoom, infinitePan);\n\n    this.subscription = this.editModeEnabled.subscribe((open) => {\n      if (!this.moveable || !this.isEditingEnabled) {\n        return;\n      }\n      this.moveable.draggable = !open;\n    });\n\n    this.panel = panel;\n    this.connections = new Connections(this);\n    this.transformComponentRef = createRef();\n  }\n\n  getNextElementName = (isFrame = false) => {\n    const label = isFrame ? 'Frame' : 'Element';\n    let idx = this.byName.size + 1;\n\n    const max = idx + 100;\n    while (true && idx < max) {\n      const name = `${label} ${idx++}`;\n      if (!this.byName.has(name)) {\n        return name;\n      }\n    }\n\n    return `${label} ${Date.now()}`;\n  };\n\n  canRename = (v: string) => {\n    return !this.byName.has(v);\n  };\n\n  load(\n    cfg: CanvasFrameOptions,\n    enableEditing: boolean,\n    showAdvancedTypes: boolean,\n    panZoom: boolean,\n    infinitePan: boolean\n  ) {\n    this.root = new RootElement(\n      cfg ?? {\n        type: 'frame',\n        elements: [DEFAULT_CANVAS_ELEMENT_CONFIG],\n      },\n      this,\n      this.save // callback when changes are made\n    );\n\n    this.isEditingEnabled = enableEditing;\n    this.shouldShowAdvancedTypes = showAdvancedTypes;\n    this.shouldPanZoom = panZoom;\n    this.shouldInfinitePan = infinitePan;\n\n    setTimeout(() => {\n      if (this.div) {\n        // If editing is enabled, clear selecto instance\n        const destroySelecto = enableEditing;\n        initMoveable(destroySelecto, enableEditing, this);\n        this.currentLayer = this.root;\n        this.selection.next([]);\n        this.connections.select(undefined);\n        this.connections.updateState();\n      }\n    });\n    return this.root;\n  }\n\n  context: DimensionContext = {\n    getColor: (color: ColorDimensionConfig) => getColorDimensionFromData(this.data, color),\n    getScale: (scale: ScaleDimensionConfig) => getScaleDimensionFromData(this.data, scale),\n    getScalar: (scalar: ScalarDimensionConfig) => getScalarDimensionFromData(this.data, scalar),\n    getText: (text: TextDimensionConfig) => getTextDimensionFromData(this.data, text),\n    getResource: (res: ResourceDimensionConfig) => getResourceDimensionFromData(this.data, res),\n    getPanelData: () => this.data,\n  };\n\n  updateData(data: PanelData) {\n    this.data = data;\n    this.root.updateData(this.context);\n  }\n\n  updateSize(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n    this.style = { width, height };\n\n    if (this.selecto?.getSelectedTargets().length) {\n      this.clearCurrentSelection();\n    }\n  }\n\n  clearCurrentSelection(skipNextSelectionBroadcast = false) {\n    this.skipNextSelectionBroadcast = skipNextSelectionBroadcast;\n    let event: MouseEvent = new MouseEvent('click');\n    this.selecto?.clickTarget(event, this.div);\n  }\n\n  save = (updateMoveable = false) => {\n    this.onSave(this.root.getSaveModel());\n\n    if (updateMoveable) {\n      setTimeout(() => {\n        if (this.div) {\n          initMoveable(true, this.isEditingEnabled, this);\n        }\n      });\n    }\n  };\n\n  setNonTargetPointerEvents = (target: Element, disablePointerEvents: boolean) => {\n    const stack = [...this.root.elements];\n    while (stack.length > 0) {\n      const currentElement = stack.shift();\n\n      if (currentElement && currentElement.div && currentElement.div !== target) {\n        currentElement.applyLayoutStylesToDiv(disablePointerEvents);\n      }\n\n      const nestedElements = currentElement instanceof FrameState ? currentElement.elements : [];\n      for (const nestedElement of nestedElements) {\n        stack.unshift(nestedElement);\n      }\n    }\n  };\n\n  setRef = (sceneContainer: HTMLDivElement) => {\n    this.div = sceneContainer;\n  };\n\n  select = (selection: SelectionParams) => {\n    if (this.selecto) {\n      this.selecto.setSelectedTargets(selection.targets);\n      this.updateSelection(selection);\n      this.editModeEnabled.next(false);\n\n      // Hide connection anchors on programmatic select\n      if (this.connections.connectionAnchorDiv) {\n        this.connections.connectionAnchorDiv.style.display = 'none';\n      }\n    }\n  };\n\n  updateSelection = (selection: SelectionParams) => {\n    this.moveable!.target = selection.targets;\n    if (this.skipNextSelectionBroadcast) {\n      this.skipNextSelectionBroadcast = false;\n      return;\n    }\n\n    if (selection.frame) {\n      this.selection.next([selection.frame]);\n    } else {\n      const s = selection.targets.map((t) => findElementByTarget(t, this.root.elements)!);\n      this.selection.next(s);\n    }\n  };\n\n  addToSelection = () => {\n    try {\n      let selection: SelectionParams = { targets: [] };\n      selection.targets = [...this.targetsToSelect];\n      this.select(selection);\n    } catch (error) {\n      appEvents.emit(AppEvents.alertError, ['Unable to add to selection']);\n    }\n  };\n\n  render() {\n    const isTooltipValid =\n      (this.tooltip?.element?.getLinks && this.tooltip?.element?.getLinks({}).length > 0) ||\n      this.tooltip?.element?.data?.field;\n    const canShowElementTooltip = !this.isEditingEnabled && isTooltipValid;\n\n    const sceneDiv = (\n      <div key={this.revId} className={this.styles.wrap} style={this.style} ref={this.setRef}>\n        {this.connections.render()}\n        {this.root.render()}\n        {this.isEditingEnabled && (\n          <Portal>\n            <CanvasContextMenu\n              scene={this}\n              panel={this.panel}\n              onVisibilityChange={this.contextMenuOnVisibilityChange}\n            />\n          </Portal>\n        )}\n        {canShowElementTooltip && (\n          <Portal>\n            <CanvasTooltip scene={this} />\n          </Portal>\n        )}\n      </div>\n    );\n\n    return config.featureToggles.canvasPanelPanZoom ? (\n      <SceneTransformWrapper scene={this}>{sceneDiv}</SceneTransformWrapper>\n    ) : (\n      sceneDiv\n    );\n  }\n}\n\nconst getStyles = () => ({\n  wrap: css({\n    overflow: 'hidden',\n    position: 'relative',\n  }),\n});\n","import { css } from '@emotion/css';\nimport { useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { ResourceDimensionMode } from '@grafana/schema';\nimport { Portal, useTheme2 } from '@grafana/ui';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { MediaType, ResourceFolderName } from 'app/features/dimensions';\nimport { ResourcePickerPopover } from 'app/features/dimensions/editors/ResourcePickerPopover';\n\nimport { AnchorPoint } from '../types';\n\ntype Props = {\n  onClose: () => void;\n  scene: Scene;\n  anchorPoint: AnchorPoint;\n};\n\nexport function SetBackground({ onClose, scene, anchorPoint }: Props) {\n  const defaultValue = scene.root.options.background?.image?.fixed ?? '';\n\n  const [bgImage, setBgImage] = useState(defaultValue);\n  const theme = useTheme2();\n  const styles = getStyles(theme, anchorPoint);\n\n  const onChange = (value: string | undefined) => {\n    if (value) {\n      setBgImage(value);\n      if (scene.root) {\n        scene.root.options.background = {\n          ...scene.root.options.background,\n          image: { mode: ResourceDimensionMode.Fixed, fixed: value },\n        };\n        scene.revId++;\n        scene.save();\n\n        scene.root.reinitializeMoveable();\n      }\n\n      // Force a re-render (update scene data after config update)\n      if (scene) {\n        scene.updateData(scene.data!);\n      }\n    }\n\n    onClose();\n  };\n\n  return (\n    <Portal className={styles.portalWrapper}>\n      <ResourcePickerPopover\n        onChange={onChange}\n        value={bgImage}\n        mediaType={MediaType.Image}\n        folderName={ResourceFolderName.IOT}\n      />\n    </Portal>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2, anchorPoint: AnchorPoint) => ({\n  portalWrapper: css({\n    width: '315px',\n    height: '445px',\n    transform: `translate(${anchorPoint.x}px, ${anchorPoint.y - 200}px)`,\n  }),\n});\n","import { useCallback } from 'react';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { InlineField, InlineFieldRow, RadioButtonGroup } from '@grafana/ui/src';\nimport { BackgroundImageSize } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nconst options: Array<SelectableValue<BackgroundImageSize>> = [\n  { value: BackgroundImageSize.Original, label: 'Original' },\n  { value: BackgroundImageSize.Contain, label: 'Contain' },\n  { value: BackgroundImageSize.Cover, label: 'Cover' },\n  { value: BackgroundImageSize.Fill, label: 'Fill' },\n  { value: BackgroundImageSize.Tile, label: 'Tile' },\n];\n\nexport const BackgroundSizeEditor = ({ value, onChange }: StandardEditorProps<string, undefined, undefined>) => {\n  const imageSize = value ?? BackgroundImageSize.Cover;\n\n  const onImageSizeChange = useCallback(\n    (size: string) => {\n      onChange(size);\n    },\n    [onChange]\n  );\n\n  return (\n    <InlineFieldRow>\n      <InlineField grow={true}>\n        <RadioButtonGroup value={imageSize} options={options} onChange={onImageSizeChange} fullWidth />\n      </InlineField>\n    </InlineFieldRow>\n  );\n};\n","import { useCallback } from 'react';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { Field, RadioButtonGroup, Switch } from '@grafana/ui/src';\n\nimport { LineStyle } from '../types';\n\nconst options: Array<SelectableValue<LineStyle>> = [\n  { value: LineStyle.Solid, label: 'Solid' },\n  { value: LineStyle.Dashed, label: 'Dashed' },\n  { value: LineStyle.Dotted, label: 'Dotted' },\n];\n\nexport interface LineStyleConfig {\n  style: LineStyle;\n  animate?: boolean;\n}\n\ntype Props = StandardEditorProps<LineStyleConfig>;\n\nexport const defaultLineStyleConfig: LineStyleConfig = {\n  style: LineStyle.Solid,\n  animate: false,\n};\n\nexport const LineStyleEditor = ({ value, onChange }: Props) => {\n  if (!value) {\n    value = defaultLineStyleConfig;\n  } else if (typeof value !== 'object') {\n    value = {\n      style: value,\n      animate: false,\n    };\n  }\n\n  const onLineStyleChange = useCallback(\n    (lineStyle: LineStyle) => {\n      onChange({ ...value, style: lineStyle });\n    },\n    [onChange, value]\n  );\n\n  const onAnimateChange = useCallback(\n    (animate: boolean) => {\n      onChange({ ...value, animate });\n    },\n    [onChange, value]\n  );\n\n  return (\n    <>\n      <RadioButtonGroup value={value.style} options={options} onChange={onLineStyleChange} fullWidth />\n      {value.style !== LineStyle.Solid && (\n        <>\n          <br />\n          <Field label=\"Animate\">\n            <Switch value={value.animate} onChange={(e) => onAnimateChange(e.currentTarget.checked)} />\n          </Field>\n        </>\n      )}\n    </>\n  );\n};\n","import { StandardEditorProps, DataLink, VariableSuggestionsScope, OneClickMode } from '@grafana/data';\nimport { DataLinksInlineEditor } from '@grafana/ui';\nimport { CanvasElementOptions } from 'app/features/canvas/element';\n\ntype Props = StandardEditorProps<DataLink[], CanvasElementOptions>;\n\nexport function DataLinksEditor({ value, onChange, item, context }: Props) {\n  const oneClickMode = item.settings?.oneClickMode;\n\n  return (\n    <DataLinksInlineEditor\n      links={value}\n      onChange={onChange}\n      getSuggestions={() => (context.getSuggestions ? context.getSuggestions(VariableSuggestionsScope.Values) : [])}\n      data={[]}\n      showOneClick={oneClickMode === OneClickMode.Link}\n    />\n  );\n}\n","import { capitalize } from 'lodash';\n\nimport { FieldType } from '@grafana/data';\nimport { PanelOptionsSupplier } from '@grafana/data/src/panel/PanelPlugin';\nimport { ConnectionDirection } from 'app/features/canvas/element';\nimport { SVGElements } from 'app/features/canvas/runtime/element';\nimport { ColorDimensionEditor, ResourceDimensionEditor, ScaleDimensionEditor } from 'app/features/dimensions/editors';\nimport { BackgroundSizeEditor } from 'app/features/dimensions/editors/BackgroundSizeEditor';\n\nimport { CanvasConnection, CanvasElementOptions } from '../panelcfg.gen';\nimport { LineStyle } from '../types';\n\nimport { LineStyleEditor } from './LineStyleEditor';\nimport { DataLinksEditor } from './element/DataLinksEditor';\n\ninterface OptionSuppliers {\n  addBackground: PanelOptionsSupplier<CanvasElementOptions>;\n  addBorder: PanelOptionsSupplier<CanvasElementOptions>;\n  addDataLinks: PanelOptionsSupplier<CanvasElementOptions>;\n  addColor: PanelOptionsSupplier<CanvasConnection>;\n  addSize: PanelOptionsSupplier<CanvasConnection>;\n  addRadius: PanelOptionsSupplier<CanvasConnection>;\n  addDirection: PanelOptionsSupplier<CanvasConnection>;\n  addLineStyle: PanelOptionsSupplier<CanvasConnection>;\n}\n\nconst getCategoryName = (str: string, type: string | undefined) => {\n  if (type !== 'frame' && type !== undefined) {\n    return [str + ` (${type})`];\n  }\n  return [str];\n};\n\nexport const optionBuilder: OptionSuppliers = {\n  addBackground: (builder, context) => {\n    const category = getCategoryName('Background', context.options?.type);\n    builder\n      .addCustomEditor({\n        category,\n        id: 'background.color',\n        path: 'background.color',\n        name: 'Color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          // Configured values\n          fixed: '',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'background.image',\n        path: 'background.image',\n        name: 'Image',\n        editor: ResourceDimensionEditor,\n        settings: {\n          resourceType: 'image',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'background.size',\n        path: 'background.size',\n        name: 'Image size',\n        editor: BackgroundSizeEditor,\n        settings: {\n          resourceType: 'image',\n        },\n        showIf: () => {\n          // Do not show image size editor for SVG based elements\n          // See https://github.com/grafana/grafana/issues/84843#issuecomment-2010921066 for additional context\n          if (context.options?.type) {\n            return !SVGElements.has(context.options.type);\n          }\n\n          return true;\n        },\n      });\n  },\n\n  addBorder: (builder, context) => {\n    const category = getCategoryName('Border', context.options?.type);\n    builder.addSliderInput({\n      category,\n      path: 'border.width',\n      name: 'Width',\n      defaultValue: 2,\n      settings: {\n        min: 0,\n        max: 20,\n      },\n    });\n\n    if (context.options?.border?.width) {\n      builder.addCustomEditor({\n        category,\n        id: 'border.color',\n        path: 'border.color',\n        name: 'Color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          // Configured values\n          fixed: '',\n        },\n      });\n    }\n\n    builder.addSliderInput({\n      category,\n      path: 'border.radius',\n      name: 'Radius',\n      defaultValue: 0,\n      settings: {\n        min: 0,\n        max: 60,\n      },\n    });\n  },\n\n  addColor: (builder, context) => {\n    const category = ['Color'];\n    builder.addCustomEditor({\n      category,\n      id: 'color',\n      path: 'color',\n      name: 'Color',\n      editor: ColorDimensionEditor,\n      settings: {},\n      defaultValue: {\n        // Configured values\n        fixed: '',\n      },\n    });\n  },\n\n  addSize: (builder, context) => {\n    const category = ['Size'];\n    builder.addCustomEditor({\n      category,\n      id: 'size',\n      path: 'size',\n      name: 'Size',\n      editor: ScaleDimensionEditor,\n      settings: {\n        min: 1,\n        max: 10,\n      },\n      defaultValue: {\n        // Configured values\n        fixed: 2,\n        min: 1,\n        max: 10,\n      },\n    });\n  },\n\n  addRadius: (builder, context) => {\n    const category = ['Radius'];\n    builder.addCustomEditor({\n      category,\n      id: 'radius',\n      path: 'radius',\n      name: 'Radius',\n      editor: ScaleDimensionEditor,\n      settings: {\n        min: 0,\n        max: 200,\n        filteredFieldType: FieldType.number,\n      },\n      defaultValue: {\n        // Configured values\n        fixed: 0,\n        min: 0,\n        max: 100,\n      },\n    });\n  },\n\n  addDirection: (builder, context) => {\n    const category = ['Arrow Direction'];\n    builder.addRadio({\n      category,\n      path: 'direction',\n      name: 'Direction',\n      settings: {\n        options: [\n          { value: undefined, label: capitalize(ConnectionDirection.Forward) },\n          { value: ConnectionDirection.Reverse, label: capitalize(ConnectionDirection.Reverse) },\n          { value: ConnectionDirection.Both, label: capitalize(ConnectionDirection.Both) },\n          { value: ConnectionDirection.None, label: capitalize(ConnectionDirection.None) },\n        ],\n      },\n      defaultValue: ConnectionDirection.Forward,\n    });\n  },\n\n  addLineStyle: (builder, context) => {\n    const category = ['Line style'];\n    builder.addCustomEditor({\n      category,\n      id: 'lineStyle',\n      path: 'lineStyle',\n      name: 'Line style',\n      editor: LineStyleEditor,\n      settings: {},\n      defaultValue: { value: LineStyle.Solid, label: 'Solid' },\n    });\n  },\n\n  addDataLinks: (builder, context) => {\n    builder.addCustomEditor({\n      category: ['Data links'],\n      id: 'dataLinks',\n      path: 'links',\n      name: 'Links',\n      editor: DataLinksEditor,\n      settings: context.options,\n    });\n  },\n};\n","import { get as lodashGet } from 'lodash';\n\nimport { NestedPanelOptions, NestedValueAccess } from '@grafana/data/src/utils/OptionsUIBuilders';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { CanvasConnection } from '../panelcfg.gen';\nimport { ConnectionState } from '../types';\n\nimport { optionBuilder } from './options';\n\nexport interface CanvasConnectionEditorOptions {\n  connection: ConnectionState;\n  scene: Scene;\n  category?: string[];\n}\n\nexport function getConnectionEditor(opts: CanvasConnectionEditorOptions): NestedPanelOptions<CanvasConnection> {\n  return {\n    category: opts.category,\n    path: '--', // not used!\n\n    values: (parent: NestedValueAccess) => ({\n      getValue: (path: string) => {\n        return lodashGet(opts.connection.info, path);\n      },\n      // TODO: Fix this unknown (maybe a dimension supplier?)\n      onChange: (path: string, value: unknown) => {\n        let options = opts.connection.info;\n        options = setOptionImmutably(options, path, value);\n        opts.scene.connections.onChange(opts.connection, options);\n      },\n    }),\n\n    build: (builder, context) => {\n      const ctx = { ...context, options: opts.connection.info };\n      optionBuilder.addColor(builder, ctx);\n      optionBuilder.addSize(builder, ctx);\n      optionBuilder.addRadius(builder, ctx);\n      optionBuilder.addDirection(builder, ctx);\n      optionBuilder.addLineStyle(builder, ctx);\n    },\n  };\n}\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { VerticalConstraint, HorizontalConstraint, Constraint } from '../../panelcfg.gen';\n\ninterface Props {\n  onVerticalConstraintChange: (v: VerticalConstraint) => void;\n  onHorizontalConstraintChange: (h: HorizontalConstraint) => void;\n  currentConstraints: Constraint;\n}\n\nexport const ConstraintSelectionBox = ({\n  onVerticalConstraintChange,\n  onHorizontalConstraintChange,\n  currentConstraints,\n}: Props) => {\n  const styles = useStyles2(getStyles(currentConstraints));\n\n  const onClickTopConstraint = () => {\n    onVerticalConstraintChange(VerticalConstraint.Top);\n  };\n\n  const onClickBottomConstraint = () => {\n    onVerticalConstraintChange(VerticalConstraint.Bottom);\n  };\n\n  const onClickVerticalCenterConstraint = () => {\n    onVerticalConstraintChange(VerticalConstraint.Center);\n  };\n\n  const onClickLeftConstraint = () => {\n    onHorizontalConstraintChange(HorizontalConstraint.Left);\n  };\n\n  const onClickRightConstraint = () => {\n    onHorizontalConstraintChange(HorizontalConstraint.Right);\n  };\n\n  const onClickHorizontalCenterConstraint = () => {\n    onHorizontalConstraintChange(HorizontalConstraint.Center);\n  };\n\n  return (\n    <svg\n      version=\"1.0\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"75.000000pt\"\n      height=\"75.000000pt\"\n      viewBox=\"0 0 228.000000 228.000000\"\n      preserveAspectRatio=\"xMidYMid meet\"\n      style={{ marginBottom: '4.8px' }}\n    >\n      <g transform=\"translate(0.000000,228.000000) scale(0.100000,-0.100000)\" fill=\"#000000\" stroke=\"none\">\n        <path\n          fill=\"#e5e5e5\"\n          d=\"M198 2028 l-28 -32 0 -912 0 -912 31 -31 31 -31 915 0 915 0 29 29\n29 29 0 917 0 917 -27 29 -28 29 -920 0 -920 0 -27 -32z m1876 -17 c15 -16 16\n-98 16 -927 0 -860 -1 -909 -18 -926 -17 -17 -66 -18 -927 -18 -862 0 -910 1\n-927 18 -17 17 -18 65 -18 926 0 832 1 911 16 927 16 18 45 19 468 21 248 2\n659 2 912 0 431 -2 462 -4 478 -21z\"\n        />\n        <rect className={styles.topConstraint} height=\"228\" width=\"46\" y=\"1735\" x=\"1123\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickTopConstraint}\n          height=\"350\"\n          width=\"300\"\n          y=\"1680\"\n          x=\"995\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.bottomConstraint} height=\"228\" width=\"46\" y=\"210\" x=\"1123\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickBottomConstraint}\n          height=\"350\"\n          width=\"300\"\n          y=\"135\"\n          x=\"995\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.leftConstraint} height=\"46\" width=\"228\" y=\"1060\" x=\"265\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickLeftConstraint}\n          height=\"300\"\n          width=\"350\"\n          y=\"925\"\n          x=\"200\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.rightConstraint} height=\"46\" width=\"228\" y=\"1060\" x=\"1795\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickRightConstraint}\n          height=\"300\"\n          width=\"350\"\n          y=\"925\"\n          x=\"1730\"\n          fill=\"transparent\"\n        />\n        <path\n          className={styles.box}\n          d=\"M568 1669 c-17 -9 -18 -48 -18 -584 0 -558 1 -575 19 -585 27 -14\n1125 -14 1152 0 18 10 19 27 19 580 0 504 -2 570 -16 584 -14 14 -80 16 -577\n16 -363 -1 -568 -4 -579 -11z m1119 -42 c4 -5 4 -1079 0 -1084 -5 -4 -1079 -4\n-1084 0 -5 6 -4 1077 1 1085 4 7 1076 6 1083 -1z\"\n        />\n        <rect className={styles.verticalCenterConstraint} height=\"456\" width=\"46\" y=\"855\" x=\"1123\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickVerticalCenterConstraint}\n          height=\"660\"\n          width=\"300\"\n          y=\"750\"\n          x=\"995\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.horizontalCenterConstraint} height=\"46\" width=\"456\" y=\"1060\" x=\"918\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickHorizontalCenterConstraint}\n          height=\"300\"\n          width=\"660\"\n          y=\"925\"\n          x=\"815\"\n          fill=\"transparent\"\n        />\n      </g>\n    </svg>\n  );\n};\n\nconst getStyles = (currentConstraints: Constraint) => (theme: GrafanaTheme2) => {\n  const HOVER_COLOR = '#daebf7';\n  const HOVER_OPACITY = '0.6';\n  const SELECTED_COLOR = '#0d99ff';\n\n  const selectionBoxColor = theme.isDark ? '#ffffff' : '#000000';\n\n  return {\n    constraintHover: css({\n      '&:hover': {\n        fill: HOVER_COLOR,\n        fillOpacity: HOVER_OPACITY,\n      },\n    }),\n    topConstraint: css({\n      ...(currentConstraints.vertical === VerticalConstraint.Top ||\n      currentConstraints.vertical === VerticalConstraint.TopBottom\n        ? {\n            width: '92pt',\n            x: '1085',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    bottomConstraint: css({\n      ...(currentConstraints.vertical === VerticalConstraint.Bottom ||\n      currentConstraints.vertical === VerticalConstraint.TopBottom\n        ? {\n            width: '92pt',\n            x: '1085',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    leftConstraint: css({\n      ...(currentConstraints.horizontal === HorizontalConstraint.Left ||\n      currentConstraints.horizontal === HorizontalConstraint.LeftRight\n        ? {\n            height: '92pt',\n            y: '1014',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    rightConstraint: css({\n      ...(currentConstraints.horizontal === HorizontalConstraint.Right ||\n      currentConstraints.horizontal === HorizontalConstraint.LeftRight\n        ? {\n            height: '92pt',\n            y: '1014',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    horizontalCenterConstraint: css({\n      ...(currentConstraints.horizontal === HorizontalConstraint.Center\n        ? {\n            height: '92pt',\n            y: '1014',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    verticalCenterConstraint: css({\n      ...(currentConstraints.vertical === VerticalConstraint.Center\n        ? {\n            width: '92pt',\n            x: '1085',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    box: css({\n      fill: selectionBoxColor,\n    }),\n  };\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data/src';\nimport { IconButton, useStyles2 } from '@grafana/ui/src';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { QuickPlacement } from 'app/features/canvas/types';\n\nimport { HorizontalConstraint, VerticalConstraint, Placement } from '../../panelcfg.gen';\n\nimport { CanvasEditorOptions } from './elementEditor';\n\ntype Props = {\n  onPositionChange: (value: number | undefined, placement: keyof Placement) => void;\n  element: ElementState;\n  settings: CanvasEditorOptions;\n};\n\nexport const QuickPositioning = ({ onPositionChange, element, settings }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const onQuickPositioningChange = (position: QuickPlacement) => {\n    const defaultConstraint = { vertical: VerticalConstraint.Top, horizontal: HorizontalConstraint.Left };\n    const originalConstraint = { ...element.options.constraint };\n\n    element.options.constraint = defaultConstraint;\n    element.setPlacementFromConstraint();\n\n    switch (position) {\n      case QuickPlacement.Top:\n        onPositionChange(0, 'top');\n        break;\n      case QuickPlacement.Bottom:\n        onPositionChange(getRightBottomPosition(element.options.placement?.height ?? 0, 'bottom'), 'top');\n        break;\n      case QuickPlacement.VerticalCenter:\n        onPositionChange(getCenterPosition(element.options.placement?.height ?? 0, 'v'), 'top');\n        break;\n      case QuickPlacement.Left:\n        onPositionChange(0, 'left');\n        break;\n      case QuickPlacement.Right:\n        onPositionChange(getRightBottomPosition(element.options.placement?.width ?? 0, 'right'), 'left');\n        break;\n      case QuickPlacement.HorizontalCenter:\n        onPositionChange(getCenterPosition(element.options.placement?.width ?? 0, 'h'), 'left');\n        break;\n    }\n\n    element.options.constraint = originalConstraint;\n    element.setPlacementFromConstraint();\n  };\n\n  // Basing this on scene will mean that center is based on root for the time being\n  const getCenterPosition = (elementSize: number, align: 'h' | 'v') => {\n    const sceneSize = align === 'h' ? settings.scene.width : settings.scene.height;\n\n    return (sceneSize - elementSize) / 2;\n  };\n\n  const getRightBottomPosition = (elementSize: number, align: 'right' | 'bottom') => {\n    const sceneSize = align === 'right' ? settings.scene.width : settings.scene.height;\n\n    return sceneSize - elementSize;\n  };\n\n  return (\n    <div className={styles.buttonGroup}>\n      <IconButton\n        name=\"horizontal-align-left\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Left)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip=\"Align left\"\n      />\n      <IconButton\n        name=\"horizontal-align-center\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.HorizontalCenter)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip=\"Align horizontal centers\"\n      />\n      <IconButton\n        name=\"horizontal-align-right\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Right)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip=\"Align right\"\n      />\n      <IconButton\n        name=\"vertical-align-top\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Top)}\n        size=\"lg\"\n        tooltip=\"Align top\"\n      />\n      <IconButton\n        name=\"vertical-align-center\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.VerticalCenter)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip=\"Align vertical centers\"\n      />\n      <IconButton\n        name=\"vertical-align-bottom\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Bottom)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip=\"Align bottom\"\n      />\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  buttonGroup: css({\n    display: 'flex',\n    flexWrap: 'wrap',\n    padding: '12px 0 12px 0',\n  }),\n  button: css({\n    marginLeft: '5px',\n    marginRight: '5px',\n  }),\n});\n","import { useObservable } from 'react-use';\nimport { Subject } from 'rxjs';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { Field, Icon, InlineField, InlineFieldRow, Select, Stack } from '@grafana/ui';\nimport { NumberInput } from 'app/core/components/OptionsUI/NumberInput';\n\nimport { HorizontalConstraint, Options, Placement, VerticalConstraint } from '../../panelcfg.gen';\n\nimport { ConstraintSelectionBox } from './ConstraintSelectionBox';\nimport { QuickPositioning } from './QuickPositioning';\nimport { CanvasEditorOptions } from './elementEditor';\n\nconst places: Array<keyof Placement> = ['top', 'left', 'bottom', 'right', 'width', 'height', 'rotation'];\n\nconst horizontalOptions: Array<SelectableValue<HorizontalConstraint>> = [\n  { label: 'Left', value: HorizontalConstraint.Left },\n  { label: 'Right', value: HorizontalConstraint.Right },\n  { label: 'Left & right', value: HorizontalConstraint.LeftRight },\n  { label: 'Center', value: HorizontalConstraint.Center },\n  { label: 'Scale', value: HorizontalConstraint.Scale },\n];\n\nconst verticalOptions: Array<SelectableValue<VerticalConstraint>> = [\n  { label: 'Top', value: VerticalConstraint.Top },\n  { label: 'Bottom', value: VerticalConstraint.Bottom },\n  { label: 'Top & bottom', value: VerticalConstraint.TopBottom },\n  { label: 'Center', value: VerticalConstraint.Center },\n  { label: 'Scale', value: VerticalConstraint.Scale },\n];\n\ntype Props = StandardEditorProps<unknown, CanvasEditorOptions, Options>;\n\nexport function PlacementEditor({ item }: Props) {\n  const settings = item.settings;\n\n  // Will force a rerender whenever the subject changes\n  useObservable(settings?.scene ? settings.scene.moved : new Subject());\n\n  if (!settings) {\n    return <div>Loading...</div>;\n  }\n\n  const element = settings.element;\n  if (!element) {\n    return <div>???</div>;\n  }\n  const { options } = element;\n  const { placement, constraint: layout } = options;\n\n  if (placement) {\n    placement.rotation = placement?.rotation ?? 0;\n  }\n\n  const reselectElementAfterChange = () => {\n    setTimeout(() => {\n      settings.scene.select({ targets: [element.div!] });\n    });\n  };\n\n  const onHorizontalConstraintSelect = (h: SelectableValue<HorizontalConstraint>) => {\n    onHorizontalConstraintChange(h.value!);\n  };\n\n  const onHorizontalConstraintChange = (h: HorizontalConstraint) => {\n    element.options.constraint!.horizontal = h;\n    element.setPlacementFromConstraint();\n    settings.scene.revId++;\n    settings.scene.save(true);\n    reselectElementAfterChange();\n  };\n\n  const onVerticalConstraintSelect = (v: SelectableValue<VerticalConstraint>) => {\n    onVerticalConstraintChange(v.value!);\n  };\n\n  const onVerticalConstraintChange = (v: VerticalConstraint) => {\n    element.options.constraint!.vertical = v;\n    element.setPlacementFromConstraint();\n    settings.scene.revId++;\n    settings.scene.save(true);\n    reselectElementAfterChange();\n  };\n\n  const onPositionChange = (value: number | undefined, placement: keyof Placement) => {\n    element.options.placement![placement] = value ?? element.options.placement![placement];\n    element.applyLayoutStylesToDiv();\n    settings.scene.clearCurrentSelection(true);\n    reselectElementAfterChange();\n  };\n\n  const constraint = element.tempConstraint ?? layout ?? {};\n\n  return (\n    <div>\n      <QuickPositioning onPositionChange={onPositionChange} settings={settings} element={element} />\n      <br />\n      <Field label=\"Constraints\">\n        <Stack direction=\"row\">\n          <ConstraintSelectionBox\n            onVerticalConstraintChange={onVerticalConstraintChange}\n            onHorizontalConstraintChange={onHorizontalConstraintChange}\n            currentConstraints={constraint}\n          />\n          <Stack direction=\"column\">\n            <Stack direction=\"row\">\n              <Icon name=\"arrows-h\" />\n              <Select\n                options={horizontalOptions}\n                onChange={onHorizontalConstraintSelect}\n                value={constraint.horizontal}\n              />\n            </Stack>\n            <Stack direction=\"row\">\n              <Icon name=\"arrows-v\" />\n              <Select options={verticalOptions} onChange={onVerticalConstraintSelect} value={constraint.vertical} />\n            </Stack>\n          </Stack>\n        </Stack>\n      </Field>\n\n      <br />\n\n      <Field label=\"Position\">\n        <>\n          {places.map((p) => {\n            const v = placement![p];\n            if (v == null) {\n              return null;\n            }\n\n            // Need to set explicit min/max for rotation as logic only can handle 0-360\n            const min = p === 'rotation' ? 0 : undefined;\n            const max = p === 'rotation' ? 360 : undefined;\n\n            return (\n              <InlineFieldRow key={p}>\n                <InlineField label={p} labelWidth={8} grow={true}>\n                  <NumberInput min={min} max={max} value={v} onChange={(v) => onPositionChange(v, p)} />\n                </InlineField>\n              </InlineFieldRow>\n            );\n          })}\n        </>\n      </Field>\n    </div>\n  );\n}\n","import { capitalize, get as lodashGet } from 'lodash';\n\nimport { OneClickMode } from '@grafana/data';\nimport { NestedPanelOptions, NestedValueAccess } from '@grafana/data/src/utils/OptionsUIBuilders';\nimport { CanvasElementOptions } from 'app/features/canvas/element';\nimport {\n  DEFAULT_CANVAS_ELEMENT_CONFIG,\n  canvasElementRegistry,\n  defaultElementItems,\n} from 'app/features/canvas/registry';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { getElementTypes } from '../../utils';\nimport { optionBuilder } from '../options';\n\nimport { PlacementEditor } from './PlacementEditor';\n\nexport interface CanvasEditorOptions {\n  element: ElementState;\n  scene: Scene;\n  category?: string[];\n}\n\nexport interface TreeViewEditorProps {\n  scene: Scene;\n  layer: FrameState;\n  selected: ElementState[];\n}\n\nexport function getElementEditor(opts: CanvasEditorOptions): NestedPanelOptions<CanvasElementOptions> {\n  return {\n    category: opts.category,\n    path: '--', // not used!\n\n    // Note that canvas editor writes things to the scene!\n    values: (parent: NestedValueAccess) => ({\n      getValue: (path) => {\n        return lodashGet(opts.element.options, path);\n      },\n      onChange: (path, value) => {\n        let options = opts.element.options;\n        if (path === 'type' && value) {\n          const layer = canvasElementRegistry.getIfExists(value);\n          if (!layer) {\n            console.warn('layer does not exist', value);\n            return;\n          }\n          options = {\n            ...options,\n            ...layer.getNewOptions(options),\n            type: layer.id,\n          };\n        } else {\n          options = setOptionImmutably(options, path, value);\n        }\n        opts.element.onChange(options);\n        opts.element.updateData(opts.scene.context);\n      },\n    }),\n\n    // Dynamically fill the selected element\n    build: (builder, context) => {\n      const { options } = opts.element;\n      const current = options?.type ? options.type : DEFAULT_CANVAS_ELEMENT_CONFIG.type;\n      const layerTypes = getElementTypes(opts.scene.shouldShowAdvancedTypes, current).options;\n\n      const isUnsupported =\n        !opts.scene.shouldShowAdvancedTypes && !defaultElementItems.filter((item) => item.id === options?.type).length;\n\n      builder.addSelect({\n        path: 'type',\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n        name: undefined as any, // required, but hide space\n        settings: {\n          options: layerTypes,\n        },\n        description: isUnsupported\n          ? 'Selected element type is not supported by current settings. Please enable advanced element types.'\n          : '',\n      });\n\n      // force clean layer configuration\n      const layer = canvasElementRegistry.getIfExists(options?.type ?? DEFAULT_CANVAS_ELEMENT_CONFIG.type)!;\n      let currentOptions = options;\n      if (!currentOptions) {\n        currentOptions = {\n          ...layer.getNewOptions(options),\n          type: layer.id,\n          name: `Element ${Date.now()}.${Math.floor(Math.random() * 100)}`,\n        };\n      }\n      const ctx = { ...context, options: currentOptions };\n\n      if (layer?.registerOptionsUI) {\n        layer.registerOptionsUI(builder, ctx);\n      }\n\n      const shouldAddLayoutEditor = opts.element.item.standardEditorConfig?.layout ?? true;\n      if (shouldAddLayoutEditor) {\n        builder.addCustomEditor({\n          category: ['Layout'],\n          id: 'content',\n          path: '__', // not used\n          name: 'Quick placement',\n          editor: PlacementEditor,\n          settings: opts,\n        });\n      }\n\n      const shouldAddBackgroundEditor = opts.element.item.standardEditorConfig?.background ?? true;\n      if (shouldAddBackgroundEditor) {\n        optionBuilder.addBackground(builder, ctx);\n      }\n\n      const shouldAddBorderEditor = opts.element.item.standardEditorConfig?.border ?? true;\n      if (shouldAddBorderEditor) {\n        optionBuilder.addBorder(builder, ctx);\n      }\n\n      builder.addRadio({\n        category: ['Data links'],\n        path: 'oneClickMode',\n        name: 'One-click',\n        description: 'When enabled, a single click opens the first link',\n        settings: {\n          options: [\n            { value: OneClickMode.Off, label: capitalize(OneClickMode.Off) },\n            { value: OneClickMode.Link, label: capitalize(OneClickMode.Link) },\n          ],\n        },\n        defaultValue: OneClickMode.Off,\n      });\n\n      optionBuilder.addDataLinks(builder, ctx);\n    },\n  };\n}\n","/**\n * Webpack has bug for import loop, which is not the same behavior as ES module.\n * When util.js imports the TreeNode for tree generate will cause treeContextTypes be empty.\n */\nimport * as React from 'react';\nexport var TreeContext = /*#__PURE__*/React.createContext(null);","import * as React from 'react';\nexport default function DropIndicator(_ref) {\n  var dropPosition = _ref.dropPosition,\n    dropLevelOffset = _ref.dropLevelOffset,\n    indent = _ref.indent;\n  var style = {\n    pointerEvents: 'none',\n    position: 'absolute',\n    right: 0,\n    backgroundColor: 'red',\n    height: 2\n  };\n  switch (dropPosition) {\n    case -1:\n      style.top = 0;\n      style.left = -dropLevelOffset * indent;\n      break;\n    case 1:\n      style.bottom = 0;\n      style.left = -dropLevelOffset * indent;\n      break;\n    case 0:\n      style.bottom = 0;\n      style.left = indent;\n      break;\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: style\n  });\n}","function _objectDestructuringEmpty(t) {\n  if (null == t) throw new TypeError(\"Cannot destructure \" + t);\n}\nexport { _objectDestructuringEmpty as default };","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport classNames from 'classnames';\nimport * as React from 'react';\nvar Indent = function Indent(_ref) {\n  var prefixCls = _ref.prefixCls,\n    level = _ref.level,\n    isStart = _ref.isStart,\n    isEnd = _ref.isEnd;\n  var baseClassName = \"\".concat(prefixCls, \"-indent-unit\");\n  var list = [];\n  for (var i = 0; i < level; i += 1) {\n    list.push( /*#__PURE__*/React.createElement(\"span\", {\n      key: i,\n      className: classNames(baseClassName, _defineProperty(_defineProperty({}, \"\".concat(baseClassName, \"-start\"), isStart[i]), \"\".concat(baseClassName, \"-end\"), isEnd[i]))\n    }));\n  }\n  return /*#__PURE__*/React.createElement(\"span\", {\n    \"aria-hidden\": \"true\",\n    className: \"\".concat(prefixCls, \"-indent\")\n  }, list);\n};\nexport default /*#__PURE__*/React.memo(Indent);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"@babel/runtime/helpers/esm/createSuper\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _excluded = [\"eventKey\", \"className\", \"style\", \"dragOver\", \"dragOverGapTop\", \"dragOverGapBottom\", \"isLeaf\", \"isStart\", \"isEnd\", \"expanded\", \"selected\", \"checked\", \"halfChecked\", \"loading\", \"domRef\", \"active\", \"data\", \"onMouseMove\", \"selectable\"];\nimport classNames from 'classnames';\nimport pickAttrs from \"rc-util/es/pickAttrs\";\nimport * as React from 'react';\n// @ts-ignore\nimport { TreeContext } from \"./contextTypes\";\nimport Indent from \"./Indent\";\nimport getEntity from \"./utils/keyUtil\";\nimport { convertNodePropsToEventData } from \"./utils/treeUtil\";\nvar ICON_OPEN = 'open';\nvar ICON_CLOSE = 'close';\nvar defaultTitle = '---';\nvar InternalTreeNode = /*#__PURE__*/function (_React$Component) {\n  _inherits(InternalTreeNode, _React$Component);\n  var _super = _createSuper(InternalTreeNode);\n  function InternalTreeNode() {\n    var _this;\n    _classCallCheck(this, InternalTreeNode);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      dragNodeHighlight: false\n    });\n    _defineProperty(_assertThisInitialized(_this), \"selectHandle\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"cacheIndent\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"onSelectorClick\", function (e) {\n      // Click trigger before select/check operation\n      var onNodeClick = _this.props.context.onNodeClick;\n      onNodeClick(e, convertNodePropsToEventData(_this.props));\n      if (_this.isSelectable()) {\n        _this.onSelect(e);\n      } else {\n        _this.onCheck(e);\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onSelectorDoubleClick\", function (e) {\n      var onNodeDoubleClick = _this.props.context.onNodeDoubleClick;\n      onNodeDoubleClick(e, convertNodePropsToEventData(_this.props));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onSelect\", function (e) {\n      if (_this.isDisabled()) return;\n      var onNodeSelect = _this.props.context.onNodeSelect;\n      onNodeSelect(e, convertNodePropsToEventData(_this.props));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onCheck\", function (e) {\n      if (_this.isDisabled()) return;\n      var _this$props = _this.props,\n        disableCheckbox = _this$props.disableCheckbox,\n        checked = _this$props.checked;\n      var onNodeCheck = _this.props.context.onNodeCheck;\n      if (!_this.isCheckable() || disableCheckbox) return;\n      var targetChecked = !checked;\n      onNodeCheck(e, convertNodePropsToEventData(_this.props), targetChecked);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onMouseEnter\", function (e) {\n      var onNodeMouseEnter = _this.props.context.onNodeMouseEnter;\n      onNodeMouseEnter(e, convertNodePropsToEventData(_this.props));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onMouseLeave\", function (e) {\n      var onNodeMouseLeave = _this.props.context.onNodeMouseLeave;\n      onNodeMouseLeave(e, convertNodePropsToEventData(_this.props));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onContextMenu\", function (e) {\n      var onNodeContextMenu = _this.props.context.onNodeContextMenu;\n      onNodeContextMenu(e, convertNodePropsToEventData(_this.props));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDragStart\", function (e) {\n      var onNodeDragStart = _this.props.context.onNodeDragStart;\n      e.stopPropagation();\n      _this.setState({\n        dragNodeHighlight: true\n      });\n      onNodeDragStart(e, _assertThisInitialized(_this));\n      try {\n        // ie throw error\n        // firefox-need-it\n        e.dataTransfer.setData('text/plain', '');\n      } catch (error) {\n        // empty\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDragEnter\", function (e) {\n      var onNodeDragEnter = _this.props.context.onNodeDragEnter;\n      e.preventDefault();\n      e.stopPropagation();\n      onNodeDragEnter(e, _assertThisInitialized(_this));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDragOver\", function (e) {\n      var onNodeDragOver = _this.props.context.onNodeDragOver;\n      e.preventDefault();\n      e.stopPropagation();\n      onNodeDragOver(e, _assertThisInitialized(_this));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDragLeave\", function (e) {\n      var onNodeDragLeave = _this.props.context.onNodeDragLeave;\n      e.stopPropagation();\n      onNodeDragLeave(e, _assertThisInitialized(_this));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDragEnd\", function (e) {\n      var onNodeDragEnd = _this.props.context.onNodeDragEnd;\n      e.stopPropagation();\n      _this.setState({\n        dragNodeHighlight: false\n      });\n      onNodeDragEnd(e, _assertThisInitialized(_this));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDrop\", function (e) {\n      var onNodeDrop = _this.props.context.onNodeDrop;\n      e.preventDefault();\n      e.stopPropagation();\n      _this.setState({\n        dragNodeHighlight: false\n      });\n      onNodeDrop(e, _assertThisInitialized(_this));\n    });\n    // Disabled item still can be switch\n    _defineProperty(_assertThisInitialized(_this), \"onExpand\", function (e) {\n      var _this$props2 = _this.props,\n        loading = _this$props2.loading,\n        onNodeExpand = _this$props2.context.onNodeExpand;\n      if (loading) return;\n      onNodeExpand(e, convertNodePropsToEventData(_this.props));\n    });\n    // Drag usage\n    _defineProperty(_assertThisInitialized(_this), \"setSelectHandle\", function (node) {\n      _this.selectHandle = node;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"getNodeState\", function () {\n      var expanded = _this.props.expanded;\n      if (_this.isLeaf()) {\n        return null;\n      }\n      return expanded ? ICON_OPEN : ICON_CLOSE;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"hasChildren\", function () {\n      var eventKey = _this.props.eventKey;\n      var keyEntities = _this.props.context.keyEntities;\n      var _ref = getEntity(keyEntities, eventKey) || {},\n        children = _ref.children;\n      return !!(children || []).length;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"isLeaf\", function () {\n      var _this$props3 = _this.props,\n        isLeaf = _this$props3.isLeaf,\n        loaded = _this$props3.loaded;\n      var loadData = _this.props.context.loadData;\n      var hasChildren = _this.hasChildren();\n      if (isLeaf === false) {\n        return false;\n      }\n      return isLeaf || !loadData && !hasChildren || loadData && loaded && !hasChildren;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"isDisabled\", function () {\n      var disabled = _this.props.disabled;\n      var treeDisabled = _this.props.context.disabled;\n      return !!(treeDisabled || disabled);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"isCheckable\", function () {\n      var checkable = _this.props.checkable;\n      var treeCheckable = _this.props.context.checkable;\n\n      // Return false if tree or treeNode is not checkable\n      if (!treeCheckable || checkable === false) return false;\n      return treeCheckable;\n    });\n    // Load data to avoid default expanded tree without data\n    _defineProperty(_assertThisInitialized(_this), \"syncLoadData\", function (props) {\n      var expanded = props.expanded,\n        loading = props.loading,\n        loaded = props.loaded;\n      var _this$props$context = _this.props.context,\n        loadData = _this$props$context.loadData,\n        onNodeLoad = _this$props$context.onNodeLoad;\n      if (loading) {\n        return;\n      }\n\n      // read from state to avoid loadData at same time\n      if (loadData && expanded && !_this.isLeaf() && !loaded) {\n        // We needn't reload data when has children in sync logic\n        // It's only needed in node expanded\n        onNodeLoad(convertNodePropsToEventData(_this.props));\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"isDraggable\", function () {\n      var _this$props4 = _this.props,\n        data = _this$props4.data,\n        draggable = _this$props4.context.draggable;\n      return !!(draggable && (!draggable.nodeDraggable || draggable.nodeDraggable(data)));\n    });\n    // ==================== Render: Drag Handler ====================\n    _defineProperty(_assertThisInitialized(_this), \"renderDragHandler\", function () {\n      var _this$props$context2 = _this.props.context,\n        draggable = _this$props$context2.draggable,\n        prefixCls = _this$props$context2.prefixCls;\n      return draggable !== null && draggable !== void 0 && draggable.icon ? /*#__PURE__*/React.createElement(\"span\", {\n        className: \"\".concat(prefixCls, \"-draggable-icon\")\n      }, draggable.icon) : null;\n    });\n    // ====================== Render: Switcher ======================\n    _defineProperty(_assertThisInitialized(_this), \"renderSwitcherIconDom\", function (isLeaf) {\n      var switcherIconFromProps = _this.props.switcherIcon;\n      var switcherIconFromCtx = _this.props.context.switcherIcon;\n      var switcherIcon = switcherIconFromProps || switcherIconFromCtx;\n      // if switcherIconDom is null, no render switcher span\n      if (typeof switcherIcon === 'function') {\n        return switcherIcon(_objectSpread(_objectSpread({}, _this.props), {}, {\n          isLeaf: isLeaf\n        }));\n      }\n      return switcherIcon;\n    });\n    // Switcher\n    _defineProperty(_assertThisInitialized(_this), \"renderSwitcher\", function () {\n      var expanded = _this.props.expanded;\n      var prefixCls = _this.props.context.prefixCls;\n      if (_this.isLeaf()) {\n        // if switcherIconDom is null, no render switcher span\n        var _switcherIconDom = _this.renderSwitcherIconDom(true);\n        return _switcherIconDom !== false ? /*#__PURE__*/React.createElement(\"span\", {\n          className: classNames(\"\".concat(prefixCls, \"-switcher\"), \"\".concat(prefixCls, \"-switcher-noop\"))\n        }, _switcherIconDom) : null;\n      }\n      var switcherCls = classNames(\"\".concat(prefixCls, \"-switcher\"), \"\".concat(prefixCls, \"-switcher_\").concat(expanded ? ICON_OPEN : ICON_CLOSE));\n      var switcherIconDom = _this.renderSwitcherIconDom(false);\n      return switcherIconDom !== false ? /*#__PURE__*/React.createElement(\"span\", {\n        onClick: _this.onExpand,\n        className: switcherCls\n      }, switcherIconDom) : null;\n    });\n    // ====================== Render: Checkbox ======================\n    // Checkbox\n    _defineProperty(_assertThisInitialized(_this), \"renderCheckbox\", function () {\n      var _this$props5 = _this.props,\n        checked = _this$props5.checked,\n        halfChecked = _this$props5.halfChecked,\n        disableCheckbox = _this$props5.disableCheckbox;\n      var prefixCls = _this.props.context.prefixCls;\n      var disabled = _this.isDisabled();\n      var checkable = _this.isCheckable();\n      if (!checkable) return null;\n\n      // [Legacy] Custom element should be separate with `checkable` in future\n      var $custom = typeof checkable !== 'boolean' ? checkable : null;\n      return /*#__PURE__*/React.createElement(\"span\", {\n        className: classNames(\"\".concat(prefixCls, \"-checkbox\"), checked && \"\".concat(prefixCls, \"-checkbox-checked\"), !checked && halfChecked && \"\".concat(prefixCls, \"-checkbox-indeterminate\"), (disabled || disableCheckbox) && \"\".concat(prefixCls, \"-checkbox-disabled\")),\n        onClick: _this.onCheck\n      }, $custom);\n    });\n    // ==================== Render: Title + Icon ====================\n    _defineProperty(_assertThisInitialized(_this), \"renderIcon\", function () {\n      var loading = _this.props.loading;\n      var prefixCls = _this.props.context.prefixCls;\n      return /*#__PURE__*/React.createElement(\"span\", {\n        className: classNames(\"\".concat(prefixCls, \"-iconEle\"), \"\".concat(prefixCls, \"-icon__\").concat(_this.getNodeState() || 'docu'), loading && \"\".concat(prefixCls, \"-icon_loading\"))\n      });\n    });\n    // Icon + Title\n    _defineProperty(_assertThisInitialized(_this), \"renderSelector\", function () {\n      var dragNodeHighlight = _this.state.dragNodeHighlight;\n      var _this$props6 = _this.props,\n        _this$props6$title = _this$props6.title,\n        title = _this$props6$title === void 0 ? defaultTitle : _this$props6$title,\n        selected = _this$props6.selected,\n        icon = _this$props6.icon,\n        loading = _this$props6.loading,\n        data = _this$props6.data;\n      var _this$props$context3 = _this.props.context,\n        prefixCls = _this$props$context3.prefixCls,\n        showIcon = _this$props$context3.showIcon,\n        treeIcon = _this$props$context3.icon,\n        loadData = _this$props$context3.loadData,\n        titleRender = _this$props$context3.titleRender;\n      var disabled = _this.isDisabled();\n      var wrapClass = \"\".concat(prefixCls, \"-node-content-wrapper\");\n\n      // Icon - Still show loading icon when loading without showIcon\n      var $icon;\n      if (showIcon) {\n        var currentIcon = icon || treeIcon;\n        $icon = currentIcon ? /*#__PURE__*/React.createElement(\"span\", {\n          className: classNames(\"\".concat(prefixCls, \"-iconEle\"), \"\".concat(prefixCls, \"-icon__customize\"))\n        }, typeof currentIcon === 'function' ? currentIcon(_this.props) : currentIcon) : _this.renderIcon();\n      } else if (loadData && loading) {\n        $icon = _this.renderIcon();\n      }\n\n      // Title\n      var titleNode;\n      if (typeof title === 'function') {\n        titleNode = title(data);\n      } else if (titleRender) {\n        titleNode = titleRender(data);\n      } else {\n        titleNode = title;\n      }\n      var $title = /*#__PURE__*/React.createElement(\"span\", {\n        className: \"\".concat(prefixCls, \"-title\")\n      }, titleNode);\n      return /*#__PURE__*/React.createElement(\"span\", {\n        ref: _this.setSelectHandle,\n        title: typeof title === 'string' ? title : '',\n        className: classNames(\"\".concat(wrapClass), \"\".concat(wrapClass, \"-\").concat(_this.getNodeState() || 'normal'), !disabled && (selected || dragNodeHighlight) && \"\".concat(prefixCls, \"-node-selected\")),\n        onMouseEnter: _this.onMouseEnter,\n        onMouseLeave: _this.onMouseLeave,\n        onContextMenu: _this.onContextMenu,\n        onClick: _this.onSelectorClick,\n        onDoubleClick: _this.onSelectorDoubleClick\n      }, $icon, $title, _this.renderDropIndicator());\n    });\n    // =================== Render: Drop Indicator ===================\n    _defineProperty(_assertThisInitialized(_this), \"renderDropIndicator\", function () {\n      var _this$props7 = _this.props,\n        disabled = _this$props7.disabled,\n        eventKey = _this$props7.eventKey;\n      var _this$props$context4 = _this.props.context,\n        draggable = _this$props$context4.draggable,\n        dropLevelOffset = _this$props$context4.dropLevelOffset,\n        dropPosition = _this$props$context4.dropPosition,\n        prefixCls = _this$props$context4.prefixCls,\n        indent = _this$props$context4.indent,\n        dropIndicatorRender = _this$props$context4.dropIndicatorRender,\n        dragOverNodeKey = _this$props$context4.dragOverNodeKey,\n        direction = _this$props$context4.direction;\n      var rootDraggable = !!draggable;\n      // allowDrop is calculated in Tree.tsx, there is no need for calc it here\n      var showIndicator = !disabled && rootDraggable && dragOverNodeKey === eventKey;\n\n      // This is a hot fix which is already fixed in\n      // https://github.com/react-component/tree/pull/743/files\n      // But some case need break point so we hack on this\n      // ref https://github.com/ant-design/ant-design/issues/43493\n      var mergedIndent = indent !== null && indent !== void 0 ? indent : _this.cacheIndent;\n      _this.cacheIndent = indent;\n      return showIndicator ? dropIndicatorRender({\n        dropPosition: dropPosition,\n        dropLevelOffset: dropLevelOffset,\n        indent: mergedIndent,\n        prefixCls: prefixCls,\n        direction: direction\n      }) : null;\n    });\n    return _this;\n  }\n  _createClass(InternalTreeNode, [{\n    key: \"componentDidMount\",\n    value:\n    // Isomorphic needn't load data in server side\n    function componentDidMount() {\n      this.syncLoadData(this.props);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.syncLoadData(this.props);\n    }\n  }, {\n    key: \"isSelectable\",\n    value: function isSelectable() {\n      var selectable = this.props.selectable;\n      var treeSelectable = this.props.context.selectable;\n\n      // Ignore when selectable is undefined or null\n      if (typeof selectable === 'boolean') {\n        return selectable;\n      }\n      return treeSelectable;\n    }\n  }, {\n    key: \"render\",\n    value:\n    // =========================== Render ===========================\n    function render() {\n      var _classNames;\n      var _this$props8 = this.props,\n        eventKey = _this$props8.eventKey,\n        className = _this$props8.className,\n        style = _this$props8.style,\n        dragOver = _this$props8.dragOver,\n        dragOverGapTop = _this$props8.dragOverGapTop,\n        dragOverGapBottom = _this$props8.dragOverGapBottom,\n        isLeaf = _this$props8.isLeaf,\n        isStart = _this$props8.isStart,\n        isEnd = _this$props8.isEnd,\n        expanded = _this$props8.expanded,\n        selected = _this$props8.selected,\n        checked = _this$props8.checked,\n        halfChecked = _this$props8.halfChecked,\n        loading = _this$props8.loading,\n        domRef = _this$props8.domRef,\n        active = _this$props8.active,\n        data = _this$props8.data,\n        onMouseMove = _this$props8.onMouseMove,\n        selectable = _this$props8.selectable,\n        otherProps = _objectWithoutProperties(_this$props8, _excluded);\n      var _this$props$context5 = this.props.context,\n        prefixCls = _this$props$context5.prefixCls,\n        filterTreeNode = _this$props$context5.filterTreeNode,\n        keyEntities = _this$props$context5.keyEntities,\n        dropContainerKey = _this$props$context5.dropContainerKey,\n        dropTargetKey = _this$props$context5.dropTargetKey,\n        draggingNodeKey = _this$props$context5.draggingNodeKey;\n      var disabled = this.isDisabled();\n      var dataOrAriaAttributeProps = pickAttrs(otherProps, {\n        aria: true,\n        data: true\n      });\n      var _ref2 = getEntity(keyEntities, eventKey) || {},\n        level = _ref2.level;\n      var isEndNode = isEnd[isEnd.length - 1];\n      var mergedDraggable = this.isDraggable();\n      var draggableWithoutDisabled = !disabled && mergedDraggable;\n      var dragging = draggingNodeKey === eventKey;\n      var ariaSelected = selectable !== undefined ? {\n        'aria-selected': !!selectable\n      } : undefined;\n      return /*#__PURE__*/React.createElement(\"div\", _extends({\n        ref: domRef,\n        className: classNames(className, \"\".concat(prefixCls, \"-treenode\"), (_classNames = {}, _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_classNames, \"\".concat(prefixCls, \"-treenode-disabled\"), disabled), \"\".concat(prefixCls, \"-treenode-switcher-\").concat(expanded ? 'open' : 'close'), !isLeaf), \"\".concat(prefixCls, \"-treenode-checkbox-checked\"), checked), \"\".concat(prefixCls, \"-treenode-checkbox-indeterminate\"), halfChecked), \"\".concat(prefixCls, \"-treenode-selected\"), selected), \"\".concat(prefixCls, \"-treenode-loading\"), loading), \"\".concat(prefixCls, \"-treenode-active\"), active), \"\".concat(prefixCls, \"-treenode-leaf-last\"), isEndNode), \"\".concat(prefixCls, \"-treenode-draggable\"), mergedDraggable), \"dragging\", dragging), _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_classNames, 'drop-target', dropTargetKey === eventKey), 'drop-container', dropContainerKey === eventKey), 'drag-over', !disabled && dragOver), 'drag-over-gap-top', !disabled && dragOverGapTop), 'drag-over-gap-bottom', !disabled && dragOverGapBottom), 'filter-node', filterTreeNode && filterTreeNode(convertNodePropsToEventData(this.props))))),\n        style: style\n        // Draggable config\n        ,\n        draggable: draggableWithoutDisabled,\n        \"aria-grabbed\": dragging,\n        onDragStart: draggableWithoutDisabled ? this.onDragStart : undefined\n        // Drop config\n        ,\n        onDragEnter: mergedDraggable ? this.onDragEnter : undefined,\n        onDragOver: mergedDraggable ? this.onDragOver : undefined,\n        onDragLeave: mergedDraggable ? this.onDragLeave : undefined,\n        onDrop: mergedDraggable ? this.onDrop : undefined,\n        onDragEnd: mergedDraggable ? this.onDragEnd : undefined,\n        onMouseMove: onMouseMove\n      }, ariaSelected, dataOrAriaAttributeProps), /*#__PURE__*/React.createElement(Indent, {\n        prefixCls: prefixCls,\n        level: level,\n        isStart: isStart,\n        isEnd: isEnd\n      }), this.renderDragHandler(), this.renderSwitcher(), this.renderCheckbox(), this.renderSelector());\n    }\n  }]);\n  return InternalTreeNode;\n}(React.Component);\nvar ContextTreeNode = function ContextTreeNode(props) {\n  return /*#__PURE__*/React.createElement(TreeContext.Consumer, null, function (context) {\n    return /*#__PURE__*/React.createElement(InternalTreeNode, _extends({}, props, {\n      context: context\n    }));\n  });\n};\nContextTreeNode.displayName = 'TreeNode';\nContextTreeNode.isTreeNode = 1;\nexport default ContextTreeNode;","import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport * as React from 'react';\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\n\n/**\n * Trigger only when component unmount\n */\nexport default function useUnmount(triggerStart, triggerEnd) {\n  var _React$useState = React.useState(false),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    firstMount = _React$useState2[0],\n    setFirstMount = _React$useState2[1];\n  useLayoutEffect(function () {\n    if (firstMount) {\n      triggerStart();\n      return function () {\n        triggerEnd();\n      };\n    }\n  }, [firstMount]);\n  useLayoutEffect(function () {\n    setFirstMount(true);\n    return function () {\n      setFirstMount(false);\n    };\n  }, []);\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectDestructuringEmpty from \"@babel/runtime/helpers/esm/objectDestructuringEmpty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"className\", \"style\", \"motion\", \"motionNodes\", \"motionType\", \"onMotionStart\", \"onMotionEnd\", \"active\", \"treeNodeRequiredProps\"];\nimport classNames from 'classnames';\nimport CSSMotion from 'rc-motion';\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport * as React from 'react';\nimport { TreeContext } from \"./contextTypes\";\nimport TreeNode from \"./TreeNode\";\nimport useUnmount from \"./useUnmount\";\nimport { getTreeNodeProps } from \"./utils/treeUtil\";\nvar MotionTreeNode = function MotionTreeNode(_ref, ref) {\n  var className = _ref.className,\n    style = _ref.style,\n    motion = _ref.motion,\n    motionNodes = _ref.motionNodes,\n    motionType = _ref.motionType,\n    onOriginMotionStart = _ref.onMotionStart,\n    onOriginMotionEnd = _ref.onMotionEnd,\n    active = _ref.active,\n    treeNodeRequiredProps = _ref.treeNodeRequiredProps,\n    props = _objectWithoutProperties(_ref, _excluded);\n  var _React$useState = React.useState(true),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    visible = _React$useState2[0],\n    setVisible = _React$useState2[1];\n  var _React$useContext = React.useContext(TreeContext),\n    prefixCls = _React$useContext.prefixCls;\n\n  // Calculate target visible here.\n  // And apply in effect to make `leave` motion work.\n  var targetVisible = motionNodes && motionType !== 'hide';\n  useLayoutEffect(function () {\n    if (motionNodes) {\n      if (targetVisible !== visible) {\n        setVisible(targetVisible);\n      }\n    }\n  }, [motionNodes]);\n  var triggerMotionStart = function triggerMotionStart() {\n    if (motionNodes) {\n      onOriginMotionStart();\n    }\n  };\n\n  // Should only trigger once\n  var triggerMotionEndRef = React.useRef(false);\n  var triggerMotionEnd = function triggerMotionEnd() {\n    if (motionNodes && !triggerMotionEndRef.current) {\n      triggerMotionEndRef.current = true;\n      onOriginMotionEnd();\n    }\n  };\n\n  // Effect if unmount\n  useUnmount(triggerMotionStart, triggerMotionEnd);\n\n  // Motion end event\n  var onVisibleChanged = function onVisibleChanged(nextVisible) {\n    if (targetVisible === nextVisible) {\n      triggerMotionEnd();\n    }\n  };\n  if (motionNodes) {\n    return /*#__PURE__*/React.createElement(CSSMotion, _extends({\n      ref: ref,\n      visible: visible\n    }, motion, {\n      motionAppear: motionType === 'show',\n      onVisibleChanged: onVisibleChanged\n    }), function (_ref2, motionRef) {\n      var motionClassName = _ref2.className,\n        motionStyle = _ref2.style;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        ref: motionRef,\n        className: classNames(\"\".concat(prefixCls, \"-treenode-motion\"), motionClassName),\n        style: motionStyle\n      }, motionNodes.map(function (treeNode) {\n        var restProps = Object.assign({}, (_objectDestructuringEmpty(treeNode.data), treeNode.data)),\n          title = treeNode.title,\n          key = treeNode.key,\n          isStart = treeNode.isStart,\n          isEnd = treeNode.isEnd;\n        delete restProps.children;\n        var treeNodeProps = getTreeNodeProps(key, treeNodeRequiredProps);\n        return /*#__PURE__*/React.createElement(TreeNode, _extends({}, restProps, treeNodeProps, {\n          title: title,\n          active: active,\n          data: treeNode.data,\n          key: key,\n          isStart: isStart,\n          isEnd: isEnd\n        }));\n      }));\n    });\n  }\n  return /*#__PURE__*/React.createElement(TreeNode, _extends({\n    domRef: ref,\n    className: className,\n    style: style\n  }, props, {\n    active: active\n  }));\n};\nMotionTreeNode.displayName = 'MotionTreeNode';\nvar RefMotionTreeNode = /*#__PURE__*/React.forwardRef(MotionTreeNode);\nexport default RefMotionTreeNode;","export function findExpandedKeys() {\n  var prev = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var next = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var prevLen = prev.length;\n  var nextLen = next.length;\n  if (Math.abs(prevLen - nextLen) !== 1) {\n    return {\n      add: false,\n      key: null\n    };\n  }\n  function find(shorter, longer) {\n    var cache = new Map();\n    shorter.forEach(function (key) {\n      cache.set(key, true);\n    });\n    var keys = longer.filter(function (key) {\n      return !cache.has(key);\n    });\n    return keys.length === 1 ? keys[0] : null;\n  }\n  if (prevLen < nextLen) {\n    return {\n      add: true,\n      key: find(prev, next)\n    };\n  }\n  return {\n    add: false,\n    key: find(next, prev)\n  };\n}\nexport function getExpandRange(shorter, longer, key) {\n  var shorterStartIndex = shorter.findIndex(function (data) {\n    return data.key === key;\n  });\n  var shorterEndNode = shorter[shorterStartIndex + 1];\n  var longerStartIndex = longer.findIndex(function (data) {\n    return data.key === key;\n  });\n  if (shorterEndNode) {\n    var longerEndIndex = longer.findIndex(function (data) {\n      return data.key === shorterEndNode.key;\n    });\n    return longer.slice(longerStartIndex + 1, longerEndIndex);\n  }\n  return longer.slice(longerStartIndex + 1);\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectDestructuringEmpty from \"@babel/runtime/helpers/esm/objectDestructuringEmpty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"prefixCls\", \"data\", \"selectable\", \"checkable\", \"expandedKeys\", \"selectedKeys\", \"checkedKeys\", \"loadedKeys\", \"loadingKeys\", \"halfCheckedKeys\", \"keyEntities\", \"disabled\", \"dragging\", \"dragOverNodeKey\", \"dropPosition\", \"motion\", \"height\", \"itemHeight\", \"virtual\", \"focusable\", \"activeItem\", \"focused\", \"tabIndex\", \"onKeyDown\", \"onFocus\", \"onBlur\", \"onActiveChange\", \"onListChangeStart\", \"onListChangeEnd\"];\n/**\n * Handle virtual list of the TreeNodes.\n */\n\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport VirtualList from 'rc-virtual-list';\nimport * as React from 'react';\nimport MotionTreeNode from \"./MotionTreeNode\";\nimport { findExpandedKeys, getExpandRange } from \"./utils/diffUtil\";\nimport { getKey, getTreeNodeProps } from \"./utils/treeUtil\";\nvar HIDDEN_STYLE = {\n  width: 0,\n  height: 0,\n  display: 'flex',\n  overflow: 'hidden',\n  opacity: 0,\n  border: 0,\n  padding: 0,\n  margin: 0\n};\nvar noop = function noop() {};\nexport var MOTION_KEY = \"RC_TREE_MOTION_\".concat(Math.random());\nvar MotionNode = {\n  key: MOTION_KEY\n};\nexport var MotionEntity = {\n  key: MOTION_KEY,\n  level: 0,\n  index: 0,\n  pos: '0',\n  node: MotionNode,\n  nodes: [MotionNode]\n};\nvar MotionFlattenData = {\n  parent: null,\n  children: [],\n  pos: MotionEntity.pos,\n  data: MotionNode,\n  title: null,\n  key: MOTION_KEY,\n  /** Hold empty list here since we do not use it */\n  isStart: [],\n  isEnd: []\n};\n/**\n * We only need get visible content items to play the animation.\n */\nexport function getMinimumRangeTransitionRange(list, virtual, height, itemHeight) {\n  if (virtual === false || !height) {\n    return list;\n  }\n  return list.slice(0, Math.ceil(height / itemHeight) + 1);\n}\nfunction itemKey(item) {\n  var key = item.key,\n    pos = item.pos;\n  return getKey(key, pos);\n}\nfunction getAccessibilityPath(item) {\n  var path = String(item.data.key);\n  var current = item;\n  while (current.parent) {\n    current = current.parent;\n    path = \"\".concat(current.data.key, \" > \").concat(path);\n  }\n  return path;\n}\nvar NodeList = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var prefixCls = props.prefixCls,\n    data = props.data,\n    selectable = props.selectable,\n    checkable = props.checkable,\n    expandedKeys = props.expandedKeys,\n    selectedKeys = props.selectedKeys,\n    checkedKeys = props.checkedKeys,\n    loadedKeys = props.loadedKeys,\n    loadingKeys = props.loadingKeys,\n    halfCheckedKeys = props.halfCheckedKeys,\n    keyEntities = props.keyEntities,\n    disabled = props.disabled,\n    dragging = props.dragging,\n    dragOverNodeKey = props.dragOverNodeKey,\n    dropPosition = props.dropPosition,\n    motion = props.motion,\n    height = props.height,\n    itemHeight = props.itemHeight,\n    virtual = props.virtual,\n    focusable = props.focusable,\n    activeItem = props.activeItem,\n    focused = props.focused,\n    tabIndex = props.tabIndex,\n    onKeyDown = props.onKeyDown,\n    onFocus = props.onFocus,\n    onBlur = props.onBlur,\n    onActiveChange = props.onActiveChange,\n    onListChangeStart = props.onListChangeStart,\n    onListChangeEnd = props.onListChangeEnd,\n    domProps = _objectWithoutProperties(props, _excluded);\n\n  // =============================== Ref ================================\n  var listRef = React.useRef(null);\n  var indentMeasurerRef = React.useRef(null);\n  React.useImperativeHandle(ref, function () {\n    return {\n      scrollTo: function scrollTo(scroll) {\n        listRef.current.scrollTo(scroll);\n      },\n      getIndentWidth: function getIndentWidth() {\n        return indentMeasurerRef.current.offsetWidth;\n      }\n    };\n  });\n\n  // ============================== Motion ==============================\n  var _React$useState = React.useState(expandedKeys),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    prevExpandedKeys = _React$useState2[0],\n    setPrevExpandedKeys = _React$useState2[1];\n  var _React$useState3 = React.useState(data),\n    _React$useState4 = _slicedToArray(_React$useState3, 2),\n    prevData = _React$useState4[0],\n    setPrevData = _React$useState4[1];\n  var _React$useState5 = React.useState(data),\n    _React$useState6 = _slicedToArray(_React$useState5, 2),\n    transitionData = _React$useState6[0],\n    setTransitionData = _React$useState6[1];\n  var _React$useState7 = React.useState([]),\n    _React$useState8 = _slicedToArray(_React$useState7, 2),\n    transitionRange = _React$useState8[0],\n    setTransitionRange = _React$useState8[1];\n  var _React$useState9 = React.useState(null),\n    _React$useState10 = _slicedToArray(_React$useState9, 2),\n    motionType = _React$useState10[0],\n    setMotionType = _React$useState10[1];\n\n  // When motion end but data change, this will makes data back to previous one\n  var dataRef = React.useRef(data);\n  dataRef.current = data;\n  function onMotionEnd() {\n    var latestData = dataRef.current;\n    setPrevData(latestData);\n    setTransitionData(latestData);\n    setTransitionRange([]);\n    setMotionType(null);\n    onListChangeEnd();\n  }\n\n  // Do animation if expanded keys changed\n  // layoutEffect here to avoid blink of node removing\n  useLayoutEffect(function () {\n    setPrevExpandedKeys(expandedKeys);\n    var diffExpanded = findExpandedKeys(prevExpandedKeys, expandedKeys);\n    if (diffExpanded.key !== null) {\n      if (diffExpanded.add) {\n        var keyIndex = prevData.findIndex(function (_ref) {\n          var key = _ref.key;\n          return key === diffExpanded.key;\n        });\n        var rangeNodes = getMinimumRangeTransitionRange(getExpandRange(prevData, data, diffExpanded.key), virtual, height, itemHeight);\n        var newTransitionData = prevData.slice();\n        newTransitionData.splice(keyIndex + 1, 0, MotionFlattenData);\n        setTransitionData(newTransitionData);\n        setTransitionRange(rangeNodes);\n        setMotionType('show');\n      } else {\n        var _keyIndex = data.findIndex(function (_ref2) {\n          var key = _ref2.key;\n          return key === diffExpanded.key;\n        });\n        var _rangeNodes = getMinimumRangeTransitionRange(getExpandRange(data, prevData, diffExpanded.key), virtual, height, itemHeight);\n        var _newTransitionData = data.slice();\n        _newTransitionData.splice(_keyIndex + 1, 0, MotionFlattenData);\n        setTransitionData(_newTransitionData);\n        setTransitionRange(_rangeNodes);\n        setMotionType('hide');\n      }\n    } else if (prevData !== data) {\n      // If whole data changed, we just refresh the list\n      setPrevData(data);\n      setTransitionData(data);\n    }\n  }, [expandedKeys, data]);\n\n  // We should clean up motion if is changed by dragging\n  React.useEffect(function () {\n    if (!dragging) {\n      onMotionEnd();\n    }\n  }, [dragging]);\n  var mergedData = motion ? transitionData : data;\n  var treeNodeRequiredProps = {\n    expandedKeys: expandedKeys,\n    selectedKeys: selectedKeys,\n    loadedKeys: loadedKeys,\n    loadingKeys: loadingKeys,\n    checkedKeys: checkedKeys,\n    halfCheckedKeys: halfCheckedKeys,\n    dragOverNodeKey: dragOverNodeKey,\n    dropPosition: dropPosition,\n    keyEntities: keyEntities\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, focused && activeItem && /*#__PURE__*/React.createElement(\"span\", {\n    style: HIDDEN_STYLE,\n    \"aria-live\": \"assertive\"\n  }, getAccessibilityPath(activeItem)), /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"input\", {\n    style: HIDDEN_STYLE,\n    disabled: focusable === false || disabled,\n    tabIndex: focusable !== false ? tabIndex : null,\n    onKeyDown: onKeyDown,\n    onFocus: onFocus,\n    onBlur: onBlur,\n    value: \"\",\n    onChange: noop,\n    \"aria-label\": \"for screen reader\"\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-treenode\"),\n    \"aria-hidden\": true,\n    style: {\n      position: 'absolute',\n      pointerEvents: 'none',\n      visibility: 'hidden',\n      height: 0,\n      overflow: 'hidden',\n      border: 0,\n      padding: 0\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-indent\")\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    ref: indentMeasurerRef,\n    className: \"\".concat(prefixCls, \"-indent-unit\")\n  }))), /*#__PURE__*/React.createElement(VirtualList, _extends({}, domProps, {\n    data: mergedData,\n    itemKey: itemKey,\n    height: height,\n    fullHeight: false,\n    virtual: virtual,\n    itemHeight: itemHeight,\n    prefixCls: \"\".concat(prefixCls, \"-list\"),\n    ref: listRef,\n    onVisibleChange: function onVisibleChange(originList, fullList) {\n      var originSet = new Set(originList);\n      var restList = fullList.filter(function (item) {\n        return !originSet.has(item);\n      });\n\n      // Motion node is not render. Skip motion\n      if (restList.some(function (item) {\n        return itemKey(item) === MOTION_KEY;\n      })) {\n        onMotionEnd();\n      }\n    }\n  }), function (treeNode) {\n    var pos = treeNode.pos,\n      restProps = Object.assign({}, (_objectDestructuringEmpty(treeNode.data), treeNode.data)),\n      title = treeNode.title,\n      key = treeNode.key,\n      isStart = treeNode.isStart,\n      isEnd = treeNode.isEnd;\n    var mergedKey = getKey(key, pos);\n    delete restProps.key;\n    delete restProps.children;\n    var treeNodeProps = getTreeNodeProps(mergedKey, treeNodeRequiredProps);\n    return /*#__PURE__*/React.createElement(MotionTreeNode, _extends({}, restProps, treeNodeProps, {\n      title: title,\n      active: !!activeItem && key === activeItem.key,\n      pos: pos,\n      data: treeNode.data,\n      isStart: isStart,\n      isEnd: isEnd,\n      motion: motion,\n      motionNodes: key === MOTION_KEY ? transitionRange : null,\n      motionType: motionType,\n      onMotionStart: onListChangeStart,\n      onMotionEnd: onMotionEnd,\n      treeNodeRequiredProps: treeNodeRequiredProps,\n      onMouseMove: function onMouseMove() {\n        onActiveChange(null);\n      }\n    }));\n  }));\n});\nNodeList.displayName = 'NodeList';\nexport default NodeList;","import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"children\"];\n/* eslint-disable no-lonely-if */\n/**\n * Legacy code. Should avoid to use if you are new to import these code.\n */\n\nimport warning from \"rc-util/es/warning\";\nimport React from 'react';\nimport TreeNode from \"./TreeNode\";\nimport getEntity from \"./utils/keyUtil\";\nexport { getPosition, isTreeNode } from \"./utils/treeUtil\";\nexport function arrDel(list, value) {\n  if (!list) return [];\n  var clone = list.slice();\n  var index = clone.indexOf(value);\n  if (index >= 0) {\n    clone.splice(index, 1);\n  }\n  return clone;\n}\nexport function arrAdd(list, value) {\n  var clone = (list || []).slice();\n  if (clone.indexOf(value) === -1) {\n    clone.push(value);\n  }\n  return clone;\n}\nexport function posToArr(pos) {\n  return pos.split('-');\n}\nexport function getDragChildrenKeys(dragNodeKey, keyEntities) {\n  // not contains self\n  // self for left or right drag\n  var dragChildrenKeys = [];\n  var entity = getEntity(keyEntities, dragNodeKey);\n  function dig() {\n    var list = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    list.forEach(function (_ref) {\n      var key = _ref.key,\n        children = _ref.children;\n      dragChildrenKeys.push(key);\n      dig(children);\n    });\n  }\n  dig(entity.children);\n  return dragChildrenKeys;\n}\nexport function isLastChild(treeNodeEntity) {\n  if (treeNodeEntity.parent) {\n    var posArr = posToArr(treeNodeEntity.pos);\n    return Number(posArr[posArr.length - 1]) === treeNodeEntity.parent.children.length - 1;\n  }\n  return false;\n}\nexport function isFirstChild(treeNodeEntity) {\n  var posArr = posToArr(treeNodeEntity.pos);\n  return Number(posArr[posArr.length - 1]) === 0;\n}\n\n// Only used when drag, not affect SSR.\nexport function calcDropPosition(event, dragNode, targetNode, indent, startMousePosition, allowDrop, flattenedNodes, keyEntities, expandKeys, direction) {\n  var _abstractDropNodeEnti;\n  var clientX = event.clientX,\n    clientY = event.clientY;\n  var _getBoundingClientRec = event.target.getBoundingClientRect(),\n    top = _getBoundingClientRec.top,\n    height = _getBoundingClientRec.height;\n  // optional chain for testing\n  var horizontalMouseOffset = (direction === 'rtl' ? -1 : 1) * (((startMousePosition === null || startMousePosition === void 0 ? void 0 : startMousePosition.x) || 0) - clientX);\n  var rawDropLevelOffset = (horizontalMouseOffset - 12) / indent;\n\n  // Filter the expanded keys to exclude the node that not has children currently (like async nodes).\n  var filteredExpandKeys = expandKeys.filter(function (key) {\n    var _keyEntities$key;\n    return (_keyEntities$key = keyEntities[key]) === null || _keyEntities$key === void 0 || (_keyEntities$key = _keyEntities$key.children) === null || _keyEntities$key === void 0 ? void 0 : _keyEntities$key.length;\n  });\n\n  // find abstract drop node by horizontal offset\n  var abstractDropNodeEntity = getEntity(keyEntities, targetNode.props.eventKey);\n  if (clientY < top + height / 2) {\n    // first half, set abstract drop node to previous node\n    var nodeIndex = flattenedNodes.findIndex(function (flattenedNode) {\n      return flattenedNode.key === abstractDropNodeEntity.key;\n    });\n    var prevNodeIndex = nodeIndex <= 0 ? 0 : nodeIndex - 1;\n    var prevNodeKey = flattenedNodes[prevNodeIndex].key;\n    abstractDropNodeEntity = getEntity(keyEntities, prevNodeKey);\n  }\n  var initialAbstractDropNodeKey = abstractDropNodeEntity.key;\n  var abstractDragOverEntity = abstractDropNodeEntity;\n  var dragOverNodeKey = abstractDropNodeEntity.key;\n  var dropPosition = 0;\n  var dropLevelOffset = 0;\n\n  // Only allow cross level drop when dragging on a non-expanded node\n  if (!filteredExpandKeys.includes(initialAbstractDropNodeKey)) {\n    for (var i = 0; i < rawDropLevelOffset; i += 1) {\n      if (isLastChild(abstractDropNodeEntity)) {\n        abstractDropNodeEntity = abstractDropNodeEntity.parent;\n        dropLevelOffset += 1;\n      } else {\n        break;\n      }\n    }\n  }\n  var abstractDragDataNode = dragNode.props.data;\n  var abstractDropDataNode = abstractDropNodeEntity.node;\n  var dropAllowed = true;\n  if (isFirstChild(abstractDropNodeEntity) && abstractDropNodeEntity.level === 0 && clientY < top + height / 2 && allowDrop({\n    dragNode: abstractDragDataNode,\n    dropNode: abstractDropDataNode,\n    dropPosition: -1\n  }) && abstractDropNodeEntity.key === targetNode.props.eventKey) {\n    // first half of first node in first level\n    dropPosition = -1;\n  } else if ((abstractDragOverEntity.children || []).length && filteredExpandKeys.includes(dragOverNodeKey)) {\n    // drop on expanded node\n    // only allow drop inside\n    if (allowDrop({\n      dragNode: abstractDragDataNode,\n      dropNode: abstractDropDataNode,\n      dropPosition: 0\n    })) {\n      dropPosition = 0;\n    } else {\n      dropAllowed = false;\n    }\n  } else if (dropLevelOffset === 0) {\n    if (rawDropLevelOffset > -1.5) {\n      // | Node     | <- abstractDropNode\n      // | -^-===== | <- mousePosition\n      // 1. try drop after\n      // 2. do not allow drop\n      if (allowDrop({\n        dragNode: abstractDragDataNode,\n        dropNode: abstractDropDataNode,\n        dropPosition: 1\n      })) {\n        dropPosition = 1;\n      } else {\n        dropAllowed = false;\n      }\n    } else {\n      // | Node     | <- abstractDropNode\n      // | ---==^== | <- mousePosition\n      // whether it has children or doesn't has children\n      // always\n      // 1. try drop inside\n      // 2. try drop after\n      // 3. do not allow drop\n      if (allowDrop({\n        dragNode: abstractDragDataNode,\n        dropNode: abstractDropDataNode,\n        dropPosition: 0\n      })) {\n        dropPosition = 0;\n      } else if (allowDrop({\n        dragNode: abstractDragDataNode,\n        dropNode: abstractDropDataNode,\n        dropPosition: 1\n      })) {\n        dropPosition = 1;\n      } else {\n        dropAllowed = false;\n      }\n    }\n  } else {\n    // | Node1 | <- abstractDropNode\n    //      |  Node2  |\n    // --^--|----=====| <- mousePosition\n    // 1. try insert after Node1\n    // 2. do not allow drop\n    if (allowDrop({\n      dragNode: abstractDragDataNode,\n      dropNode: abstractDropDataNode,\n      dropPosition: 1\n    })) {\n      dropPosition = 1;\n    } else {\n      dropAllowed = false;\n    }\n  }\n  return {\n    dropPosition: dropPosition,\n    dropLevelOffset: dropLevelOffset,\n    dropTargetKey: abstractDropNodeEntity.key,\n    dropTargetPos: abstractDropNodeEntity.pos,\n    dragOverNodeKey: dragOverNodeKey,\n    dropContainerKey: dropPosition === 0 ? null : ((_abstractDropNodeEnti = abstractDropNodeEntity.parent) === null || _abstractDropNodeEnti === void 0 ? void 0 : _abstractDropNodeEnti.key) || null,\n    dropAllowed: dropAllowed\n  };\n}\n\n/**\n * Return selectedKeys according with multiple prop\n * @param selectedKeys\n * @param props\n * @returns [string]\n */\nexport function calcSelectedKeys(selectedKeys, props) {\n  if (!selectedKeys) return undefined;\n  var multiple = props.multiple;\n  if (multiple) {\n    return selectedKeys.slice();\n  }\n  if (selectedKeys.length) {\n    return [selectedKeys[0]];\n  }\n  return selectedKeys;\n}\nvar internalProcessProps = function internalProcessProps(props) {\n  return props;\n};\nexport function convertDataToTree(treeData, processor) {\n  if (!treeData) return [];\n  var _ref2 = processor || {},\n    _ref2$processProps = _ref2.processProps,\n    processProps = _ref2$processProps === void 0 ? internalProcessProps : _ref2$processProps;\n  var list = Array.isArray(treeData) ? treeData : [treeData];\n  return list.map(function (_ref3) {\n    var children = _ref3.children,\n      props = _objectWithoutProperties(_ref3, _excluded);\n    var childrenNodes = convertDataToTree(children, processor);\n    return /*#__PURE__*/React.createElement(TreeNode, _extends({\n      key: props.key\n    }, processProps(props)), childrenNodes);\n  });\n}\n\n/**\n * Parse `checkedKeys` to { checkedKeys, halfCheckedKeys } style\n */\nexport function parseCheckedKeys(keys) {\n  if (!keys) {\n    return null;\n  }\n\n  // Convert keys to object format\n  var keyProps;\n  if (Array.isArray(keys)) {\n    // [Legacy] Follow the api doc\n    keyProps = {\n      checkedKeys: keys,\n      halfCheckedKeys: undefined\n    };\n  } else if (_typeof(keys) === 'object') {\n    keyProps = {\n      checkedKeys: keys.checked || undefined,\n      halfCheckedKeys: keys.halfChecked || undefined\n    };\n  } else {\n    warning(false, '`checkedKeys` is not an array or an object');\n    return null;\n  }\n  return keyProps;\n}\n\n/**\n * If user use `autoExpandParent` we should get the list of parent node\n * @param keyList\n * @param keyEntities\n */\nexport function conductExpandParent(keyList, keyEntities) {\n  var expandedKeys = new Set();\n  function conductUp(key) {\n    if (expandedKeys.has(key)) return;\n    var entity = getEntity(keyEntities, key);\n    if (!entity) return;\n    expandedKeys.add(key);\n    var parent = entity.parent,\n      node = entity.node;\n    if (node.disabled) return;\n    if (parent) {\n      conductUp(parent.key);\n    }\n  }\n  (keyList || []).forEach(function (key) {\n    conductUp(key);\n  });\n  return _toConsumableArray(expandedKeys);\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"@babel/runtime/helpers/esm/createSuper\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n// TODO: https://www.w3.org/TR/2017/NOTE-wai-aria-practices-1.1-20171214/examples/treeview/treeview-2/treeview-2a.html\n// Fully accessibility support\n\nimport classNames from 'classnames';\nimport KeyCode from \"rc-util/es/KeyCode\";\nimport pickAttrs from \"rc-util/es/pickAttrs\";\nimport warning from \"rc-util/es/warning\";\nimport * as React from 'react';\nimport { TreeContext } from \"./contextTypes\";\nimport DropIndicator from \"./DropIndicator\";\nimport NodeList, { MOTION_KEY, MotionEntity } from \"./NodeList\";\nimport TreeNode from \"./TreeNode\";\nimport { arrAdd, arrDel, calcDropPosition, calcSelectedKeys, conductExpandParent, getDragChildrenKeys, parseCheckedKeys, posToArr } from \"./util\";\nimport { conductCheck } from \"./utils/conductUtil\";\nimport getEntity from \"./utils/keyUtil\";\nimport { convertDataToEntities, convertNodePropsToEventData, convertTreeToData, fillFieldNames, flattenTreeData, getTreeNodeProps, warningWithoutKey } from \"./utils/treeUtil\";\nvar MAX_RETRY_TIMES = 10;\nvar Tree = /*#__PURE__*/function (_React$Component) {\n  _inherits(Tree, _React$Component);\n  var _super = _createSuper(Tree);\n  function Tree() {\n    var _this;\n    _classCallCheck(this, Tree);\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(_args));\n    _defineProperty(_assertThisInitialized(_this), \"destroyed\", false);\n    _defineProperty(_assertThisInitialized(_this), \"delayedDragEnterLogic\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"loadingRetryTimes\", {});\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      keyEntities: {},\n      indent: null,\n      selectedKeys: [],\n      checkedKeys: [],\n      halfCheckedKeys: [],\n      loadedKeys: [],\n      loadingKeys: [],\n      expandedKeys: [],\n      draggingNodeKey: null,\n      dragChildrenKeys: [],\n      // dropTargetKey is the key of abstract-drop-node\n      // the abstract-drop-node is the real drop node when drag and drop\n      // not the DOM drag over node\n      dropTargetKey: null,\n      dropPosition: null,\n      // the drop position of abstract-drop-node, inside 0, top -1, bottom 1\n      dropContainerKey: null,\n      // the container key of abstract-drop-node if dropPosition is -1 or 1\n      dropLevelOffset: null,\n      // the drop level offset of abstract-drag-over-node\n      dropTargetPos: null,\n      // the pos of abstract-drop-node\n      dropAllowed: true,\n      // if drop to abstract-drop-node is allowed\n      // the abstract-drag-over-node\n      // if mouse is on the bottom of top dom node or no the top of the bottom dom node\n      // abstract-drag-over-node is the top node\n      dragOverNodeKey: null,\n      treeData: [],\n      flattenNodes: [],\n      focused: false,\n      activeKey: null,\n      listChanging: false,\n      prevProps: null,\n      fieldNames: fillFieldNames()\n    });\n    _defineProperty(_assertThisInitialized(_this), \"dragStartMousePosition\", null);\n    _defineProperty(_assertThisInitialized(_this), \"dragNode\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"currentMouseOverDroppableNodeKey\", null);\n    _defineProperty(_assertThisInitialized(_this), \"listRef\", /*#__PURE__*/React.createRef());\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragStart\", function (event, node) {\n      var _this$state = _this.state,\n        expandedKeys = _this$state.expandedKeys,\n        keyEntities = _this$state.keyEntities;\n      var onDragStart = _this.props.onDragStart;\n      var eventKey = node.props.eventKey;\n      _this.dragNode = node;\n      _this.dragStartMousePosition = {\n        x: event.clientX,\n        y: event.clientY\n      };\n      var newExpandedKeys = arrDel(expandedKeys, eventKey);\n      _this.setState({\n        draggingNodeKey: eventKey,\n        dragChildrenKeys: getDragChildrenKeys(eventKey, keyEntities),\n        indent: _this.listRef.current.getIndentWidth()\n      });\n      _this.setExpandedKeys(newExpandedKeys);\n      window.addEventListener('dragend', _this.onWindowDragEnd);\n      onDragStart === null || onDragStart === void 0 || onDragStart({\n        event: event,\n        node: convertNodePropsToEventData(node.props)\n      });\n    });\n    /**\n     * [Legacy] Select handler is smaller than node,\n     * so that this will trigger when drag enter node or select handler.\n     * This is a little tricky if customize css without padding.\n     * Better for use mouse move event to refresh drag state.\n     * But let's just keep it to avoid event trigger logic change.\n     */\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragEnter\", function (event, node) {\n      var _this$state2 = _this.state,\n        expandedKeys = _this$state2.expandedKeys,\n        keyEntities = _this$state2.keyEntities,\n        dragChildrenKeys = _this$state2.dragChildrenKeys,\n        flattenNodes = _this$state2.flattenNodes,\n        indent = _this$state2.indent;\n      var _this$props = _this.props,\n        onDragEnter = _this$props.onDragEnter,\n        onExpand = _this$props.onExpand,\n        allowDrop = _this$props.allowDrop,\n        direction = _this$props.direction;\n      var _node$props = node.props,\n        pos = _node$props.pos,\n        eventKey = _node$props.eventKey;\n      var _assertThisInitialize = _assertThisInitialized(_this),\n        dragNode = _assertThisInitialize.dragNode;\n\n      // record the key of node which is latest entered, used in dragleave event.\n      if (_this.currentMouseOverDroppableNodeKey !== eventKey) {\n        _this.currentMouseOverDroppableNodeKey = eventKey;\n      }\n      if (!dragNode) {\n        _this.resetDragState();\n        return;\n      }\n      var _calcDropPosition = calcDropPosition(event, dragNode, node, indent, _this.dragStartMousePosition, allowDrop, flattenNodes, keyEntities, expandedKeys, direction),\n        dropPosition = _calcDropPosition.dropPosition,\n        dropLevelOffset = _calcDropPosition.dropLevelOffset,\n        dropTargetKey = _calcDropPosition.dropTargetKey,\n        dropContainerKey = _calcDropPosition.dropContainerKey,\n        dropTargetPos = _calcDropPosition.dropTargetPos,\n        dropAllowed = _calcDropPosition.dropAllowed,\n        dragOverNodeKey = _calcDropPosition.dragOverNodeKey;\n      if (\n      // don't allow drop inside its children\n      dragChildrenKeys.indexOf(dropTargetKey) !== -1 ||\n      // don't allow drop when drop is not allowed caculated by calcDropPosition\n      !dropAllowed) {\n        _this.resetDragState();\n        return;\n      }\n\n      // Side effect for delay drag\n      if (!_this.delayedDragEnterLogic) {\n        _this.delayedDragEnterLogic = {};\n      }\n      Object.keys(_this.delayedDragEnterLogic).forEach(function (key) {\n        clearTimeout(_this.delayedDragEnterLogic[key]);\n      });\n      if (dragNode.props.eventKey !== node.props.eventKey) {\n        // hoist expand logic here\n        // since if logic is on the bottom\n        // it will be blocked by abstract dragover node check\n        //   => if you dragenter from top, you mouse will still be consider as in the top node\n        event.persist();\n        _this.delayedDragEnterLogic[pos] = window.setTimeout(function () {\n          if (_this.state.draggingNodeKey === null) return;\n          var newExpandedKeys = _toConsumableArray(expandedKeys);\n          var entity = getEntity(keyEntities, node.props.eventKey);\n          if (entity && (entity.children || []).length) {\n            newExpandedKeys = arrAdd(expandedKeys, node.props.eventKey);\n          }\n          if (!('expandedKeys' in _this.props)) {\n            _this.setExpandedKeys(newExpandedKeys);\n          }\n          onExpand === null || onExpand === void 0 || onExpand(newExpandedKeys, {\n            node: convertNodePropsToEventData(node.props),\n            expanded: true,\n            nativeEvent: event.nativeEvent\n          });\n        }, 800);\n      }\n\n      // Skip if drag node is self\n      if (dragNode.props.eventKey === dropTargetKey && dropLevelOffset === 0) {\n        _this.resetDragState();\n        return;\n      }\n\n      // Update drag over node and drag state\n      _this.setState({\n        dragOverNodeKey: dragOverNodeKey,\n        dropPosition: dropPosition,\n        dropLevelOffset: dropLevelOffset,\n        dropTargetKey: dropTargetKey,\n        dropContainerKey: dropContainerKey,\n        dropTargetPos: dropTargetPos,\n        dropAllowed: dropAllowed\n      });\n      onDragEnter === null || onDragEnter === void 0 || onDragEnter({\n        event: event,\n        node: convertNodePropsToEventData(node.props),\n        expandedKeys: expandedKeys\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragOver\", function (event, node) {\n      var _this$state3 = _this.state,\n        dragChildrenKeys = _this$state3.dragChildrenKeys,\n        flattenNodes = _this$state3.flattenNodes,\n        keyEntities = _this$state3.keyEntities,\n        expandedKeys = _this$state3.expandedKeys,\n        indent = _this$state3.indent;\n      var _this$props2 = _this.props,\n        onDragOver = _this$props2.onDragOver,\n        allowDrop = _this$props2.allowDrop,\n        direction = _this$props2.direction;\n      var _assertThisInitialize2 = _assertThisInitialized(_this),\n        dragNode = _assertThisInitialize2.dragNode;\n      if (!dragNode) {\n        return;\n      }\n      var _calcDropPosition2 = calcDropPosition(event, dragNode, node, indent, _this.dragStartMousePosition, allowDrop, flattenNodes, keyEntities, expandedKeys, direction),\n        dropPosition = _calcDropPosition2.dropPosition,\n        dropLevelOffset = _calcDropPosition2.dropLevelOffset,\n        dropTargetKey = _calcDropPosition2.dropTargetKey,\n        dropContainerKey = _calcDropPosition2.dropContainerKey,\n        dropAllowed = _calcDropPosition2.dropAllowed,\n        dropTargetPos = _calcDropPosition2.dropTargetPos,\n        dragOverNodeKey = _calcDropPosition2.dragOverNodeKey;\n      if (dragChildrenKeys.indexOf(dropTargetKey) !== -1 || !dropAllowed) {\n        // don't allow drop inside its children\n        // don't allow drop when drop is not allowed calculated by calcDropPosition\n        return;\n      }\n\n      // Update drag position\n\n      if (dragNode.props.eventKey === dropTargetKey && dropLevelOffset === 0) {\n        if (!(_this.state.dropPosition === null && _this.state.dropLevelOffset === null && _this.state.dropTargetKey === null && _this.state.dropContainerKey === null && _this.state.dropTargetPos === null && _this.state.dropAllowed === false && _this.state.dragOverNodeKey === null)) {\n          _this.resetDragState();\n        }\n      } else if (!(dropPosition === _this.state.dropPosition && dropLevelOffset === _this.state.dropLevelOffset && dropTargetKey === _this.state.dropTargetKey && dropContainerKey === _this.state.dropContainerKey && dropTargetPos === _this.state.dropTargetPos && dropAllowed === _this.state.dropAllowed && dragOverNodeKey === _this.state.dragOverNodeKey)) {\n        _this.setState({\n          dropPosition: dropPosition,\n          dropLevelOffset: dropLevelOffset,\n          dropTargetKey: dropTargetKey,\n          dropContainerKey: dropContainerKey,\n          dropTargetPos: dropTargetPos,\n          dropAllowed: dropAllowed,\n          dragOverNodeKey: dragOverNodeKey\n        });\n      }\n      onDragOver === null || onDragOver === void 0 || onDragOver({\n        event: event,\n        node: convertNodePropsToEventData(node.props)\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragLeave\", function (event, node) {\n      // if it is outside the droppable area\n      // currentMouseOverDroppableNodeKey will be updated in dragenter event when into another droppable receiver.\n      if (_this.currentMouseOverDroppableNodeKey === node.props.eventKey && !event.currentTarget.contains(event.relatedTarget)) {\n        _this.resetDragState();\n        _this.currentMouseOverDroppableNodeKey = null;\n      }\n      var onDragLeave = _this.props.onDragLeave;\n      onDragLeave === null || onDragLeave === void 0 || onDragLeave({\n        event: event,\n        node: convertNodePropsToEventData(node.props)\n      });\n    });\n    // since stopPropagation() is called in treeNode\n    // if onWindowDrag is called, whice means state is keeped, drag state should be cleared\n    _defineProperty(_assertThisInitialized(_this), \"onWindowDragEnd\", function (event) {\n      _this.onNodeDragEnd(event, null, true);\n      window.removeEventListener('dragend', _this.onWindowDragEnd);\n    });\n    // if onNodeDragEnd is called, onWindowDragEnd won't be called since stopPropagation() is called\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragEnd\", function (event, node) {\n      var onDragEnd = _this.props.onDragEnd;\n      _this.setState({\n        dragOverNodeKey: null\n      });\n      _this.cleanDragState();\n      onDragEnd === null || onDragEnd === void 0 || onDragEnd({\n        event: event,\n        node: convertNodePropsToEventData(node.props)\n      });\n      _this.dragNode = null;\n      window.removeEventListener('dragend', _this.onWindowDragEnd);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDrop\", function (event, node) {\n      var _this$getActiveItem;\n      var outsideTree = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var _this$state4 = _this.state,\n        dragChildrenKeys = _this$state4.dragChildrenKeys,\n        dropPosition = _this$state4.dropPosition,\n        dropTargetKey = _this$state4.dropTargetKey,\n        dropTargetPos = _this$state4.dropTargetPos,\n        dropAllowed = _this$state4.dropAllowed;\n      if (!dropAllowed) return;\n      var onDrop = _this.props.onDrop;\n      _this.setState({\n        dragOverNodeKey: null\n      });\n      _this.cleanDragState();\n      if (dropTargetKey === null) return;\n      var abstractDropNodeProps = _objectSpread(_objectSpread({}, getTreeNodeProps(dropTargetKey, _this.getTreeNodeRequiredProps())), {}, {\n        active: ((_this$getActiveItem = _this.getActiveItem()) === null || _this$getActiveItem === void 0 ? void 0 : _this$getActiveItem.key) === dropTargetKey,\n        data: getEntity(_this.state.keyEntities, dropTargetKey).node\n      });\n      var dropToChild = dragChildrenKeys.indexOf(dropTargetKey) !== -1;\n      warning(!dropToChild, \"Can not drop to dragNode's children node. This is a bug of rc-tree. Please report an issue.\");\n      var posArr = posToArr(dropTargetPos);\n      var dropResult = {\n        event: event,\n        node: convertNodePropsToEventData(abstractDropNodeProps),\n        dragNode: _this.dragNode ? convertNodePropsToEventData(_this.dragNode.props) : null,\n        dragNodesKeys: [_this.dragNode.props.eventKey].concat(dragChildrenKeys),\n        dropToGap: dropPosition !== 0,\n        dropPosition: dropPosition + Number(posArr[posArr.length - 1])\n      };\n      if (!outsideTree) {\n        onDrop === null || onDrop === void 0 || onDrop(dropResult);\n      }\n      _this.dragNode = null;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"cleanDragState\", function () {\n      var draggingNodeKey = _this.state.draggingNodeKey;\n      if (draggingNodeKey !== null) {\n        _this.setState({\n          draggingNodeKey: null,\n          dropPosition: null,\n          dropContainerKey: null,\n          dropTargetKey: null,\n          dropLevelOffset: null,\n          dropAllowed: true,\n          dragOverNodeKey: null\n        });\n      }\n      _this.dragStartMousePosition = null;\n      _this.currentMouseOverDroppableNodeKey = null;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"triggerExpandActionExpand\", function (e, treeNode) {\n      var _this$state5 = _this.state,\n        expandedKeys = _this$state5.expandedKeys,\n        flattenNodes = _this$state5.flattenNodes;\n      var expanded = treeNode.expanded,\n        key = treeNode.key,\n        isLeaf = treeNode.isLeaf;\n      if (isLeaf || e.shiftKey || e.metaKey || e.ctrlKey) {\n        return;\n      }\n      var node = flattenNodes.filter(function (nodeItem) {\n        return nodeItem.key === key;\n      })[0];\n      var eventNode = convertNodePropsToEventData(_objectSpread(_objectSpread({}, getTreeNodeProps(key, _this.getTreeNodeRequiredProps())), {}, {\n        data: node.data\n      }));\n      _this.setExpandedKeys(expanded ? arrDel(expandedKeys, key) : arrAdd(expandedKeys, key));\n      _this.onNodeExpand(e, eventNode);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeClick\", function (e, treeNode) {\n      var _this$props3 = _this.props,\n        onClick = _this$props3.onClick,\n        expandAction = _this$props3.expandAction;\n      if (expandAction === 'click') {\n        _this.triggerExpandActionExpand(e, treeNode);\n      }\n      onClick === null || onClick === void 0 || onClick(e, treeNode);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDoubleClick\", function (e, treeNode) {\n      var _this$props4 = _this.props,\n        onDoubleClick = _this$props4.onDoubleClick,\n        expandAction = _this$props4.expandAction;\n      if (expandAction === 'doubleClick') {\n        _this.triggerExpandActionExpand(e, treeNode);\n      }\n      onDoubleClick === null || onDoubleClick === void 0 || onDoubleClick(e, treeNode);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeSelect\", function (e, treeNode) {\n      var selectedKeys = _this.state.selectedKeys;\n      var _this$state6 = _this.state,\n        keyEntities = _this$state6.keyEntities,\n        fieldNames = _this$state6.fieldNames;\n      var _this$props5 = _this.props,\n        onSelect = _this$props5.onSelect,\n        multiple = _this$props5.multiple;\n      var selected = treeNode.selected;\n      var key = treeNode[fieldNames.key];\n      var targetSelected = !selected;\n\n      // Update selected keys\n      if (!targetSelected) {\n        selectedKeys = arrDel(selectedKeys, key);\n      } else if (!multiple) {\n        selectedKeys = [key];\n      } else {\n        selectedKeys = arrAdd(selectedKeys, key);\n      }\n\n      // [Legacy] Not found related usage in doc or upper libs\n      var selectedNodes = selectedKeys.map(function (selectedKey) {\n        var entity = getEntity(keyEntities, selectedKey);\n        if (!entity) return null;\n        return entity.node;\n      }).filter(function (node) {\n        return node;\n      });\n      _this.setUncontrolledState({\n        selectedKeys: selectedKeys\n      });\n      onSelect === null || onSelect === void 0 || onSelect(selectedKeys, {\n        event: 'select',\n        selected: targetSelected,\n        node: treeNode,\n        selectedNodes: selectedNodes,\n        nativeEvent: e.nativeEvent\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeCheck\", function (e, treeNode, checked) {\n      var _this$state7 = _this.state,\n        keyEntities = _this$state7.keyEntities,\n        oriCheckedKeys = _this$state7.checkedKeys,\n        oriHalfCheckedKeys = _this$state7.halfCheckedKeys;\n      var _this$props6 = _this.props,\n        checkStrictly = _this$props6.checkStrictly,\n        onCheck = _this$props6.onCheck;\n      var key = treeNode.key;\n\n      // Prepare trigger arguments\n      var checkedObj;\n      var eventObj = {\n        event: 'check',\n        node: treeNode,\n        checked: checked,\n        nativeEvent: e.nativeEvent\n      };\n      if (checkStrictly) {\n        var checkedKeys = checked ? arrAdd(oriCheckedKeys, key) : arrDel(oriCheckedKeys, key);\n        var halfCheckedKeys = arrDel(oriHalfCheckedKeys, key);\n        checkedObj = {\n          checked: checkedKeys,\n          halfChecked: halfCheckedKeys\n        };\n        eventObj.checkedNodes = checkedKeys.map(function (checkedKey) {\n          return getEntity(keyEntities, checkedKey);\n        }).filter(function (entity) {\n          return entity;\n        }).map(function (entity) {\n          return entity.node;\n        });\n        _this.setUncontrolledState({\n          checkedKeys: checkedKeys\n        });\n      } else {\n        // Always fill first\n        var _conductCheck = conductCheck([].concat(_toConsumableArray(oriCheckedKeys), [key]), true, keyEntities),\n          _checkedKeys = _conductCheck.checkedKeys,\n          _halfCheckedKeys = _conductCheck.halfCheckedKeys;\n\n        // If remove, we do it again to correction\n        if (!checked) {\n          var keySet = new Set(_checkedKeys);\n          keySet.delete(key);\n          var _conductCheck2 = conductCheck(Array.from(keySet), {\n            checked: false,\n            halfCheckedKeys: _halfCheckedKeys\n          }, keyEntities);\n          _checkedKeys = _conductCheck2.checkedKeys;\n          _halfCheckedKeys = _conductCheck2.halfCheckedKeys;\n        }\n        checkedObj = _checkedKeys;\n\n        // [Legacy] This is used for `rc-tree-select`\n        eventObj.checkedNodes = [];\n        eventObj.checkedNodesPositions = [];\n        eventObj.halfCheckedKeys = _halfCheckedKeys;\n        _checkedKeys.forEach(function (checkedKey) {\n          var entity = getEntity(keyEntities, checkedKey);\n          if (!entity) return;\n          var node = entity.node,\n            pos = entity.pos;\n          eventObj.checkedNodes.push(node);\n          eventObj.checkedNodesPositions.push({\n            node: node,\n            pos: pos\n          });\n        });\n        _this.setUncontrolledState({\n          checkedKeys: _checkedKeys\n        }, false, {\n          halfCheckedKeys: _halfCheckedKeys\n        });\n      }\n      onCheck === null || onCheck === void 0 || onCheck(checkedObj, eventObj);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeLoad\", function (treeNode) {\n      var _entity$children;\n      var key = treeNode.key;\n      var keyEntities = _this.state.keyEntities;\n\n      // Skip if has children already\n      var entity = getEntity(keyEntities, key);\n      if (entity !== null && entity !== void 0 && (_entity$children = entity.children) !== null && _entity$children !== void 0 && _entity$children.length) {\n        return;\n      }\n      var loadPromise = new Promise(function (resolve, reject) {\n        // We need to get the latest state of loading/loaded keys\n        _this.setState(function (_ref) {\n          var _ref$loadedKeys = _ref.loadedKeys,\n            loadedKeys = _ref$loadedKeys === void 0 ? [] : _ref$loadedKeys,\n            _ref$loadingKeys = _ref.loadingKeys,\n            loadingKeys = _ref$loadingKeys === void 0 ? [] : _ref$loadingKeys;\n          var _this$props7 = _this.props,\n            loadData = _this$props7.loadData,\n            onLoad = _this$props7.onLoad;\n          if (!loadData || loadedKeys.indexOf(key) !== -1 || loadingKeys.indexOf(key) !== -1) {\n            return null;\n          }\n\n          // Process load data\n          var promise = loadData(treeNode);\n          promise.then(function () {\n            var currentLoadedKeys = _this.state.loadedKeys;\n            var newLoadedKeys = arrAdd(currentLoadedKeys, key);\n\n            // onLoad should trigger before internal setState to avoid `loadData` trigger twice.\n            // https://github.com/ant-design/ant-design/issues/12464\n            onLoad === null || onLoad === void 0 || onLoad(newLoadedKeys, {\n              event: 'load',\n              node: treeNode\n            });\n            _this.setUncontrolledState({\n              loadedKeys: newLoadedKeys\n            });\n            _this.setState(function (prevState) {\n              return {\n                loadingKeys: arrDel(prevState.loadingKeys, key)\n              };\n            });\n            resolve();\n          }).catch(function (e) {\n            _this.setState(function (prevState) {\n              return {\n                loadingKeys: arrDel(prevState.loadingKeys, key)\n              };\n            });\n\n            // If exceed max retry times, we give up retry\n            _this.loadingRetryTimes[key] = (_this.loadingRetryTimes[key] || 0) + 1;\n            if (_this.loadingRetryTimes[key] >= MAX_RETRY_TIMES) {\n              var currentLoadedKeys = _this.state.loadedKeys;\n              warning(false, 'Retry for `loadData` many times but still failed. No more retry.');\n              _this.setUncontrolledState({\n                loadedKeys: arrAdd(currentLoadedKeys, key)\n              });\n              resolve();\n            }\n            reject(e);\n          });\n          return {\n            loadingKeys: arrAdd(loadingKeys, key)\n          };\n        });\n      });\n\n      // Not care warning if we ignore this\n      loadPromise.catch(function () {});\n      return loadPromise;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeMouseEnter\", function (event, node) {\n      var onMouseEnter = _this.props.onMouseEnter;\n      onMouseEnter === null || onMouseEnter === void 0 || onMouseEnter({\n        event: event,\n        node: node\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeMouseLeave\", function (event, node) {\n      var onMouseLeave = _this.props.onMouseLeave;\n      onMouseLeave === null || onMouseLeave === void 0 || onMouseLeave({\n        event: event,\n        node: node\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeContextMenu\", function (event, node) {\n      var onRightClick = _this.props.onRightClick;\n      if (onRightClick) {\n        event.preventDefault();\n        onRightClick({\n          event: event,\n          node: node\n        });\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onFocus\", function () {\n      var onFocus = _this.props.onFocus;\n      _this.setState({\n        focused: true\n      });\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      onFocus === null || onFocus === void 0 || onFocus.apply(void 0, args);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onBlur\", function () {\n      var onBlur = _this.props.onBlur;\n      _this.setState({\n        focused: false\n      });\n      _this.onActiveChange(null);\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      onBlur === null || onBlur === void 0 || onBlur.apply(void 0, args);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"getTreeNodeRequiredProps\", function () {\n      var _this$state8 = _this.state,\n        expandedKeys = _this$state8.expandedKeys,\n        selectedKeys = _this$state8.selectedKeys,\n        loadedKeys = _this$state8.loadedKeys,\n        loadingKeys = _this$state8.loadingKeys,\n        checkedKeys = _this$state8.checkedKeys,\n        halfCheckedKeys = _this$state8.halfCheckedKeys,\n        dragOverNodeKey = _this$state8.dragOverNodeKey,\n        dropPosition = _this$state8.dropPosition,\n        keyEntities = _this$state8.keyEntities;\n      return {\n        expandedKeys: expandedKeys || [],\n        selectedKeys: selectedKeys || [],\n        loadedKeys: loadedKeys || [],\n        loadingKeys: loadingKeys || [],\n        checkedKeys: checkedKeys || [],\n        halfCheckedKeys: halfCheckedKeys || [],\n        dragOverNodeKey: dragOverNodeKey,\n        dropPosition: dropPosition,\n        keyEntities: keyEntities\n      };\n    });\n    // =========================== Expanded ===========================\n    /** Set uncontrolled `expandedKeys`. This will also auto update `flattenNodes`. */\n    _defineProperty(_assertThisInitialized(_this), \"setExpandedKeys\", function (expandedKeys) {\n      var _this$state9 = _this.state,\n        treeData = _this$state9.treeData,\n        fieldNames = _this$state9.fieldNames;\n      var flattenNodes = flattenTreeData(treeData, expandedKeys, fieldNames);\n      _this.setUncontrolledState({\n        expandedKeys: expandedKeys,\n        flattenNodes: flattenNodes\n      }, true);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeExpand\", function (e, treeNode) {\n      var expandedKeys = _this.state.expandedKeys;\n      var _this$state10 = _this.state,\n        listChanging = _this$state10.listChanging,\n        fieldNames = _this$state10.fieldNames;\n      var _this$props8 = _this.props,\n        onExpand = _this$props8.onExpand,\n        loadData = _this$props8.loadData;\n      var expanded = treeNode.expanded;\n      var key = treeNode[fieldNames.key];\n\n      // Do nothing when motion is in progress\n      if (listChanging) {\n        return;\n      }\n\n      // Update selected keys\n      var index = expandedKeys.indexOf(key);\n      var targetExpanded = !expanded;\n      warning(expanded && index !== -1 || !expanded && index === -1, 'Expand state not sync with index check');\n      if (targetExpanded) {\n        expandedKeys = arrAdd(expandedKeys, key);\n      } else {\n        expandedKeys = arrDel(expandedKeys, key);\n      }\n      _this.setExpandedKeys(expandedKeys);\n      onExpand === null || onExpand === void 0 || onExpand(expandedKeys, {\n        node: treeNode,\n        expanded: targetExpanded,\n        nativeEvent: e.nativeEvent\n      });\n\n      // Async Load data\n      if (targetExpanded && loadData) {\n        var loadPromise = _this.onNodeLoad(treeNode);\n        if (loadPromise) {\n          loadPromise.then(function () {\n            // [Legacy] Refresh logic\n            var newFlattenTreeData = flattenTreeData(_this.state.treeData, expandedKeys, fieldNames);\n            _this.setUncontrolledState({\n              flattenNodes: newFlattenTreeData\n            });\n          }).catch(function () {\n            var currentExpandedKeys = _this.state.expandedKeys;\n            var expandedKeysToRestore = arrDel(currentExpandedKeys, key);\n            _this.setExpandedKeys(expandedKeysToRestore);\n          });\n        }\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onListChangeStart\", function () {\n      _this.setUncontrolledState({\n        listChanging: true\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onListChangeEnd\", function () {\n      setTimeout(function () {\n        _this.setUncontrolledState({\n          listChanging: false\n        });\n      });\n    });\n    // =========================== Keyboard ===========================\n    _defineProperty(_assertThisInitialized(_this), \"onActiveChange\", function (newActiveKey) {\n      var activeKey = _this.state.activeKey;\n      var _this$props9 = _this.props,\n        onActiveChange = _this$props9.onActiveChange,\n        _this$props9$itemScro = _this$props9.itemScrollOffset,\n        itemScrollOffset = _this$props9$itemScro === void 0 ? 0 : _this$props9$itemScro;\n      if (activeKey === newActiveKey) {\n        return;\n      }\n      _this.setState({\n        activeKey: newActiveKey\n      });\n      if (newActiveKey !== null) {\n        _this.scrollTo({\n          key: newActiveKey,\n          offset: itemScrollOffset\n        });\n      }\n      onActiveChange === null || onActiveChange === void 0 || onActiveChange(newActiveKey);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"getActiveItem\", function () {\n      var _this$state11 = _this.state,\n        activeKey = _this$state11.activeKey,\n        flattenNodes = _this$state11.flattenNodes;\n      if (activeKey === null) {\n        return null;\n      }\n      return flattenNodes.find(function (_ref2) {\n        var key = _ref2.key;\n        return key === activeKey;\n      }) || null;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"offsetActiveKey\", function (offset) {\n      var _this$state12 = _this.state,\n        flattenNodes = _this$state12.flattenNodes,\n        activeKey = _this$state12.activeKey;\n      var index = flattenNodes.findIndex(function (_ref3) {\n        var key = _ref3.key;\n        return key === activeKey;\n      });\n\n      // Align with index\n      if (index === -1 && offset < 0) {\n        index = flattenNodes.length;\n      }\n      index = (index + offset + flattenNodes.length) % flattenNodes.length;\n      var item = flattenNodes[index];\n      if (item) {\n        var _key4 = item.key;\n        _this.onActiveChange(_key4);\n      } else {\n        _this.onActiveChange(null);\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onKeyDown\", function (event) {\n      var _this$state13 = _this.state,\n        activeKey = _this$state13.activeKey,\n        expandedKeys = _this$state13.expandedKeys,\n        checkedKeys = _this$state13.checkedKeys,\n        fieldNames = _this$state13.fieldNames;\n      var _this$props10 = _this.props,\n        onKeyDown = _this$props10.onKeyDown,\n        checkable = _this$props10.checkable,\n        selectable = _this$props10.selectable;\n\n      // >>>>>>>>>> Direction\n      switch (event.which) {\n        case KeyCode.UP:\n          {\n            _this.offsetActiveKey(-1);\n            event.preventDefault();\n            break;\n          }\n        case KeyCode.DOWN:\n          {\n            _this.offsetActiveKey(1);\n            event.preventDefault();\n            break;\n          }\n      }\n\n      // >>>>>>>>>> Expand & Selection\n      var activeItem = _this.getActiveItem();\n      if (activeItem && activeItem.data) {\n        var treeNodeRequiredProps = _this.getTreeNodeRequiredProps();\n        var expandable = activeItem.data.isLeaf === false || !!(activeItem.data[fieldNames.children] || []).length;\n        var eventNode = convertNodePropsToEventData(_objectSpread(_objectSpread({}, getTreeNodeProps(activeKey, treeNodeRequiredProps)), {}, {\n          data: activeItem.data,\n          active: true\n        }));\n        switch (event.which) {\n          // >>> Expand\n          case KeyCode.LEFT:\n            {\n              // Collapse if possible\n              if (expandable && expandedKeys.includes(activeKey)) {\n                _this.onNodeExpand({}, eventNode);\n              } else if (activeItem.parent) {\n                _this.onActiveChange(activeItem.parent.key);\n              }\n              event.preventDefault();\n              break;\n            }\n          case KeyCode.RIGHT:\n            {\n              // Expand if possible\n              if (expandable && !expandedKeys.includes(activeKey)) {\n                _this.onNodeExpand({}, eventNode);\n              } else if (activeItem.children && activeItem.children.length) {\n                _this.onActiveChange(activeItem.children[0].key);\n              }\n              event.preventDefault();\n              break;\n            }\n\n          // Selection\n          case KeyCode.ENTER:\n          case KeyCode.SPACE:\n            {\n              if (checkable && !eventNode.disabled && eventNode.checkable !== false && !eventNode.disableCheckbox) {\n                _this.onNodeCheck({}, eventNode, !checkedKeys.includes(activeKey));\n              } else if (!checkable && selectable && !eventNode.disabled && eventNode.selectable !== false) {\n                _this.onNodeSelect({}, eventNode);\n              }\n              break;\n            }\n        }\n      }\n      onKeyDown === null || onKeyDown === void 0 || onKeyDown(event);\n    });\n    /**\n     * Only update the value which is not in props\n     */\n    _defineProperty(_assertThisInitialized(_this), \"setUncontrolledState\", function (state) {\n      var atomic = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var forceState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      if (!_this.destroyed) {\n        var needSync = false;\n        var allPassed = true;\n        var newState = {};\n        Object.keys(state).forEach(function (name) {\n          if (name in _this.props) {\n            allPassed = false;\n            return;\n          }\n          needSync = true;\n          newState[name] = state[name];\n        });\n        if (needSync && (!atomic || allPassed)) {\n          _this.setState(_objectSpread(_objectSpread({}, newState), forceState));\n        }\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"scrollTo\", function (scroll) {\n      _this.listRef.current.scrollTo(scroll);\n    });\n    return _this;\n  }\n  _createClass(Tree, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.destroyed = false;\n      this.onUpdated();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.onUpdated();\n    }\n  }, {\n    key: \"onUpdated\",\n    value: function onUpdated() {\n      var _this$props11 = this.props,\n        activeKey = _this$props11.activeKey,\n        _this$props11$itemScr = _this$props11.itemScrollOffset,\n        itemScrollOffset = _this$props11$itemScr === void 0 ? 0 : _this$props11$itemScr;\n      if (activeKey !== undefined && activeKey !== this.state.activeKey) {\n        this.setState({\n          activeKey: activeKey\n        });\n        if (activeKey !== null) {\n          this.scrollTo({\n            key: activeKey,\n            offset: itemScrollOffset\n          });\n        }\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('dragend', this.onWindowDragEnd);\n      this.destroyed = true;\n    }\n  }, {\n    key: \"resetDragState\",\n    value: function resetDragState() {\n      this.setState({\n        dragOverNodeKey: null,\n        dropPosition: null,\n        dropLevelOffset: null,\n        dropTargetKey: null,\n        dropContainerKey: null,\n        dropTargetPos: null,\n        dropAllowed: false\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state14 = this.state,\n        focused = _this$state14.focused,\n        flattenNodes = _this$state14.flattenNodes,\n        keyEntities = _this$state14.keyEntities,\n        draggingNodeKey = _this$state14.draggingNodeKey,\n        activeKey = _this$state14.activeKey,\n        dropLevelOffset = _this$state14.dropLevelOffset,\n        dropContainerKey = _this$state14.dropContainerKey,\n        dropTargetKey = _this$state14.dropTargetKey,\n        dropPosition = _this$state14.dropPosition,\n        dragOverNodeKey = _this$state14.dragOverNodeKey,\n        indent = _this$state14.indent;\n      var _this$props12 = this.props,\n        prefixCls = _this$props12.prefixCls,\n        className = _this$props12.className,\n        style = _this$props12.style,\n        showLine = _this$props12.showLine,\n        focusable = _this$props12.focusable,\n        _this$props12$tabInde = _this$props12.tabIndex,\n        tabIndex = _this$props12$tabInde === void 0 ? 0 : _this$props12$tabInde,\n        selectable = _this$props12.selectable,\n        showIcon = _this$props12.showIcon,\n        icon = _this$props12.icon,\n        switcherIcon = _this$props12.switcherIcon,\n        draggable = _this$props12.draggable,\n        checkable = _this$props12.checkable,\n        checkStrictly = _this$props12.checkStrictly,\n        disabled = _this$props12.disabled,\n        motion = _this$props12.motion,\n        loadData = _this$props12.loadData,\n        filterTreeNode = _this$props12.filterTreeNode,\n        height = _this$props12.height,\n        itemHeight = _this$props12.itemHeight,\n        virtual = _this$props12.virtual,\n        titleRender = _this$props12.titleRender,\n        dropIndicatorRender = _this$props12.dropIndicatorRender,\n        onContextMenu = _this$props12.onContextMenu,\n        onScroll = _this$props12.onScroll,\n        direction = _this$props12.direction,\n        rootClassName = _this$props12.rootClassName,\n        rootStyle = _this$props12.rootStyle;\n      var domProps = pickAttrs(this.props, {\n        aria: true,\n        data: true\n      });\n\n      // It's better move to hooks but we just simply keep here\n      var draggableConfig;\n      if (draggable) {\n        if (_typeof(draggable) === 'object') {\n          draggableConfig = draggable;\n        } else if (typeof draggable === 'function') {\n          draggableConfig = {\n            nodeDraggable: draggable\n          };\n        } else {\n          draggableConfig = {};\n        }\n      }\n      return /*#__PURE__*/React.createElement(TreeContext.Provider, {\n        value: {\n          prefixCls: prefixCls,\n          selectable: selectable,\n          showIcon: showIcon,\n          icon: icon,\n          switcherIcon: switcherIcon,\n          draggable: draggableConfig,\n          draggingNodeKey: draggingNodeKey,\n          checkable: checkable,\n          checkStrictly: checkStrictly,\n          disabled: disabled,\n          keyEntities: keyEntities,\n          dropLevelOffset: dropLevelOffset,\n          dropContainerKey: dropContainerKey,\n          dropTargetKey: dropTargetKey,\n          dropPosition: dropPosition,\n          dragOverNodeKey: dragOverNodeKey,\n          indent: indent,\n          direction: direction,\n          dropIndicatorRender: dropIndicatorRender,\n          loadData: loadData,\n          filterTreeNode: filterTreeNode,\n          titleRender: titleRender,\n          onNodeClick: this.onNodeClick,\n          onNodeDoubleClick: this.onNodeDoubleClick,\n          onNodeExpand: this.onNodeExpand,\n          onNodeSelect: this.onNodeSelect,\n          onNodeCheck: this.onNodeCheck,\n          onNodeLoad: this.onNodeLoad,\n          onNodeMouseEnter: this.onNodeMouseEnter,\n          onNodeMouseLeave: this.onNodeMouseLeave,\n          onNodeContextMenu: this.onNodeContextMenu,\n          onNodeDragStart: this.onNodeDragStart,\n          onNodeDragEnter: this.onNodeDragEnter,\n          onNodeDragOver: this.onNodeDragOver,\n          onNodeDragLeave: this.onNodeDragLeave,\n          onNodeDragEnd: this.onNodeDragEnd,\n          onNodeDrop: this.onNodeDrop\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        role: \"tree\",\n        className: classNames(prefixCls, className, rootClassName, _defineProperty(_defineProperty(_defineProperty({}, \"\".concat(prefixCls, \"-show-line\"), showLine), \"\".concat(prefixCls, \"-focused\"), focused), \"\".concat(prefixCls, \"-active-focused\"), activeKey !== null)),\n        style: rootStyle\n      }, /*#__PURE__*/React.createElement(NodeList, _extends({\n        ref: this.listRef,\n        prefixCls: prefixCls,\n        style: style,\n        data: flattenNodes,\n        disabled: disabled,\n        selectable: selectable,\n        checkable: !!checkable,\n        motion: motion,\n        dragging: draggingNodeKey !== null,\n        height: height,\n        itemHeight: itemHeight,\n        virtual: virtual,\n        focusable: focusable,\n        focused: focused,\n        tabIndex: tabIndex,\n        activeItem: this.getActiveItem(),\n        onFocus: this.onFocus,\n        onBlur: this.onBlur,\n        onKeyDown: this.onKeyDown,\n        onActiveChange: this.onActiveChange,\n        onListChangeStart: this.onListChangeStart,\n        onListChangeEnd: this.onListChangeEnd,\n        onContextMenu: onContextMenu,\n        onScroll: onScroll\n      }, this.getTreeNodeRequiredProps(), domProps))));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, prevState) {\n      var prevProps = prevState.prevProps;\n      var newState = {\n        prevProps: props\n      };\n      function needSync(name) {\n        return !prevProps && name in props || prevProps && prevProps[name] !== props[name];\n      }\n\n      // ================== Tree Node ==================\n      var treeData;\n\n      // fieldNames\n      var fieldNames = prevState.fieldNames;\n      if (needSync('fieldNames')) {\n        fieldNames = fillFieldNames(props.fieldNames);\n        newState.fieldNames = fieldNames;\n      }\n\n      // Check if `treeData` or `children` changed and save into the state.\n      if (needSync('treeData')) {\n        treeData = props.treeData;\n      } else if (needSync('children')) {\n        warning(false, '`children` of Tree is deprecated. Please use `treeData` instead.');\n        treeData = convertTreeToData(props.children);\n      }\n\n      // Save flatten nodes info and convert `treeData` into keyEntities\n      if (treeData) {\n        newState.treeData = treeData;\n        var entitiesMap = convertDataToEntities(treeData, {\n          fieldNames: fieldNames\n        });\n        newState.keyEntities = _objectSpread(_defineProperty({}, MOTION_KEY, MotionEntity), entitiesMap.keyEntities);\n\n        // Warning if treeNode not provide key\n        if (process.env.NODE_ENV !== 'production') {\n          warningWithoutKey(treeData, fieldNames);\n        }\n      }\n      var keyEntities = newState.keyEntities || prevState.keyEntities;\n\n      // ================ expandedKeys =================\n      if (needSync('expandedKeys') || prevProps && needSync('autoExpandParent')) {\n        newState.expandedKeys = props.autoExpandParent || !prevProps && props.defaultExpandParent ? conductExpandParent(props.expandedKeys, keyEntities) : props.expandedKeys;\n      } else if (!prevProps && props.defaultExpandAll) {\n        var cloneKeyEntities = _objectSpread({}, keyEntities);\n        delete cloneKeyEntities[MOTION_KEY];\n        newState.expandedKeys = Object.keys(cloneKeyEntities).map(function (key) {\n          return cloneKeyEntities[key].key;\n        });\n      } else if (!prevProps && props.defaultExpandedKeys) {\n        newState.expandedKeys = props.autoExpandParent || props.defaultExpandParent ? conductExpandParent(props.defaultExpandedKeys, keyEntities) : props.defaultExpandedKeys;\n      }\n      if (!newState.expandedKeys) {\n        delete newState.expandedKeys;\n      }\n\n      // ================ flattenNodes =================\n      if (treeData || newState.expandedKeys) {\n        var flattenNodes = flattenTreeData(treeData || prevState.treeData, newState.expandedKeys || prevState.expandedKeys, fieldNames);\n        newState.flattenNodes = flattenNodes;\n      }\n\n      // ================ selectedKeys =================\n      if (props.selectable) {\n        if (needSync('selectedKeys')) {\n          newState.selectedKeys = calcSelectedKeys(props.selectedKeys, props);\n        } else if (!prevProps && props.defaultSelectedKeys) {\n          newState.selectedKeys = calcSelectedKeys(props.defaultSelectedKeys, props);\n        }\n      }\n\n      // ================= checkedKeys =================\n      if (props.checkable) {\n        var checkedKeyEntity;\n        if (needSync('checkedKeys')) {\n          checkedKeyEntity = parseCheckedKeys(props.checkedKeys) || {};\n        } else if (!prevProps && props.defaultCheckedKeys) {\n          checkedKeyEntity = parseCheckedKeys(props.defaultCheckedKeys) || {};\n        } else if (treeData) {\n          // If `treeData` changed, we also need check it\n          checkedKeyEntity = parseCheckedKeys(props.checkedKeys) || {\n            checkedKeys: prevState.checkedKeys,\n            halfCheckedKeys: prevState.halfCheckedKeys\n          };\n        }\n        if (checkedKeyEntity) {\n          var _checkedKeyEntity = checkedKeyEntity,\n            _checkedKeyEntity$che = _checkedKeyEntity.checkedKeys,\n            checkedKeys = _checkedKeyEntity$che === void 0 ? [] : _checkedKeyEntity$che,\n            _checkedKeyEntity$hal = _checkedKeyEntity.halfCheckedKeys,\n            halfCheckedKeys = _checkedKeyEntity$hal === void 0 ? [] : _checkedKeyEntity$hal;\n          if (!props.checkStrictly) {\n            var conductKeys = conductCheck(checkedKeys, true, keyEntities);\n            checkedKeys = conductKeys.checkedKeys;\n            halfCheckedKeys = conductKeys.halfCheckedKeys;\n          }\n          newState.checkedKeys = checkedKeys;\n          newState.halfCheckedKeys = halfCheckedKeys;\n        }\n      }\n\n      // ================= loadedKeys ==================\n      if (needSync('loadedKeys')) {\n        newState.loadedKeys = props.loadedKeys;\n      }\n      return newState;\n    }\n  }]);\n  return Tree;\n}(React.Component);\n_defineProperty(Tree, \"defaultProps\", {\n  prefixCls: 'rc-tree',\n  showLine: false,\n  showIcon: true,\n  selectable: true,\n  multiple: false,\n  checkable: false,\n  disabled: false,\n  checkStrictly: false,\n  draggable: false,\n  defaultExpandParent: true,\n  autoExpandParent: false,\n  defaultExpandAll: false,\n  defaultExpandedKeys: [],\n  defaultCheckedKeys: [],\n  defaultSelectedKeys: [],\n  dropIndicatorRender: DropIndicator,\n  allowDrop: function allowDrop() {\n    return true;\n  },\n  expandAction: false\n});\n_defineProperty(Tree, \"TreeNode\", TreeNode);\nexport default Tree;","import Tree from \"./Tree\";\nimport TreeNode from \"./TreeNode\";\nexport { TreeNode };\nexport default Tree;","import { css } from '@emotion/react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nexport function getGlobalStyles(theme: GrafanaTheme2) {\n  return css({\n    '.moveable-control-box': {\n      zIndex: 999,\n    },\n    '.rc-tree': {\n      margin: 0,\n      marginBottom: '15px',\n      border: '1px solid transparent',\n      '&-focused:not(&-active-focused)': {\n        borderColor: 'cyan',\n      },\n      '.rc-tree-title': {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        width: '100%',\n      },\n      '.rc-tree-treenode': {\n        margin: 0,\n        padding: '1px',\n        lineHeight: '24px',\n        whiteSpace: 'nowrap',\n        listStyle: 'none',\n        outline: 0,\n        display: 'flex',\n        marginBottom: '3px',\n        cursor: 'pointer',\n        '.draggable': {\n          color: '#333',\n          MozUserSelect: 'none',\n          KhtmlUserSelect: 'none',\n          WebkitUserSelect: 'none',\n          userSelect: 'none',\n        },\n        '&.drop-container': {\n          '> .draggable::after': {\n            position: 'absolute',\n            top: 0,\n            right: 0,\n            bottom: 0,\n            left: 0,\n            boxShadow: 'inset 0 0 0 2px blue',\n            content: '\"\"',\n          },\n          '& ~ .rc-tree-treenode': {\n            borderLeft: `2px solid ${theme.components.input.borderColor}`,\n          },\n        },\n        '&.drop-target': {\n          '& ~ .rc-tree-treenode': {\n            borderLeft: 'none',\n          },\n        },\n        '&.filter-node': {\n          '> .rc-tree-node-content-wrapper': {\n            color: '#a60000 !important',\n            fontWeight: 'bold !important',\n          },\n        },\n        ul: {\n          margin: 0,\n          padding: '0 0 0 18px',\n        },\n        '.rc-tree-node-content-wrapper': {\n          position: 'relative',\n          display: 'inline-block',\n          height: '24px',\n          margin: 0,\n          padding: 0,\n          textDecoration: 'none',\n          verticalAlign: 'top',\n          cursor: 'grab',\n          flexGrow: 1,\n          border: `1px solid ${theme.components.input.borderColor}`,\n          borderRadius: `${theme.shape.radius.default}`,\n          background: `${theme.colors.background.secondary}`,\n          minHeight: `${theme.spacing.gridSize * 4}px`,\n          '&:hover': {\n            border: `1px solid ${theme.components.input.borderHover}`,\n          },\n          '&.rc-tree-node-selected': {\n            border: `1px solid ${theme.colors.primary.border}`,\n            opacity: 1,\n          },\n        },\n        span: {\n          height: '100%',\n          '&.rc-tree-checkbox, &.rc-tree-iconEle': {\n            display: 'inline-block',\n            width: '16px',\n            height: '16px',\n            marginRight: '2px',\n            lineHeight: '16px',\n            verticalAlign: '-0.125em',\n            backgroundColor: 'transparent',\n            backgroundRepeat: 'no-repeat',\n            backgroundAttachment: 'scroll',\n            border: '0 none',\n            outline: 'none',\n            cursor: 'pointer',\n            '&.rc-tree-icon__customize': {\n              backgroundImage: 'none',\n            },\n          },\n          '&.rc-tree-switcher': {\n            display: 'flex',\n            alignItems: 'center',\n            width: '16px',\n            height: 'auto',\n            backgroundColor: 'transparent',\n            backgroundRepeat: 'no-repeat',\n            backgroundAttachment: 'scroll',\n            border: '0 none',\n            outline: 'none',\n            cursor: 'pointer',\n            '&.rc-tree-icon__customize': {\n              backgroundImage: 'none',\n            },\n            '&.rc-tree-switcher-noop': {\n              cursor: 'auto',\n            },\n            '&.rc-tree-switcher_open': {\n              backgroundPosition: '-93px -56px',\n            },\n            '&.rc-tree-switcher_close': {\n              backgroundPosition: '-75px -56px',\n            },\n          },\n          '&.rc-tree-icon_loading': {\n            marginRight: '2px',\n            verticalAlign: 'top',\n            background:\n              \"url('data:image/gif;base64,R0lGODlhEAAQAKIGAMLY8YSx5HOm4Mjc88/g9Ofw+v///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgAGACwAAAAAEAAQAAADMGi6RbUwGjKIXCAA016PgRBElAVlG/RdLOO0X9nK61W39qvqiwz5Ls/rRqrggsdkAgAh+QQFCgAGACwCAAAABwAFAAADD2hqELAmiFBIYY4MAutdCQAh+QQFCgAGACwGAAAABwAFAAADD1hU1kaDOKMYCGAGEeYFCQAh+QQFCgAGACwKAAIABQAHAAADEFhUZjSkKdZqBQG0IELDQAIAIfkEBQoABgAsCgAGAAUABwAAAxBoVlRKgyjmlAIBqCDCzUoCACH5BAUKAAYALAYACgAHAAUAAAMPaGpFtYYMAgJgLogA610JACH5BAUKAAYALAIACgAHAAUAAAMPCAHWFiI4o1ghZZJB5i0JACH5BAUKAAYALAAABgAFAAcAAAMQCAFmIaEp1motpDQySMNFAgA7') no-repeat scroll 0 0 transparent\",\n          },\n          '&.rc-tree-checkbox': {\n            width: '13px',\n            height: '13px',\n            margin: '0 3px',\n            backgroundPosition: '0 0',\n            '&-checked': {\n              backgroundPosition: '-14px 0',\n            },\n            '&-indeterminate': {\n              backgroundPosition: '-14px -28px',\n            },\n            '&-disabled': {\n              backgroundPosition: '0 -56px',\n            },\n            '&.rc-tree-checkbox-checked.rc-tree-checkbox-disabled': {\n              backgroundPosition: '-14px -56px',\n            },\n            '&.rc-tree-checkbox-indeterminate.rc-tree-checkbox-disabled': {\n              position: 'relative',\n              background: '#ccc',\n              borderRadius: '3px',\n              '&::after': {\n                position: 'absolute',\n                top: '5px',\n                left: '3px',\n                width: '5px',\n                height: 0,\n                border: '2px solid #fff',\n                borderTop: 0,\n                borderLeft: 0,\n                WebkitTransform: 'scale(1)',\n                transform: 'scale(1)',\n                content: '\" \"',\n              },\n            },\n          },\n        },\n      },\n      '&:not(.rc-tree-show-line)': {\n        '.rc-tree-treenode': {\n          '.rc-tree-switcher-noop': {\n            background: 'none',\n          },\n        },\n      },\n      '&.rc-tree-show-line': {\n        '.rc-tree-treenode:not(:last-child)': {\n          '> ul': {\n            background:\n              \"url('data:image/gif;base64,R0lGODlhCQACAIAAAMzMzP///yH5BAEAAAEALAAAAAAJAAIAAAIEjI9pUAA7') 0 0 repeat-y\",\n          },\n          '> .rc-tree-switcher-noop': {\n            backgroundPosition: '-56px -18px',\n          },\n        },\n        '.rc-tree-treenode:last-child': {\n          '> .rc-tree-switcher-noop': {\n            backgroundPosition: '-56px -36px',\n          },\n        },\n      },\n      '&-child-tree': {\n        display: 'none',\n        '&-open': {\n          display: 'block',\n        },\n      },\n      '&-treenode-disabled': {\n        '> span:not(.rc-tree-switcher), > a, > a span': {\n          color: '#767676',\n          cursor: 'not-allowed',\n        },\n      },\n      '&-treenode-active': {\n        background: 'rgba(0, 0, 0, 0.1)',\n      },\n      '&-node-selected': {\n        opacity: 0.8,\n      },\n      '&-icon__open': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n        backgroundPosition: '-110px -16px',\n      },\n      '&-icon__close': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n        backgroundPosition: '-110px 0',\n      },\n      '&-icon__docu': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n        backgroundPosition: '-110px -32px',\n      },\n      '&-icon__customize': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n      },\n      '&-title': {\n        display: 'inline-block',\n      },\n      '&-indent': {\n        display: 'inline-block',\n        height: 0,\n        verticalAlign: 'bottom',\n      },\n      '&-indent-unit': {\n        display: 'inline-block',\n        width: '16px',\n      },\n      '&-draggable-icon': {\n        display: 'inline-flex',\n        justifyContent: 'center',\n        width: '16px',\n      },\n    },\n  });\n}\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { IconButton, useStyles2 } from '@grafana/ui';\nimport { LayerName } from 'app/core/components/Layers/LayerName';\nimport { ElementState } from 'app/features/canvas/runtime/element';\n\nimport { LayerActionID } from '../../types';\nimport { TreeViewEditorProps } from '../element/elementEditor';\n\nimport { TreeElement } from './tree';\n\ninterface Props {\n  settings: TreeViewEditorProps;\n  nodeData: TreeElement;\n  setAllowSelection: (allow: boolean) => void;\n}\n\nexport const TreeNodeTitle = ({ settings, nodeData, setAllowSelection }: Props) => {\n  const element = nodeData.dataRef;\n  const name = nodeData.dataRef.getName();\n\n  const styles = useStyles2(getStyles);\n\n  const layer = settings.layer;\n\n  const getScene = () => {\n    if (!settings?.layer) {\n      return;\n    }\n\n    return settings.layer.scene;\n  };\n\n  const onDelete = (element: ElementState) => {\n    const elLayer = element.parent ?? layer;\n    elLayer.doAction(LayerActionID.Delete, element);\n    setAllowSelection(false);\n  };\n\n  const onDuplicate = (element: ElementState) => {\n    const elLayer = element.parent ?? layer;\n    elLayer.doAction(LayerActionID.Duplicate, element);\n    setAllowSelection(false);\n  };\n\n  const onNameChange = (element: ElementState, name: string) => {\n    element.onChange({ ...element.options, name });\n  };\n\n  const verifyLayerNameUniqueness = (nameToVerify: string) => {\n    const scene = getScene();\n\n    return Boolean(scene?.canRename(nameToVerify));\n  };\n\n  const getLayerInfo = (element: ElementState) => {\n    return element.options.type;\n  };\n\n  return (\n    <>\n      <LayerName\n        name={name}\n        onChange={(v) => onNameChange(element, v)}\n        verifyLayerNameUniqueness={verifyLayerNameUniqueness ?? undefined}\n      />\n\n      <div className={styles.textWrapper}>&nbsp; {getLayerInfo(element)}</div>\n\n      {!nodeData.children && (\n        <div className={styles.actionButtonsWrapper}>\n          <IconButton\n            name=\"copy\"\n            title=\"Duplicate\"\n            className={styles.actionIcon}\n            onClick={() => onDuplicate(element)}\n            tooltip=\"Duplicate\"\n          />\n          <IconButton\n            name=\"trash-alt\"\n            title=\"remove\"\n            className={styles.actionIcon}\n            onClick={() => onDelete(element)}\n            tooltip=\"Remove\"\n          />\n        </div>\n      )}\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  actionButtonsWrapper: css({\n    display: 'flex',\n    alignItems: 'flex-end',\n  }),\n  actionIcon: css({\n    color: theme.colors.text.secondary,\n    cursor: 'pointer',\n    '&:hover': {\n      color: theme.colors.text.primary,\n    },\n  }),\n  textWrapper: css({\n    display: 'flex',\n    alignItems: 'center',\n    flexGrow: 1,\n    overflow: 'hidden',\n    marginRight: theme.spacing(1),\n  }),\n  layerName: css({\n    fontWeight: theme.typography.fontWeightMedium,\n    color: theme.colors.primary.text,\n    cursor: 'pointer',\n    overflow: 'hidden',\n    marginLeft: theme.spacing(0.5),\n  }),\n});\n","import { CSSProperties } from 'react';\n\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { RootElement } from 'app/features/canvas/runtime/root';\n\nimport { DragNode, DropNode } from '../../types';\n\nexport interface TreeElement {\n  key: number;\n  title: string;\n  selectable?: boolean;\n  children?: TreeElement[];\n  dataRef: ElementState | FrameState;\n  style?: CSSProperties;\n}\n\nexport function getTreeData(root?: RootElement | FrameState, selection?: string[], selectedColor?: string) {\n  let elements: TreeElement[] = [];\n  if (root) {\n    for (let i = root.elements.length; i--; i >= 0) {\n      const item = root.elements[i];\n      const element: TreeElement = {\n        key: item.UID,\n        title: item.getName(),\n        selectable: true,\n        dataRef: item,\n      };\n\n      if (item instanceof FrameState) {\n        element.children = getTreeData(item, selection, selectedColor);\n      }\n      elements.push(element);\n    }\n  }\n\n  return elements;\n}\n\nexport function onNodeDrop(\n  info: { node: DropNode; dragNode: DragNode; dropPosition: number; dropToGap: boolean },\n  treeData: TreeElement[]\n) {\n  const destKey = info.node.key;\n  const srcKey = info.dragNode.key;\n  const destPos = info.node.pos.split('-');\n  const destPosition = info.dropPosition - Number(destPos[destPos.length - 1]);\n\n  const loop = (\n    data: TreeElement[],\n    key: number,\n    callback: { (item: TreeElement, index: number, arr: TreeElement[]): void }\n  ) => {\n    data.forEach((item, index, arr) => {\n      if (item.key === key) {\n        callback(item, index, arr);\n        return;\n      }\n      if (item.children) {\n        loop(item.children, key, callback);\n      }\n    });\n  };\n  const data = [...treeData];\n\n  // Find dragObject\n  let srcElement: TreeElement | undefined = undefined;\n  loop(data, srcKey, (item: TreeElement, index: number, arr: TreeElement[]) => {\n    arr.splice(index, 1);\n    srcElement = item;\n  });\n\n  if (destPosition === 0) {\n    // Drop on the content\n    loop(data, destKey, (item: TreeElement) => {\n      item.children = item.children || [];\n      item.children.unshift(srcElement!);\n    });\n  } else {\n    // Drop on the gap (insert before or insert after)\n    let ar: TreeElement[] = [];\n    let i = 0;\n    loop(data, destKey, (item: TreeElement, index: number, arr: TreeElement[]) => {\n      ar = arr;\n      i = index;\n    });\n\n    if (destPosition === -1) {\n      ar.splice(i, 0, srcElement!);\n    } else {\n      ar.splice(i + 1, 0, srcElement!);\n    }\n  }\n\n  return data;\n}\n","import { css } from '@emotion/css';\nimport { Global } from '@emotion/react';\nimport Tree, { TreeNodeProps } from 'rc-tree';\nimport { Key, useEffect, useMemo, useState } from 'react';\n\nimport { GrafanaTheme2, StandardEditorProps } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { Button, Icon, Stack, useStyles2, useTheme2 } from '@grafana/ui';\nimport { AddLayerButton } from 'app/core/components/Layers/AddLayerButton';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { frameSelection, reorderElements } from 'app/features/canvas/runtime/sceneElementManagement';\n\nimport { getGlobalStyles } from '../../globalStyles';\nimport { Options } from '../../panelcfg.gen';\nimport { DragNode, DropNode } from '../../types';\nimport { doSelect, getElementTypes, onAddItem } from '../../utils';\nimport { TreeViewEditorProps } from '../element/elementEditor';\n\nimport { TreeNodeTitle } from './TreeNodeTitle';\nimport { getTreeData, onNodeDrop, TreeElement } from './tree';\n\nlet allowSelection = true;\n\nexport const TreeNavigationEditor = ({ item }: StandardEditorProps<unknown, TreeViewEditorProps, Options>) => {\n  const [treeData, setTreeData] = useState(getTreeData(item?.settings?.scene.root));\n  const [autoExpandParent, setAutoExpandParent] = useState(true);\n  const [expandedKeys, setExpandedKeys] = useState<Key[]>([]);\n  const [selectedKeys, setSelectedKeys] = useState<Key[]>([]);\n\n  const theme = useTheme2();\n  const globalCSS = getGlobalStyles(theme);\n  const styles = useStyles2(getStyles);\n\n  const selectedBgColor = theme.colors.primary.border;\n  const { settings } = item;\n  const selection = useMemo(\n    () => (settings?.selected ? settings.selected.map((v) => v?.getName()) : []),\n    [settings?.selected]\n  );\n\n  const selectionByUID = useMemo(\n    () => (settings?.selected ? settings.selected.map((v) => v?.UID) : []),\n    [settings?.selected]\n  );\n\n  useEffect(() => {\n    setTreeData(getTreeData(item?.settings?.scene.root, selection, selectedBgColor));\n    setSelectedKeys(selectionByUID);\n    setAllowSelection();\n  }, [item?.settings?.scene.root, selectedBgColor, selection, selectionByUID]);\n\n  if (!settings) {\n    return <div>No settings</div>;\n  }\n\n  const layer = settings.layer;\n  if (!layer) {\n    return <div>Missing layer?</div>;\n  }\n\n  const onSelect = (selectedKeys: Key[], info: { node: { dataRef: ElementState } }) => {\n    if (allowSelection && item.settings?.scene) {\n      doSelect(item.settings.scene, info.node.dataRef);\n    }\n  };\n\n  const allowDrop = () => {\n    return true;\n  };\n\n  const onDrop = (info: { node: DropNode; dragNode: DragNode; dropPosition: number; dropToGap: boolean }) => {\n    const destPos = info.node.pos.split('-');\n    const destPosition = info.dropPosition - Number(destPos[destPos.length - 1]);\n\n    const srcEl = info.dragNode.dataRef;\n    const destEl = info.node.dataRef;\n\n    const data = onNodeDrop(info, treeData);\n\n    setTreeData(data);\n    reorderElements(srcEl, destEl, info.dropToGap, destPosition);\n  };\n\n  const onExpand = (expandedKeys: Key[]) => {\n    setExpandedKeys(expandedKeys);\n    setAutoExpandParent(false);\n  };\n\n  const switcherIcon = (obj: TreeNodeProps) => {\n    if (obj.isLeaf) {\n      // TODO: Implement element specific icons\n      return <></>;\n    }\n\n    return (\n      <Icon\n        name=\"angle-right\"\n        title={'Node Icon'}\n        style={{\n          transform: `rotate(${obj.expanded ? 90 : 0}deg)`,\n          fill: theme.colors.text.primary,\n        }}\n      />\n    );\n  };\n\n  const setAllowSelection = (allow = true) => {\n    allowSelection = allow;\n  };\n\n  const onClearSelection = () => {\n    layer.scene.clearCurrentSelection();\n  };\n\n  const onTitleRender = (nodeData: TreeElement) => {\n    return <TreeNodeTitle nodeData={nodeData} setAllowSelection={setAllowSelection} settings={settings} />;\n  };\n\n  // TODO: This functionality is currently kinda broken / no way to decouple / delete created frames at this time\n  const onFrameSelection = () => {\n    if (layer.scene) {\n      frameSelection(layer.scene);\n    } else {\n      console.warn('no scene!');\n    }\n  };\n\n  const typeOptions = getElementTypes(settings.scene.shouldShowAdvancedTypes).options;\n\n  return (\n    <>\n      <Global styles={globalCSS} />\n      <Tree\n        selectable={true}\n        onSelect={onSelect}\n        draggable={true}\n        defaultExpandAll={true}\n        autoExpandParent={autoExpandParent}\n        showIcon={false}\n        allowDrop={allowDrop}\n        onDrop={onDrop}\n        expandedKeys={expandedKeys}\n        onExpand={onExpand}\n        treeData={treeData}\n        titleRender={onTitleRender}\n        switcherIcon={switcherIcon}\n        selectedKeys={selectedKeys}\n        multiple={true}\n      />\n\n      <Stack justifyContent=\"space-between\" direction=\"row\">\n        <div className={styles.addLayerButton}>\n          <AddLayerButton onChange={(sel) => onAddItem(sel, layer)} options={typeOptions} label={'Add item'} />\n        </div>\n        {selection.length > 0 && (\n          <Button size=\"sm\" variant=\"secondary\" onClick={onClearSelection}>\n            Clear selection\n          </Button>\n        )}\n        {selection.length > 1 && config.featureToggles.canvasPanelNesting && (\n          <Button size=\"sm\" variant=\"secondary\" onClick={onFrameSelection}>\n            Frame selection\n          </Button>\n        )}\n      </Stack>\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  addLayerButton: css({\n    marginLeft: '18px',\n    minWidth: '150px',\n  }),\n});\n","import { get as lodashGet } from 'lodash';\n\nimport { NestedPanelOptions, NestedValueAccess } from '@grafana/data/src/utils/OptionsUIBuilders';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { InstanceState } from '../../CanvasPanel';\nimport { PlacementEditor } from '../element/PlacementEditor';\nimport { optionBuilder } from '../options';\n\nimport { TreeNavigationEditor } from './TreeNavigationEditor';\n\nexport interface LayerEditorProps {\n  scene: Scene;\n  layer: FrameState;\n  selected: ElementState[];\n}\n\nexport function getLayerEditor(opts: InstanceState): NestedPanelOptions<LayerEditorProps> {\n  const { selected, scene } = opts;\n\n  if (!scene.currentLayer) {\n    scene.currentLayer = scene.root;\n  }\n\n  if (selected) {\n    for (const element of selected) {\n      if (element instanceof FrameState) {\n        scene.currentLayer = element;\n        break;\n      }\n\n      if (element && element.parent) {\n        scene.currentLayer = element.parent;\n        break;\n      }\n    }\n  }\n\n  const options = scene.currentLayer.options || { elements: [] };\n\n  return {\n    category: ['Layer'],\n    path: '--', // not used!\n\n    // Note that canvas editor writes things to the scene!\n    values: (parent: NestedValueAccess) => ({\n      getValue: (path) => {\n        return lodashGet(options, path);\n      },\n      onChange: (path, value) => {\n        if (path === 'type' && value) {\n          console.warn('unable to change layer type');\n          return;\n        }\n        const c = setOptionImmutably(options, path, value);\n        scene.currentLayer?.onChange(c);\n        scene.currentLayer?.updateData(scene.context);\n      },\n    }),\n\n    // Dynamically fill the selected element\n    build: (builder, context) => {\n      const currentLayer = scene.currentLayer;\n      if (currentLayer && !currentLayer.isRoot()) {\n        // TODO: the non-root nav option\n      }\n\n      builder.addCustomEditor({\n        id: 'content',\n        path: 'root',\n        name: 'Elements',\n        editor: TreeNavigationEditor,\n        settings: { scene, layer: scene.currentLayer, selected },\n      });\n\n      const ctx = { ...context, options };\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n      optionBuilder.addBackground(builder as any, ctx);\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n      optionBuilder.addBorder(builder as any, ctx);\n\n      if (currentLayer && !currentLayer.isRoot()) {\n        builder.addCustomEditor({\n          category: ['Layout'],\n          id: 'content',\n          path: '__', // not used\n          name: 'Constraints',\n          editor: PlacementEditor,\n          settings: {\n            scene: opts.scene,\n            element: currentLayer,\n          },\n        });\n      }\n    },\n  };\n}\n","import { useState } from 'react';\n\nimport { Tab, TabsBar } from '@grafana/ui/src';\n\nimport { InlineEditTabs } from '../../types';\n\ntype Props = {\n  onTabChange: (v: string) => void;\n};\n\nexport const TabsEditor = ({ onTabChange }: Props) => {\n  const [activeTab, setActiveTab] = useState<string>(InlineEditTabs.SelectedElement);\n\n  const tabs = [\n    { label: 'Selected Element', value: InlineEditTabs.SelectedElement },\n    { label: 'Element Management', value: InlineEditTabs.ElementManagement },\n  ];\n\n  const onCurrentTabChange = (value: string) => {\n    onTabChange(value);\n    setActiveTab(value);\n  };\n\n  return (\n    <>\n      <TabsBar>\n        {tabs.map((t, index) => (\n          <Tab\n            key={`${t.value}-${index}`}\n            label={t.label}\n            active={t.value === activeTab}\n            onChangeTab={() => onCurrentTabChange(t.value!)}\n          />\n        ))}\n      </TabsBar>\n    </>\n  );\n};\n","import { css } from '@emotion/css';\nimport { get as lodashGet } from 'lodash';\nimport { useMemo, useState } from 'react';\nimport { useObservable } from 'react-use';\n\nimport { DataFrame, GrafanaTheme2, PanelOptionsEditorBuilder, StandardEditorContext } from '@grafana/data';\nimport { PanelOptionsSupplier } from '@grafana/data/src/panel/PanelPlugin';\nimport { NestedValueAccess } from '@grafana/data/src/utils/OptionsUIBuilders';\nimport { useStyles2 } from '@grafana/ui/src';\nimport { AddLayerButton } from 'app/core/components/Layers/AddLayerButton';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { OptionsPaneCategory } from 'app/features/dashboard/components/PanelEditor/OptionsPaneCategory';\nimport { OptionsPaneCategoryDescriptor } from 'app/features/dashboard/components/PanelEditor/OptionsPaneCategoryDescriptor';\nimport { fillOptionsPaneItems } from 'app/features/dashboard/components/PanelEditor/getVisualizationOptions';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { activePanelSubject, InstanceState } from '../../CanvasPanel';\nimport { addStandardCanvasEditorOptions } from '../../module';\nimport { Options } from '../../panelcfg.gen';\nimport { InlineEditTabs } from '../../types';\nimport { getElementTypes, onAddItem } from '../../utils';\nimport { getConnectionEditor } from '../connectionEditor';\nimport { getElementEditor } from '../element/elementEditor';\nimport { getLayerEditor } from '../layer/layerEditor';\n\nimport { TabsEditor } from './TabsEditor';\n\nexport function InlineEditBody() {\n  const activePanel = useObservable(activePanelSubject);\n  const instanceState = activePanel?.panel.context?.instanceState;\n  const styles = useStyles2(getStyles);\n\n  const [activeTab, setActiveTab] = useState<string>(InlineEditTabs.SelectedElement);\n\n  const pane = useMemo(() => {\n    const p = activePanel?.panel;\n    const state: InstanceState = instanceState;\n    if (!(state && state.scene) || !p) {\n      return new OptionsPaneCategoryDescriptor({ id: 'root', title: 'root' });\n    }\n\n    const supplier = (builder: PanelOptionsEditorBuilder<Options>) => {\n      if (activeTab === InlineEditTabs.ElementManagement) {\n        builder.addNestedOptions(getLayerEditor(instanceState));\n      }\n\n      const selectedConnection = state.selectedConnection;\n      if (selectedConnection && activeTab === InlineEditTabs.SelectedElement) {\n        builder.addNestedOptions(\n          getConnectionEditor({\n            category: [`Selected connection`],\n            connection: selectedConnection,\n            scene: state.scene,\n          })\n        );\n      }\n\n      const selection = state.selected;\n      if (selection?.length === 1 && activeTab === InlineEditTabs.SelectedElement) {\n        const element = selection[0];\n        if (element && !(element instanceof FrameState)) {\n          builder.addNestedOptions(\n            getElementEditor({\n              category: [`Selected element (${element.options.name})`],\n              element,\n              scene: state.scene,\n            })\n          );\n        }\n      }\n\n      addStandardCanvasEditorOptions(builder);\n    };\n\n    return getOptionsPaneCategoryDescriptor(\n      {\n        options: p.props.options,\n        onChange: p.props.onOptionsChange,\n        data: p.props.data?.series,\n      },\n      supplier\n    );\n  }, [instanceState, activePanel, activeTab]);\n\n  const topLevelItemsContainerStyle = {\n    marginLeft: 15,\n    marginTop: 10,\n  };\n\n  const onTabChange = (tab: string) => {\n    setActiveTab(tab);\n  };\n\n  const typeOptions = getElementTypes(instanceState?.scene.shouldShowAdvancedTypes).options;\n  const rootLayer: FrameState | undefined = instanceState?.layer;\n\n  const noElementSelected =\n    instanceState &&\n    activeTab === InlineEditTabs.SelectedElement &&\n    instanceState.selected.length === 0 &&\n    instanceState.selectedConnection === undefined;\n\n  return (\n    <>\n      <div style={topLevelItemsContainerStyle}>{pane.items.map((item) => item.render())}</div>\n      <div style={topLevelItemsContainerStyle}>\n        <AddLayerButton onChange={(sel) => onAddItem(sel, rootLayer)} options={typeOptions} label={'Add item'} />\n      </div>\n      <div style={topLevelItemsContainerStyle}>\n        <TabsEditor onTabChange={onTabChange} />\n        {pane.categories.map((p) => renderOptionsPaneCategoryDescriptor(p))}\n        {noElementSelected && <div className={styles.selectElement}>Please select an element</div>}\n      </div>\n    </>\n  );\n}\n\n// Recursively render options\nfunction renderOptionsPaneCategoryDescriptor(pane: OptionsPaneCategoryDescriptor) {\n  return (\n    <OptionsPaneCategory {...pane.props} key={pane.props.id}>\n      <div>{pane.items.map((v) => v.render())}</div>\n      {pane.categories.map((c) => renderOptionsPaneCategoryDescriptor(c))}\n    </OptionsPaneCategory>\n  );\n}\n\ninterface EditorProps<T> {\n  onChange: (v: T) => void;\n  options: T;\n  data?: DataFrame[];\n}\n\nfunction getOptionsPaneCategoryDescriptor<T extends object>(\n  props: EditorProps<T>,\n  supplier: PanelOptionsSupplier<T>\n): OptionsPaneCategoryDescriptor {\n  const context: StandardEditorContext<unknown, unknown> = {\n    data: props.data ?? [],\n    options: props.options,\n  };\n\n  const root = new OptionsPaneCategoryDescriptor({ id: 'root', title: 'root' });\n  const getOptionsPaneCategory = (categoryNames?: string[]): OptionsPaneCategoryDescriptor => {\n    if (categoryNames?.length) {\n      const key = categoryNames[0];\n      let sub = root.categories.find((v) => v.props.id === key);\n      if (!sub) {\n        sub = new OptionsPaneCategoryDescriptor({ id: key, title: key });\n        root.categories.push(sub);\n      }\n      return sub;\n    }\n    return root;\n  };\n\n  const access: NestedValueAccess = {\n    getValue: (path) => lodashGet(props.options, path),\n    onChange: (path, value) => {\n      props.onChange(setOptionImmutably<T>(props.options, path, value));\n    },\n  };\n\n  // Use the panel options loader\n  fillOptionsPaneItems(supplier, access, getOptionsPaneCategory, context);\n  return root;\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  selectElement: css({\n    color: theme.colors.text.secondary,\n    padding: theme.spacing(2),\n  }),\n});\n","import { css } from '@emotion/css';\nimport { SyntheticEvent, useEffect, useRef, useState } from 'react';\nimport Draggable, { DraggableEventHandler } from 'react-draggable';\nimport { Resizable, ResizeCallbackData } from 'react-resizable';\n\nimport { Dimensions2D, GrafanaTheme2 } from '@grafana/data';\nimport { IconButton, Portal, useStyles2 } from '@grafana/ui';\nimport store from 'app/core/store';\nimport { Scene } from 'app/features/canvas/runtime/scene';\n\nimport { InlineEditBody } from './InlineEditBody';\n\ntype Props = {\n  onClose?: () => void;\n  id: number;\n  scene: Scene;\n};\n\nconst OFFSET_X = 10;\nconst OFFSET_Y = 32;\n\nexport function InlineEdit({ onClose, id, scene }: Props) {\n  const root = scene.root.div?.getBoundingClientRect();\n  const windowHeight = window.innerHeight;\n  const windowWidth = window.innerWidth;\n  const ref = useRef<HTMLDivElement>(null);\n  const styles = useStyles2(getStyles);\n  const inlineEditKey = 'inlineEditPanel' + id.toString();\n\n  const defaultMeasurements = { width: 400, height: 400 };\n  const widthOffset = root?.width ?? defaultMeasurements.width + OFFSET_X * 2;\n  const defaultX = root?.x ?? 0 + widthOffset - defaultMeasurements.width - OFFSET_X;\n  const defaultY = root?.y ?? 0 + OFFSET_Y;\n\n  const savedPlacement = store.getObject(inlineEditKey, {\n    x: defaultX,\n    y: defaultY,\n    w: defaultMeasurements.width,\n    h: defaultMeasurements.height,\n  });\n  const [measurements, setMeasurements] = useState<Dimensions2D>({ width: savedPlacement.w, height: savedPlacement.h });\n  const [placement, setPlacement] = useState({ x: savedPlacement.x, y: savedPlacement.y });\n\n  // Checks that placement is within browser window\n  useEffect(() => {\n    const minX = windowWidth - measurements.width - OFFSET_X;\n    const minY = windowHeight - measurements.height - OFFSET_Y;\n    if (minX < placement.x && minX > 0) {\n      setPlacement({ ...placement, x: minX });\n    }\n    if (minY < placement.y && minY > 0) {\n      setPlacement({ ...placement, y: minY });\n    }\n  }, [windowHeight, windowWidth, placement, measurements]);\n\n  const onDragStop: DraggableEventHandler = (event, dragElement) => {\n    let x = dragElement.x < 0 ? 0 : dragElement.x;\n    let y = dragElement.y < 0 ? 0 : dragElement.y;\n\n    setPlacement({ x: x, y: y });\n    saveToStore(x, y, measurements.width, measurements.height);\n  };\n\n  const onResizeStop = (event: SyntheticEvent<Element, Event>, data: ResizeCallbackData) => {\n    const { size } = data;\n    setMeasurements({ width: size.width, height: size.height });\n    saveToStore(placement.x, placement.y, size.width, size.height);\n  };\n\n  const saveToStore = (x: number, y: number, width: number, height: number) => {\n    store.setObject(inlineEditKey, { x: x, y: y, w: width, h: height });\n  };\n\n  return (\n    <Portal>\n      <div className={styles.draggableWrapper}>\n        <Draggable handle=\"strong\" onStop={onDragStop} position={{ x: placement.x, y: placement.y }}>\n          <Resizable height={measurements.height} width={measurements.width} onResize={onResizeStop}>\n            <div\n              className={styles.inlineEditorContainer}\n              style={{ height: `${measurements.height}px`, width: `${measurements.width}px` }}\n              ref={ref}\n            >\n              <strong className={styles.inlineEditorHeader}>\n                <div className={styles.placeholder} />\n                <div>Canvas Inline Editor</div>\n                <IconButton\n                  name=\"times\"\n                  size=\"xl\"\n                  className={styles.inlineEditorClose}\n                  onClick={onClose}\n                  tooltip=\"Close inline editor\"\n                />\n              </strong>\n              <div className={styles.inlineEditorContentWrapper}>\n                <div className={styles.inlineEditorContent}>\n                  <InlineEditBody />\n                </div>\n              </div>\n            </div>\n          </Resizable>\n        </Draggable>\n      </div>\n    </Portal>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  inlineEditorContainer: css({\n    display: 'flex',\n    flexDirection: 'column',\n    background: theme.components.panel.background,\n    border: `1px solid ${theme.colors.border.weak}`,\n    boxShadow: theme.shadows.z3,\n    zIndex: 1000,\n    opacity: 1,\n    minWidth: '400px',\n  }),\n  draggableWrapper: css({\n    width: 0,\n    height: 0,\n  }),\n  inlineEditorHeader: css({\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    background: theme.colors.background.canvas,\n    borderBottom: `1px solid ${theme.colors.border.weak}`,\n    height: '40px',\n    cursor: 'move',\n  }),\n  inlineEditorContent: css({\n    whiteSpace: 'pre-wrap',\n    padding: '10px',\n  }),\n  inlineEditorClose: css({\n    marginLeft: 'auto',\n  }),\n  placeholder: css({\n    width: '24px',\n    height: '24px',\n    visibility: 'hidden',\n    marginRight: 'auto',\n  }),\n  inlineEditorContentWrapper: css({\n    overflow: 'scroll',\n  }),\n});\n","import { Component } from 'react';\nimport * as React from 'react';\nimport { ReplaySubject, Subscription } from 'rxjs';\n\nimport { PanelProps } from '@grafana/data';\nimport { locationService } from '@grafana/runtime/src';\nimport { PanelContext, PanelContextRoot } from '@grafana/ui';\nimport { CanvasFrameOptions } from 'app/features/canvas/frame';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { getDashboardSrv } from 'app/features/dashboard/services/DashboardSrv';\nimport { PanelEditEnteredEvent, PanelEditExitedEvent } from 'app/types/events';\n\nimport { SetBackground } from './components/SetBackground';\nimport { InlineEdit } from './editor/inline/InlineEdit';\nimport { Options } from './panelcfg.gen';\nimport { AnchorPoint, CanvasTooltipPayload, ConnectionState } from './types';\n\ninterface Props extends PanelProps<Options> {}\n\ninterface State {\n  refresh: number;\n  openInlineEdit: boolean;\n  openSetBackground: boolean;\n  contextMenuAnchorPoint: AnchorPoint;\n  moveableAction: boolean;\n}\n\nexport interface InstanceState {\n  scene: Scene;\n  selected: ElementState[];\n  selectedConnection?: ConnectionState;\n}\n\nexport interface SelectionAction {\n  panel: CanvasPanel;\n}\n\nlet canvasInstances: CanvasPanel[] = [];\nlet activeCanvasPanel: CanvasPanel | undefined = undefined;\nlet isInlineEditOpen = false;\nlet isSetBackgroundOpen = false;\n\nexport const activePanelSubject = new ReplaySubject<SelectionAction>(1);\n\nexport class CanvasPanel extends Component<Props, State> {\n  declare context: React.ContextType<typeof PanelContextRoot>;\n  static contextType = PanelContextRoot;\n  panelContext: PanelContext | undefined;\n\n  readonly scene: Scene;\n  private subs = new Subscription();\n  needsReload = false;\n  isEditing = locationService.getSearchObject().editPanel !== undefined;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      refresh: 0,\n      openInlineEdit: false,\n      openSetBackground: false,\n      contextMenuAnchorPoint: { x: 0, y: 0 },\n      moveableAction: false,\n    };\n\n    // TODO: Will need to update this approach for dashboard scenes\n    // migration (new dashboard edit experience)\n    const dashboard = getDashboardSrv().getCurrent();\n    const allowEditing = this.props.options.inlineEditing && dashboard?.editable;\n\n    // Only the initial options are ever used.\n    // later changes are all controlled by the scene\n    this.scene = new Scene(\n      this.props.options.root,\n      allowEditing,\n      this.props.options.showAdvancedTypes,\n      this.props.options.panZoom,\n      this.props.options.infinitePan,\n      this.onUpdateScene,\n      this\n    );\n    this.scene.updateSize(props.width, props.height);\n    this.scene.updateData(props.data);\n    this.scene.inlineEditingCallback = this.openInlineEdit;\n    this.scene.setBackgroundCallback = this.openSetBackground;\n    this.scene.tooltipCallback = this.tooltipCallback;\n    this.scene.moveableActionCallback = this.moveableActionCallback;\n\n    this.subs.add(\n      this.props.eventBus.subscribe(PanelEditEnteredEvent, (evt: PanelEditEnteredEvent) => {\n        // Remove current selection when entering edit mode for any panel in dashboard\n        this.scene.clearCurrentSelection();\n        this.closeInlineEdit();\n      })\n    );\n\n    this.subs.add(\n      this.props.eventBus.subscribe(PanelEditExitedEvent, (evt: PanelEditExitedEvent) => {\n        if (this.props.id === evt.payload) {\n          this.needsReload = true;\n          this.scene.clearCurrentSelection();\n        }\n      })\n    );\n  }\n\n  componentDidMount() {\n    activeCanvasPanel = this;\n    activePanelSubject.next({ panel: this });\n\n    this.panelContext = this.context;\n    if (this.panelContext.onInstanceStateChange) {\n      this.panelContext.onInstanceStateChange({\n        scene: this.scene,\n        layer: this.scene.root,\n      });\n\n      this.subs.add(\n        this.scene.selection.subscribe({\n          next: (v) => {\n            if (v.length) {\n              activeCanvasPanel = this;\n              activePanelSubject.next({ panel: this });\n            }\n\n            canvasInstances.forEach((canvasInstance) => {\n              if (canvasInstance !== activeCanvasPanel) {\n                canvasInstance.scene.clearCurrentSelection(true);\n                canvasInstance.scene.connections.select(undefined);\n              }\n            });\n\n            this.panelContext?.onInstanceStateChange!({\n              scene: this.scene,\n              selected: v,\n              layer: this.scene.root,\n            });\n          },\n        })\n      );\n\n      this.subs.add(\n        this.scene.connections.selection.subscribe({\n          next: (v) => {\n            if (!this.context.instanceState) {\n              return;\n            }\n\n            this.panelContext?.onInstanceStateChange!({\n              scene: this.scene,\n              selected: this.context.instanceState.selected,\n              selectedConnection: v,\n              layer: this.scene.root,\n            });\n\n            if (v) {\n              activeCanvasPanel = this;\n              activePanelSubject.next({ panel: this });\n            }\n\n            canvasInstances.forEach((canvasInstance) => {\n              if (canvasInstance !== activeCanvasPanel) {\n                canvasInstance.scene.clearCurrentSelection(true);\n                canvasInstance.scene.connections.select(undefined);\n              }\n            });\n\n            setTimeout(() => {\n              this.forceUpdate();\n            });\n          },\n        })\n      );\n    }\n\n    canvasInstances.push(this);\n  }\n\n  componentWillUnmount() {\n    this.scene.subscription.unsubscribe();\n    this.subs.unsubscribe();\n    isInlineEditOpen = false;\n    isSetBackgroundOpen = false;\n    canvasInstances = canvasInstances.filter((ci) => ci.props.id !== activeCanvasPanel?.props.id);\n  }\n\n  // NOTE, all changes to the scene flow through this function\n  // even the editor gets current state from the same scene instance!\n  onUpdateScene = (root: CanvasFrameOptions) => {\n    const { onOptionsChange, options } = this.props;\n    onOptionsChange({\n      ...options,\n      root,\n    });\n\n    this.setState({ refresh: this.state.refresh + 1 });\n    activePanelSubject.next({ panel: this });\n  };\n\n  shouldComponentUpdate(nextProps: Props, nextState: State) {\n    const { width, height, data, options } = this.props;\n    let changed = false;\n\n    if (width !== nextProps.width || height !== nextProps.height) {\n      this.scene.updateSize(nextProps.width, nextProps.height);\n      changed = true;\n    }\n\n    if (data !== nextProps.data && !this.scene.ignoreDataUpdate) {\n      this.scene.updateData(nextProps.data);\n      changed = true;\n    }\n\n    if (options !== nextProps.options && !this.scene.ignoreDataUpdate) {\n      this.scene.updateData(nextProps.data);\n      changed = true;\n    }\n\n    if (this.state.refresh !== nextState.refresh) {\n      changed = true;\n    }\n\n    if (this.state.openInlineEdit !== nextState.openInlineEdit) {\n      changed = true;\n    }\n\n    if (this.state.openSetBackground !== nextState.openSetBackground) {\n      changed = true;\n    }\n\n    if (this.state.moveableAction !== nextState.moveableAction) {\n      changed = true;\n    }\n\n    // After editing, the options are valid, but the scene was in a different panel or inline editing mode has changed\n    const inlineEditingSwitched = this.props.options.inlineEditing !== nextProps.options.inlineEditing;\n    const shouldShowAdvancedTypesSwitched =\n      this.props.options.showAdvancedTypes !== nextProps.options.showAdvancedTypes;\n    const panZoomSwitched = this.props.options.panZoom !== nextProps.options.panZoom;\n    const infinitePanSwitched = this.props.options.infinitePan !== nextProps.options.infinitePan;\n    if (\n      this.needsReload ||\n      inlineEditingSwitched ||\n      shouldShowAdvancedTypesSwitched ||\n      panZoomSwitched ||\n      infinitePanSwitched\n    ) {\n      if (inlineEditingSwitched) {\n        // Replace scene div to prevent selecto instance leaks\n        this.scene.revId++;\n      }\n\n      this.needsReload = false;\n      this.scene.load(\n        nextProps.options.root,\n        nextProps.options.inlineEditing,\n        nextProps.options.showAdvancedTypes,\n        nextProps.options.panZoom,\n        nextProps.options.infinitePan\n      );\n      this.scene.updateSize(nextProps.width, nextProps.height);\n      this.scene.updateData(nextProps.data);\n      changed = true;\n    }\n\n    return changed;\n  }\n\n  openInlineEdit = () => {\n    if (isInlineEditOpen) {\n      this.forceUpdate();\n      this.setActivePanel();\n      return;\n    }\n\n    this.setActivePanel();\n    this.setState({ openInlineEdit: true });\n    isInlineEditOpen = true;\n  };\n\n  openSetBackground = (anchorPoint: AnchorPoint) => {\n    if (isSetBackgroundOpen) {\n      this.forceUpdate();\n      this.setActivePanel();\n      return;\n    }\n\n    this.setActivePanel();\n    this.setState({ openSetBackground: true });\n    this.setState({ contextMenuAnchorPoint: anchorPoint });\n\n    isSetBackgroundOpen = true;\n  };\n\n  tooltipCallback = (tooltip: CanvasTooltipPayload | undefined) => {\n    this.scene.tooltip = tooltip;\n    this.forceUpdate();\n  };\n\n  moveableActionCallback = (updated: boolean) => {\n    this.setState({ moveableAction: updated });\n    this.forceUpdate();\n  };\n\n  closeInlineEdit = () => {\n    this.setState({ openInlineEdit: false });\n    isInlineEditOpen = false;\n  };\n\n  closeSetBackground = () => {\n    this.setState({ openSetBackground: false });\n    isSetBackgroundOpen = false;\n  };\n\n  setActivePanel = () => {\n    activeCanvasPanel = this;\n    activePanelSubject.next({ panel: this });\n  };\n\n  renderInlineEdit = () => {\n    return <InlineEdit onClose={() => this.closeInlineEdit()} id={this.props.id} scene={this.scene} />;\n  };\n\n  renderSetBackground = () => {\n    return (\n      <SetBackground\n        onClose={() => this.closeSetBackground()}\n        scene={this.scene}\n        anchorPoint={this.state.contextMenuAnchorPoint}\n      />\n    );\n  };\n\n  render() {\n    return (\n      <>\n        {this.scene.render()}\n        {this.state.openInlineEdit && this.renderInlineEdit()}\n        {this.state.openSetBackground && this.renderSetBackground()}\n      </>\n    );\n  }\n}\n","import { css } from '@emotion/css';\n\nimport { StandardEditorProps, GrafanaTheme2 } from '@grafana/data';\nimport { Alert, Icon, Stack, useStyles2 } from '@grafana/ui';\n\nconst helpUrl = 'https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/canvas/';\n\nexport const PanZoomHelp = ({}: StandardEditorProps<string, unknown, unknown, unknown>) => {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <>\n      <Stack direction=\"row\">\n        <Alert\n          title=\"Pan and zoom controls\"\n          severity=\"info\"\n          buttonContent={<Icon name=\"question-circle\" size=\"xl\" />}\n          className={styles.alert}\n          onRemove={() => {\n            const newWindow = window.open(helpUrl, '_blank', 'noopener,noreferrer');\n            if (newWindow) {\n              newWindow.opener = null;\n            }\n          }}\n        >\n          <Stack direction=\"column\">\n            <ul>\n              <li>\n                Pan:\n                <ul>\n                  <li>Middle mouse</li>\n                  <li>CTRL + right mouse</li>\n                </ul>\n              </li>\n              <li>Zoom: Scroll wheel</li>\n              <li>Reset: Double click</li>\n            </ul>\n          </Stack>\n        </Alert>\n      </Stack>\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  alert: css({\n    '& div': { padding: '4px', alignItems: 'start' },\n    marginBottom: '0px',\n    marginTop: '5px',\n    padding: '2px',\n    'ul > li': { marginLeft: '10px' },\n  }),\n});\n","import { DataLink, DynamicConfigValue, FieldMatcherID, PanelModel, OneClickMode } from '@grafana/data';\nimport { CanvasElementOptions } from 'app/features/canvas/element';\n\nimport { Options } from './panelcfg.gen';\n\nexport const canvasMigrationHandler = (panel: PanelModel): Partial<Options> => {\n  const pluginVersion = panel?.pluginVersion ?? '';\n\n  // Rename text-box to rectangle\n  // Initial plugin version is empty string for first migration\n  if (pluginVersion === '') {\n    const root = panel.options?.root;\n    if (root?.elements) {\n      for (const element of root.elements) {\n        if (element.type === 'text-box') {\n          element.type = 'rectangle';\n        }\n      }\n    }\n  }\n\n  if (pluginVersion.startsWith('11.0')) {\n    // Migration for v11.0 for ellipse element refactor: https://github.com/grafana/grafana/pull/84205\n    const root = panel.options?.root;\n    if (root?.elements) {\n      for (const element of root.elements) {\n        if (element.type === 'ellipse') {\n          // Take existing ellipse specific background and border config and apply it to the element's general background and border config\n          if (element.config.backgroundColor) {\n            element.background = element.config.backgroundColor;\n            delete element.config.backgroundColor;\n          }\n          if (element.config.borderColor) {\n            element.border.color = element.config.borderColor;\n            delete element.config.borderColor;\n          }\n          if (element.config.width) {\n            element.border.width = element.config.width;\n            delete element.config.width;\n          }\n        }\n      }\n    }\n  }\n\n  if (parseFloat(pluginVersion) <= 11.3) {\n    // migrate links from field name overrides to elements\n    for (let idx = 0; idx < panel.fieldConfig.overrides.length; idx++) {\n      const override = panel.fieldConfig.overrides[idx];\n\n      if (override.matcher.id === FieldMatcherID.byName) {\n        let props: DynamicConfigValue[] = [];\n\n        // append override links to elements with dimensions mapped to same field name\n        for (const prop of override.properties) {\n          if (prop.id === 'links') {\n            addLinks(panel.options.root.elements, prop.value ?? [], override.matcher.options);\n          } else {\n            props.push(prop);\n          }\n        }\n\n        if (props.length > 0) {\n          override.properties = props;\n        } else {\n          panel.fieldConfig.overrides.splice(idx, 1);\n        }\n      }\n    }\n\n    // migrate oneClickLinks to oneClickMode\n    const root = panel.options?.root;\n    if (root?.elements) {\n      for (const element of root.elements) {\n        if (element.oneClickLinks) {\n          element.oneClickMode = OneClickMode.Link;\n          delete element.oneClickLinks;\n        }\n      }\n    }\n  }\n\n  return panel.options;\n};\n\nfunction addLinks(elements: CanvasElementOptions[], links: DataLink[], fieldName?: string) {\n  const varsNamesRegex = /(\\${__field.name})|(\\${__field.labels.*?})|(\\${__series.name})/g;\n\n  const linksCopy = [...links];\n  linksCopy.forEach((link) => {\n    const isFieldOrSeries = varsNamesRegex.test(link.url);\n    if (isFieldOrSeries) {\n      link.url = link.url.replace(varsNamesRegex, (match, fieldName1, fieldLabels1, seriesName1) => {\n        if (fieldName1 || seriesName1) {\n          return '${__data.fields[\"' + fieldName + '\"]}';\n        }\n\n        if (fieldLabels1) {\n          const labels = fieldLabels1.match(new RegExp('.labels' + '(.*)' + '}'));\n          return '${__data.fields[\"' + fieldName + '\"].labels' + labels[1] + '}';\n        }\n\n        return match;\n      });\n    }\n  });\n\n  elements.forEach((element) => {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    let cfg: Record<string, any> = element.config;\n\n    for (let k in cfg) {\n      let dim = cfg[k];\n\n      // todo: getFieldDisplayName?\n      if (dim.field === fieldName) {\n        element.links ??= [];\n        element.links.push(...linksCopy);\n      }\n    }\n  });\n}\n","import { FieldConfigProperty, PanelOptionsEditorBuilder, PanelPlugin } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\n\nimport { CanvasPanel, InstanceState } from './CanvasPanel';\nimport { getConnectionEditor } from './editor/connectionEditor';\nimport { getElementEditor } from './editor/element/elementEditor';\nimport { getLayerEditor } from './editor/layer/layerEditor';\nimport { PanZoomHelp } from './editor/panZoomHelp';\nimport { canvasMigrationHandler } from './migrations';\nimport { Options } from './panelcfg.gen';\n\nexport const addStandardCanvasEditorOptions = (builder: PanelOptionsEditorBuilder<Options>) => {\n  builder.addBooleanSwitch({\n    path: 'inlineEditing',\n    name: 'Inline editing',\n    description: 'Enable editing the panel directly',\n    defaultValue: true,\n  });\n\n  builder.addBooleanSwitch({\n    path: 'showAdvancedTypes',\n    name: 'Experimental element types',\n    description: 'Enable selection of experimental element types',\n    defaultValue: true,\n  });\n\n  builder.addBooleanSwitch({\n    path: 'panZoom',\n    name: 'Pan and zoom',\n    description: 'Enable pan and zoom',\n    defaultValue: false,\n    showIf: (opts) => config.featureToggles.canvasPanelPanZoom,\n  });\n  builder.addCustomEditor({\n    id: 'panZoomHelp',\n    path: 'panZoomHelp',\n    name: '',\n    editor: PanZoomHelp,\n    showIf: (opts) => config.featureToggles.canvasPanelPanZoom && opts.panZoom,\n  });\n  builder.addBooleanSwitch({\n    path: 'infinitePan',\n    name: 'Infinite panning',\n    description:\n      'Enable infinite panning - useful for expansive canvases. Warning: this is an experimental feature and currently only works well with elements that are top / left constrained',\n    defaultValue: false,\n    showIf: (opts) => config.featureToggles.canvasPanelPanZoom && opts.panZoom,\n  });\n};\n\nexport const plugin = new PanelPlugin<Options>(CanvasPanel)\n  .setNoPadding() // extend to panel edges\n  .useFieldConfig({\n    standardOptions: {\n      [FieldConfigProperty.Mappings]: {\n        settings: {\n          icon: true,\n        },\n      },\n      [FieldConfigProperty.Links]: {\n        hideFromDefaults: true,\n      },\n    },\n  })\n  .setMigrationHandler(canvasMigrationHandler)\n  .setPanelOptions((builder, context) => {\n    const state: InstanceState = context.instanceState;\n\n    addStandardCanvasEditorOptions(builder);\n\n    if (state && state.scene) {\n      builder.addNestedOptions(getLayerEditor(state));\n\n      const selection = state.selected;\n      const connectionSelection = state.selectedConnection;\n\n      if (selection?.length === 1) {\n        const element = selection[0];\n        if (!(element instanceof FrameState)) {\n          builder.addNestedOptions(\n            getElementEditor({\n              category: [`Selected element (${element.options.name})`],\n              element,\n              scene: state.scene,\n            })\n          );\n        }\n      }\n\n      if (connectionSelection) {\n        builder.addNestedOptions(\n          getConnectionEditor({\n            category: ['Selected connection'],\n            connection: connectionSelection,\n            scene: state.scene,\n          })\n        );\n      }\n    }\n  });\n"],"names":["AddLayerButton","onChange","options","label","NotFoundDisplay","config","notFoundItem","HorizontalConstraint","VerticalConstraint","BackgroundImageSize","HttpRequestMethod","ConnectionPath","defaultCanvasConnection","defaultCanvasElementOptions","defaultOptions","LayerActionID","InlineEditTabs","LineStyle","StrokeDasharray","ParamsEditor","value","paramName","setParamName","paramValue","setParamValue","changeParamValue","currentTarget","changeParamName","removeParam","key","updatedParams","param","addParam","newParams","e","a","b","isAddParamsDisabled","Stack","Input","IconButton","entry","callApi","api","updateLoadingStateCallback","interpolatedUrl","interpolateVariables","requestMatchesGrafanaOrigin","request","getRequest","error","text","panel","requestHeaders","url","getData","data","requestEndpoint","requestURL","grafanaURL","dummyStringSettings","httpMethodOptions","contentTypeOptions","APIEditor","context","defaultApiConfig","onEndpointChange","endpoint","onDataChange","onMethodChange","method","onContentTypeChange","contentType","formatCreateLabel","input","onQueryParamsChange","queryParams","onHeaderParamsChange","headerParams","renderJSON","json","JSONFormatter","renderTestAPIButton","Button","InlineFieldRow","InlineField","RadioButtonGroup","Select","Field","variantOptions","ButtonStyleEditor","defaultStyleConfig","onVariantChange","variant","ConnectionDirection","defaultBgColor","defaultTextColor","defaultLightTextColor","defaultThemeTextColor","QuickPlacement","Align","VAlign","ButtonDisplay","styles","getStyles","isLoading","setIsLoading","loading","onClick","Spinner","theme","buttonItem","dimensionContext","elementOptions","buttonConfig","getAPIConfig","builder","category","TextDimensionEditor","cloudItem","props","uniqueId","textConfig","background","border","ColorDimensionEditor","textTop","textLeft","textTransform","droneFrontItem","droneFrontTransformStyle","droneFrontConfig","droneSideItem","droneSidePitchTransformStyle","droneSideConfig","droneTopItem","fRightRotorAnimation","fLeftRotorAnimation","bRightRotorAnimation","bLeftRotorAnimation","droneTopTransformStyle","droneTopConfig","ellipseItem","svgStrokePathClass","IconDisplay","svgStyle","SanitizedSVG","iconItem","iconConfig","path","dummyFieldSettings","MetricValueDisplay","isSelected","scene","panelData","isEditMode","useObservable","of","getDisplayValue","fieldNotFound","fieldNames","MetricValueEdit","onFieldChange","field","selectedElement","FieldNamePicker","metricValueItem","parallelogramItem","RectangleDisplay","stylesFactory","rectangleItem","ServerDatabase","getServerStyles","ServerSingle","ServerStack","ServerTerminal","ServerType","outlineColor","serverItem","serverConfig","TextDisplay","TextEdit","textRef","saveText","onKeyDown","event","onKeyUp","textValue","textItem","triangleItem","windTurbineItem","windTurbineAnimation","windTurbineConfig","DEFAULT_CANVAS_ELEMENT_CONFIG","defaultElementItems","advancedElementItems","canvasElementRegistry","Registry","counter","SVGElements","ElementState","item","parent","target","hasHorizontalCenterConstraint","hasVerticalCenterConstraint","height","yOffset","rotationDelta","placement","calculatedRotation","transformScale","style","deltaX","deltaY","dirLR","dirTB","rotationInRadians","originalDirLR","originalDirTB","primaryDataLink","getRowIndex","rect","fallbackName","newName","trav","disablePointerEvents","constraint","vertical","horizontal","translate","elementType","elementContainer","parentContainer","parentBorderWidth","rotationTopOffset","rotationLeftOffset","rotationDegrees","rotationRadians","rotationOffset","calculateDelta","dimension1","dimension2","relativeTop","relativeBottom","relativeLeft","relativeRight","width","elementCenter","distanceFromCenter","ctx","frames","link","defaultField","css","color","image","v","visitor","oldName","isConnectionTarget","getConnectionsByTarget","connection","div","doSelect","element","selection","FrameState","targetElements","getElementTypes","shouldShowAdvancedTypes","current","getElementTypesOptions","items","selectables","alpha","option","onAddItem","sel","rootLayer","anchorPoint","newItem","newElementOptions","newElement","isConnectionSource","sceneByName","getConnections","connections","c","index","updateConnectionsForSource","con","calculateCoordinates","sourceRect","parentRect","info","sourceHorizontalCenter","sourceVerticalCenter","x1","y1","x2","y2","targetRect","targetHorizontalCenter","targetVerticalCenter","parentHorizontalCenter","parentVerticalCenter","calculateMidpoint","calculateAbsoluteCoords","valueX","valueY","calculateAngle","calculateDistance","fieldName","getConnectionStyles","defaultArrowSize","defaultArrowDirection","defaultArrowColor","lastRowIndex","strokeColor","strokeWidth","strokeRadius","arrowDirection","lineStyle","getLineStyle","shouldAnimate","getParentBoundingClientRect","getTransformInstance","getParent","prefixNames","prefix","classNames","_i","className","name","prefixCSS","_","selector","refs","i","Properties","properties","action","component","prototype","property","withMethods","methods","duplicate","propertyName","methodName","_a","args","result","RGB","RGBA","HSL","HSLA","COLOR_MODELS","FUNCTION","PROPERTY","ARRAY","OBJECT","STRING","NUMBER","UNDEFINED","IS_WINDOW","doc","prefixes","getCrossBrowserProperty","length","TRANSFORM","FILTER","ANIMATION","KEYFRAMES","OPEN_CLOSED_CHARACTERS","TINY_NUM","REVERSE_TINY_NUM","DEFAULT_UNIT_PRESETS","pos","size","__spreadArrays","s","il","r","k","j","jl","dot","a1","a2","b1","b2","isUndefined","isObject","isArray","isEqualSeparator","character","separator","isCharacterSpace","isSeparatorSpace","findOpen","openCharacter","texts","openCloseCharacters","isIgnore","findIgnore","findClose","otherText","closeCharacter","_loop_1","nextIndex","open","out_i_1","state_1","splitText","splitOptions","_b","isSeparateFirst","isSeparateOnlyOpenClose","_c","isSeparateOpenClose","_d","openClosedText","close","regexText","regex","chr","values","tempValues","resetTemp","_loop_2","out_i_2","nextOpenCloseCharacters","state_2","splitSpace","splitComma","splitBracket","matches","splitUnit","unit","camelize","str","all","letter","letter2","toArray","now","findIndex","arr","callback","defaultIndex","findLastIndex","findLast","defalutValue","firstTime","raf","currTime","id","caf","handle","getKeys","obj","getValues","keys","sortOrders","orders","index1","index2","convertUnitSize","sizeFunction","between","min","max","checkBoundSize","targetSize","compareSize","isMax","ratio","throttle","defaultSize","throttledSize","calculateBoundSize","minSize","maxSize","keepRatio","minWidth","minHeight","maxWidth","maxHeight","sum","nums","total","getRad","pos1","pos2","distX","distY","rad","getCenterPoint","points","getShapeDirection","center","pos1Rad","pos2Rad","num","reverseUnit","throttleArray","replaceOnce","fromText","toText","isOnce","flat","prev","cur","deepFlat","elements","cutHex","hex","hexToRGBA","h","g","toFullHex","hslToRGBA","hsl","l","x","m","rgb","stringToRGBA","colorArr","$","selectors","multi","hasClass","addClass","removeClass","reg","fromCSS","cssObject","getWindow","addEvent","el","type","listener","removeEvent","getDocument","getDocumentElement","getDocumentBody","isWindow","val","isNode","PolyMap","__proto","prevIndex","HashMap","SUPPORT_MAP","Link","prevLink","nextLink","orderChanged","changed","fixed","fromLinks","toLinks","from","to","fromLink","toLink","fromIndex","toIndex","Result","prevList","list","added","removed","maintained","changedBeforeAdded","ordered","pureChanged","fromBefore","toBefore","diff","findKeyCallback","mapClass","prevKeys","prevKeyMap","keyMap","removedMap","addedCount","removedCount","prevListIndex","listIndex","ListDiffer","newData","extendStatics","d","p","__extends","__","__assign","t","n","__rest","__spreadArray","pack","ar","fillKeys","arr2","fillProps","defaultProps","name_1","isDiff","getAttributes","otherProps","splitProps","attributes","events","name_2","findContainerNode","provider","base","removeNode","node","parentNode","executeHooks","hooks","hook","renderFunctionComponent","hooksIndex","Provider","ref","ps","contexts","nextElement","nextState","isForceUpdate","self","currentDepth","scheduledContexts","scheduledSubs","isContextUpdate","nextChildSubs","childs","sub","depth","child","renderProviders","prevProps","setCurrentInstance","fr","getCurrentInstance","getHooksIndex","setHooksInex","nextHooksIndex","Component","state","prevState","isUpdate","PureComponent","_super","createRef","defaultValue","refCallback","forwardRef","func","createComponent","contextValue","ComponentProvider","container","_this","nextProps","isMount","contextType","template","nextContexts","ef","def","diffAttributes","attrs1","attrs2","diffObject","name_3","diffEvents","events1","events2","provier","name_4","name_5","keys1","keys2","diffStyle","style1","style2","beforeName","name_6","name_7","name_8","getNativeEventName","ElementProvider","isRemove","eventName","contextValues","containerNode","isSVG","prevAttributes","prevEvents","nextAttributes","nextEvents","name_9","findDOMNode","comp","providers","findNodeProvider","children","ContainerProvider","TextProvider","diffProviders","containerProvider","childrenKeys","childrenProvider","next","createProvider","childProvider","getNextSibiling","childProviders","providerClass","updatedHooks","hyd","updated","nodeProvider","renderProvider","isProvider","render","renderSelf","createContext","$_subs","Consumer","getContext","mainComponent","subs","Portal","createPortal","_renderToString","parentContexts","stringProps_1","styleName","styleValue","strings","renderToString","renderSelfToString","checkHookInfo","inst","prevHt","defaultFunction","deps","contextId","providerComponent","st","nextValue","effect","unshift","effects","useImperativeHandle","some","getUserAgent","agent","userAgent","execRegExp","pattern","hasUserAgentData","userAgentData","brands","findVersion","versionTest","convertVersion","findPreset","presets","userPreset","version","preset","findPresetBrand","brandInfo","findBrand","brand","BROWSER_PRESETS","CHROMIUM_PRESETS","WEBKIT_PRESETS","WEBVIEW_PRESETS","OS_PRESETS","parseUserAgentData","osData","isMobile","firstBrand","browser","os","chromiumBrand","webkitBrand","platform_1","browserBrand","parseUserAgent","nextAgent","browserPreset","browserVersion","osPreset","osVersion","chromiumPreset","webkitPreset","getAccurateAgent","agentInfo","add","matrix","inverseMatrix","startIndex","fromX","swap","iv","divide","ignoreDimension","newMatrix","invert","createIdentityMatrix","identityIndex","targetStartIndex","targetIndex","transpose","getOrigin","originMatrix","w","fromTranslation","convertPositionMatrix","convertDimension","multiplies","matrixes","multiply","matrix2","plus","nextPos","minus","convertCSStoMatrix","is2d","convertMatrixtoCSS","calculate","rotateX3d","rotateY3d","rotateZ3d","createRotateMatrix","scale3d","sx","sy","sz","rotate","translate3d","tx","ty","tz","matrix3d","matrix1","cos","sin","createScaleMatrix","scale","createOriginMatrix","origin","createWarpMatrix","pos0","pos3","nextPos0","nextPos1","nextPos2","nextPos3","x0","y0","x3","y3","u0","v0","u1","v1","u2","v2","u3","v3","getCenter","createMatrix","parseMat","transform","toMat","parse","getElementMatrix","calculateMatrixDist","res","getDistElementMatrix","matrixInfos","matrixFunction","functionValue","transforms","functionName","nextSize_1","posX","posY","posZ","nextSize","_e","_f","_g","_h","unitValue","childrenCount","ChildrenDiffer","EventEmitter","resolve","isStop","listeners","getDefaultScrollPosition","checkDefaultScrollEvent","getContainerElement","DragScroll","inputEvent","top","left","clientX","clientY","threshold","_startRect","_startPos","direction","prevScrollPos","throttleTime","isDrag","nextScrollPos","offsetX","offsetY","nextDirection","getScrollPosition","useScroll","nowTime","distTime","checkScrollEvent","tinyThrottle","isSameConstants","linearConstants1","linearConstants2","isSamePoint","point1","point2","getAreaSize","point","nextPoint","fitPoints","getMinMaxs","minX","minY","maxX","maxY","ratioX","ratioY","xs","ys","isInside","excludeLine","y","xLine","xLinearConstants","getLinearConstants","lines","convertLines","intersectionPosInfos","line","linearConstants","standardPoint","xPoints","getPointsOnLines","getIntersectionPointsByConstants","linePoint","intersectionCount","xMap","prevValue","getDistanceFromPointToConstants","dx","dy","c1","c2","isZeroA","isZeroB","results","getIntersectionPoints","line1","line2","isLimit","isPointOnLine","minMaxs","order","minMax","right","bottom","pointX","pointY","getOverlapPointInfos","points1","points2","targetPoints1","targetPoints2","lines1","lines2","linearConstantsList1","linearConstantsList2","overlapInfos","linePointInfos","intersectionPoints","isNext","pointMap","getOverlapPoints","infos","isConnectedLine","prevIndex1","prevIndex2","nextIndex1","nextIndex2","getOverlapAreas","areas","area","findReversedAreas","isFirst","nextPoints1","nextArea","areaPoint","nextPoint2","point2Index","findConnectedAreas","getUnoverlapAreas","overlapAreas","unoverlapAreas","overlapArea","nextOverlapArea","connectedAreas","firstConnectedArea","lastPoint_1","firstPoint","firstIndex","getOverlapSize","getRotatiion","touches","isMultiTouch","getEventClients","getClients","getClient","isMouseEvent","getPosition","clients","prevClients","startClients","getAverageClient","originalClientX","originalClientY","prevX","prevY","startX","startY","sumClient","minLength","client","ClientStore","isAdd","position","positions","movement","currentClient","prevClient","INPUT_TAGNAMES","Gesto","targets","isTrusted","isDragAPI","pinchOutside","preventWheelClick","preventRightClick","preventDefault","checkInput","dragFocusedInput","preventClickEventOnDragStart","preventClickEventOnDrag","preventClickEventByCondition","useTouch","isDragStart","activeElement","tagName","hasInput","hasContentEditable","activeTagName","timer","isScroll","dragResult","clientsLength","currentTime","isDouble","firstTarget","checkWindowBlur","passive_1","isCallDrag","store","nextClients","currentData","pinchThreshold","isPinch","isPrevDrag","isFirstDrag","storePosition","win","passive","hash","stringHash","getHash","getShadowRoot","parentElement","rootNode","replaceStyle","trimmedSelector","subSelector","trimmedSubSelector","injectStyle","shadowRoot","styled","injectClassName","styleElement","count","injectCount","StyledElement","defaultStyled","tag","injector","Styled","Tag","cssId","cspNonce","targetRef","injectResult","__decorate","decorators","desc","__values","o","__read","makeAble","able","DIRECTIONS4","DIRECTIONS","getSVGCursor","degree","getCursorCSS","degree45","defaultCursor","IS_WEBKIT","IS_WEBKIT605","navi","browserName","IS_CHROME","IS_CHROMIUM","chromiumVersion","IS_CHROMIUM109","IS_FIREFOX","IS_SAFARI_ABOVE15","PREFIX","directionCSS","dir","originX","originY","offset","MOVEABLE_CSS","NEARBY_POS","FLOAT_POINT_NUM","MIN_SCALE","MAX_NUM","MIN_NUM","DIRECTION_REGION_TO_DIRECTION","DIRECTION_INDEXES","DIRECTION_ROTATIONS","MOVEABLE_METHODS","setCustomDrag","delta","isConvert","ableName","datas","ableDatas","convertDragDist","CustomGesto","originalDatas","calculateElementPosition","is3d","poses","calculatePoses","x4","y4","calculatePosition","sign","calculatePointerDist","moveable","moveableClientRect","rootMatrix","calculateInversePosition","getDragDist","setDragStart","allMatrix","beforeMatrix","offsetMatrix","targetMatrix","transformOrigin","getTransformDirection","resolveTransformEvent","nextTransforms","nextTransformAppendedIndexes","convertTransformInfo","targetFunction","matFunctionName","convertTransformFormat","dist","getTransformDist","getBeforeDragDist","bx","by","getTransfromMatrix","isAfter","beforeTransform","afterTransform","beforeTransform2","afterTransform2","targetAllTransform","nextTargetMatrix","res1","afterTargetMatrix","inverseBeforeMatrix","startDragBeforeDist","absoluteOrigin","isBefore","startDragDist","getInverseDragDist","calculateTransformOrigin","prevWidth","prevHeight","prevOrigin","prevSize","measureRatio","getPosIndexesByDirection","indexes","getPosesByDirection","getPosBySingleDirection","getPosByDirection","startPos","fixedDirection","fixedPos","getNextMatrix","getAbsoluteMatrix","getNextTransformMatrix","isAllTransform","targetTransform","scaleMatrix","fillTransformStartEvent","getBeforeRenderableDatas","setTransformIndex","setDefaultTransformIndex","startTransforms","fillOriginalTransform","getNextTransforms","getNextTransformText","getNextStyle","fillTransformEvent","nextTransform","drag","Draggable","fillCSSObject","getTranslateFixedPosition","fixedOffset","nextMatrix","nextFixedPosition","getDirectionOffset","getTranslateDist","fixedPosition","groupable","groupLeft","groupTop","getScaleDist","getDirectionByPos","fixedOffsetPosition","getRotateDist","rotateDist","getResizeDist","nextOrigin","getAbsolutePosition","getAbsolutePosesByState","getGestoData","targetGesto","controlGesto","getIndividualTransforms","getStyle","individualTransforms","getMatrixStackInfo","checkContainer","documentElement","requestEnd","isEnd","targetTransformOrigin","hasFixed","offsetContainer","getOffsetInfo","zoom","getCachedStyle","getElementTransform","isFixed","getTransformMatrix","offsetParent","isOffsetEnd","isStatic","parentClientLeft","parentClientTop","fixedClientLeft","fixedClientTop","fixedInfo","getPositionFixedInfo","length_1","convert3DMatrixes","getOffsetPosInfo","hasOffset","origin_1","targetOrigin","offsetPos","offsetLeft","offsetTop","getSVGMatrix","targetZoom","offsetInfo","offsetZoom","parentSlotElement","customOffsetParent","customOffsetLeft","customOffsetTop","margin","getBodyOffset","isElementTarget","scrollLeft","scrollTop","cacheStyleMap","clientRectStyleMap","matrixContainerInfos","setStoreCache","useCache","getCachedClientRect","clientRect","nextClientRect","getClientRect","getCachedMatrixContainerInfo","result_1","cache","nextStyle_1","cached","fillChildEvents","groupableDatas","childDatas","triggerChildGesto","isStart","moveables","childEvents","eventParams","ev","childMoveable","gestos","childEvent","triggerChildAbles","eachEvent","startChildDist","parentDatas","startPositions","originalX","originalY","renderDirectionControlsByInfos","renderDirections","React","renderPoses","rotationRad","getProps","degRotation","absDegree","directionMap","renderState","renderDirectionMap","directionSign","directionRotation","dataAttrs","getControlTransform","renderDirectionControls","defaultDirections","directions","displayAroundControls","renderAroundControls","renderLine","rotation","renderEdgeLines","edge","getRenderDirections","renderDiagonalDirections","renderAllDirections","checkBoundPoses","bounds","verticalPoses","horizontalPoses","nextBounds","checkBounds","getBounds","externalBounds","containerHeight","containerWidth","clientLeft","clientTop","snapOffsetLeft","snapOffsetTop","snapOffsetRight","snapOffsetBottom","isCSS","checkBoundKeepRatio","endPos","endX","endY","abs","isBottom","isRight","verticalInfo","horizontalInfo","isBound","isVertical","startBoundPos","endBoundPos","minPos","maxPos","boundInfos","isBoundRotate$1","relativePoses","boundRect","nextPoses","boundRotate","vec","boundPos","getDistSize","checkRotateBounds","prevPoses","relativeRad1","relativeRad2","nextRad","VERTICAL_NAMES","HORIZONTAL_NAMES","SNAP_SKIP_NAMES_MAP","VERTICAL_NAMES_MAP","HORIZONTAL_NAMES_MAP","getInitialBounds","hasGuidelines","snappable","innerBounds","verticalGuidelines","horizontalGuidelines","snapGridWidth","snapGridHeight","guidelines","enableSnap","getSnapDirections","snapDirections","mapSnapDirectionPoses","snapPoses","nextSnapDirections","nextSnapPoses","splitSnapDirectionPoses","horizontalNames","verticalNames","calculateContainerPos","containerRect","clientPos","solveLineConstants","NAME_snapRotationThreshold","NAME_snapRotationDegrees","NAME_snapHorizontalThreshold","NAME_snapVerticalThreshold","checkMoveableSnapPoses","posesX","posesY","dirXs","dirYs","customSnapVerticalThreshold","customSnapHorizontalThreshold","snapThresholdMultiples","snapHorizontalThreshold","selectValue","snapVerticalThreshold","checkSnapPoses","multiples","checkSnap","checkSnapKeepRatio","getTinyDist","verticalSnapInfo","horizontalSnapInfo","getNearestSnapGuidelineInfo","isVerticalSnap","verticalGuideline","isHorizontalSnap","horizontalGuideline","horizontalPos","verticalPos","isSnap","getStringDirection","stringDirection","checkSnaps","horizontalDirection","verticalDirection","snapInfo","posInfo","guidelineInfo","guideline","targetType","targetPoses","snapThreshold","dirs","posType","snapPosInfos","targetPos","guidelineInfos","snapPosInfo","getSnapInfosByDirection","snapDirection","nextDir","checkSnapBoundPriority","aDist","bDist","getNearOffsetInfo","offsets","aSign","bSign","aOffset","bOffset","getCheckSnapDirections","endDirection_1","signX","signY","signs","isStartLine","cx","cy","hitTestLine","test1","test2","isSameStartLine","dots","centerSign","checkInnerBoundDot","start","end","checkInnerBound","verticalSign","horizontalSign","lineConstants","leftLine","topLine","rightLine","bottomLine","topBoundInfo","checkLineBoundCollision","bottomBoundInfo","leftBoundInfo","rightBoundInfo","isAllVerticalBound","isVerticalBound","isAllHorizontalBound","isHorizontalBound","verticalOffset","maxOffset","horizontalOffset","isAllBound","boundLine","isRender","dot1","boundDot1","boundDot2","dy2","dx2","hasDx","hasDy","slope","getInnerBoundInfo","lineInfos","multiple","sizeOffset","getInnerBoundDragInfo","getCheckInnerBoundLineInfos","innerBoundInfo","widthOffsetInfo","heightOffsetInfo","getCheckSnapLineDirections","lineDirections","virtualPoses","dir1","dir2","virtualLine","isBoundRotate","boundDots","getDistPointLine","solveReverseLine","checkRotateInnerBounds","dotInfos","lineRad","lineDist","dotDist","dotRad","distRad","nextRad1","nextRad2","checkInnerBoundPoses","boundMap","pos4","lineInfo","isHorizontalStart","isVerticalStart","solveEquation","snapOffset","solveNextOffset","dist1","dist2","isOutside","widthOffset","heightOffset","getSnapBound","boundInfo","checkThrottleDragRotate","throttleDragRotate","adjustPoses","adjustPos","prevDistY","checkSnapBoundsDrag","ignoreSnap","getAbsolutePoses","getRect","boundPoses","checkMoveableSnapBounds","verticalSnapBoundInfo","horizontalSnapBoundInfo","verticalInnerBoundInfo","horizontalInnerBoundInfo","horizontalBoundInfos","verticalBoundInfos","horizontalDist","verticalDist","checkSnapBounds","guideines","checkSnapRightLine","snapBoundInfo","rad180","isHorizontalLine","isVerticalLine","getSnapBoundInfo","isRequest","startDirection","endDirection","otherStartPos","otherEndPos","checkSnapBoundsKeepRatio","otherHorizontalOffset","isOtherHorizontalBound","isOtherHorizontalSnap","otherVerticalOffset","isOtherVerticalBound","isOtherVerticalSnap","snapLine","getSnapBoundOffset","horizontalBoundInfo","verticalBoundInfo","checkMaxBounds","left_1","top_1","right_1","bottom_1","otherDirection","isCheckVertical","isCheckHorizontal","otherPos","deg","nextOtherPos","isHeightOutside","isWidthOutside","hideThrottleDragRotateLine","dragInfo","beforeOrigin","parentEvent","parentGesto","startCheckSnapDrag","params","fillParams","triggerEvent","parentFlag","deltaOffset","useSnap","isGroup","parentThrottleDrag","prevDist","prevBeforeDist","startValue","parentMoveable","throttleDrag","dragRotateRad","startDragRotate","ry","rx","beforeTranslate","beforeDist","beforeDelta","fillEndParams","nextParams","passDelta","getFixedDirectionInfo","getOffsetFixedDirectionInfo","nextFixedOffset","getOffsetFixedPositionInfo","offsetFixedPosition","directionCondition$2","getDirectionCondition","Resizable","getDirectionViewClassName","parentDirection","parentFixedDirection","getTotalDirection","setRatio","setFixedDirection","setFixedPosition","setMin","setMax","nextMaxSize","startWidth","startHeight","parentKeepRatio","dragClient","parentDist","resolveMatrix","isResize","startOffsetWidth","startOffsetHeight","isWidth","startOffsetMatrix","startTransformOrigin","targetN","nextAllMatrix","resizeFormat","throttleResize","keepRatioFinally","sizeDirection","distWidth","distHeight","getNextBoundingSize","getOffsetSizeDist","nextWidth","nextHeight","boundingWidth","boundingHeight","nextFixedDirection","snapDist","checkSnapResize","computeSize","isNoSnap","inverseDelta","fillAfterTransform","errorWidth","errorHeight","isErrorWidth","isErrorHeight","originalEvents","parentStartOffsetWidth","parentStartOffsetHeight","updateGroupMin","originalMinSize","childMinSize","childStartOffsetWidth","childStartOffsetHeight","parentMinWidth","parentMinHeight","updateGroupMax","originalMaxSize","childMaxSize","parentMaxWidth","parentMaxHeight","catchEvent","parentScale","setRotateStartInfo","startAbsoluteOrigin","getAbsoluteDist","defaultDeg","prevDeg","normalizedPrevDeg","loop","getAbsoluteDistByClient","getRotateInfo","moveableRect","throttleRotate","prevSnapDeg","snapRotation","checkSnapRotate","snapDeg","getRotationPositions","rotationPosition","radPoses","getRotationRad","isReverse","dragControlCondition","rotationTarget","getRefTargets","Rotatable","rotatable","rotateAroundControls","resolveAblesWithRotatable","jsxs","ables","resolveMap_1","directionControlInfos","parentRotate","beforeDirection","resizeStart","startClientX","startClientY","externalRotate","inputTarget","regionDirection","controlDirection","clientPoses","calculateMoveableClientPositions","originalFixedPosition_1","fixedBeforeOrigin","fixedAfterOrigin","posDelta","dragStart","resolveAble","getTotalOrigin","rotatation","clientDistX","clientDistY","groupDelta","beforeInfo","afterInfo","absoluteInfo","isRotate","targetDirection","beforeRotation","absoluteDelta","absoluteDist","absoluteRotation","startRotation","absoluteStartRotation","nextClientX","nextClientY","nextRotation","inverseDist","dragEvent","transformEvent","parentDistance","resize","resizeEvent","parentLeft","parentTop","parentBeforeOrigin","childClient","startGroupClient","prevClientX","prevClientY","distRotate","renderGuideline","isHorizontal","scaleType","renderInnerGuideline","renderSnapPoses","renderPos","renderGuidelines","isDisplayInnerSnapDigit","mainNames","targetStart","targetEnd","hide","elementRect","renderDigitLine","lineType","gap","snapDigit","isDisplaySnapDigit","snapDistFormat","sizeName","absGap","snapSize","groupByElementGuidelines","otherIndex","names","groupBy","nextGuidelines","inner","elementRect1","elementRect2","renderDashedGuidelines","rendered","groups","sideNames","sidePos","prevRect","nextRect","size1","size2","renderPos1","renderPos2","renderGapGuidelines","targetSideStart","targetSideEnd","gapRects","sideStartPos","sideEndPos","sideCenterPos","getTotalGuidelines","containerClientRect","overflow","containerClientHeight","containerClientWidth","snapGap","maxSnapElementGuidelineDistance","isDisplayGridGuidelines","elementGuidelines","getElementGuidelines","totalGuidelines","getGapGuidelines","getGridGuidelines","getDefaultGuidelines","checkBetweenRects","snapThresholds","maxSnapElementGapDistance","elementRects","gapGuidelines","targetCenter","targetStart2","targetEnd2","snapThresholdMap","getDist","nextElementRects","snapRect1","snapRect2","rect1","rect2","rect1Start","rect1End","rect2Start","rect2End","isCenter","startGridGroupGuidelines","snapGridAll","snapRenderInfo","hasDirection","rect_1","children_1","posName","clientOffset","rectSize","rectPos","childSizes","firstChildSize","childSnapSizes","rectRatio","childSize","startOffset","snapThresholdInfo","defaultSnapGridWidth","defaultSnapGridHeight","pushGuideline","distance","prevValues","snapRect","nextElementGuidelines","getRefTarget","nextValues","getSnapElementRects","elementSnapDirections","topValue","leftValue","rightValue","bottomValue","centerValue","middleValue","rectTop","rectLeft","sizes","getObjectGuidelines","containerSize","posGuideline","snapWidth","snapHeight","offsetDelta","containerLeft","containerTop","elementLeft","elementTop","elementRight","elementBottom","checkSnapInfo","snapContainer","snapContainerTarget","snapContainerRect","offset1","getDragDistByState","offset2","getNextFixedPoses","nextFixedPos","normalized","getSizeOffsetInfo","innerBoundLineInfos","recheckSizeByTwoDirection","snapPos","nextWidthOffset","nextHeightOffset","checkSizeDist","getNextPoses","isWidthBound","isHeightBound","widthDist","heightDist","isGetWidthOffset","bumpDegree","baseDeg","deg1","deg2","getMinDegreeDistance","deg3","snapRotationThreshold","snapRotationDegrees","origin2_1","rad_1","sorted","firstDegree","checkSnapScale","sizeDist","getSnapGuidelines","posInfos","addBoundGuidelines","verticalSnapPoses","horizontalSnapPoses","innerBoundMap","verticalInnerBoundPoses","horizontalInnerBoundPoses","innerPos","directionCondition$1","Snappable","targetTop","targetLeft","snapRenderThreshold","watchValue","minLeft","minTop","externalPoses","snapInfos","hasExternalPoses","externalRect","verticalPosInfos","horizontalPosInfos","allGuidelines","nextBoundMap","nextInnerBoundMap","multiply2","defaultSync","fn","measureSVGSize","viewBox","getSVGViewBox","getBeforeTransformOrigin","relativeOrigin","getTransformOrigin","getTransformOriginArray","computedTransform","baseVal","lastParent","isParent","checkZoom","getTargetStyle","hasSlot","assignedSlotParentElement","isCustomElement","targetPosition","willChange","slotParentNode","targetParentNode","getSVGGraphicsOffset","getBodyStyle","bodyPosition","marginLeft","marginTop","fixedContainer","hasTransform","body","makeMatrixCSS","clientWidth","clientHeight","viewBoxWidth","viewBoxHeight","scaleX","scaleY","preserveAspectRatio","align","meetOrSlice","svgOrigin","xAlign","yAlign","scaleDimension","isGTarget","isFillBox","bbox","rectWidth","rectHeight","calculateRect","getSVGOffset","targetInfo","getSize","mat","prevLeft","prevTop","posOrigin","rectOrigin","mat2","nextLeft","nextTop","distLeft","distTop","rootClientRect","rootPoses","getDiagonalSize","offsetWidth","offsetHeight","cssWidth","cssHeight","contentWidth","contentHeight","minOffsetWidth","minOffsetHeight","maxOffsetWidth","maxOffsetHeight","inlineCSSWidth","inlineCSSHeight","svg","targetStyle","boxSizing","borderLeft","borderRight","borderTop","borderBottom","paddingLeft","paddingRight","paddingTop","paddingBottom","horizontalPadding","verticalPadding","horizontalBorder","verticalBorder","getParentStyle","resetClientRect","getExtendsRect","isRoot","extendsRect","getClientRectByPosition","isExtends","baseTop","baseLeft","convertTransformOriginArray","getDirection","direciton","unsetAbles","isControl","unsetGesto","gestoName","gesto","resolvedEvent","prevEvent","nextEvent","isBeforeEvent","isManager","pseudoElt","filterAbles","triggerAblesSimultaneously","enabledAbles","ableGroups","equals","groupKeys","groupKey","keyIndex","group","groupByMap","calculatePadding","xAdded","yAdded","nextAdded","convertCSSSize","isRelative","checkAbles","beforeFunctionTexts","beforeFunctionTexts2","targetFunctionText","afterFunctionTexts","afterFunctionTexts2","beforeFunctions","beforeFunctions2","afterFunctions","afterFunctions2","targetFunctions","beforeFunctionMatrix","beforeFunctionMatrix2","afterFunctionMatrix","afterFunctionMatrix2","allFunctionMatrix","isArrayFormat","isSelector","userTargets","getAbsoluteRotation","getSizeDistByDist","startSize","standardRad","signSize","startWidthSize","startHeightSize","secondRad","firstRad","distSize","pinchScale","startFixedDirection","directionsDists","directionRatios","ratioDistance","dist_1","convertTransformUnit","xy","leftOrigin","rightOrigin","originObject","nextOriginObject","rotatePosesInfo","isDeepArrayEquals","arr1","value1","value2","isArray1","isArray2","valueKey","countEach","getPaddingBox","padding","Pinchable","angle","pinchable","controlEventName","pinchAbles","ableEvent","directionCondition","Scalable","setMinScaleSize","setMaxScaleSize","isScale","throttleScale","tempScaleValue","getNextScale","stateDirection","nextScale","distSign","isSelfPinch","startOffsetSize","scaleSize","distText","scaleText","isZeroScale","scaleEndParam","moveableScale","getMiddleLinePos","getTriangleRad","rad1","rad2","isValidPos","poses1","poses2","pi","Warpable","resizable","scalable","warpable","linePosFrom1","linePosFrom2","linePosFrom3","linePosFrom4","linePosTo1","linePosTo2","linePosTo3","linePosTo4","targetInverseMatrix","prevMatrix","isWarp","posIndexes","absolutePoses","selectedPoses","nearByPoses","afterMatrix","totalMatrix","AREA_PIECES","AREA_PIECE","AVOID","VIEW_DRAGGING","restoreStyle","renderPieces","DragArea","dragArea","passDragArea","areaElement","rects","Origin","originStyle","scrollContainer","Scrollable","scrollOptions","dragScroll","scrollContainerElement","scrollThreshold","scrollThrottleTime","Default","Padding","paddingDirections","paddingPos1","paddingPos2","paddingPos3","paddingPos4","RADIUS_DIRECTIONS","calculateRatio","sumSize","sumRatio","HORIZONTAL_RADIUS_ORDER","VERTICAL_RADIUS_ORDER","HORIZONTAL_RADIUS_DIRECTIONS","VERTICAL_RADIUS_DIRECTIONS","getRadiusStyles","clipStyles","radiusPoses","raws","rawPos","getRadiusRange","controlPoses","horizontalRange","verticalRange","clipPose","getRadiusValues","minCounts","full","splitIndex","splitLength","horizontalValues","verticalValues","horizontalValuesLength","verticalValuesLength","hasVerticalValues","nwValue","neValue","seValue","_j","swValue","_k","_l","wnValue","_m","enValue","_o","esValue","_p","wsValue","horizontalRawPoses","verticalRawPoses","nextHorizontalPoses","nextVerticalPoses","removeRadiusPos","radiuslIndex","deleteCount","addRadiusPos","horizontalIndex","verticalIndex","radiusX","radiusY","startVerticalIndex","splitRadiusPoses","horizontals","verticals","CLIP_DIRECTIONS","CLIP_RECT_DIRECTIONS","getClipStyles","clipPath","clipRelative","clipType","clipPoses","isRect","isCircle","subWidth","subHeight","getRectPoses","dirx","diry","getControlSize","xRange","yRange","getClipPath","defaultClip","customClip","clipText","clipPrefix","splitter","xPos","yPos","radiusX_1","radiusY_1","radius","xRadius","yRadius","centerPos_1","roundIndex","rectLength","radiusValues","_q","_r","_s","top_2","_t","nextRight","nextBottom","_u","posValue","top_3","moveControlPos","dists","verticalDirections","horizontalDirections","verticalDirection_1","horizontalDirection_1","fixedIndex","nextDist","nextControlPoses_1","controlPose","controlDir","dirDir","dirHorizontal","dirVertical","addClipPath","clipIndex","clipStyle","removeClipPath","Clippable","customClipPath","defaultClipPath","clipArea","clipPathState","snapBoundInfos","calculatedPos","controls","isInset","isPolygon","linePoses_1","clipLeft","clipTop","ellipseClipPath","piece","areaPoses","allWidth","allHeight","allLeft_1","allTop_1","directionType","snapPos1","snapPos2","dragWithClip","isDragTarget","isLine","isArea","originalDraggable","originalDist","firstDist","isDragWithTarget","isAll","guidePoses","isEllipse","guideRect","guideXPoses","guideYPoses","rectPoses","rectDists_1","boundDelta","snapOffsetY","snapOffsetX","distSnapX","distSnapY","width_1","height_1","nextControlPoses_2","nextClipStyles","dragDist","isClipStart","OriginDraggable","originRelative","distOrigin","dragDelta","addBorderRadiusByLine","lineIndex","horizontalsLength","virtual","verticalsLength","controlIndex","controlPoseInfo","addBorderRadius","removeBorderRadius","getBorderRadius","borderRadius","triggerRoundEvent","getStyleBorderRadius","firstMoveable","Roundable","roundClickable","borderRadiusState","minRoundControls","maxRoundControls","roundPadding","isDisplayShadowRoundControls","verticalCount","horizontalCount","basePos","originalPos","isDisplayVerticalShadow","isDisplay","indexAttr","roundRelative","selectedControlPose","selectedVertical","selectedHorizontal","pose","poseDist","isIdentityMatrix","identityMatrix","BeforeRenderable","inlineTransform","cssMatrix","startTransform","Renderable","transformObject","matrixInfo","triggerAble","moveableAbles","eventOperations","eventAffix","eventType","requestInstant","requestAble_1","isDragStop","stop","isFirstStart","gestoType","prevGesto","trigger","conditionName","nextDatas","forceEndedCount","updatedCount","eventOperation","eventAbles","isForceEnd","flushSync","checkMoveableTarget","eventTarget","dragTargetElement","getTargetAbleGesto","moveableTarget","controlBox","dragTarget","checkTarget","getAbleGesto","getControlAbleGesto","checkControlTarget","ableType","conditionFunctions","isTargetAbles","preventClickDefault","dragContaienrOption","dragContainer","isPinchScheduled","EventManager","calculateMatrixStack","rootContainer","isAbsolute3d","prevTargetMatrix","containerZoom","rootMatrixes","isRoot3d","offsetRootContainer","rootZoom","isNext3d","isSVGGraphicElement","nextRootMatrixes","originalRootContainer","endContainer","rootMatrixBeforeOffset","nextInfo","isMatrix3d","originalRootMatrix","calculateElementInfo","allResult","getElementInfo","getMoveableTargetInfo","moveableElement","requestStyles","targetClientRect","rootContainerClientRect","getStyle_1","beforePosition","absoluteTargetPosition","absoluteContainerPosition","containerClientRectLeft","containerClientRectTop","containterClientLeft","containerClientTop","clientDelta","getPersistState","MoveableManager","parentPosition","propsTarget","translateZ","ControlBoxElement","linePadding","controlPadding","stateTarget","groupTargets","isDragging","ableAttributes","ableClassName","isVisible","viewContainer","manager","wrapperMoveable","totalSize","isTarget","isSetState","isSingle","persistState","statePos","isInstant","allAbles","requsetAble","ableRequester","requester","ableParam","originalBeforeOrigin","stateLeft","stateTop","isPersisted","renderPos3","renderPos4","zoomOffset","stateContainer","isTargetChanged","isChanged","moveableContainer","customStyleMap","hasControlBox","persistData","firstRenderState","pinchStart","dragControlStart","targetAbles","controlAbles","Renderer","styleNames","ableStyleNames","hasTargetAble","hasControlAble","isUnset","hideDefaultLines","hideChildMoveableDefaultLines","useDragArea","nextTarget","prevTarget","prevDragArea","isDragTargetChanged","isDragAreaChanged","eventKeys","hasAbles","viewContainerOption","nextClassNames","prevClassNames","classPrefix","targetGestoData","controlGestoData","observer","records","e_1","records_1","records_1_1","mutation","e_1_1","Groupable","renderGroupRects","persistDatChildren","Clickable","isMoveableElement","containsElement","containsTarget","parentTarget","getDraggableEvent","edgeDraggable","IndividualGroupable","MOVEABLE_ABLES","MOVEABLE_EVENTS","MOVEABLE_PROPS","solveConstantsDistance","solveC","getMaxPos","getMinPos","getGroupRect","parentPoses","fixedRotation","a1_1","a2_1","a1MinMax_1","a1MinMaxPos_1","a2MinMax_1","a2MinMaxPos_1","a1Dist","a2Dist","a1MinPos","a1MaxPos","a2MinPos","a2MaxPos","minHorizontalLine","maxHorizontalLine","minVerticalLine","maxVerticalLine","minX_1","minY_1","maxX_1","maxY_1","changedX","findMoveableGroups","childTargetGroups","targetGroup","childMoveableGroups","checked","MoveableGroup","checkeds","targetGroups","moveableGroups","useDefaultGroupRotate","finded","isReset","defaultGroupRotate","persistedRoatation","getMoveableGroupRect","parentRotation","posesRotations","rotations","groupRotation","firstRotation","isSameRotation","groupPoses","groupRect","rootGroupRect","posesInfo","rotateScale","isContainerChanged","MoveableIndividualGroup","canPersist","individualProps","controlBoxElement","dragElement","getElementTargets","refTargets","selectorMap","elementTargets","getTargetGroups","compareRefTargets","prevRefTargets","nextRefTargets","InitialMoveable","cssMap","moveableContructor","userAbles","userProps","nextSelectorMap","totalAbles","prevMoveable","target_1","prevTargetMoveable","mv","resolvePromise","isBrowser","updateSelectorMap","selectorTarget","Moveable","makeMoveable","InnerMoveable","PROPERTIES","METHODS","EVENTS","nextOptions","selfElement","innerMoveable","createCommonjsModule","module","keycode","exports","keyCode","searchInput","hasKeyCode","search","foundNamedKey","codes","aliases","nameOrCode","alias","keycode_1","keycode_2","keycode_3","keycode_4","keycode_5","codeData","keysSort","getKey","keyName","getCombi","getModifierCombi","getArrangeCombi","arrangeKeys","prevScore","nextScore","globalKeyController","KeyController","comb","isToggle","combi","touch","filterDuplicated","map","elementFromPoint","baseNode","jsx","elChildren","elStyle","attrs","diffValue","boundArea","getDefaultElementRect","passTargets","beforeTargets","afterTargets","continueSelectWithoutDeselect","getLineSize","CLASS_NAME","OPTIONS","OPTION_TYPES","Selecto","clickedTarget","selectFromInside","selectByClick","boundContainer","preventDragFromInside","clickBySelectEnd","dragCondition","boundElement","rectElement","hitRect","firstPassedTargets","allowClickBySelectEnd","hasInsideTargets","pointTarget","isPreventSelect","innerScrollOptions","isInnerScroll","inputEvent_1","innerScrollElement","hasScrollOptions","selectFlag","isKeyDown","isKeyUp","containers","portalContainer","selectedTargets","beforeSelected","selectedElements","startPoint","endPoint","mousedown","mousemove","mouseup","getElementRect","selectableElements","selectableTargets","selectablePoints","hasIndexesMap","parentMap_1","parents","paths","prevParentElement","keyContainer","toggleContinueSelect","toggleContinueSelectWithoutDeselect","nextClassName","continueSelect","selectRect","gestoEvent","hitRate","innerGroups","innerWidth","innerHeight","ignoreClick","rectPoints","isHit","hitRateValue","inArea","overlapPoints","overlapSize","rate","selectableInners","yGroups","isMoveInnerScroll","parentMap_2","parentInfo","containerInfo","isDragStartEnd","startResult","startSelectedTargets","startPassedTargets","afterAdded","afterRemoved","afterPrevList","afterList","containerX","containerY","offsetSize","passedTargets","isKeyup","nextKeys","toggleKeys","singleKey_1","innerScrollContainer_1","parentMap_3","innerScrollPathsList","innerScrollPaths","isAlwaysTrue","selectablePoints_1","groups_1","getter","setter","Selecto$1","CONNECTION_ANCHOR_DIV_ID","CONNECTION_ANCHOR_ALT","CONNECTION_ANCHOR_HIGHLIGHT_OFFSET","ANCHORS","ANCHOR_PADDING","HALF_SIZE","ConnectionAnchors","setRef","setAnchorsRef","handleMouseLeave","highlightEllipseRef","halfSizeHighlightEllipse","anchorImage","onMouseEnterAnchor","onMouseLeaveHighlightElement","handleMouseLeaveAnchors","generateAnchors","anchors","anchor","reorderElements","src","dest","dragToGap","destPosition","updateElements","idx","destIndex","findElementByTarget","sceneElements","stack","currentElement","nestedElements","nestedElement","frameSelection","first","currentSelectedElements","currentLayer","newLayer","framePlacement","generateFrameContainer","maxRight","maxBottom","idCounter","htmlElementTypes","ConnectionSVG","setSVGRef","setLineRef","setSVGVertexRef","setVertexPathRef","setVertexRef","headId","CONNECTION_LINE_ID","EDITOR_HEAD_ID","maximumVertices","selectedConnection","setSelectedConnection","selectedConnectionRef","clearSelectedConnection","selectConnection","renderConnections","source","vertices","xStart","yStart","xEnd","yEnd","midpoint","xDist","yDist","connectionCursorStyle","selectedStyles","CONNECTION_HEAD_ID_START","CONNECTION_HEAD_ID_END","addVertices","pathString","vertex","X","Y","xa","ya","xb","yb","lHalfArc","angle1","angle2","Xn","Yn","previousVertex","Xp","Yp","theta","ccw","lSegment","nextVertex","lSegmentNext","lDelta","markerStart","markerEnd","getAnimationDirection","CONNECTION_VERTEX_ID","CONNECTION_VERTEX_ADD_ID","CONNECTION_VERTEX_ORTHO_TOLERANCE","CONNECTION_VERTEX_SNAP_TOLERANCE","Connections","BehaviorSubject","anchorElement","anchorsElement","connectionSVG","connectionLine","connectionVertex","connectionVertexPath","elementTarget","customElementAnchors","anchorsAmount","elementBoundingRect","parentBoundingRect","connectionLineX1","connectionLineY1","sourceX","sourceY","targetX","targetY","targetName","selectedValue","vx1","vy1","vx2","vy2","xSnap","ySnap","deleteVertex","verticalBefore","verticalAfter","horizontalBefore","horizontalAfter","angleOverall","angleBefore","connectionIndex","vertexIndex","currentSource","currentConnections","currentVertices","currentVertex","newVertex","selectedTarget","connectionStartTargetBox","connectionAnchorOffsetX","connectionAnchorOffsetY","mouseX","mouseY","update","settingsViewable","openSettings","evt","onKeyPress","dimensionViewable","constraintViewable","targetElement","verticalConstraintVisualization","horizontalConstraintVisualization","borderStyle","centerIndicatorLineOne","centerIndicatorLineTwo","centerIndicator","verticalConstraintTop","verticalConstraintBottom","verticalConstraintTopBottom","verticalConstraintCenterLine","verticalConstraintCenter","horizontalConstraintLeft","horizontalConstraintRight","horizontalConstraintLeftRight","horizontalConstraintCenterLine","horizontalConstraintCenter","disableCustomables","enableCustomables","isTargetAlreadySelected","selectedTargetParent","generateTargetElements","rootElements","initMoveable","destroySelecto","allowChanges","targetedElement","elementSupportsEditing","needsUpdate","isTargetMoveableElement","isElementSelected","DEFAULT_OFFSET","HORIZONTAL_OFFSET","frameItemDummy","updateName","shiftItemsOnDuplicate","opts","oldPlacement","copy","elem","endIndex","firstPosition","srcIndex","vals","CanvasContextMenu","onVisibilityChange","inlineEditorOpen","isMenuVisible","setIsMenuVisible","setAnchorPoint","handleContextMenu","closeContextMenu","renderMenuItems","openCloseEditorMenuItem","MenuItem","editElementMenuItem","onClickEditElementMenuItem","typeOptions","getTypeOptionsSubmenu","submenuItems","onClickItem","sceneContainerDimensions","addItemMenuItem","setBackgroundMenuItem","contextMenuAction","actionType","currentSelectedElement","ContextMenu","CanvasTooltip","onClose","overlayProps","useOverlay","dialogProps","useDialog","timeField","lastTimeValue","shouldDisplayTimeContentItem","headerItem","contentItems","links","linkLookup","VizTooltipContainer","CloseButton","VizTooltipHeader","VizTooltipContent","VizTooltipFooter","roundNumber","decimal","checkIsNumber","handleCallback","easeOut","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","animations","handleCancelAnimationFrame","animation","handleCancelAnimation","contextInstance","handleSetupAnimation","animationName","animationTime","startTime","lastStep","frameTime","animationProgress","animationType","step","isValidTargetState","targetState","positionX","positionY","animate","isValid","setTransformState","scaleDiff","positionXDiff","positionYDiff","newScale","newPositionX","newPositionY","getComponentsSizes","wrapperComponent","contentComponent","wrapperWidth","wrapperHeight","newContentWidth","newContentHeight","newDiffWidth","newDiffHeight","diffWidth","diffHeight","centerZoomedOut","scaleWidthFactor","scaleHeightFactor","minPositionX","maxPositionX","minPositionY","maxPositionY","calculateBounds","boundLimiter","minBound","maxBound","isActive","handleCalculateBounds","getMouseBoundedPosition","limitToBounds","paddingValueX","paddingValueY","paddingX","paddingY","handleCalculateZoomPositions","scaleDifference","calculatedPositionX","calculatedPositionY","newPositions","checkZoomBounds","minScale","maxScale","zoomPadding","enablePadding","scalePadding","minScaleWithPadding","isPanningStartAllowed","excluded","isInitialized","targetIsShadowDom","isWrapperChild","isAllowed","isExcluded","isExcludedNode","isPanningAllowed","isPanning","setup","disabled","handlePanningSetup","handleTouchPanningSetup","oneFingerTouch","handlePanToBounds","xChanged","yChanged","mousePosX","mousePosY","handleNewPosition","getPanningClientPosition","startCoords","transformState","panning","lockAxisX","lockAxisY","getPaddingValue","disablePadding","isVelocityCalculationAllowed","mounted","velocityAnimation","disabledVelocity","isVelocityAllowed","velocity","getVelocityMoveTime","equalToMove","sensitivity","getVelocityPosition","newPosition","startPosition","currentPosition","isLocked","minPosition","maxPosition","minTarget","maxTarget","calculatedPosition","getSizeMultiplier","defaultMultiplier","handleCalculateVelocity","lastMousePosition","velocityTime","sizeMultiplier","distanceX","distanceY","velocityX","velocityY","interval","speed","handleVelocityPanning","alignmentAnimation","zoomAnimation","sizeX","sizeY","velocityAlignmentTime","alignAnimationTime","moveAnimationTime","finalAnimationTime","maxTargetX","minTargetX","maxTargetY","minTargetY","startState","alignAnimation","alignStep","customStep","currentPositionX","currentPositionY","handlePanningStart","handleAlignToBounds","isDisabled","handlePanning","handlePanningEnd","velocityDisabled","wrapperRect","contentRect","isZoomed","handleZoomToPoint","handleAlignToScaleBounds","mousePositionX","mousePositionY","initialState","initialSetup","baseClasses","createState","createSetup","newSetup","validValue","validParameter","dataType","handleCalculateButtonZoom","smooth","targetScale","handleZoomToViewCenter","resetTransformations","onResetTransformation","initialTransformation","newBounds","boundedPositions","newState","getOffset","wrapper","content","wrapperOffset","contentOffset","xOff","yOff","calculateZoomToNode","customZoom","nodeRect","nodeOffset","nodeLeft","nodeTop","nodeWidth","nodeHeight","zoomIn","zoomOut","setTransform","resetTransform","centerView","getCenterPosition","zoomToElement","getControls","getState","passiveSupported","makePassiveEventOption","matchPrefix","exclude","cancelTimeout","timeout","getTransformStyles","getMatrixTransformStyles","centerPositionX","centerPositionY","mergeRefs","isWheelAllowed","wheelDisabled","touchPadDisabled","getDeltaY","getDelta","customDelta","getMousePosition","handleCalculateWheelZoom","disable","getTarget","paddingEnabled","handleWheelZoomStop","previousWheelEvent","isPinchStartAllowed","isPinchAllowed","pinchStartDistance","calculateTouchMidPoint","firstPointX","firstPointY","secondPointX","secondPointY","getTouchDistance","calculatePinchZoom","currentDistance","pinchStartScale","touchProportion","wheelStopEventTime","wheelAnimationTime","handleWheelStart","onWheelStart","onZoomStart","handleWheelZoom","onWheel","onZoom","wheel","smoothStep","zoomStep","mousePosition","isPaddingDisabled","isLimitedToBounds","handleWheelStop","onWheelStop","onZoomStop","hasStoppedZooming","getTouchCenter","totalX","totalY","handlePinchStart","handlePinchZoom","midPoint","panX","panY","finalX","finalY","handlePinchStop","pinchMidpoint","handleDoubleClickStop","handleDoubleClickResetMode","getDoubleClickScale","mode","handleDoubleClick","doubleClickStopEventTimer","isDoubleClickAllowed","ZoomPanPinch","newProps","currentDocument","currentWindow","centerOnInit","currentWidth","currentHeight","keysPressed","onPanningStart","onPanning","onPanningStop","onPinchingStart","onPinching","onPinchingStop","isDoubleTap","isPanningAction","isPinchAction","onTransformed","ctx_1","Context","getContent","TransformWrapper","instance","KeepScale","localRef","initialElementRect","useResize","onResize","dependencies","resizeObserverRef","rectRef","didUnmount","entries","newSize","previewStyles","MiniMap","borderColor","rest","initialized","setInitialized","useTransformContext","miniMapInstance","mainRef","wrapperRef","previewRef","getViewportSize","getContentSize","computeMiniMapScale","contentSize","computeMiniMapSize","computeMiniMapStyle","transformMiniMap","miniSize","wrapSize","previewScale","initialize","useTransformEffect","useTransformInit","zpp","wrapperStyle","styleInject","insertAt","head","css_248z","TransformComponent","wrapperClass","contentClass","contentStyle","wrapperProps","contentProps","init","cleanupWindowEvents","contentRef","libraryContext","useControls","unmountCallback","unmount","useTransformComponent","transformRender","setTransformRender","SceneTransformWrapper","sceneDiv","zoomPanPinchRef","updateMoveable","onSceneContainerMouseDown","RootElement","changeCallback","Scene","cfg","enableEditing","showAdvancedTypes","panZoom","infinitePan","onSave","ReplaySubject","Subject","visible","transformInstance","isFrame","scalar","sceneContainer","skipNextSelectionBroadcast","isTooltipValid","canShowElementTooltip","SetBackground","bgImage","setBgImage","ResourcePickerPopover","BackgroundSizeEditor","imageSize","onImageSizeChange","defaultLineStyleConfig","LineStyleEditor","onLineStyleChange","onAnimateChange","Switch","DataLinksEditor","oneClickMode","DataLinksInlineEditor","getCategoryName","optionBuilder","getConnectionEditor","lodash","ConstraintSelectionBox","onVerticalConstraintChange","onHorizontalConstraintChange","currentConstraints","onClickTopConstraint","onClickBottomConstraint","onClickVerticalCenterConstraint","onClickLeftConstraint","onClickRightConstraint","onClickHorizontalCenterConstraint","HOVER_COLOR","HOVER_OPACITY","SELECTED_COLOR","selectionBoxColor","QuickPositioning","onPositionChange","settings","onQuickPositioningChange","defaultConstraint","originalConstraint","getRightBottomPosition","elementSize","places","horizontalOptions","verticalOptions","PlacementEditor","layout","reselectElementAfterChange","onHorizontalConstraintSelect","onVerticalConstraintSelect","Icon","NumberInput","getElementEditor","layer","layerTypes","isUnsupported","currentOptions","TreeContext","DropIndicator","_ref","dropPosition","dropLevelOffset","indent","_objectDestructuringEmpty","Indent","prefixCls","level","baseClassName","_excluded","ICON_OPEN","ICON_CLOSE","defaultTitle","InternalTreeNode","_React$Component","_len","_key","onNodeClick","onNodeDoubleClick","onNodeSelect","_this$props","disableCheckbox","onNodeCheck","targetChecked","onNodeMouseEnter","onNodeMouseLeave","onNodeContextMenu","onNodeDragStart","onNodeDragEnter","onNodeDragOver","onNodeDragLeave","onNodeDragEnd","onNodeDrop","_this$props2","onNodeExpand","expanded","eventKey","keyEntities","_this$props3","isLeaf","loaded","loadData","hasChildren","treeDisabled","checkable","treeCheckable","_this$props$context","onNodeLoad","_this$props4","draggable","_this$props$context2","switcherIconFromProps","switcherIconFromCtx","switcherIcon","_switcherIconDom","switcherCls","switcherIconDom","_this$props5","halfChecked","$custom","dragNodeHighlight","_this$props6","_this$props6$title","title","selected","icon","_this$props$context3","showIcon","treeIcon","titleRender","wrapClass","$icon","currentIcon","titleNode","$title","_this$props7","_this$props$context4","dropIndicatorRender","dragOverNodeKey","rootDraggable","showIndicator","mergedIndent","selectable","treeSelectable","_classNames","_this$props8","dragOver","dragOverGapTop","dragOverGapBottom","domRef","active","onMouseMove","_this$props$context5","filterTreeNode","dropContainerKey","dropTargetKey","draggingNodeKey","dataOrAriaAttributeProps","pickAttrs","_ref2","isEndNode","mergedDraggable","draggableWithoutDisabled","dragging","ariaSelected","ContextTreeNode","useUnmount","triggerStart","triggerEnd","_React$useState","_React$useState2","firstMount","setFirstMount","MotionTreeNode","motion","motionNodes","motionType","onOriginMotionStart","onOriginMotionEnd","treeNodeRequiredProps","setVisible","_React$useContext","targetVisible","triggerMotionStart","triggerMotionEndRef","triggerMotionEnd","onVisibleChanged","nextVisible","motionRef","motionClassName","motionStyle","treeNode","restProps","treeNodeProps","RefMotionTreeNode","findExpandedKeys","prevLen","nextLen","find","shorter","longer","getExpandRange","shorterStartIndex","shorterEndNode","longerStartIndex","longerEndIndex","HIDDEN_STYLE","noop","MOTION_KEY","MotionNode","MotionEntity","MotionFlattenData","getMinimumRangeTransitionRange","itemHeight","itemKey","getAccessibilityPath","NodeList","expandedKeys","selectedKeys","checkedKeys","loadedKeys","loadingKeys","halfCheckedKeys","focusable","activeItem","focused","tabIndex","onFocus","onBlur","onActiveChange","onListChangeStart","onListChangeEnd","domProps","listRef","indentMeasurerRef","scroll","prevExpandedKeys","setPrevExpandedKeys","_React$useState3","_React$useState4","prevData","setPrevData","_React$useState5","_React$useState6","transitionData","setTransitionData","_React$useState7","_React$useState8","transitionRange","setTransitionRange","_React$useState9","_React$useState10","setMotionType","dataRef","onMotionEnd","latestData","diffExpanded","rangeNodes","newTransitionData","_keyIndex","_rangeNodes","_newTransitionData","mergedData","originList","fullList","originSet","restList","mergedKey","arrDel","clone","arrAdd","posToArr","getDragChildrenKeys","dragNodeKey","dragChildrenKeys","entity","dig","isLastChild","treeNodeEntity","posArr","isFirstChild","calcDropPosition","dragNode","targetNode","startMousePosition","allowDrop","flattenedNodes","expandKeys","_abstractDropNodeEnti","_getBoundingClientRec","horizontalMouseOffset","rawDropLevelOffset","filteredExpandKeys","_keyEntities$key","abstractDropNodeEntity","nodeIndex","flattenedNode","prevNodeIndex","prevNodeKey","initialAbstractDropNodeKey","abstractDragOverEntity","abstractDragDataNode","abstractDropDataNode","dropAllowed","calcSelectedKeys","internalProcessProps","convertDataToTree","treeData","processor","_ref2$processProps","processProps","_ref3","childrenNodes","parseCheckedKeys","keyProps","warning","conductExpandParent","keyList","conductUp","MAX_RETRY_TIMES","Tree","_args","_this$state","onDragStart","newExpandedKeys","_this$state2","flattenNodes","onDragEnter","onExpand","_node$props","_assertThisInitialize","_calcDropPosition","dropTargetPos","_this$state3","onDragOver","_assertThisInitialize2","_calcDropPosition2","onDragLeave","onDragEnd","_this$getActiveItem","outsideTree","_this$state4","onDrop","abstractDropNodeProps","dropToChild","dropResult","_this$state5","nodeItem","eventNode","expandAction","onDoubleClick","_this$state6","onSelect","targetSelected","selectedNodes","selectedKey","_this$state7","oriCheckedKeys","oriHalfCheckedKeys","checkStrictly","onCheck","checkedObj","eventObj","checkedKey","_conductCheck","_checkedKeys","_halfCheckedKeys","keySet","_conductCheck2","_entity$children","loadPromise","reject","_ref$loadedKeys","_ref$loadingKeys","onLoad","promise","currentLoadedKeys","newLoadedKeys","onMouseEnter","onMouseLeave","onRightClick","_len2","_key2","_len3","_key3","_this$state8","_this$state9","_this$state10","listChanging","targetExpanded","newFlattenTreeData","currentExpandedKeys","expandedKeysToRestore","newActiveKey","activeKey","_this$props9","_this$props9$itemScro","itemScrollOffset","_this$state11","_this$state12","_key4","_this$state13","_this$props10","KeyCode","expandable","atomic","forceState","needSync","allPassed","_this$props11","_this$props11$itemScr","_this$state14","_this$props12","showLine","_this$props12$tabInde","onContextMenu","onScroll","rootClassName","rootStyle","draggableConfig","entitiesMap","cloneKeyEntities","checkedKeyEntity","_checkedKeyEntity","_checkedKeyEntity$che","_checkedKeyEntity$hal","conductKeys","getGlobalStyles","TreeNodeTitle","nodeData","setAllowSelection","getScene","onDelete","onDuplicate","onNameChange","verifyLayerNameUniqueness","nameToVerify","getLayerInfo","LayerName","getTreeData","root","selectedColor","destKey","srcKey","destPos","srcElement","allowSelection","TreeNavigationEditor","setTreeData","autoExpandParent","setAutoExpandParent","setExpandedKeys","setSelectedKeys","globalCSS","selectedBgColor","selectionByUID","srcEl","destEl","allow","onClearSelection","onTitleRender","onFrameSelection","getLayerEditor","TabsEditor","onTabChange","activeTab","setActiveTab","tabs","onCurrentTabChange","TabsBar","Tab","InlineEditBody","activePanel","activePanelSubject","instanceState","pane","OptionsPaneCategoryDescriptor","supplier","addStandardCanvasEditorOptions","getOptionsPaneCategoryDescriptor","topLevelItemsContainerStyle","tab","noElementSelected","renderOptionsPaneCategoryDescriptor","OptionsPaneCategory","getOptionsPaneCategory","categoryNames","access","OFFSET_X","OFFSET_Y","InlineEdit","windowHeight","windowWidth","inlineEditKey","defaultMeasurements","defaultX","defaultY","savedPlacement","measurements","setMeasurements","setPlacement","onDragStop","saveToStore","onResizeStop","canvasInstances","activeCanvasPanel","isInlineEditOpen","isSetBackgroundOpen","CanvasPanel","Subscription","onOptionsChange","tooltip","dashboard","allowEditing","PanelContext","canvasInstance","ci","inlineEditingSwitched","shouldShowAdvancedTypesSwitched","panZoomSwitched","infinitePanSwitched","helpUrl","PanZoomHelp","Alert","newWindow","canvasMigrationHandler","pluginVersion","override","prop","addLinks","varsNamesRegex","linksCopy","match","fieldName1","fieldLabels1","seriesName1","labels","PanelPlugin","connectionSelection"],"sourceRoot":""}