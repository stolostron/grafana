"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4785],{89858:(K,D,a)=>{a.r(D),a.d(D,{DataTrailsPage:()=>R,default:()=>Y});var e=a(96540),c=a(32196),g=a(24180),C=a(64388),z=a(12131),d=a(16401),E=a(40845),N=a(67608),p=a(67061),H=a(55852),A=a(94753),M=a(72724),f=a(10860),P=a(78369),U=a(29158),T=a(4200),i=a(51080);function L({trail:t,onSelect:n,onDelete:l}){const r=(0,E.of)(j),o=d.jh.lookupVariable(T.Ao,t);if(!(o instanceof d.H9))return null;const h=o.state.filters,S=(0,i.U4)(t),k=()=>n(t);return e.createElement(f.Z,{onClick:k,className:r.card},e.createElement(f.Z.Heading,null,(0,i.aO)(t.state.metric)),e.createElement("div",{className:r.description},e.createElement(p.B,{gap:1.5,wrap:"wrap"},h.map(s=>e.createElement(P.v,{key:s.key,name:`${s.key}: ${s.value}`,colorIndex:12})))),e.createElement(f.Z.Actions,{className:r.actions},e.createElement(p.B,{gap:1,justifyContent:"space-between",grow:1},e.createElement("div",{className:r.secondary},e.createElement("b",null,"Datasource:")," ",(0,i.nH)(S)),t.state.createdAt&&e.createElement("i",{className:r.secondary},e.createElement("b",null,"Created:")," ",(0,M.LE)(t.state.createdAt,{format:"LL"})))),l&&e.createElement(f.Z.SecondaryActions,null,e.createElement(U.K,{key:"delete",name:"trash-alt",className:r.secondary,tooltip:"Remove bookmark",onClick:l})))}function j(t){return{tag:(0,c.css)({maxWidth:"260px",overflow:"hidden",textOverflow:"ellipsis"}),card:(0,c.css)({padding:t.spacing(1)}),secondary:(0,c.css)({color:t.colors.text.secondary,fontSize:"12px"}),description:(0,c.css)({width:"100%",gridArea:"Description",margin:t.spacing(1,0,0),color:t.colors.text.secondary,lineHeight:t.typography.body.lineHeight}),actions:(0,c.css)({marginRight:t.spacing(1)})}}var m=a(74764),y=a(40588);class F extends d.Bs{constructor(n){super(n),this.onNewMetricsTrail=()=>{const l=B(this),r=(0,i.ef)((0,i.hR)());(0,y.z)("exploration_started",{cause:"new_clicked"}),(0,m._)().setRecentTrail(r),l.goToUrlForTrail(r)},this.onSelectTrail=(l,r)=>{const o=B(this);(0,y.z)("exploration_started",{cause:r?"bookmark_clicked":"recent_clicked"}),(0,m._)().setRecentTrail(l),o.goToUrlForTrail(l)}}static{this.Component=({model:n})=>{const[l,r]=(0,e.useState)(Date.now()),o=(0,E.of)(O),h=s=>{(0,m._)().removeBookmark(s),(0,y.z)("bookmark_changed",{action:"deleted"}),r(Date.now())};if(!(0,m._)().recent.length){const s=(0,i.ef)((0,i.hR)());return e.createElement(g.rd,{to:(0,i.xi)(s)})}const S=s=>n.onSelectTrail(s,!1),k=s=>n.onSelectTrail(s,!0);return e.createElement("div",{className:o.container},e.createElement(p.B,{direction:"column",gap:1,alignItems:"start"},e.createElement(H.$n,{icon:"plus",size:"md",variant:"primary",onClick:n.onNewMetricsTrail},"New metric exploration")),e.createElement(p.B,{gap:5},e.createElement("div",{className:o.column},e.createElement(A.E,{variant:"h4"},"Recent metrics explorations"),e.createElement("div",{className:o.trailList},(0,m._)().recent.map((s,v)=>{const u=s.resolve();return e.createElement(L,{key:(u.state.key||"")+v,trail:u,onSelect:S})}))),e.createElement("div",{className:o.verticalLine}),e.createElement("div",{className:o.column},e.createElement(A.E,{variant:"h4"},"Bookmarks"),e.createElement("div",{className:o.trailList},(0,m._)().bookmarks.map((s,v)=>{const u=s.resolve();return e.createElement(L,{key:(u.state.key||"")+v,trail:u,onSelect:k,onDelete:()=>h(v)})})))))}}}function B(t){return d.jh.getAncestor(t,I)}function O(t){return{container:(0,c.css)({flexGrow:1,display:"flex",flexDirection:"column",gap:t.spacing(3)}),column:(0,c.css)({display:"flex",flexGrow:1,flexDirection:"column",gap:t.spacing(2)}),newTrail:(0,c.css)({height:"auto",justifyContent:"center",fontSize:t.typography.h5.fontSize}),trailCard:(0,c.css)({}),trailList:(0,c.css)({display:"flex",flexDirection:"column",gap:t.spacing(2)}),verticalLine:(0,c.css)({borderLeft:`1px solid ${t.colors.border.weak}`})}}var V=a(90623);class I extends d.Bs{constructor(n){super(n)}goToUrlForTrail(n){this.setState({trail:n}),z.Ny.push((0,i.xi)(n))}static{this.Component=({model:n})=>{const{trail:l,home:r}=n.useState(),o=(0,E.of)(G);return e.createElement(g.dO,null,e.createElement(g.qh,{exact:!0,path:T.QX,render:()=>e.createElement(N.Y,{navId:"explore/metrics",layout:C.k.Standard,renderTitle:()=>e.createElement(V.p,null),subTitle:""},e.createElement(r.Component,{model:r}))}),e.createElement(g.qh,{exact:!0,path:T.km,render:()=>e.createElement(N.Y,{navId:"explore/metrics",pageNav:{text:(0,i.aO)(l.state.metric)},layout:C.k.Custom},e.createElement("div",{className:o.customPage},e.createElement(Z,{trail:l})))}))}}}function Z({trail:t}){const[n,l]=e.useState(!1);return(0,e.useEffect)(()=>{n||((0,m._)().setRecentTrail(t),l(!0))},[t,n]),n?e.createElement(t.Component,{model:t}):null}let x;function $(){return x||(x=new I({trail:w(),home:new F({})})),x}function w(){const t=(0,i.ef)();return(0,d.Is)().initSync(t),(0,d.Is)().cleanUp(t),(0,m._)().findMatchingRecentTrail(t)?.resolve()||t}function G(t){return{customPage:(0,c.css)({padding:t.spacing(2,3,2,3),background:t.isLight?t.colors.background.primary:t.colors.background.canvas,flexGrow:1,display:"flex",flexDirection:"column"})}}function R(){const t=$();return e.createElement(t.Component,{model:t})}const Y=R}}]);

//# sourceMappingURL=DataTrailsPage.2916e1d7cfd54cefe382.js.map