{"version":3,"file":"UsersListPage.1b61c82d62ca416b6f2f.js","mappings":"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","sources":["webpack://grafana/./public/app/features/admin/Users/OrgUsersTable.tsx","webpack://grafana/./public/app/features/invites/InviteeRow.tsx","webpack://grafana/./public/app/features/invites/InviteesTable.tsx","webpack://grafana/./public/app/features/invites/state/selectors.ts","webpack://grafana/./public/app/features/users/state/actions.ts","webpack://grafana/./public/app/features/users/state/selectors.ts","webpack://grafana/./public/app/features/users/UsersActionBar.tsx","webpack://grafana/./public/app/features/users/UsersListPage.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\n\nimport { OrgRole } from '@grafana/data';\nimport { selectors as e2eSelectors } from '@grafana/e2e-selectors';\nimport {\n  Avatar,\n  Box,\n  Button,\n  CellProps,\n  Column,\n  ConfirmModal,\n  FetchDataFunc,\n  Icon,\n  InteractiveTable,\n  Pagination,\n  Stack,\n  Tag,\n  Text,\n  Tooltip,\n} from '@grafana/ui';\nimport { UserRolePicker } from 'app/core/components/RolePicker/UserRolePicker';\nimport { fetchRoleOptions } from 'app/core/components/RolePicker/api';\nimport { TagBadge } from 'app/core/components/TagFilter/TagBadge';\nimport { contextSrv } from 'app/core/core';\nimport { AccessControlAction, OrgUser, Role } from 'app/types';\n\nimport { OrgRolePicker } from '../OrgRolePicker';\n\ntype Cell<T extends keyof OrgUser = keyof OrgUser> = CellProps<OrgUser, OrgUser[T]>;\n\nconst disabledRoleMessage = `This user's role is not editable because it is synchronized from your auth provider.\nRefer to the Grafana authentication docs for details.`;\n\nconst getBasicRoleDisabled = (user: OrgUser) => {\n  const isUserSynced = user?.isExternallySynced;\n  return !contextSrv.hasPermissionInMetadata(AccessControlAction.OrgUsersWrite, user) || isUserSynced;\n};\n\nconst selectors = e2eSelectors.pages.UserListPage.UsersListPage;\n\nexport interface Props {\n  users: OrgUser[];\n  orgId?: number;\n  onRoleChange: (role: OrgRole, user: OrgUser) => void;\n  onRemoveUser: (user: OrgUser) => void;\n  fetchData?: FetchDataFunc<OrgUser>;\n  changePage: (page: number) => void;\n  page: number;\n  totalPages: number;\n  rolesLoading?: boolean;\n}\n\nexport const OrgUsersTable = ({\n  users,\n  orgId,\n  onRoleChange,\n  onRemoveUser,\n  fetchData,\n  changePage,\n  page,\n  totalPages,\n  rolesLoading,\n}: Props) => {\n  const [userToRemove, setUserToRemove] = useState<OrgUser | null>(null);\n  const [roleOptions, setRoleOptions] = useState<Role[]>([]);\n\n  useEffect(() => {\n    async function fetchOptions() {\n      try {\n        if (contextSrv.hasPermission(AccessControlAction.ActionRolesList)) {\n          let options = await fetchRoleOptions(orgId);\n          setRoleOptions(options);\n        }\n      } catch (e) {\n        console.error('Error loading options');\n      }\n    }\n    if (contextSrv.licensedAccessControlEnabled()) {\n      fetchOptions();\n    }\n  }, [orgId]);\n\n  const columns: Array<Column<OrgUser>> = useMemo(\n    () => [\n      {\n        id: 'avatarUrl',\n        header: '',\n        cell: ({ cell: { value } }: Cell<'avatarUrl'>) => value && <Avatar src={value} alt=\"User avatar\" />,\n      },\n      {\n        id: 'login',\n        header: 'Login',\n        cell: ({ cell: { value } }: Cell<'login'>) => <div>{value}</div>,\n        sortType: 'string',\n      },\n      {\n        id: 'email',\n        header: 'Email',\n        cell: ({ cell: { value } }: Cell<'email'>) => value,\n        sortType: 'string',\n      },\n      {\n        id: 'name',\n        header: 'Name',\n        cell: ({ cell: { value } }: Cell<'name'>) => value,\n        sortType: 'string',\n      },\n      {\n        id: 'lastSeenAtAge',\n        header: 'Last active',\n        cell: ({ cell: { value } }: Cell<'lastSeenAtAge'>) => {\n          return <>{value && <>{value === '10 years' ? <Text color={'disabled'}>Never</Text> : value}</>}</>;\n        },\n        sortType: (a, b) => new Date(a.original.lastSeenAt).getTime() - new Date(b.original.lastSeenAt).getTime(),\n      },\n      {\n        id: 'role',\n        header: 'Role',\n        cell: ({ cell: { value }, row: { original } }: Cell<'role'>) => {\n          const basicRoleDisabled = getBasicRoleDisabled(original);\n          return contextSrv.licensedAccessControlEnabled() ? (\n            <UserRolePicker\n              userId={original.userId}\n              roles={original.roles || []}\n              isLoading={rolesLoading}\n              orgId={orgId}\n              roleOptions={roleOptions}\n              basicRole={value}\n              onBasicRoleChange={(newRole) => onRoleChange(newRole, original)}\n              basicRoleDisabled={basicRoleDisabled}\n              basicRoleDisabledMessage={disabledRoleMessage}\n              width={40}\n            />\n          ) : (\n            <OrgRolePicker\n              aria-label=\"Role\"\n              value={value}\n              disabled={basicRoleDisabled}\n              onChange={(newRole) => onRoleChange(newRole, original)}\n            />\n          );\n        },\n      },\n      {\n        id: 'info',\n        header: '',\n        cell: ({ row: { original } }: Cell) => {\n          const basicRoleDisabled = getBasicRoleDisabled(original);\n          return (\n            basicRoleDisabled && (\n              <Box display={'flex'} alignItems={'center'} marginLeft={1}>\n                <Tooltip\n                  interactive={true}\n                  content={\n                    <div>\n                      This user&apos;s role is not editable because it is synchronized from your auth provider. Refer to\n                      the&nbsp;\n                      <a\n                        href={\n                          'https://grafana.com/docs/grafana/latest/administration/user-management/manage-org-users/#change-a-users-organization-permissions'\n                        }\n                        rel=\"noreferrer\"\n                        target=\"_blank\"\n                      >\n                        Grafana authentication docs\n                      </a>\n                      &nbsp;for details.\n                    </div>\n                  }\n                >\n                  <Icon name=\"question-circle\" />\n                </Tooltip>\n              </Box>\n            )\n          );\n        },\n      },\n      {\n        id: 'authLabels',\n        header: 'Origin',\n        cell: ({ cell: { value } }: Cell<'authLabels'>) => (\n          <>{Array.isArray(value) && value.length > 0 && <TagBadge label={value[0]} removeIcon={false} count={0} />}</>\n        ),\n      },\n      {\n        id: 'isDisabled',\n        header: '',\n        cell: ({ cell: { value } }: Cell<'isDisabled'>) => <>{value && <Tag colorIndex={9} name={'Disabled'} />}</>,\n      },\n      {\n        id: 'delete',\n        header: '',\n        cell: ({ row: { original } }: Cell) => {\n          return (\n            contextSrv.hasPermissionInMetadata(AccessControlAction.OrgUsersRemove, original) && (\n              <Button\n                size=\"sm\"\n                variant=\"destructive\"\n                onClick={() => {\n                  setUserToRemove(original);\n                }}\n                icon=\"times\"\n                aria-label={`Delete user ${original.name}`}\n              />\n            )\n          );\n        },\n      },\n    ],\n    [rolesLoading, orgId, roleOptions, onRoleChange]\n  );\n\n  return (\n    <Stack direction={'column'} gap={2} data-testid={selectors.container}>\n      <InteractiveTable columns={columns} data={users} getRowId={(user) => String(user.userId)} fetchData={fetchData} />\n      <Stack justifyContent=\"flex-end\">\n        <Pagination onNavigate={changePage} currentPage={page} numberOfPages={totalPages} hideWhenSinglePage={true} />\n      </Stack>\n      {Boolean(userToRemove) && (\n        <ConfirmModal\n          body={`Are you sure you want to delete user ${userToRemove?.login}?`}\n          confirmText=\"Delete\"\n          title=\"Delete\"\n          onDismiss={() => {\n            setUserToRemove(null);\n          }}\n          isOpen={true}\n          onConfirm={() => {\n            if (!userToRemove) {\n              return;\n            }\n            onRemoveUser(userToRemove);\n            setUserToRemove(null);\n          }}\n        />\n      )}\n    </Stack>\n  );\n};\n","import React, { PureComponent } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\n\nimport { Button, ClipboardButton } from '@grafana/ui';\nimport { Invitee } from 'app/types';\n\nimport { revokeInvite } from './state/actions';\n\nconst mapDispatchToProps = {\n  revokeInvite,\n};\n\nconst connector = connect(null, mapDispatchToProps);\n\ninterface OwnProps {\n  invitee: Invitee;\n}\n\nexport type Props = OwnProps & ConnectedProps<typeof connector>;\n\nclass InviteeRow extends PureComponent<Props> {\n  render() {\n    const { invitee, revokeInvite } = this.props;\n    return (\n      <tr>\n        <td>{invitee.email}</td>\n        <td>{invitee.name}</td>\n        <td className=\"text-right\">\n          <ClipboardButton icon=\"copy\" variant=\"secondary\" size=\"sm\" getText={() => invitee.url}>\n            Copy Invite\n          </ClipboardButton>\n          &nbsp;\n        </td>\n        <td>\n          <Button\n            variant=\"destructive\"\n            size=\"sm\"\n            icon=\"times\"\n            onClick={() => revokeInvite(invitee.code)}\n            aria-label=\"Revoke Invite\"\n          />\n        </td>\n      </tr>\n    );\n  }\n}\n\nexport default connector(InviteeRow);\n","import React, { PureComponent } from 'react';\n\nimport { Invitee } from 'app/types';\n\nimport InviteeRow from './InviteeRow';\n\nexport interface Props {\n  invitees: Invitee[];\n}\n\nexport default class InviteesTable extends PureComponent<Props> {\n  render() {\n    const { invitees } = this.props;\n\n    return (\n      <table className=\"filter-table form-inline\">\n        <thead>\n          <tr>\n            <th>Email</th>\n            <th>Name</th>\n            <th />\n            <th style={{ width: '34px' }} />\n          </tr>\n        </thead>\n        <tbody data-testid=\"InviteesTable-body\">\n          {invitees.map((invitee, index) => {\n            return <InviteeRow key={`${invitee.id}-${index}`} invitee={invitee} />;\n          })}\n        </tbody>\n      </table>\n    );\n  }\n}\n","import { EntityState, createSelector } from '@reduxjs/toolkit';\n\nimport { Invitee } from 'app/types';\n\nimport { selectors } from './reducers';\n\nexport const { selectAll, selectById, selectTotal } = selectors;\n\nconst selectQuery = (_state: EntityState<Invitee>, query: string) => query;\nexport const selectInvitesMatchingQuery = createSelector([selectAll, selectQuery], (invites, searchQuery) => {\n  const regex = new RegExp(searchQuery, 'i');\n  const matches = invites.filter((invite) => regex.test(invite.name) || regex.test(invite.email));\n  return matches;\n});\n","import { debounce } from 'lodash';\n\nimport { getBackendSrv } from '@grafana/runtime';\nimport { FetchDataArgs } from '@grafana/ui';\nimport { contextSrv } from 'app/core/core';\nimport { accessControlQueryParam } from 'app/core/utils/accessControl';\nimport { OrgUser } from 'app/types';\n\nimport { AccessControlAction, ThunkResult } from '../../../types';\n\nimport {\n  usersLoaded,\n  pageChanged,\n  usersFetchBegin,\n  usersFetchEnd,\n  searchQueryChanged,\n  sortChanged,\n  rolesFetchBegin,\n  rolesFetchEnd,\n} from './reducers';\n\nexport function loadUsers(): ThunkResult<void> {\n  return async (dispatch, getState) => {\n    try {\n      dispatch(usersFetchBegin());\n      const { perPage, page, searchQuery, sort } = getState().users;\n      const users = await getBackendSrv().get(\n        `/api/org/users/search`,\n        accessControlQueryParam({ perpage: perPage, page, query: searchQuery, sort })\n      );\n\n      if (\n        contextSrv.licensedAccessControlEnabled() &&\n        contextSrv.hasPermission(AccessControlAction.ActionUserRolesList)\n      ) {\n        dispatch(rolesFetchBegin());\n        const orgId = contextSrv.user.orgId;\n        const userIds = users?.orgUsers.map((u: OrgUser) => u.userId);\n        const roles = await getBackendSrv().post(`/api/access-control/users/roles/search`, { userIds, orgId });\n        users.orgUsers.forEach((u: OrgUser) => {\n          u.roles = roles ? roles[u.userId] || [] : [];\n        });\n        dispatch(rolesFetchEnd());\n      }\n      dispatch(usersLoaded(users));\n    } catch (error) {\n      usersFetchEnd();\n    }\n  };\n}\n\nconst fetchUsersWithDebounce = debounce((dispatch) => dispatch(loadUsers()), 300);\n\nexport function updateUser(user: OrgUser): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().patch(`/api/org/users/${user.userId}`, { role: user.role });\n    dispatch(loadUsers());\n  };\n}\n\nexport function removeUser(userId: number): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().delete(`/api/org/users/${userId}`);\n    dispatch(loadUsers());\n  };\n}\n\nexport function changePage(page: number): ThunkResult<void> {\n  return async (dispatch) => {\n    dispatch(pageChanged(page));\n    dispatch(loadUsers());\n  };\n}\n\nexport function changeSort({ sortBy }: FetchDataArgs<OrgUser>): ThunkResult<void> {\n  const sort = sortBy.length ? `${sortBy[0].id}-${sortBy[0].desc ? 'desc' : 'asc'}` : undefined;\n  return async (dispatch) => {\n    dispatch(sortChanged(sort));\n    dispatch(loadUsers());\n  };\n}\n\nexport function changeSearchQuery(query: string): ThunkResult<void> {\n  return async (dispatch) => {\n    dispatch(searchQueryChanged(query));\n    fetchUsersWithDebounce(dispatch);\n  };\n}\n","import { UsersState } from 'app/types';\n\nexport const getUsers = (state: UsersState) => {\n  const regex = new RegExp(state.searchQuery, 'i');\n\n  return state.users.filter((user) => {\n    return regex.test(user.login) || regex.test(user.email) || regex.test(user.name);\n  });\n};\n\nexport const getUsersSearchQuery = (state: UsersState) => state.searchQuery;\n","import React from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\n\nimport { RadioButtonGroup, LinkButton, FilterInput, InlineField } from '@grafana/ui';\nimport config from 'app/core/config';\nimport { contextSrv } from 'app/core/core';\nimport { AccessControlAction, StoreState } from 'app/types';\n\nimport { selectTotal } from '../invites/state/selectors';\n\nimport { changeSearchQuery } from './state/actions';\nimport { getUsersSearchQuery } from './state/selectors';\n\nexport interface OwnProps {\n  showInvites: boolean;\n  onShowInvites: () => void;\n}\n\nfunction mapStateToProps(state: StoreState) {\n  return {\n    searchQuery: getUsersSearchQuery(state.users),\n    pendingInvitesCount: selectTotal(state.invites),\n    externalUserMngLinkName: state.users.externalUserMngLinkName,\n    externalUserMngLinkUrl: state.users.externalUserMngLinkUrl,\n  };\n}\n\nconst mapDispatchToProps = {\n  changeSearchQuery,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\nexport type Props = ConnectedProps<typeof connector> & OwnProps;\n\nexport const UsersActionBarUnconnected = ({\n  externalUserMngLinkName,\n  externalUserMngLinkUrl,\n  searchQuery,\n  pendingInvitesCount,\n  changeSearchQuery,\n  onShowInvites,\n  showInvites,\n}: Props): JSX.Element => {\n  const options = [\n    { label: 'Users', value: 'users' },\n    { label: `Pending Invites (${pendingInvitesCount})`, value: 'invites' },\n  ];\n  const canAddToOrg: boolean = contextSrv.hasPermission(AccessControlAction.OrgUsersAdd);\n  // Show invite button in the following cases:\n  // 1) the instance is not a hosted Grafana instance (!config.externalUserMngInfo)\n  // 2) new basic auth users can be created for this instance (!config.disableLoginForm).\n  const showInviteButton: boolean = canAddToOrg && !(config.disableLoginForm && config.externalUserMngInfo);\n\n  return (\n    <div className=\"page-action-bar\" data-testid=\"users-action-bar\">\n      <InlineField grow>\n        <FilterInput\n          value={searchQuery}\n          onChange={changeSearchQuery}\n          placeholder=\"Search user by login, email or name\"\n        />\n      </InlineField>\n      {pendingInvitesCount > 0 && (\n        <div style={{ marginLeft: '1rem' }}>\n          <RadioButtonGroup value={showInvites ? 'invites' : 'users'} options={options} onChange={onShowInvites} />\n        </div>\n      )}\n      {showInviteButton && <LinkButton href=\"org/users/invite\">Invite</LinkButton>}\n      {externalUserMngLinkUrl && (\n        <LinkButton href={externalUserMngLinkUrl} target=\"_blank\" rel=\"noopener\">\n          {externalUserMngLinkName}\n        </LinkButton>\n      )}\n    </div>\n  );\n};\n\nexport const UsersActionBar = connector(UsersActionBarUnconnected);\n","import React, { useEffect, useState } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\n\nimport { renderMarkdown } from '@grafana/data';\nimport { Page } from 'app/core/components/Page/Page';\nimport { contextSrv } from 'app/core/core';\nimport { OrgUser, OrgRole, StoreState } from 'app/types';\n\nimport { OrgUsersTable } from '../admin/Users/OrgUsersTable';\nimport InviteesTable from '../invites/InviteesTable';\nimport { fetchInvitees } from '../invites/state/actions';\nimport { selectInvitesMatchingQuery } from '../invites/state/selectors';\n\nimport { UsersActionBar } from './UsersActionBar';\nimport { loadUsers, removeUser, updateUser, changePage, changeSort } from './state/actions';\nimport { getUsers, getUsersSearchQuery } from './state/selectors';\n\nfunction mapStateToProps(state: StoreState) {\n  const searchQuery = getUsersSearchQuery(state.users);\n  return {\n    users: getUsers(state.users),\n    searchQuery: getUsersSearchQuery(state.users),\n    page: state.users.page,\n    totalPages: state.users.totalPages,\n    perPage: state.users.perPage,\n    invitees: selectInvitesMatchingQuery(state.invites, searchQuery),\n    externalUserMngInfo: state.users.externalUserMngInfo,\n    isLoading: state.users.isLoading,\n    rolesLoading: state.users.rolesLoading,\n  };\n}\n\nconst mapDispatchToProps = {\n  loadUsers,\n  fetchInvitees,\n  changePage,\n  changeSort,\n  updateUser,\n  removeUser,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\nexport type Props = ConnectedProps<typeof connector>;\n\nexport interface State {\n  showInvites: boolean;\n}\n\nexport const UsersListPageUnconnected = ({\n  users,\n  page,\n  totalPages,\n  invitees,\n  externalUserMngInfo,\n  isLoading,\n  rolesLoading,\n  loadUsers,\n  fetchInvitees,\n  changePage,\n  updateUser,\n  removeUser,\n  changeSort,\n}: Props) => {\n  const [showInvites, setShowInvites] = useState(false);\n  const externalUserMngInfoHtml = externalUserMngInfo ? renderMarkdown(externalUserMngInfo) : '';\n\n  useEffect(() => {\n    loadUsers();\n    fetchInvitees();\n  }, [fetchInvitees, loadUsers]);\n\n  const onRoleChange = (role: OrgRole, user: OrgUser) => {\n    updateUser({ ...user, role: role });\n  };\n\n  const onRemoveUser = (user: OrgUser) => removeUser(user.userId);\n\n  const onShowInvites = () => {\n    setShowInvites(!showInvites);\n  };\n\n  const renderTable = () => {\n    if (showInvites) {\n      return <InviteesTable invitees={invitees} />;\n    } else {\n      return (\n        <OrgUsersTable\n          users={users}\n          orgId={contextSrv.user.orgId}\n          rolesLoading={rolesLoading}\n          onRoleChange={onRoleChange}\n          onRemoveUser={onRemoveUser}\n          fetchData={changeSort}\n          changePage={changePage}\n          page={page}\n          totalPages={totalPages}\n        />\n      );\n    }\n  };\n\n  return (\n    <Page.Contents isLoading={!isLoading}>\n      <UsersActionBar onShowInvites={onShowInvites} showInvites={showInvites} />\n      {externalUserMngInfoHtml && (\n        <div className=\"grafana-info-box\" dangerouslySetInnerHTML={{ __html: externalUserMngInfoHtml }} />\n      )}\n      {isLoading && renderTable()}\n    </Page.Contents>\n  );\n};\n\nexport const UsersListPageContent = connector(UsersListPageUnconnected);\n\nexport default function UsersListPage() {\n  return (\n    <Page navId=\"users\">\n      <UsersListPageContent />\n    </Page>\n  );\n}\n"],"names":["disabledRoleMessage","getBasicRoleDisabled","user","isUserSynced","selectors","OrgUsersTable","users","orgId","onRoleChange","onRemoveUser","fetchData","changePage","page","totalPages","rolesLoading","userToRemove","setUserToRemove","roleOptions","setRoleOptions","fetchOptions","options","columns","value","a","b","original","basicRoleDisabled","newRole","mapDispatchToProps","connector","InviteeRow","invitee","revokeInvite","ClipboardButton","Button","InviteesTable","invitees","index","selectAll","selectById","selectTotal","selectQuery","_state","query","selectInvitesMatchingQuery","invites","searchQuery","regex","invite","loadUsers","dispatch","getState","perPage","sort","accessControl","userIds","u","roles","fetchUsersWithDebounce","updateUser","removeUser","userId","changeSort","sortBy","changeSearchQuery","getUsers","state","getUsersSearchQuery","mapStateToProps","UsersActionBar","externalUserMngLinkName","externalUserMngLinkUrl","pendingInvitesCount","onShowInvites","showInvites","showInviteButton","config","InlineField","FilterInput","RadioButtonGroup","UsersListPageUnconnected","externalUserMngInfo","isLoading","fetchInvitees","setShowInvites","externalUserMngInfoHtml","role","renderTable","Page","UsersListPageContent","UsersListPage"],"sourceRoot":""}